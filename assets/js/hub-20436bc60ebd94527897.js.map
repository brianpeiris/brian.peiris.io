{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/telemetry.js","webpack:///./src/utils/i18n.js","webpack:///./src/storage/store.js","webpack:///./src/assets/avatars/avatars.js","webpack:///./src/react-components/info-dialog.js","webpack:///./src/utils/identity.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/assets/environments/environments.js","webpack:///./src/assets/images/help-hud.png","webpack:///./src/assets/images/help-hud@2x.png","webpack:///./src/react-components/link-dialog.js","webpack:///./src/react-components/create-object-dialog.js","webpack:///./src/assets/images/giphy_logo.png","webpack:///./src/utils/qs_truthy.js","webpack:///./src/utils/webgl.js","webpack:///./src/object-types.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/loop-animation.js","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/utils/media-utils.js","webpack:///./src/components/gamma-factor.js","webpack:///./src/assets/images/logo.svg","webpack:///./src/utils/link-channel.js","webpack:///./src/utils/crypto.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/App.js","webpack:///./src/utils/dpad.js","webpack:///./src/components/hand-controls2.js","webpack:///./src/components/layers.js","webpack:///./src/systems/app-mode.js","webpack:///./src/utils/auto-box-collider.js","webpack:///./src/utils/vr-caps-detect.js","webpack:///./src/hub.js","webpack:///./src/utils/logging.js","webpack:///./src/utils/audio-context-fix.js","webpack:///./src/behaviours/trackpad-dpad4.js","webpack:///./src/behaviours/trackpad-scrolling.js","webpack:///./src/behaviours/joystick-dpad4.js","webpack:///./src/behaviours/msft-mr-axis-with-deadzone.js","webpack:///./src/activators/pressedmove.js","webpack:///./src/activators/reversey.js","webpack:///./src/activators/shortpress.js","webpack:///./src/components/wasd-to-analog2d.js","webpack:///./src/components/mute-mic.js","webpack:///./src/components/bone-mute-state-indicator.js","webpack:///./src/components/bone-visibility.js","webpack:///./src/components/in-world-hud.js","webpack:///./src/components/virtual-gamepad-controls.js","webpack:///./src/components/ik-controller.js","webpack:///./src/components/character-controller.js","webpack:///./src/components/haptic-feedback.js","webpack:///./src/components/networked-video-player.js","webpack:///./src/components/offset-relative-to.js","webpack:///./src/components/water.js","webpack:///./src/components/skybox.js","webpack:///./src/components/spawn-controller.js","webpack:///./src/components/hide-when-quality.js","webpack:///./src/components/player-info.js","webpack:///./src/components/debug.js","webpack:///./src/components/hand-poses.js","webpack:///./src/components/gltf-bundle.js","webpack:///./src/components/hud-controller.js","webpack:///./src/components/freeze-controller.js","webpack:///./src/components/icon-button.js","webpack:///./src/components/text-button.js","webpack:///./src/components/block-button.js","webpack:///./src/components/visible-while-frozen.js","webpack:///./src/components/stats-plus.js","webpack:///./src/components/networked-avatar.js","webpack:///./src/components/css-class.js","webpack:///./src/components/scene-shadow.js","webpack:///./src/components/avatar-replay.js","webpack:///./src/components/media-views.js","webpack:///./src/assets/images/media-error.gif","webpack:///./src/components/pinch-to-move.js","webpack:///./src/components/look-on-mobile.js","webpack:///./src/components/pitch-yaw-rotator.js","webpack:///./src/components/input-configurator.js","webpack:///./src/utils/touch-events-handler.js","webpack:///./src/utils/mouse-events-handler.js","webpack:///./src/utils/gearvr-mouse-events-handler.js","webpack:///./src/utils/action-event-handler.js","webpack:///./src/components/sticky-object.js","webpack:///./src/components/auto-scale-cannon-physics-body.js","webpack:///./src/components/position-at-box-shape-border.js","webpack:///./src/components/remove-networked-object-button.js","webpack:///./src/components/destroy-at-extreme-distances.js","webpack:///./src/components/media-loader.js","webpack:///./src/assets/LoadingObject_Atom.glb","webpack:///./src/components/ambient-light.js","webpack:///./src/components/directional-light.js","webpack:///./src/components/hemisphere-light.js","webpack:///./src/components/point-light.js","webpack:///./src/components/spot-light.js","webpack:///./src/components/visible-to-owner.js","webpack:///./src/react-components/ui-root.js","webpack:///./src/assets/images/mic_denied.png","webpack:///./src/assets/images/mic_denied@2x.png","webpack:///./src/assets/images/mic_granted.png","webpack:///./src/assets/images/mic_granted@2x.png","webpack:///./src/assets/images/level_background.png","webpack:///./src/assets/images/level_background@2x.png","webpack:///./src/assets/images/level_fill.png","webpack:///./src/assets/images/level_fill@2x.png","webpack:///./src/assets/images/mic_level.png","webpack:///./src/assets/images/mic_level@2x.png","webpack:///./src/assets/images/speaker_level.png","webpack:///./src/assets/images/speaker_level@2x.png","webpack:///./src/assets/images/mic_small.png","webpack:///./src/assets/images/mic_small@2x.png","webpack:///./src/assets/images/dropdown_arrow.png","webpack:///./src/assets/images/dropdown_arrow@2x.png","webpack:///./src/assets/images/warning_icon.png","webpack:///./src/assets/images/warning_icon@2x.png","webpack:///./src/react-components/auto-exit-warning.js","webpack:///./src/react-components/entry-buttons.js","webpack:///./src/assets/images/mobile_screen_entry.svg","webpack:///./src/assets/images/desktop_screen_entry.svg","webpack:///./src/assets/images/generic_vr_entry.svg","webpack:///./src/assets/images/gearvr_entry.svg","webpack:///./src/assets/images/daydream_entry.svg","webpack:///./src/assets/images/device_entry.svg","webpack:///./src/react-components/profile-info-header.js","webpack:///./src/assets/images/account.svg","webpack:///./src/react-components/profile-entry-panel.js","webpack:///./src/react-components/2d-hud.js","webpack:///./src/utils/hub-channel.js","webpack:///./src/systems/nav.js","webpack:///./src/systems/personal-space-bubble.js","webpack:///./src/systems/exit-on-blur.js","webpack:///./src/components/super-networked-interactable.js","webpack:///./src/components/networked-counter.js","webpack:///./src/components/super-spawner.js","webpack:///./src/utils/async-utils.js","webpack:///./src/components/event-repeater.js","webpack:///./src/components/controls-shape-offset.js","webpack:///./src/components/duck.js","webpack:///./src/components/quack.js","webpack:///./src/components/grabbable-toggle.js","webpack:///./src/components/cardboard-controls.js","webpack:///./src/components/cursor-controller.js","webpack:///./src/components/nav-mesh-helper.js","webpack:///./src/systems/tunnel-effect.js","webpack:///./src/utils/postprocessing/EffectComposer.js","webpack:///./src/utils/postprocessing/RenderPass.js","webpack:///./src/utils/postprocessing/ShaderPass.js","webpack:///./src/utils/postprocessing/MaskPass.js","webpack:///./src/utils/shaders/CopyShader.js","webpack:///./src/utils/shaders/VignetteShader.js","webpack:///./src/components/tools/pen.js","webpack:///./src/components/tools/networked-drawing.js","webpack:///./src/utils/sharedbuffergeometrymanager.js","webpack:///./src/utils/sharedbuffergeometry.js","webpack:///./src/components/tools/drawing-manager.js","webpack:///./src/network-schemas.js","webpack:///./src/input-mappings.js","webpack:///./src/utils/concurrent-load-detector.js","webpack:///./src/assets/stylesheets/link-dialog.scss","webpack:///./src/assets/stylesheets/create-object-dialog.scss","webpack:///./src/assets/stylesheets/hub.scss","webpack:///./src/components/virtual-gamepad-controls.css","webpack:///./src/components/networked-video-player.css","webpack:///./src/assets/stylesheets/ui-root.scss","webpack:///./src/assets/stylesheets/entry.scss","webpack:///./src/assets/stylesheets/2d-hud.scss"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Raven","config","install","_ravenJs","_translationsData","navigatorLang","navigator","languages","language","userLanguage","toLowerCase","split","lang","localeData","messages","en","_jsonschema","_deepmerge","_eventTargetShim","_identity","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","validator","Validator","SCHEMA","id","definitions","profile","type","additionalProperties","properties","displayName","pattern","avatarId","activity","hasFoundFreeze","hasChangedName","lastEnteredAt","settings","lastUsedMicDeviceId","$ref","Store","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","getPrototypeOf","init","update","generateDefaultProfile","state","generateRandomName","localStorage","getItem","setItem","JSON","stringify","newState","finalState","_deepmerge2","default","isValid","validate","valid","Error","dispatchEvent","CustomEvent","parse","EventTarget","avatars","model","_react","_copyToClipboard","_propTypes","_reactIntl","_formUrlencoded","_linkDialog","_createObjectDialog","InfoDialog","props","_ref","onContainerClicked","e","currentTarget","target","onCloseDialog","onCustomSceneClicked","onCustomScene","customRoomName","customSceneUrl","shareLinkClicked","share","title","document","url","shareLink","copyLinkClicked","link","_copyToClipboard2","setState","copyLinkButtonText","mailingListEmail","mailingListPrivacy","createObjectUrl","signUpForMailingList","preventDefault","stopPropagation","payload","email","newsletters","privacy","fmt","source_url","location","href","fetch","body","_formUrlencoded2","method","headers","content-type","then","onSubmittedEmail","_x","arguments","loc","protocol","host","pathname","onKeyDown","addEventListener","removeEventListener","_this2","dialogType","_react2","createElement","dialogTitle","dialogBody","dialogTypes","slack","rel","email_submitted","invite","className","readOnly","onFocus","select","onClick","safari","create_object","_createObjectDialog2","onCreateObject","custom_scene","onSubmit","placeholder","onChange","required","updates","checked","FormattedMessage","report","help","style","textAlign","src","_image","srcSet","_image2","webvr_recommend","fontSize","_linkDialog2","linkCode","Component","propTypes","PropTypes","oneOf","values","func","string","selectRandom","names","Math","floor","random","avatarIds","_avatars","arr","map","av","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","texture","THREE","CubeTextureLoader","load","format","RGBFormat","contentType","preferredTechnique","onProgress","gltfUrl","fileMap","includes","Promise","resolve","reject","worker","SketchfabZipWorker","onmessage","_e$data","_slicedToArray","success","fileMapOrError","postMessage","getFilesFromSketchfabZip","gltfLoader","GLTFLoader","setLazy","_ref4","parser","materials","json","material","extensions","MOZ_alt_materials","undefined","altMaterialIndex","CachedEnvMapTexture","loadEnvMap","gltf","scene","scenes","cameras","animations","envMap","traverse","needsUpdate","keys","forEach","URL","revokeObjectURL","_sketchfabZipWorker","_posx","_negx","_posy","_negy","_posz","_negz","GLTFCache","inflateComponent","el","componentName","componentData","AFRAME","components","multiple","Array","isArray","setAttribute","GLTFModelPlus","registerComponent","componentKey","inflator","attachTemplate","root","templateRoot","targetEls","querySelectorAll","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","iterator","next","done","cloneNode","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","attributes","err","return","children","appendChild","schema","inflate","APP","quality","loadTemplates","applySrc","templates","templateEl","importNode","firstElementChild","content","getAttribute","_ref5","_asyncToGenerator","charAt","assetEl","getElementById","substring","lastSrc","inflatedEl","console","warn","removeInflatedEl","loadGLTF","skinnedMeshes","node","uuid","isSkinnedMesh","clone","cloneBones","cloneSkinnedMeshes","isBone","skinnedMesh","skeleton","cloneSkinnedMesh","orderedCloneBones","bones","cloneBone","Skeleton","boneInverses","matrixWorld","cloneGltf","object3DToSet","inflateEntities","isRoot","childEntities","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","child","nodeHasBehavior","userData","append","replace","classList","add","rotation","order","setFromQuaternion","quaternion","x","position","y","z","RAD2DEG","scale","matrixAutoUpdate","matrix","identity","setObject3D","object3D","parent","entityComponents","prop","_AFRAME$GLTFModelPlus","setTimeout","emit","error","_x5","_x6","parentNode","removeChild","EXTRA_ENVIRONMENTS","ALL_ENVIRONMENTS","concat","ENVIRONMENT_URLS","DEFAULT_ENVIRONMENT_URL","_classnames","LinkDialog","styles","domain","code","digit","keepOpen","_classnames2","codeLoadingPanel","_giphy_logo","_reactFontawesome","_faPaperclip","_faTimes","attributionHostnames","giphy.com","giphyLogo","media.giphy.com","DEFAULT_OBJECT_URL","isMobile","utils","device","mobileInstructions","desktopInstructions","lastUrl","CreateObjectDialog","file","fileName","onUrlChange","attributionImage","validity","hostname","onFileChange","files","onCreateClicked","reset","fileInput","cancelButton","smallButton","cancelIcon","FontAwesomeIcon","icon","faTimes","uploadButton","htmlFor","uploadIcon","faPaperclip","filenameLabel","leftSideOfInput","urlInput","addMediaForm","ref","f","hideFileInput","inputBorder","buttons","actionButton","param","val","qs","test","URLSearchParams","search","patchWebGLRenderingContext","userAgent","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","renderer","WebGLRenderer","Scene","Float32Array","size","dataTexture","DataTexture","RGBAFormat","FloatType","box","Mesh","PlaneBufferGeometry","MeshBasicMaterial","render","Camera","context","getError","dispose","checkFloatTextureSupport","objectTypeForOriginAndContentType","contentOrigin","prefix","objectTypeMimePrefixLookupMap","startsWith","types","objectTypeForOrigin","_toConsumableArray","ObjectTypes","UNKNOWN","ObjectContentOrigins","FILE","CLIPBOARD","SPAWNER","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","urlType","fileType","clipboardType","spawnerType","image/","model/","application/x-zip-compressed","video/","audio/","application/pdf","volume","prevVolume","smoothing","threshold","event","ctx","AudioContext","getContext","analyser","createAnalyser","fftSize","levels","Uint8Array","frequencyBinCount","detail","soundSource","connect","tick","getByteTimeDomainData","sum","amplitude","currVolume","sqrt","minScale","maxScale","visible","_data","audioAnalyser","min","setScalar","mixer","object3DMap","rootObject3D","mesh","setAnimationMixer","onModelLoaded","sceneObject3D","AnimationMixer","dt","destroy","dependencies","clip","animationMixerComponent","updateClipState","oldData","play","clipName","action","clipAction","enabled","setLoop","LoopRepeat","Infinity","stop","_objectTypes","mediaAPIEndpoint","_ref2","_ref3","fetchContentType","contentIndexCache","Map","resolveMediaCache","fetchMaxContentIndex","documentUrl","pageUrl","has","maxIndex","parseInt","set","_x2","_x3","upload","resolveMedia","skipContentType","index","parsedUrl","cacheKey","isHttpOrHttps","resolved","Content-Type","media","raw","origin","meta","expected_content_type","_x4","formData","FormData","interactableId","addMedia","template","resize","entity","orientation","callback","reader","File","FileReader","onload","view","DataView","getUint16","byteLength","offset","marker","getUint32","little","tags","readAsArrayBuffer","response","srcUrl","searchParams","access_token","catch","objectType","gammaFactor","isScene","prevData","sceneEl","needsShaderUpdate","time","isMesh","_crypto","LinkChannel","store","setSocket","socket","generateCode","onFinished","finished","step","toString","padStart","readyToSend","leftChannel","channel","timeout","leave","cancel","on","incoming","path","_extends","generatePublicKeyAndEncryptedObject","public_key","publicKeyString","encryptedData","target_session_id","reply_to_session_id","join","receive","attemptLink","generateKeys","privateKey","numOccupants","params","session_id","decryptObject","publicKey","crypto","subtle","deriveKey","public","exportKey","importKey","namedCurve","keyPair","generateKey","publicKeyToString","incomingPublicKeyString","obj","iv","incomingPublicKey","stringToPublicKey","secret","btoa","arrayBufferToString","encrypt","stringToArrayBuffer","base64value","ciphertext","atob","decrypt","buf","charCodeAt","b","String","fromCharCode","connectToReticulum","socketProtocol","socketHost","socketPort","_process$env$RETICULU","_process$env$RETICULU2","retHost","retPort","socketUrl","log","Socket","_v2","_v","_phoenix","disableiOSZoom","_detectBrowser","detectOS","lastTouchAtMs","ev","now","Date","getTime","isDoubleTouch","euler","Euler","Quaternion","setFromEuler","shape","halfExtents","_componentName","nav","systems","zone","found","loadMesh","_store","App","angleTo4Direction","angle","angleTo8Direction","direction","POSES","CONTROLLER_OFFSETS","Matrix4","oculus-touch-controls","makeTranslation","oculus-go-controls","vive-controls","compose","Vector3","DEG2RAD","windows-motion-controls","daydream-controls","gearvr-controls","pose","fingersDown","thumb","middle","ring","pinky","onMiddleRingPinkyDown","updatePose","onMiddleRingPinkyUp","onIndexDown","onIndexUp","onThumbDown","onThumbUp","onControllerConnected","onControllerDisconnected","connectedController","pause","hand","controlConfiguration","orientationOffset","remove","nextFingersDown","assign","determinePose","previous","current","_fingersDown","getControllerOffset","Layers","reflection","layers","enable","disable","AppModes","freeze","DEFAULT","HUD","registerSystem","setMode","newMode","invert","AppModeSystem","updateComponentState","isModeActive","modes","actionSets","_this3","idx","indexOf","inputActions","currentInputMapping","inVRMode","is","getBox","boxRoot","Box3","copy","updateMatrixWorld","setFromObject","worldToLocal","max","getScaleCoefficient","dX","abs","dY","dZ","lengthOfLongestComponent","ua","isSamsungBrowser","browser","isOculusBrowser","isWebVRCapableBrowser","hasNativeWebVRImplementation","isDaydreamCapableBrowser","isIDevice","isIOS","isFirefoxBrowser","isUIWebView","mediaDevices","VR_DEVICE_AVAILABILITY","maybe","yes","no","displays","getVRDisplays","isInHMD","screen","isNonWebVRFirefox","generic","cardboard","gearvr","isMaybeGearVRCompatibleDevice","daydream","isMaybeDaydreamCompatibleDevice","find","capabilities","canPresent","GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST","hasDaydreamWebVRDevice","detect","_webgl","_screenfull","_trackpadDpad","_trackpadScrolling","_joystickDpad","_msftMrAxisWithDeadzone","_pressedmove","_reversey","_reactDom","_uiRoot","_hubChannel","_linkChannel","_phoenixUtils","_disableIosZoom","_mediaUtils","_environments","_App","_networkSchemas","_inputMappings","_telemetry","_vrCapsDetect","_concurrentLoadDetector","_qs_truthy","NODE_ENV","JANUS_SERVER","RETICULUM_SERVER","ASSET_BUNDLE_SERVER","BUILD_VERSION","RENDER_ORDER","HUD_BACKGROUND","HUD_ICONS","CURSOR","isBotMode","_qs_truthy2","isTelemetryDisabled","isDebug","_telemetry2","registerInputBehaviour","trackpad_dpad4","trackpad_scrolling","joystick_dpad4","msft_mr_axis_with_deadzone","registerInputActivator","PressedMove","ReverseY","registerInputMappings","inputConfig","concurrentLoadDetector","ConcurrentLoadDetector","mountUI","disableAutoExitOnConcurrentLoad","forcedVREntryType","enableScreenSharing","showProfileEntry","ReactDOM","_uiRoot2","requestFullscreen","screenfull","isFullscreen","request","start","onReady","querySelector","hubChannel","HubChannel","linkChannel","_networkSchemas2","uiProps","remountUI","exitScene","NAF","connection","adapter","localMediaStream","getTracks","disconnect","setAnimationLoop","enterScene","mediaStream","enterInVR","hubId","aframeInspectorUrl","playerRig","enterVR","registerInputActions","inGameActions","room","serverURL","debug","applyProfileOnPlayerRig","avatarSrc","hudController","showTip","username","avatarScale","videoTracks","getVideoTracks","sharingScreen","screenEntityId","clientId","screenEntity","track","addTrack","removeTrack","setLocalMediaStream","entities","removeEntitiesOfClient","completeSync","spawnMediaInfrontOfPlayer","_addMedia","or","sendObjectSpawnedEvent","nodeName","clipboardData","getData","dataTransfer","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","sendEntryEvent","toISOString","occupantCount","publisher","initialOccupants","occupants","connectError","isFull","msg","match","roomUnavailableReason","session","options","verbose","camera","leftController","rightController","audioEl","audioInput","onchange","loop","muted","crossorigin","createObjectURL","dataInput","recordingUrl","captureStream","getAudioTracks","platformUnsupportedReason","RTCDataChannelEvent","buildNumber","reload","getAvailableVREntryTypes","availableVREntryTypes","environmentRoot","initialEnvironmentEl","initialEnvironmentLoaded","noop","setRoom","hubName","enterSceneImmediately","MediaStream","hasLoaded","hub","hubs","defaultSpaceTopic","topics","sceneUrl","assets","a","asset_type","gltfEl","hub_id","setPhoenixChannel","res","reason","_debug","logFilter","resume","_dpad","outputPrefix","lastDirection","pressed","emitDPad4","press","unpress","hapticIntensity","centerRadius","addEventListeners","removeEventListeners","axis","inCenter","atan2","move","end","isScrolling","emittedEventDetail","onStart","onMove","onEnd","angleToDirection","intensity","deadzone","emitAxisMoveWithDeadzone","button","onActivate","down","up","onButtonDown","onButtonUp","onAxisMove","removeListeners","emitReverseY","ShortPress","lastTime","timeOut","eventNameDown","eventNameUp","pressTimer","clearTimeout","analog2dOutputAction","output","vectors","w","onWasd","onBlur","keyEvent","targetMagnitude","bindAllEvents","elements","events","_loop","unbindAllEvents","_loop2","eventSrc","toggleEvents","muteEvents","unmuteEvents","onToggle","onMute","onUnmute","_data2","enableMicrophone","removeState","addState","unmutedBoneName","mutedBoneName","onPos","offPos","onStateToggled","unmutedBone","getObjectByName","mutedBone","modelLoaded","updateMuteState","lastVisible","haptic","raycaster","mic","pen","background","renderOrder","renderORder","updateButtonStates","onStateChange","evt","onMicClick","onFreezeClick","onPenClick","_nipplejs","_virtualGamepadControls","onEnterVr","onExitVr","onFirstInteraction","onMoveJoystickChanged","onMoveJoystickEnd","onLookJoystickChanged","onLookJoystickEnd","mockJoystickContainer","leftMock","mockJoystick","leftMockSmall","inner","rightMock","rightMockSmall","leftTouchZone","touchZone","left","leftStick","nipplejs","color","fadeTime","rightTouchZone","right","rightStick","inVr","moving","rotating","moveEvent","rotateYEvent","rotateXEvent","off","joystick","radian","force","cos","sin","display","leftEye","rightEye","head","neck","leftHand","rightHand","chest","hips","rotationSpeed","flipY","makeRotationY","PI","cameraForward","headTransform","hipsPosition","invHipsToHeadVector","middleEyeMatrix","middleEyePosition","invMiddleEyeToHead","cameraYRotation","cameraYQuaternion","invHipsQuaternion","headQuaternion","rootToChest","invRootToChest","ikRoot","findIKRoot","hands","makeRotationFromEuler","addVectors","divideScalar","getInverse","negate","_ikRoot","updateMatrix","multiplyMatrices","setFromMatrixPosition","setFromRotationMatrix","slerp","inverse","premultiply","updateHand","handState","handObject3D","controller","handMatrix","controllerObject3D","spaceInvader","handHiddenByPersonalSpace","invading","handControls","multiply","trans","transInv","pivotPos","rotationAxis","yawMatrix","rotationMatrix","rotationInvMatrix","pivotRotationMatrix","pivotRotationInvMatrix","startPos","startScale","groundAcc","easing","pivot","snapRotationDegrees","navZone","navGroup","navNode","velocity","accelerationInput","pendingSnapRotationMatrix","angularVelocity","setAccelerationInput","snapRotateLeft","snapRotateRight","setAngularVelocity","handleTeleport","leftRotationMatrix","rightRotationMatrix","axes","newPosition","navPosition","hitPoint","resetPositionOnNavMesh","deltaSeconds","distance","rotationDelta","applyMatrix4","setPosition","makeRotationAxis","updateVelocity","decompose","lengthSq","setPositionOnNavMesh","pathfinder","zones","getGroup","getClosestNode","clampStep","dvx","dvz","strengthForIntensity","low","medium","high","hapticEventName","handlePulse","getActuator","actuator","tryGetActivator","trackedControls","hapticActuators","pulse","Number","_networkedVideoPlayer","networkedEl","getNetworkedEntity","ownerId","networked","owner","rejectScreenShares","container","stream","getMediaStream","v","autoplay","playsInline","video","srcObject","videoEl","onloadedmetadata","ratio","videoWidth","videoHeight","width","height","QUARTER_CIRCLE","offsetVector","selfDestruct","updateOffset","localToWorld","getWorldQuaternion","rotateOnAxis","removeAttribute","_layers","MobileWater","geometry","normalSampler","waterNormals","sunDirection","sunColor","Color","waterColor","eye","distortionScale","side","FrontSide","fog","mirrorShader","uniforms","UniformsUtils","merge","UniformsLib","vertexShader","fragmentShader","ShaderChunk","ShaderMaterial","transparent","lights","constructor","Water","inclination","azimuth","speed","forceMobile","normalMap","waterMesh","getObject3D","waterGeometry","Texture","wrapS","wrapT","RepeatWrapping","waterConfig","textureWidth","textureHeight","water","mirrorCamera","removeObject3D","setStyle","theta","phi","Sky","shader","SkyShader","BackSide","BoxBufferGeometry","luminance","turbidity","rayleigh","mieCoefficient","mieDirectionalG","sunPosition","sky","normalize","loadedEvent","onLoad","spawnPoints","spawnPointIndex","round","spawnPoint","getWorldPosition","onQualityChanged","applyProperties","nametagEl","modelEl","info","open","thumbDown","indexDown","mrpDown","thumbUp","point","fist","pinch","NETWORK_POSES","animatePose","rootObj","clipActionObject","suffix","from","to","networkedAvatar","getNetworkedAvatar","parentEl","prev","curr","fadeOut","fadeIn","setHandPose","_addGltfEntitiesForBundleJson","baseURL","LoaderUtils","extractUrlBase","bundleJson","loaded","asset","all","_appMode","TWOPI","lookCutoff","animRange","yawCutoff","isYLocked","lockedHeadPositionY","lookDir","lookEuler","hud","pitch","yawDif","clamp","hudLocked","applyQuaternion","toggleEvent","toggleFreeze","frozen","image","hoverImage","activeImage","activeHoverImage","active","tooltip","tooltipText","activeTooltipText","onHover","hovering","updateButtonState","emitHapticPulse","onHoverOut","textHoverColor","textColor","backgroundHoverColor","backgroundColor","textEl","raycast","block","unblock","toggle","onExpand","onCollapse","stats","threeStats","aframeStats","plugins","rStats","css","fps","caption","below","groups","createStats","statsEl","statsHeaderEl","statsTitleEl","innerHTML","collapseEl","insertBefore","firstChild","fpsEl","lastFpsUpdate","performance","lastFps","frameCount","frame","hide","show","left_hand_pose","right_hand_pose","originalShadowProperties","controlsBlacklist","fetchRecording","resp","_setupController","dataLoaded","recording","cameraReplayer","startReplaying","leftControllerReplayer","rightControllerReplayer","controlsComponent","GIFWorker","frames","delays","disposals","loadCnt","img","Image","GIFTexture","encoding","sRGBEncoding","minFilter","LinearFilter","arrayBuffer","rawImageData","_gifparsingWorker","_mediaError","_ctx","generateMipmaps","isVideoTexture","NearestFilter","frameStartTime","clearRect","drawImage","createVideoTexture","preload","crossOrigin","createVideoEl","VideoTexture","once","onerror","isHLS","needsCorrectionBGRA","needsCorrectionFlipY","createPlaneMesh","DoubleSide","PlaneGeometry","fitToTexture","textureLoader","TextureLoader","disposeTexture","HTMLVideoElement","setCrossOrigin","TextureCache","cache","count","retain","cacheItem","delete","textureCache","errorImage","errorImageSrc","errorTexture","magFilter","videoPaused","tickRate","syncTolerance","onPauseStateChange","togglePlayingIfOwner","lastUpdate","updatePlaybackState","audioListener","AudioListener","cameraEl","isMine","paused","updateTexture","audioSource","createMediaElementSource","sound","PositionalAudio","setNodeSource","currentTime","release","createGIFTexture","xhr","status","statusText","onPinch","prevPinch","needsMove","diff","_e$detail","isNewPinch","CircularBuffer","items","fill","writePtr","item","difference","average","horizontalLookSpeedRatio","verticalLookSpeedRatio","hmdEuler","hmdQuaternion","prevX","prevY","pendingLookX","onRotateX","dXBuffer","dYBuffer","vrDisplay","webvrpolyfill","getPolyfillDisplays","frameData","VRFrameData","cameraController","getFrameData","fromArray","deltaYaw","deltaPitch","look","degToRad","minPitch","maxPitch","yaw","_touchEventsHandler","_mouseEventsHandler","_gearvrMouseEventsHandler","_actionEventHandler","cursorController","gazeTeleporter","leftControllerRayObject","rightControllerRayObject","gazeCursorRayObject","inVR","eventHandlers","controllerQueue","hasPointingDevice","cursor","handedness","onEnterVR","onExitVR","handleControllerConnected","handleControllerDisconnected","configureInput","tearDown","updateController","h","actionEventHandler","lookOnMobile","cursorRequiresManagement","addLookOnMobile","ActionEventHandler","GearVRMouseEventsHandler","MouseEventsHandler","setCursorVisibility","TouchEventsHandler","manageCursorEnabled","component","unshift","controllerData","rayObject","setHandThatAlsoDrivesCursor","pinchEmitter","touches","touchReservedForCursor","touchesReservedForPinch","touchReservedForLookControls","needsPinch","pinchTouchId1","pinchTouchId2","handleTouchStart","singleTouchStart","handleTouchMove","singleTouchMove","handleTouchEnd","singleTouchEnd","changedTouches","touch","clientY","innerHeight","targetX","clientX","innerWidth","targetY","moveCursor","forceCursorUpdate","startInteraction","identifier","some","pinchIndex","findIndex","t1","t2","pinchDistance","prevTouch","touchIndex","endInteraction","x1","y1","x2","y2","superHand","isLeftButtonDown","isLeftButtonHandledByCursor","isPointerLocked","onMouseDown","onMouseMove","onMouseUp","onMouseWheel","lastVerticalScrollTime","lastHorizontalScrollTime","onContextMenu","invertMouseLook","onLeftButtonDown","onRightButtonDown","isToggle","isInteracting","exitPointerLock","requestPointerLock","changed","altKey","shiftKey","changeDistanceMod","getScrollMod","deltaY","deltaMode","delta","deltaX","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","DOM_DELTA_PAGE","shouldLook","matches","sign","movementY","movementX","isMouseDownHandledByCursor","isMouseDownHandledByGazeTeleporter","cursorHand","isCursorInteracting","isTeleporting","handThatAlsoDrivesCursor","hovered","gotPrimaryDown","onPrimaryDown","onPrimaryUp","onSecondaryDown","onSecondaryUp","onPrimaryGrab","onPrimaryRelease","onSecondaryGrab","onSecondaryRelease","onCardboardButtonDown","onCardboardButtonUp","onScrollMove","scrollY","scrollX","isHandThatAlsoDrivesCursor","isCursorHand","onGrab","onRelease","onDown","onUp","gazeTeleport","handHoveredThisFrame","handStoppedHoveringThisFrame","autoLockOnLoad","autoLockOnRelease","autoLockSpeedLimit","_onGrab","_onRelease","_onBodyLoaded","hasSetupBodyLoaded","setLocked","locked","lengthSquared","stuckTo","_unstickObject","worldQuaternion","worldPosition","dir","bootImpulsePosition","CANNON","Vec3","bootImpulse","_onCollisions","els","stickyObject","_setStuckObject","stuckObject","clearedEls","collisionResponse","applyImpulse","equalityEpsilon","debounceDelay","prevScale","nextUpdateTime","epsilon","u","updateCannonScale","camWorldPos","targetPosition","pointOnBoxFace","_autoBoxCollider","HALF_PI","THREE_HALF_PI","forward","back","dirs","halfExtent","inverseHalfExtents","cam","multiplyScalar","minSquareDistance","targetDir","targetHalfExtentStr","targetHalfExtent","targetRotation","halfExtentStr","squareDistance","distanceToSquared","targetEl","pos","xMin","xMax","yMin","yMax","zMin","zMax","_LoadingObject_Atom","loadingObject","loadingObjectSrc","onError","showLoader","clearLoadingTimeout","shapeAdded","hasBakedShapes","setShapeAndScale","scaleCoefficient","shapes","center","sub","loaderMixer","showLoaderTimeout","useFancyLoader","BoxGeometry","loadingClip","images","isPDF","png","imageSrc","imageContentType","endsWith","onNext","onPrev","toolbar","nextButton","prevButton","pageLabel","repositionToolbar","light","AmbientLight","registerLight","castShadow","DirectionalLight","skyColor","groundColor","HemisphereLight","range","PointLight","decay","innerConeAngle","outerConeAngle","SpotLight","penumbra","newOwner","enumerateDevices","filter","label","kind","_en","_movingAverage","_entry","_i18n","_autoExitWarning","_entryButtons","_profileInfoHeader","_profileEntryPanel","_infoDialog","_dHud","_faUsers","_faQuestion","addLocaleData","ENTRY_STEPS","mic_grant","mic_granted","audio_setup","HMD_MIC_REGEXES","AUTO_EXIT_TIMER_SECONDS","UIRoot","_ref8","_ref10","_ref11","_ref12","entryStep","infoDialogType","linkCodeCancel","shareScreen","requestedScreen","videoTrack","audioTrack","toneInterval","tonePlaying","micLevel","micDevices","micUpdateInterval","profileNamePending","autoExitTimerStartedAt","autoExitTimerInterval","secondsRemainingBeforeAutoExit","spacebubble","exited","onSceneLoaded","sceneLoaded","onAframeStateChanged","toggleMute","toggleSpaceBubble","spawnPen","handleForcedVREntryType","enterDaydream","enter2D","playTestTone","toneClip","testToneTimeout","stopTestTone","onConcurrentLoad","setInterval","secondsSinceStart","checkForAutoExit","endAutoExitTimer","exit","isWaitingForAutoExit","clearInterval","hasGrantedMicPermissions","grantedMicLabels","performDirectEntryFlow","hasGrantedMic","setMediaStreamToDefault","beginOrSkipAudioSetup","linkSafari","intentUrl","micDeviceChanged","constraints","audio","deviceId","exact","fetchAudioTrack","setupNewMediaStream","hasAudio","ideal","setStateAndRequestScreen","fetchVideoTrack","mediaSource","frameRate","getUserMedia","fetchMicDevices","webkitAudioContext","micLevelAudioContext","micSource","createMediaStreamSource","level","micLevelMovingAverage","movingAverage","micDeviceId","micDeviceIdForMicLabel","micLabelForMediaStream","onMicGrantButton","_ref15","onProfileFinished","onAudioReadyButton","shouldShowHmdMicWarning","hasHmdMicrophone","selectedMicLabel","selectedMicDeviceId","close","_ref17","handleCloseDialog","handleCreateObject","_movingAverage2","prevProps","subtitle","exitSubtitleId","IntlProvider","locale","accept","screenSharingCheckbox","entryStyles","screenSharing","checkbox","entryPanel","buttonContainer","TwoDEntryButton","SafariEntryButton","GenericEntryButton","DaydreamEntryButton","DeviceEntryButton","secondary","inviteButton","micPanel","_image3","_image4","_image5","micClip","speakerClip","subtitleId","audioSetupPanel","_image6","_image7","_image8","_image9","_image10","_image11","_image12","_image13","_image14","_image15","_image16","_image17","_image18","_image19","dialogContents","_autoExitWarning2","secondsRemaining","onCancel","entryDialog","ProfileInfoHeader","onClickName","onClickHelp","dialogBoxClassNames","ui-interactive","ui-dialog-box","dialogBoxContentsClassNames","ui-dialog-box-contents","ui-dialog-box-contents--backgrounded","_infoDialog2","faQuestion","presenceInfo","faUsers","_profileEntryPanel2","_dHud2","TopHUD","onToggleMute","onToggleFreeze","onToggleSpaceBubble","onSpawnPen","nagButton","BottomHUD","showPhotoPicker","onMediaPicked","bool","number","AutoExitWarning","_mobile_screen_entry","_desktop_screen_entry","_generic_vr_entry","_gearvr_entry","_daydream_entry","_device_entry","EntryButton","entryButton","iconSrc","contents","prefixMessageId","bolded","mediumMessageId","entryButtonProps","MobileScreenEntryImg","DesktopScreenEntryImg","GenericVREntryImg","GearVREntryButton","GearVREntryImg","DaydreamEntryImg","DeviceEntryImg","ProfileEntryPanel","_initialiseProps","_this$props$store$sta","storeUpdated","nameInput","setAvatarStateFromIframeMessage","formatMessage","intl","saveStateAndFinish","spellCheck","inp","ifr","avatarSelector","_props$store$state$pr","hasChangedNowOrPreviously","source","contentWindow","injectIntl","top","unselectable","panel","iconButton","mute","_defineProperty","large","spawn_pen","column","bottom","mobileMediaPicker","createObject","isSameMonth","da","db","getFullYear","getMonth","entryDisplayType","isPresenting","initialOccupantCount","entryTimingFlags","getEntryTimingFlags","entryEvent","isNewDaily","isNewMonthly","isNewDayWindow","isNewMonthWindow","storedLastEnteredAt","lastEntered","msSinceLastEntered","getDate","spawnEvent","object_type","Pathfinding","Geometry","fromBufferGeometry","applyMatrix","setZoneData","createZone","invaderPos","bubblePos","createSphereGizmo","radius","SphereBufferGeometry","wireframe","WireframeGeometry","line","LineSegments","opacity","invaders","bubbles","registerBubble","bubble","unregisterBubble","registerInvader","invader","getNetworkOwner","unregisterInvader","updateDebug","setInvading","distanceSquared","radiusSum","meshName","targetMesh","useMaterial","invadingOpacity","system","findInvaderMesh","targetMaterial","radiusSquared","onTimeout","enteredVR","exitTimeout","hapticsMassVelocityFactor","counter","scrollScaleDelta","physics","currentScale","register","_stateAdded","_onGrabStart","_onGrabEnd","_onOwnershipLost","addComponent","deregister","removeComponent","takeOwnership","_changeScale","addScalar","clampScalar","stretchBody","ttl","grab_event","release_event","registeredEls","onGrabHandler","onReleaseHandler","clear","grabEventListener","_onGrabbed","releaseEventListener","_onReleased","ts","_startTimer","_destroyOldest","_registeredEls$get","oldestEl","minTs","MAX_VALUE","_destroy","_asyncUtils","nextGrabId","useCustomSpawnPosition","spawnPosition","useCustomSpawnRotation","spawnRotation","useCustomSpawnScale","spawnScale","grabEvents","releaseEvents","spawnCooldown","centerSpawnedObject","cursorSuperHand","heldEntities","cooldownTimeout","onGrabStart","onGrabEnd","onSpawnEvent","controllerCount","using6DOF","activateCooldown","waitForEvent","targetEntity","thisGrabId","eventName","eventObj","eventSource","eventListeners","_handleEvent","_handControls","additionalOffset","_handleControllerConnected","hasOffset","conjugate","initialForce","maxForce","physicsSystem","hasBody","initialScale","beforeStep","applyForce","quackPercentage","specialQuackPercentage","_handleGrabStart","rand","objPos","grabPos","q","inherit","extendDeep","physicsCore","buttonsCore","base","maxGrabbers","NaN","suppressY","primaryReleaseEvents","secondaryReleaseEvents","GRABBED_STATE","GRAB_EVENT","UNGRAB_EVENT","grabbed","grabbers","deltaPositionIsValid","grabDistance","grabDirection","grabOffset","destPosition","deltaPosition","physicsInit","lostGrabber","lastGrabber","physicsUpdate","xFactor","zFactor","yFactor","entityPosition","grabber","setLength","physicsRemove","defaultPrevented","startButtonOk","grabAvailable","isFinite","onGrabEndButton","physicsStart","resetGrabber","handIndex","endButtonOk","buttonEvent","isPrimaryRelease","isSecondaryRelease","physicsEnd","distanceTo","relatedTarget","physicsIsConstrained","gamepad","isVR","_handleEnterVR","_handleExitVR","_getGamepad","getGamepads","gamepads","rayObjectRotation","cameraPos","maxDistance","minDistance","cursorColorHovered","cursorColorUnhovered","useMousePos","drawLine","currentTargetType","currentDistance","currentDistanceMod","mousePos","Vector2","wasCursorHovered","raycasterAttr","controllerQuaternion","_handleCursorLoaded","updateRay","setRaycasterWithMousePos","isGrabbing","updateDistanceAndTargetType","isTarget","_isTargetOfType","TARGET_TYPE_INTERACTABLE","lookAt","setFromCamera","ray","intersection","intersections","mask","checkIntersections","syncToPhysics","targetDistanceMod","moddedDistance","teleportControls","queryCollisionEntities","disabledByQueryString","lerp","targetComponent","minRadius","maxSpeed","softest","isMoving","isPostProcessingReady","characterEl","_initPostProcessing","_enterVR","_exitVR","characterSpeed","characterComponent","shaderRadius","vignettePass","_bindRenderFunc","_exitTunnel","clampedSpeed","speedRatio","targetRadius","targetSoftness","_updateVignettePass","originalRenderFunc","_initComposer","isDigest","postProcessingRenderFunc","composer","EffectComposer","scenePass","RenderPass","ShaderPass","VignetteShader","softness","addPass","_renderer$getSize","getSize","pixelRatio","getPixelRatio","Uniform","renderToScreen","renderTarget","parameters","stencilBuffer","getDrawingBufferSize","WebGLRenderTarget","renderTarget1","renderTarget2","writeBuffer","readBuffer","passes","maskActive","CopyShader","copyPass","swapBuffers","pass","needsSwap","stencilFunc","NOTEQUAL","EQUAL","tmp","MaskPass","ClearMaskPass","setSize","insertPass","starti","il","scope","currentOnAfterRender","vr","onAfterRender","rendererSize","Pass","overrideMaterial","clearColor","clearAlpha","clearDepth","oldAutoClear","autoClear","oldClearColor","oldClearAlpha","getClearColor","getHex","getClearAlpha","setClearColor","textureID","defines","OrthographicCamera","quad","frustumCulled","buffers","setMask","depth","writeValue","clearValue","stencil","setTest","setOp","REPLACE","setFunc","ALWAYS","setClear","KEEP","tDiffuse","resolution","directionToCamera","drawFrequency","minDistanceBetweenPoints","drawingManager","availableColors","maxRadius","_stateRemoved","timeSinceLastDraw","lastPosition","currentDrawing","normal","colorIndex","subVectors","getLastPoint","_getNormal","draw","crossVectors","_startDraw","getDrawing","startDraw","_endDraw","endDraw","returnDrawing","_changeColor","mod","_changeRadius","_sharedbuffergeometrymanager","calculatedDirection","copyDirection","copyNormal","projectedDirection","projectedPoint","capNormal","copyArray","copyData","toArray","fromIndex","toIndex","segments","defaultRadius","minDrawTimeout","maxDrawTimeout","maxLines","maxPointsPerLine","_receiveData","networkBuffer","sendNetworkBufferQueue","drawStarted","lineStarted","remoteLineStarted","receivedBufferParts","bufferIndex","connectedToOwner","networkBufferInitialized","vertexColors","VertexColors","MeshStandardMaterial","sharedBufferGeometryManager","SharedBufferGeometryManager","addSharedBuffer","TriangleStripDrawMode","lastPoint","lastSegments","currentSegments","sharedBuffer","getSharedBuffer","drawing","prevIdx","vertexCount","networkBufferCount","currentPointCount","networkBufferHistory","onConnect","networkId","getNetworkId","drawingId","subscribeToDataChannel","unsubscribeToDataChannel","connected","isConnected","hasActiveDataChannel","sendDataGuaranteed","_broadcastDrawing","_drawFromNetwork","_sendNetworkBuffer","_deleteLines","broadcastDataGuaranteed","buffer","didWork","setHex","_draw","_updateBuffer","datum","idxLength","uv","parts","ceil","_","dataType","_addToNetworkBuffer","getHexString","toUpperCase","radiusMultiplier","_generateSegments","_drawCylinder","_drawEndCap","_endLine","_addDegenerateTriangle","_restartPrimitive","_drawCap","_drawPoint","_pushToNetworkBuffer","_addVertex","segmentIndex","restartPrimitive","segment","addVertex","addColor","g","addNormal","segmentsList","angleIncrement","_rotatePointAroundAxis","out","applyAxisAngle","_sharedbuffergeometry","sharedBuffers","primitiveMode","SharedBufferGeometry","maxBufferSize","geometries","Object3D","addBuffer","array","copyLast","BufferGeometry","vertices","normals","colors","drawMode","setDrawRange","addAttribute","BufferAttribute","setDynamic","col","norm","setXYZ","_onComponentInitialized","drawingToPen","drawingEl","vectorRequiresUpdate","almostEqualVec3","schemas","requiresNetworkUpdate","selector","snap_rotate_left","snap_rotate_right","action_mute","action_teleport_down","action_teleport_up","action_share_screen","action_ui_select_down","action_ui_select_up","behaviours","trackpad","axisMoveWithDeadzone","mappings","trackpad.pressedmove","trackpad_dpad4_pressed_west_down","trackpad_dpad4_pressed_east_down","trackpad_dpad4_pressed_center_down","trackpad_dpad4_pressed_north_down","trackpad_dpad4_pressed_south_down","trackpadup","menudown","menuup","gripdown","gripup","trackpadtouchstart","trackpadtouchend","triggerdown","triggerup","scroll","joystick_dpad4_west","joystick_dpad4_east","abuttontouchstart","abuttontouchend","bbuttontouchstart","bbuttontouchend","xbuttontouchstart","xbuttontouchend","ybuttontouchstart","ybuttontouchend","surfacetouchstart","surfacetouchend","thumbsticktouchstart","thumbsticktouchend","axismove.reverseY","abuttondown","abuttonup","joystick_dpad4_pressed_west_down","joystick_dpad4_pressed_east_down","trackpaddown","keyboard","m_press","q_press","e_press","b_press","w_down","w_up","a_down","a_up","s_down","s_up","d_down","d_up","arrowup_down","arrowup_up","arrowleft_down","arrowleft_up","arrowdown_down","arrowdown_up","arrowright_down","arrowright_up","instanceKey","startedAt","localStorageKey","started_at","interval","currentState","maxStartedAt","keep-open","code-loading-panel","action-button","input-border","add-media-form","small-button","cancel-icon","upload-icon","left-side-of-input","hide-file-input","nag-button","entry-panel","button-container","invite-button","entry-button","screen-sharing","presence-info","occupant-count","entry-dialog","people","webvr-link-container","webvrLinkContainer","webvr-link","webvrLink","small","create-object","mobile-media-picker"],"mappings":"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","file":"assets/js/hub-20436bc60ebd94527897.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([175,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import Raven from \"raven-js\";\n\nexport default function registerTelemetry() {\n  if (process.env.NODE_ENV === \"production\") {\n    Raven.config(\"https://013d6a364fed43cdb0539a61d520597a@sentry.prod.mozaws.net/370\").install();\n  }\n}\n","import localeData from \"../assets/translations.data.json\";\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\nexport const messages = localeData[lang] || localeData.en;\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { generateDefaultProfile, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9-]{3,32}$\" },\n        avatarId: { type: \"string\" }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n  }\n\n  // Initializes store with any default bits\n  init = () => {\n    this.update({\n      activity: {},\n      settings: {},\n      profile: { ...generateDefaultProfile(), ...(this.state.profile || {}) }\n    });\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  update(newState) {\n    const finalState = merge(this.state, newState);\n    const isValid = validator.validate(finalState, SCHEMA).valid;\n\n    if (!isValid) {\n      throw new Error(`Write of ${JSON.stringify(finalState)} to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","export const avatars = [\n  {\n    id: \"botdefault\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf\"\n  },\n  {\n    id: \"botbobo\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf\"\n  },\n  {\n    id: \"botdom\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf\"\n  },\n  {\n    id: \"botgreg\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf\"\n  },\n  {\n    id: \"botguest\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf\"\n  },\n  {\n    id: \"botjim\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf\"\n  },\n  {\n    id: \"botkev\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf\"\n  },\n  {\n    id: \"botpinky\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf\"\n  },\n  {\n    id: \"botrobert\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf\"\n  },\n  {\n    id: \"botwoody\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf\"\n  }\n];\n","import React, { Component } from \"react\";\nimport copy from \"copy-to-clipboard\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport formurlencoded from \"form-urlencoded\";\nimport LinkDialog from \"./link-dialog.js\";\nimport CreateObjectDialog from \"./create-object-dialog.js\";\nconst HUB_NAME_PATTERN = \"^[A-Za-z0-9-'\\\":!@#$%^&*(),.?~ ]{4,64}$\";\n\n// TODO i18n\n\nclass InfoDialog extends Component {\n  static dialogTypes = {\n    slack: Symbol(\"slack\"),\n    email_submitted: Symbol(\"email_submitted\"),\n    invite: Symbol(\"invite\"),\n    safari: Symbol(\"safari\"),\n    updates: Symbol(\"updates\"),\n    report: Symbol(\"report\"),\n    help: Symbol(\"help\"),\n    link: Symbol(\"link\"),\n    webvr_recommend: Symbol(\"webvr_recommend\"),\n    create_object: Symbol(\"create_object\"),\n    custom_scene: Symbol(\"custom_scene\")\n  };\n  static propTypes = {\n    dialogType: PropTypes.oneOf(Object.values(InfoDialog.dialogTypes)),\n    onCloseDialog: PropTypes.func,\n    onSubmittedEmail: PropTypes.func,\n    onCreateObject: PropTypes.func,\n    onCustomScene: PropTypes.func,\n    linkCode: PropTypes.string\n  };\n\n  constructor(props) {\n    super(props);\n\n    const loc = document.location;\n    this.shareLink = `${loc.protocol}//${loc.host}${loc.pathname}`;\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.onContainerClicked = this.onContainerClicked.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  onKeyDown(e) {\n    if (e.key === \"Escape\") {\n      this.props.onCloseDialog();\n    }\n  }\n\n  onContainerClicked = e => {\n    if (e.currentTarget === e.target) {\n      this.props.onCloseDialog();\n    }\n  };\n\n  onCustomSceneClicked = () => {\n    this.props.onCustomScene(this.state.customRoomName, this.state.customSceneUrl);\n    this.props.onCloseDialog();\n  };\n\n  shareLinkClicked = () => {\n    navigator.share({\n      title: document.title,\n      url: this.shareLink\n    });\n  };\n\n  copyLinkClicked = link => {\n    copy(link);\n    this.setState({ copyLinkButtonText: \"copied!\" });\n  };\n\n  state = {\n    mailingListEmail: \"\",\n    mailingListPrivacy: false,\n    copyLinkButtonText: \"copy\",\n    createObjectUrl: \"\",\n    customRoomName: \"\",\n    customSceneUrl: \"\"\n  };\n\n  signUpForMailingList = async e => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!this.state.mailingListPrivacy) return;\n\n    const url = \"https://www.mozilla.org/en-US/newsletter/\";\n\n    const payload = {\n      email: this.state.mailingListEmail,\n      newsletters: \"hubs\",\n      privacy: true,\n      fmt: \"H\",\n      source_url: document.location.href\n    };\n\n    await fetch(url, {\n      body: formurlencoded(payload),\n      method: \"POST\",\n      headers: { \"content-type\": \"application/x-www-form-urlencoded\" }\n    }).then(this.props.onSubmittedEmail);\n  };\n\n  render() {\n    if (!this.props.dialogType) {\n      return <div />;\n    }\n\n    let dialogTitle = null;\n    let dialogBody = null;\n\n    switch (this.props.dialogType) {\n      // TODO i18n, FormattedMessage doesn't play nicely with links\n      case InfoDialog.dialogTypes.slack:\n        dialogTitle = \"Get in Touch\";\n        dialogBody = (\n          <span>\n            <p>Want to join the conversation?</p>\n            <p>\n              Join us on the{\" \"}\n              <a href=\"https://webvr-slack.herokuapp.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                WebVR Slack\n              </a>{\" \"}\n              in the{\" \"}\n              <a href=\"https://webvr.slack.com/messages/social\" target=\"_blank\" rel=\"noopener noreferrer\">\n                #social\n              </a>{\" \"}\n              channel.<br />\n              VR meetups every Friday at noon PDT!\n            </p>\n            <p>\n              Or, tweet at{\" \"}\n              <a href=\"https://twitter.com/mozillareality\" target=\"_blank\" rel=\"noopener noreferrer\">\n                @mozillareality\n              </a>{\" \"}\n              on Twitter.\n            </p>\n          </span>\n        );\n        break;\n      case InfoDialog.dialogTypes.email_submitted:\n        dialogTitle = \"\";\n        dialogBody = \"Great! Please check your e-mail to confirm your subscription.\";\n        break;\n      case InfoDialog.dialogTypes.invite:\n        dialogTitle = \"Invite Others\";\n        dialogBody = (\n          <div>\n            <div>Just share the link and they&apos;ll join you:</div>\n            <div className=\"invite-form\">\n              <input\n                type=\"text\"\n                readOnly\n                onFocus={e => e.target.select()}\n                value={this.shareLink}\n                className=\"invite-form__link_field\"\n              />\n              <div className=\"invite-form__buttons\">\n                {navigator.share && (\n                  <button className=\"invite-form__action-button\" onClick={this.shareLinkClicked}>\n                    <span>share</span>\n                  </button>\n                )}\n                <button\n                  className=\"invite-form__action-button\"\n                  onClick={this.copyLinkClicked.bind(this, this.shareLink)}\n                >\n                  <span>{this.state.copyLinkButtonText}</span>\n                </button>\n              </div>\n            </div>\n          </div>\n        );\n        break;\n      case InfoDialog.dialogTypes.safari:\n        dialogTitle = \"Open in Safari\";\n        dialogBody = (\n          <div>\n            <div>Hubs does not support your current browser on iOS. Copy and paste this link directly in Safari.</div>\n            <div className=\"invite-form\">\n              <input\n                type=\"text\"\n                readOnly\n                onFocus={e => e.target.select()}\n                value={document.location}\n                className=\"invite-form__link_field\"\n              />\n              <div className=\"invite-form__buttons\">\n                <button\n                  className=\"invite-form__action-button\"\n                  onClick={this.copyLinkClicked.bind(this, document.location)}\n                >\n                  <span>{this.state.copyLinkButtonText}</span>\n                </button>\n              </div>\n            </div>\n          </div>\n        );\n        break;\n      case InfoDialog.dialogTypes.create_object:\n        dialogTitle = \"Create Object\";\n        dialogBody = (\n          <CreateObjectDialog onCreateObject={this.props.onCreateObject} onCloseDialog={this.props.onCloseDialog} />\n        );\n        break;\n      case InfoDialog.dialogTypes.custom_scene:\n        dialogTitle = \"Create a Room\";\n        dialogBody = (\n          <div>\n            <div>Choose a name and GLTF URL for your room&apos;s scene:</div>\n            <form onSubmit={this.onCustomSceneClicked}>\n              <div className=\"custom-scene-form\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Room name\"\n                  className=\"custom-scene-form__link_field\"\n                  value={this.state.customRoomName}\n                  pattern={HUB_NAME_PATTERN}\n                  title=\"Invalid name, limited to 4 to 64 characters and limited symbols.\"\n                  onChange={e => this.setState({ customRoomName: e.target.value })}\n                  required\n                />\n                <input\n                  type=\"url\"\n                  placeholder=\"URL to Scene GLTF or GLB (Optional)\"\n                  className=\"custom-scene-form__link_field\"\n                  value={this.state.customSceneUrl}\n                  onChange={e => this.setState({ customSceneUrl: e.target.value })}\n                />\n                <div className=\"custom-scene-form__buttons\">\n                  <button className=\"custom-scene-form__action-button\">\n                    <span>create</span>\n                  </button>\n                </div>\n              </div>\n            </form>\n          </div>\n        );\n        break;\n      case InfoDialog.dialogTypes.updates:\n        dialogTitle = \"\";\n        dialogBody = (\n          <span>\n            <p>Sign up to get updates about new features in Hubs.</p>\n            <form onSubmit={this.signUpForMailingList}>\n              <div className=\"mailing-list-form\">\n                <input\n                  type=\"email\"\n                  value={this.state.mailingListEmail}\n                  onChange={e => this.setState({ mailingListEmail: e.target.value })}\n                  className=\"mailing-list-form__email_field\"\n                  required\n                  placeholder=\"Your email here\"\n                />\n                <label className=\"mailing-list-form__privacy\">\n                  <input\n                    className=\"mailing-list-form__privacy_checkbox\"\n                    type=\"checkbox\"\n                    required\n                    value={this.state.mailingListPrivacy}\n                    onChange={e => this.setState({ mailingListPrivacy: e.target.checked })}\n                  />\n                  <span className=\"mailing-list-form__privacy_label\">\n                    <FormattedMessage id=\"mailing_list.privacy_label\" />{\" \"}\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://www.mozilla.org/en-US/privacy/\">\n                      <FormattedMessage id=\"mailing_list.privacy_link\" />\n                    </a>\n                  </span>\n                </label>\n                <input className=\"mailing-list-form__submit\" type=\"submit\" value=\"Sign Up Now\" />\n              </div>\n            </form>\n          </span>\n        );\n        break;\n      case InfoDialog.dialogTypes.report:\n        dialogTitle = \"Report an Issue\";\n        dialogBody = (\n          <span>\n            <p>Need to report a problem?</p>\n            <p>\n              You can file a{\" \"}\n              <a href=\"https://github.com/mozilla/hubs/issues\" target=\"_blank\" rel=\"noopener noreferrer\">\n                GitHub Issue\n              </a>{\" \"}\n              or e-mail us for support at <a href=\"mailto:hubs@mozilla.com\">hubs@mozilla.com</a>.\n            </p>\n            <p>\n              You can also find us in{\" \"}\n              <a href=\"https://webvr.slack.com/messages/social\" target=\"_blank\" rel=\"noopener noreferrer\">\n                #social\n              </a>{\" \"}\n              on the{\" \"}\n              <a href=\"https://webvr-slack.herokuapp.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                WebVR Slack\n              </a>.\n            </p>\n          </span>\n        );\n        break;\n      case InfoDialog.dialogTypes.help:\n        dialogTitle = \"Getting Started\";\n        dialogBody = (\n          <div className=\"info-dialog__help\">\n            <p>When in a room, other avatars can see and hear you.</p>\n            <p>\n              Use your controller&apos;s action button to teleport from place to place. If it has a trigger, use it to\n              pick up objects.\n            </p>\n            <p style={{ textAlign: \"center\" }}>\n              In VR, <b>look up</b> to find your menu:\n              <img\n                className=\"info-dialog__help__hud\"\n                src=\"../assets/images/help-hud.png\"\n                srcSet=\"../assets/images/help-hud@2x.png 2x\"\n              />\n            </p>\n            <p>\n              The <b>Mic Toggle</b> mutes your mic.\n            </p>\n            <p>\n              The <b>Pause/Resume Toggle</b> pauses all other avatars. You can then block them from having further\n              interactions with you.\n            </p>\n            <p>\n              The <b>Bubble Toggle</b> hides avatars that enter your personal space.\n            </p>\n            <p className=\"dialog__box__contents__links\">\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n                <FormattedMessage id=\"profile.terms_of_use\" />\n              </a>\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                href=\"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"\n              >\n                <FormattedMessage id=\"profile.privacy_notice\" />\n              </a>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/?report\">\n                <FormattedMessage id=\"help.report_issue\" />\n              </a>\n            </p>\n          </div>\n        );\n        break;\n      case InfoDialog.dialogTypes.webvr_recommend:\n        dialogTitle = \"Enter in VR\";\n        dialogBody = (\n          <div>\n            <p>To enter Hubs with Oculus or SteamVR, you can use Firefox.</p>\n            <a className=\"info-dialog--action-button\" href=\"https://www.mozilla.org/firefox\">\n              Download Firefox\n            </a>\n            <p style={{ fontSize: \"0.8em\" }}>\n              For a full list of browsers with experimental VR support, visit{\" \"}\n              <a href=\"https://webvr.rocks\" target=\"_blank\" rel=\"noopener noreferrer\">\n                WebVR Rocks\n              </a>.\n            </p>\n          </div>\n        );\n        break;\n      case InfoDialog.dialogTypes.link:\n        dialogTitle = \"Open on Headset\";\n        dialogBody = <LinkDialog linkCode={this.props.linkCode} />;\n        break;\n    }\n\n    return (\n      <div className=\"dialog-overlay\">\n        <div className=\"dialog\" onClick={this.onContainerClicked}>\n          <div className=\"dialog__box\">\n            <div className=\"dialog__box__contents\">\n              <button className=\"dialog__box__contents__close\" onClick={this.props.onCloseDialog}>\n                <span></span>\n              </button>\n              <div className=\"dialog__box__contents__title\">{dialogTitle}</div>\n              <div className=\"dialog__box__contents__body\">{dialogBody}</div>\n              <div className=\"dialog__box__contents__button-container\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default InfoDialog;\n","import { avatars } from \"../assets/avatars/avatars.js\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction selectRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${selectRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport const avatarIds = avatars.map(av => av.id);\n\nexport function generateDefaultProfile() {\n  return {\n    avatarId: selectRandom(avatarIds)\n  };\n}\n","import SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nconst GLTFCache = {};\nlet CachedEnvMapTexture = null;\n\nfunction inflateComponent(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || inflateComponent;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\n// From https://gist.github.com/cdata/f2d7a6ccdec071839bc1954c32595e87\n// Tracking glTF cloning here: https://github.com/mrdoob/three.js/issues/11573\nfunction cloneGltf(gltf) {\n  const skinnedMeshes = {};\n  gltf.scene.traverse(node => {\n    if (!node.name) {\n      node.name = node.uuid;\n    }\n    if (node.isSkinnedMesh) {\n      skinnedMeshes[node.name] = node;\n    }\n  });\n\n  const clone = {\n    animations: gltf.animations,\n    scene: gltf.scene.clone(true)\n  };\n\n  const cloneBones = {};\n  const cloneSkinnedMeshes = {};\n\n  clone.scene.traverse(node => {\n    if (node.isBone) {\n      cloneBones[node.name] = node;\n    }\n\n    if (node.isSkinnedMesh) {\n      cloneSkinnedMeshes[node.name] = node;\n    }\n  });\n\n  for (const name in skinnedMeshes) {\n    const skinnedMesh = skinnedMeshes[name];\n    const skeleton = skinnedMesh.skeleton;\n    const cloneSkinnedMesh = cloneSkinnedMeshes[name];\n\n    const orderedCloneBones = [];\n\n    for (let i = 0; i < skeleton.bones.length; ++i) {\n      const cloneBone = cloneBones[skeleton.bones[i].name];\n      orderedCloneBones.push(cloneBone);\n    }\n\n    cloneSkinnedMesh.bind(new THREE.Skeleton(orderedCloneBones, skeleton.boneInverses), cloneSkinnedMesh.matrixWorld);\n\n    cloneSkinnedMesh.material = skinnedMesh.material.clone();\n  }\n\n  return clone;\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(node, templates, isRoot) {\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const nodeHasBehavior = node.userData.components || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.setAttribute(\"position\", {\n    x: node.position.x,\n    y: node.position.y,\n    z: node.position.z\n  });\n  el.setAttribute(\"rotation\", {\n    x: node.rotation.x * THREE.Math.RAD2DEG,\n    y: node.rotation.y * THREE.Math.RAD2DEG,\n    z: node.rotation.z * THREE.Math.RAD2DEG\n  });\n  el.setAttribute(\"scale\", {\n    x: node.scale.x,\n    y: node.scale.y,\n    z: node.scale.z\n  });\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (node.userData.components && \"nav-mesh\" in node.userData.components) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.name = node.name;\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  const entityComponents = node.userData.components;\n  if (entityComponents) {\n    for (const prop in entityComponents) {\n      if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n        const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n        inflator(el, componentName, entityComponents[prop]);\n      }\n    }\n  }\n\n  return el;\n};\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nfunction nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n\nfunction getFilesFromSketchfabZip(src) {\n  return new Promise((resolve, reject) => {\n    const worker = new SketchfabZipWorker();\n    worker.onmessage = e => {\n      const [success, fileMapOrError] = e.data;\n      (success ? resolve : reject)(fileMapOrError);\n    };\n    worker.postMessage(src);\n  });\n}\n\nasync function loadEnvMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new THREE.CubeTextureLoader().load(urls);\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n\nasync function loadGLTF(src, contentType, preferredTechnique, onProgress) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\")) {\n    fileMap = await getFilesFromSketchfabZip(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const gltfLoader = new THREE.GLTFLoader();\n  gltfLoader.setLazy(true);\n\n  const { parser } = await new Promise((resolve, reject) => gltfLoader.load(gltfUrl, resolve, onProgress, reject));\n\n  const materials = parser.json.materials;\n  if (materials) {\n    for (let i = 0; i < materials.length; i++) {\n      const material = materials[i];\n\n      if (\n        material.extensions &&\n        material.extensions.MOZ_alt_materials &&\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\n      ) {\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\n        materials[i] = materials[altMaterialIndex];\n      }\n    }\n  }\n\n  if (!CachedEnvMapTexture) {\n    CachedEnvMapTexture = loadEnvMap();\n  }\n\n  const gltf = await new Promise((resolve, reject) =>\n    parser.parse(\n      (scene, scenes, cameras, animations, json) => {\n        resolve({ scene, scenes, cameras, animations, json });\n      },\n      e => {\n        reject(e);\n      }\n    )\n  );\n\n  const envMap = await CachedEnvMapTexture;\n\n  gltf.scene.traverse(object => {\n    if (object.material && object.material.type === \"MeshStandardMaterial\") {\n      object.material.envMap = envMap;\n      object.material.needsUpdate = true;\n    }\n  });\n\n  if (fileMap) {\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\n  }\n\n  return gltf;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * whitelisted components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    inflate: { default: false }\n  },\n\n  init() {\n    this.preferredTechnique =\n      window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\n    this.loadTemplates();\n  },\n\n  update() {\n    this.applySrc(this.data.src, this.data.contentType);\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      // If the src attribute is a selector, get the url from the asset item.\n      if (src && src.charAt(0) === \"#\") {\n        const assetEl = document.getElementById(src.substring(1));\n        src = assetEl.getAttribute(\"src\");\n      }\n\n      if (src === this.lastSrc) return;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.removeInflatedEl();\n        }\n        return;\n      }\n\n      if (!GLTFCache[src]) {\n        GLTFCache[src] = loadGLTF(src, contentType, this.preferredTechnique);\n      }\n\n      const model = cloneGltf(await GLTFCache[src]);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.removeInflatedEl();\n\n      this.model = model.scene || model.scenes[0];\n      this.model.animations = model.animations;\n\n      let object3DToSet = this.model;\n      if (this.data.inflate && (this.inflatedEl = inflateEntities(this.model, this.templates, true))) {\n        this.el.appendChild(this.inflatedEl);\n        object3DToSet = this.inflatedEl.object3D;\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n      this.el.setObject3D(\"mesh\", object3DToSet);\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\n    } catch (e) {\n      delete GLTFCache[src];\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  removeInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n      delete this.inflatedEl;\n    }\n  }\n});\n","const BASE_ENVIRONMENTS = [\n  \"/rooms/meetingroom/MeetingRoom.bundle.json\",\n  \"/rooms/atrium/Atrium.bundle.json\",\n  \"/rooms/MedievalFantasyBook/MedievalFantasyBook.bundle.json\",\n  \"/rooms/rooftopbuilding1/RooftopBuilding1.bundle.json\",\n  \"/rooms/wideopenspace/WideOpenSpace.bundle.json\"\n];\nconst EXTRA_ENVIRONMENTS = process.env.EXTRA_ENVIRONMENTS ? process.env.EXTRA_ENVIRONMENTS.split(\",\") : [];\nconst ALL_ENVIRONMENTS = EXTRA_ENVIRONMENTS.concat(BASE_ENVIRONMENTS);\n\nexport const ENVIRONMENT_URLS = ALL_ENVIRONMENTS.map(x => process.env.ASSET_BUNDLE_SERVER + x);\nexport const DEFAULT_ENVIRONMENT_URL = ENVIRONMENT_URLS[0];\n","module.exports = __webpack_public_path__ + \"assets/images/help-hud-4f396aacecdeab9acb5c53b63f707a87.png\";","module.exports = __webpack_public_path__ + \"assets/images/help-hud@2x-6bf5636b37144ec3d8e4a27af324f0eb.png\";","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/link-dialog.scss\";\n\nclass LinkDialog extends Component {\n  static propTypes = {\n    linkCode: PropTypes.string\n  };\n\n  render() {\n    if (!this.props.linkCode) {\n      return (\n        <div>\n          <div className={classNames(\"loading-panel\", styles.codeLoadingPanel)}>\n            <div className=\"loader-wrap\">\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div>\n        <div>\n          <FormattedMessage id=\"link.in_your_browser\" />\n        </div>\n        <a href=\"https://hub.link\" className={styles.domain} target=\"_blank\" rel=\"noopener noreferrer\">\n          hub.link\n        </a>\n        <div>\n          <FormattedMessage id=\"link.enter_code\" />\n        </div>\n        <div className={styles.code}>\n          {this.props.linkCode.split(\"\").map((d, i) => (\n            <span className={styles.digit} key={`link_code_${i}`}>\n              {d}\n            </span>\n          ))}\n        </div>\n        <div className={styles.keepOpen}>\n          <FormattedMessage id=\"link.do_not_close\" />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default LinkDialog;\n","import React, { Component } from \"react\";\nimport \"aframe\";\nimport PropTypes from \"prop-types\";\nimport giphyLogo from \"../assets/images/giphy_logo.png\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPaperclip } from \"@fortawesome/free-solid-svg-icons/faPaperclip\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport styles from \"../assets/stylesheets/create-object-dialog.scss\";\nimport cx from \"classnames\";\n\nconst attributionHostnames = {\n  \"giphy.com\": giphyLogo,\n  \"media.giphy.com\": giphyLogo\n};\n\nconst DEFAULT_OBJECT_URL = \"https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf\";\nconst isMobile = AFRAME.utils.device.isMobile();\nconst instructions = \"Paste a URL or upload a file.\";\nconst desktopTips = \"Tip: You can paste links directly into Hubs with Ctrl+V\";\nconst mobileInstructions = <div>{instructions}</div>;\nconst desktopInstructions = (\n  <div>\n    <p>{instructions}</p>\n    <p>{desktopTips}</p>\n  </div>\n);\n\nlet lastUrl = \"\";\nconst fileInputId = \"file-input\";\n\nexport default class CreateObjectDialog extends Component {\n  state = {\n    url: \"\",\n    file: null,\n    fileName: \"\"\n  };\n\n  static propTypes = {\n    onCreateObject: PropTypes.func,\n    onCloseDialog: PropTypes.func\n  };\n\n  componentDidMount() {\n    this.setState({ url: lastUrl });\n  }\n\n  componentWillUnmount() {\n    lastUrl = this.state.url;\n  }\n\n  onUrlChange = e => {\n    let attributionImage = this.state.attributionImage;\n    if (e.target && e.target.value && e.target.validity.valid) {\n      const url = new URL(e.target.value);\n      attributionImage = attributionHostnames[url.hostname];\n    }\n    this.setState({\n      url: e.target && e.target.value,\n      attributionImage: attributionImage\n    });\n  };\n\n  onFileChange = e => {\n    this.setState({\n      file: e.target.files[0],\n      fileName: e.target.files[0].name\n    });\n  };\n\n  onCreateClicked = e => {\n    e.preventDefault();\n    this.props.onCreateObject(this.state.file || this.state.url || DEFAULT_OBJECT_URL);\n    this.props.onCloseDialog();\n  };\n\n  reset = e => {\n    e.preventDefault();\n    this.setState({\n      url: \"\",\n      file: null,\n      fileName: \"\"\n    });\n    this.fileInput.value = null;\n  };\n\n  render() {\n    const cancelButton = (\n      <label className={cx(styles.smallButton, styles.cancelIcon)} onClick={this.reset}>\n        <FontAwesomeIcon icon={faTimes} />\n      </label>\n    );\n    const uploadButton = (\n      <label htmlFor={fileInputId} className={cx(styles.smallButton, styles.uploadIcon)}>\n        <FontAwesomeIcon icon={faPaperclip} />\n      </label>\n    );\n    const filenameLabel = <label className={cx(styles.leftSideOfInput)}>{this.state.fileName}</label>;\n    const urlInput = (\n      <input\n        className={cx(styles.leftSideOfInput)}\n        placeholder=\"Image/Video/glTF URL\"\n        onChange={this.onUrlChange}\n        type=\"url\"\n        value={this.state.url}\n      />\n    );\n\n    return (\n      <div>\n        {isMobile ? mobileInstructions : desktopInstructions}\n        <form onSubmit={this.onCreateClicked}>\n          <div className={styles.addMediaForm}>\n            <input\n              id={fileInputId}\n              ref={f => (this.fileInput = f)}\n              className={styles.hideFileInput}\n              type=\"file\"\n              onChange={this.onFileChange}\n            />\n            <div className={styles.inputBorder}>\n              {this.state.file ? filenameLabel : urlInput}\n              {this.state.url || this.state.fileName ? cancelButton : uploadButton}\n            </div>\n            <div className={styles.buttons}>\n              <button className={styles.actionButton}>\n                <span>create</span>\n              </button>\n            </div>\n            {this.state.attributionImage ? (\n              <div>\n                <img src={this.state.attributionImage} />\n              </div>\n            ) : null}\n          </div>\n        </form>\n      </div>\n    );\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/images/giphy_logo-439da1ed3ca70fb090eb98698485c21e.png\";","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true/i.test(val);\n}\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer();\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.context.getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nconst ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  //DRAWING: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","/**\n * Emits audioFrequencyChange events based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this.smoothing = 0.3;\n    this.threshold = 0.01;\n    this.el.addEventListener(\"sound-source-set\", event => {\n      const ctx = THREE.AudioContext.getContext();\n      this.analyser = ctx.createAnalyser();\n      this.analyser.fftSize = 32;\n      this.levels = new Uint8Array(this.analyser.frequencyBinCount);\n      event.detail.soundSource.connect(this.analyser);\n    });\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n\n    // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n    this.analyser.getByteTimeDomainData(this.levels);\n\n    let sum = 0;\n    for (let i = 0; i < this.levels.length; i++) {\n      const amplitude = (this.levels[i] - 128) / 128;\n      sum += amplitude * amplitude;\n    }\n    let currVolume = Math.sqrt(sum / this.levels.length);\n    if (currVolume < this.threshold) {\n      currVolume = 0;\n    }\n    this.volume = this.smoothing * currVolume + (1 - this.smoothing) * this.prevVolume;\n    this.prevVolume = this.volume;\n  }\n});\n\n/**\n * Sets an entity's scale base on audioFrequencyChange events.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 2 }\n  },\n\n  tick() {\n    // TODO: come up with a cleaner way to handle this.\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\n    if (!this.el.object3D.visible) return;\n\n    const { minScale, maxScale } = this.data;\n\n    const audioAnalyser = this.el.components[\"networked-audio-analyser\"];\n\n    if (!audioAnalyser) return;\n\n    const scale = Math.min(maxScale, minScale + (maxScale - minScale) * audioAnalyser.volume * 8);\n    this.el.object3D.scale.setScalar(scale);\n  }\n});\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\nAFRAME.registerComponent(\"animation-mixer\", {\n  init() {\n    this.mixer = null;\n\n    const object3DMap = this.el.object3DMap;\n    const rootObject3D = object3DMap.mesh || object3DMap.scene;\n\n    if (rootObject3D) {\n      this.setAnimationMixer(rootObject3D);\n    } else {\n      this.onModelLoaded = this.onModelLoaded.bind(this);\n      this.el.addEventListener(\"model-loaded\", this.onModelLoaded);\n    }\n  },\n\n  onModelLoaded(event) {\n    const sceneObject3D = event.detail.model;\n    this.setAnimationMixer(sceneObject3D);\n\n    this.el.removeEventListener(this.onModelLoaded);\n  },\n\n  setAnimationMixer(rootObject3D) {\n    this.mixer = new THREE.AnimationMixer(rootObject3D);\n  },\n\n  tick: function(t, dt) {\n    if (this.mixer) {\n      this.mixer.update(dt / 1000);\n    }\n  },\n\n  destroy() {\n    this.el.removeEventListener(this.onModelLoaded);\n  }\n});\n","/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  dependencies: [\"animation-mixer\"],\n  schema: {\n    clip: { type: \"string\", required: true }\n  },\n  init() {\n    const object3DMap = this.el.object3DMap;\n    this.model = object3DMap.mesh || object3DMap.scene;\n\n    if (this.model) {\n      this.mixer = this.el.components[\"animation-mixer\"].mixer;\n    } else {\n      this.onModelLoaded = this.onModelLoaded.bind(this);\n      this.el.addEventListener(\"model-loaded\", this.onModelLoaded);\n    }\n  },\n\n  onModelLoaded(event) {\n    const animationMixerComponent = this.el.components[\"animation-mixer\"];\n    this.model = event.detail.model;\n    this.mixer = animationMixerComponent.mixer;\n\n    this.updateClipState(true);\n\n    this.el.removeEventListener(this.onModelLoaded);\n  },\n\n  update(oldData) {\n    if (oldData.clip !== this.data.clip && this.model) {\n      this.updateClipState(true);\n    }\n  },\n\n  updateClipState(play) {\n    const model = this.model;\n    const clipName = this.data.clip;\n\n    for (const clip of this.model.animations) {\n      if (clip.name === clipName) {\n        const action = this.mixer.clipAction(clip, model.parent);\n\n        if (play) {\n          action.enabled = true;\n          action.setLoop(THREE.LoopRepeat, Infinity).play();\n        } else {\n          action.stop();\n        }\n\n        break;\n      }\n    }\n  },\n\n  destroy() {\n    this.updateClipState(false);\n    this.el.removeEventListener(this.onModelLoaded);\n  }\n});\n","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","import { objectTypeForOriginAndContentType } from \"../object-types\";\nlet mediaAPIEndpoint = \"/api/v1/media\";\n\nif (process.env.RETICULUM_SERVER) {\n  mediaAPIEndpoint = `https://${process.env.RETICULUM_SERVER}${mediaAPIEndpoint}`;\n}\n\nconst fetchContentType = async url => {\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\n};\n\nconst contentIndexCache = new Map();\nexport const fetchMaxContentIndex = async (documentUrl, pageUrl) => {\n  if (contentIndexCache.has(documentUrl)) return contentIndexCache.get(documentUrl);\n  const maxIndex = await fetch(pageUrl).then(r => parseInt(r.headers.get(\"x-max-content-index\")));\n  contentIndexCache.set(documentUrl, maxIndex);\n  return maxIndex;\n};\n\nconst resolveMediaCache = new Map();\nexport const resolveMedia = async (url, skipContentType, index) => {\n  const parsedUrl = new URL(url);\n  const cacheKey = `${url}|${index}`;\n  if (resolveMediaCache.has(cacheKey)) return resolveMediaCache.get(cacheKey);\n\n  const isHttpOrHttps = parsedUrl.protocol === \"http:\" || parsedUrl.protocol === \"https:\";\n  const resolved = !isHttpOrHttps\n    ? { raw: url, origin: url }\n    : await fetch(mediaAPIEndpoint, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ media: { url, index } })\n      }).then(r => r.json());\n\n  if (isHttpOrHttps && !skipContentType) {\n    const contentType =\n      (resolved.meta && resolved.meta.expected_content_type) || (await fetchContentType(resolved.raw));\n    resolved.contentType = contentType;\n  }\n\n  resolveMediaCache.set(cacheKey, resolved);\n  return resolved;\n};\n\nexport const upload = file => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  return fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nlet interactableId = 0;\nexport const addMedia = (src, template, contentOrigin, resize = false) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n  entity.id = \"interactable-media-\" + interactableId++;\n  entity.setAttribute(\"networked\", { template: template });\n  entity.setAttribute(\"media-loader\", { resize, src: typeof src === \"string\" ? src : \"\" });\n  scene.appendChild(entity);\n\n  const orientation = new Promise(function(resolve) {\n    if (src instanceof File) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (src instanceof File) {\n    upload(src)\n      .then(response => {\n        const srcUrl = new URL(response.raw);\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { src: srcUrl.href });\n      })\n      .catch(() => {\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  }\n\n  entity.addEventListener(\"media_resolved\", ({ detail }) => {\n    const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType);\n    scene.emit(\"object_spawned\", { objectType });\n  });\n\n  return { entity, orientation };\n};\n","AFRAME.registerComponent(\"gamma-factor\", {\n  schema: {\n    gammaFactor: { type: \"number\", default: 2.2 }\n  },\n\n  init() {\n    const el = this.el;\n\n    if (!el.isScene) {\n      console.warn(\"gamma-factor component can only be applied to <a-scene>\");\n    }\n  },\n\n  update(prevData) {\n    const data = this.data;\n    const sceneEl = this.el;\n    const renderer = sceneEl.renderer;\n    let needsShaderUpdate = false;\n\n    if (data.gammaFactor !== prevData.gammaFactor) {\n      renderer.gammaFactor = data.gammaFactor;\n      needsShaderUpdate = true;\n    }\n\n    if (!needsShaderUpdate || sceneEl.time === 0) {\n      return;\n    }\n\n    sceneEl.object3D.traverse(function(node) {\n      if (!node.isMesh) {\n        return;\n      }\n\n      if (Array.isArray(node.material)) {\n        node.material.forEach(function(material) {\n          material.needsUpdate = true;\n        });\n      } else {\n        node.material.needsUpdate = true;\n      }\n    });\n  }\n});\n","module.exports = __webpack_public_path__ + \"assets/images/logo-8f1dfd234d060073524bc29912a24f75.svg\";","import { generatePublicKeyAndEncryptedObject, generateKeys, decryptObject } from \"./crypto\";\n\nconst LINK_ACTION_TIMEOUT = 10000;\n\nexport default class LinkChannel {\n  constructor(store) {\n    this.store = store;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  // Returns a promise that, when resolved, will forward an object with three keys:\n  //\n  // code: The code that was made available to use for link.\n  //\n  // cancel: A function that the caller can call to cancel the use of the code.\n  //\n  // onFinished: A promise that, when resolved, indicates the code is no longer usable,\n  // because it was either successfully used by the remote device or it has expired\n  // (\"used\" or \"expired\" is passed to the callback).\n  generateCode = () => {\n    return new Promise(resolve => {\n      const onFinished = new Promise(finished => {\n        const step = () => {\n          const code = Math.floor(Math.random() * 9999)\n            .toString()\n            .padStart(4, \"0\");\n\n          // Only respond to one link_request in this channel.\n          let readyToSend = false;\n          let leftChannel = false;\n\n          const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n\n          const leave = () => {\n            if (!leftChannel) channel.leave();\n            leftChannel = true;\n          };\n\n          const cancel = () => leave();\n\n          channel.on(\"link_expired\", () => finished(\"expired\"));\n\n          channel.on(\"presence_state\", state => {\n            if (readyToSend) return;\n\n            if (Object.keys(state).length > 0) {\n              // Code is in use by someone else, try a new one\n              step();\n            } else {\n              readyToSend = true;\n              resolve({ code, cancel, onFinished });\n            }\n          });\n\n          channel.on(\"link_request\", incoming => {\n            if (readyToSend) {\n              const data = { path: location.pathname };\n\n              // Copy profile data to link'ed device if it's been set.\n              if (this.store.state.activity.hasChangedName) {\n                data.profile = { ...this.store.state.profile };\n              }\n\n              generatePublicKeyAndEncryptedObject(incoming.public_key, data).then(\n                ({ publicKeyString, encryptedData }) => {\n                  const payload = {\n                    target_session_id: incoming.reply_to_session_id,\n                    public_key: publicKeyString,\n                    data: encryptedData\n                  };\n\n                  if (!leftChannel) {\n                    channel.push(\"link_response\", payload);\n                  }\n\n                  leave();\n\n                  finished(\"used\");\n                  readyToSend = false;\n                }\n              );\n            }\n          });\n\n          channel.join().receive(\"error\", r => console.error(r));\n        };\n\n        step();\n      });\n    });\n  };\n\n  // Attempts to receive a link payload from a remote device using the given code.\n  //\n  // Promise rejects if the code is invalid or there is a problem with the channel.\n  // Promise resolves and passes payload of link source on successful link.\n  attemptLink = code => {\n    return new Promise((resolve, reject) => {\n      const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n      let finished = false;\n\n      generateKeys().then(({ publicKeyString, privateKey }) => {\n        channel.on(\"presence_state\", state => {\n          const numOccupants = Object.keys(state).length;\n\n          if (numOccupants === 1) {\n            // Great, only sender is in topic, request link\n            channel.push(\"link_request\", {\n              reply_to_session_id: this.socket.params.session_id,\n              public_key: publicKeyString\n            });\n\n            setTimeout(() => {\n              if (finished) return;\n              channel.leave();\n              reject(new Error(\"no_response\"));\n            }, LINK_ACTION_TIMEOUT);\n          } else if (numOccupants === 0) {\n            // Nobody in this channel, probably a bad code.\n            channel.leave();\n            reject(new Error(\"failed\"));\n          } else {\n            console.warn(\"link code channel already has 2 or more occupants, something fishy is going on.\");\n            channel.leave();\n            reject(new Error(\"in_use\"));\n          }\n        });\n\n        channel.on(\"link_response\", payload => {\n          finished = true;\n          channel.leave();\n\n          decryptObject(payload.public_key, privateKey, payload.data).then(resolve);\n        });\n\n        channel.join().receive(\"error\", r => console.error(r));\n      });\n    });\n  };\n}\n","// NOTE: We do not use an IV since we generate a new keypair each time we use these routines.\n\nasync function deriveKey(privateKey, publicKey) {\n  return crypto.subtle.deriveKey(\n    { name: \"ECDH\", public: publicKey },\n    privateKey,\n    { name: \"AES-CBC\", length: 256 },\n    true,\n    [\"encrypt\", \"decrypt\"]\n  );\n}\n\nasync function publicKeyToString(key) {\n  return JSON.stringify(await crypto.subtle.exportKey(\"jwk\", key));\n}\n\nasync function stringToPublicKey(s) {\n  return await crypto.subtle.importKey(\"jwk\", JSON.parse(s), { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\n}\n\nfunction stringToArrayBuffer(s) {\n  const buf = new Uint8Array(s.length);\n\n  for (let i = 0; i < s.length; i++) {\n    buf[i] = s.charCodeAt(i);\n  }\n\n  return buf;\n}\n\nfunction arrayBufferToString(b) {\n  const buf = new Uint8Array(b);\n  let s = \"\";\n\n  for (let i = 0; i < buf.byteLength; i++) {\n    s += String.fromCharCode(buf[i]);\n  }\n\n  return s;\n}\n\n// This allows a single object to be passed encrypted from a receiver in a req -> response flow\n\n// Requestor generates a public key and private key, and should send the public key to receiver.\nexport async function generateKeys() {\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  return { publicKeyString, privateKey: keyPair.privateKey };\n}\n\n// Receiver takes the public key from requestor and passes obj to get a response public key and the encrypted data to return.\nexport async function generatePublicKeyAndEncryptedObject(incomingPublicKeyString, obj) {\n  const iv = new Uint8Array(16);\n  const incomingPublicKey = await stringToPublicKey(incomingPublicKeyString);\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  const secret = await deriveKey(keyPair.privateKey, incomingPublicKey);\n\n  const encryptedData = btoa(\n    arrayBufferToString(\n      await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, secret, stringToArrayBuffer(JSON.stringify(obj)))\n    )\n  );\n\n  return { publicKeyString, encryptedData };\n}\n\n// Requestor then takes the receiver's public key, the private key (returned from generateKeys()), and the data from the receiver.\nexport async function decryptObject(publicKeyString, privateKey, base64value) {\n  const iv = new Uint8Array(16);\n  const publicKey = await stringToPublicKey(publicKeyString);\n  const secret = await deriveKey(privateKey, publicKey);\n  const ciphertext = stringToArrayBuffer(atob(base64value));\n  const data = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, secret, ciphertext);\n  return JSON.parse(arrayBufferToString(data));\n}\n","import uuid from \"uuid/v4\";\nimport { Socket } from \"phoenix\";\n\nexport function connectToReticulum() {\n  const qs = new URLSearchParams(location.search);\n\n  const socketProtocol = qs.get(\"phx_protocol\") || (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n  let socketHost = qs.get(\"phx_host\");\n  let socketPort = qs.get(\"phx_port\");\n\n  if (process.env.RETICULUM_SERVER) {\n    const [retHost, retPort] = process.env.RETICULUM_SERVER.split(\":\");\n    socketHost = socketHost || retHost || \"\";\n    socketPort = socketPort || retPort || \"443\";\n  } else {\n    socketHost = socketHost || document.location.hostname || \"\";\n    socketPort = socketPort || document.location.port || \"443\";\n  }\n\n  const socketUrl = `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}/socket`;\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socket = new Socket(socketUrl, { params: { session_id: uuid() } });\n  socket.connect();\n\n  return socket;\n}\n","import { detectOS } from \"detect-browser\";\n\nexport function disableiOSZoom() {\n  if (detectOS(navigator.userAgent) !== \"iOS\") return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","import \"./components/gltf-model-plus\";\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"collision-filter\", \"collision-filter\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"scene-shadow\", \"scene-shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\");\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"body\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\");\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\"shape\", \"shape\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"shape\",\n  (() => {\n    const euler = new THREE.Euler();\n    const orientation = new THREE.Quaternion();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      orientation.setFromEuler(euler);\n      el.setAttribute(componentName, {\n        shape: \"box\",\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\");\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\");\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"hoverable\");\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\n  const nav = AFRAME.scenes[0].systems.nav;\n  const zone = componentData.zone || \"character\";\n  let found = false;\n  el.object3D.traverse(node => {\n    if (node.isMesh && !found) {\n      found = true;\n      nav.loadMesh(node, zone);\n    }\n  });\n});\n","import Store from \"./storage/store\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.quality = \"low\";\n    this.store = new Store();\n  }\n\n  setQuality(quality) {\n    if (this.quality === quality) {\n      return false;\n    }\n\n    this.quality = quality;\n\n    if (this.scene) {\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\n    }\n\n    return true;\n  }\n}\n","export function angleTo4Direction(angle) {\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\n  if (angle > 0 && angle < 90) {\n    return \"north\";\n  } else if (angle >= 90 && angle < 180) {\n    return \"west\";\n  } else if (angle >= 180 && angle < 270) {\n    return \"south\";\n  } else {\n    return \"east\";\n  }\n}\n\nexport function angleTo8Direction(angle) {\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\n  let direction = \"\";\n  if ((angle >= 0 && angle < 120) || angle >= 330) {\n    direction += \"north\";\n  }\n  if (angle >= 150 && angle < 300) {\n    direction += \"south\";\n  }\n  if (angle >= 60 && angle < 210) {\n    direction += \"west\";\n  }\n  if ((angle >= 240 && angle < 360) || angle < 30) {\n    direction += \"east\";\n  }\n  return direction;\n}\n","const POSES = {\n  open: \"open\",\n  point: \"point\",\n  fist: \"fist\",\n  hold: \"hold\",\n  thumbUp: \"thumbUp\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  pinch: \"pinch\",\n  mrpDown: \"mrpDown\"\n};\n\nexport const CONTROLLER_OFFSETS = {\n  default: new THREE.Matrix4(),\n  \"oculus-touch-controls\": new THREE.Matrix4().makeTranslation(0, -0.015, 0.04),\n  \"oculus-go-controls\": new THREE.Matrix4(),\n  \"vive-controls\": new THREE.Matrix4().compose(\n    new THREE.Vector3(0, -0.017, 0.13),\n    new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\n    new THREE.Vector3(1, 1, 1)\n  ),\n  \"windows-motion-controls\": new THREE.Matrix4().compose(\n    new THREE.Vector3(0, -0.017, 0.13),\n    new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\n    new THREE.Vector3(1, 1, 1)\n  ),\n  \"daydream-controls\": new THREE.Matrix4().makeTranslation(0, 0, -0.04),\n  \"gearvr-controls\": new THREE.Matrix4()\n};\n\n/**\n * Converts events from various 6DoF and 3DoF controllers into hand-pose events.\n * @namespace user-input\n * @component hand-controls2\n */\nAFRAME.registerComponent(\"hand-controls2\", {\n  schema: { default: \"left\" },\n\n  init() {\n    const el = this.el;\n\n    this.pose = POSES.open;\n\n    this.fingersDown = {\n      thumb: false,\n      index: false,\n      middle: false,\n      ring: false,\n      pinky: false\n    };\n\n    this.onMiddleRingPinkyDown = this.updatePose.bind(this, {\n      middle: true,\n      ring: true,\n      pinky: true\n    });\n\n    this.onMiddleRingPinkyUp = this.updatePose.bind(this, {\n      middle: false,\n      ring: false,\n      pinky: false\n    });\n\n    this.onIndexDown = this.updatePose.bind(this, {\n      index: true\n    });\n\n    this.onIndexUp = this.updatePose.bind(this, {\n      index: false\n    });\n\n    this.onThumbDown = this.updatePose.bind(this, {\n      thumb: true\n    });\n\n    this.onThumbUp = this.updatePose.bind(this, {\n      thumb: false\n    });\n\n    this.onControllerConnected = this.onControllerConnected.bind(this);\n    this.onControllerDisconnected = this.onControllerDisconnected.bind(this);\n\n    this.connectedController = null;\n\n    el.addEventListener(\"controllerconnected\", this.onControllerConnected);\n    el.addEventListener(\"controllerdisconnected\", this.onControllerDisconnected);\n\n    el.setAttribute(\"visible\", false);\n  },\n\n  play() {\n    const el = this.el;\n    el.addEventListener(\"middle_ring_pinky_down\", this.onMiddleRingPinkyDown);\n    el.addEventListener(\"middle_ring_pinky_up\", this.onMiddleRingPinkyUp);\n    el.addEventListener(\"thumb_down\", this.onThumbDown);\n    el.addEventListener(\"thumb_up\", this.onThumbUp);\n    el.addEventListener(\"index_down\", this.onIndexDown);\n    el.addEventListener(\"index_up\", this.onIndexUp);\n  },\n\n  pause() {\n    const el = this.el;\n    el.removeEventListener(\"middle_ring_pinky_down\", this.onMiddleRingPinkyDown);\n    el.removeEventListener(\"middle_ring_pinky_up\", this.onMiddleRingPinkyUp);\n    el.removeEventListener(\"thumb_down\", this.onThumbDown);\n    el.removeEventListener(\"thumb_up\", this.onThumbUp);\n    el.removeEventListener(\"index_down\", this.onIndexDown);\n    el.removeEventListener(\"index_up\", this.onIndexUp);\n  },\n\n  // Attach the platform specific tracked controllers.\n  update(prevData) {\n    const el = this.el;\n    const hand = this.data;\n\n    const controlConfiguration = {\n      hand: hand,\n      model: false,\n      orientationOffset: { x: 0, y: 0, z: 0 }\n    };\n\n    if (hand !== prevData) {\n      el.setAttribute(\"vive-controls\", controlConfiguration);\n      el.setAttribute(\"oculus-touch-controls\", controlConfiguration);\n      el.setAttribute(\"oculus-go-controls\", controlConfiguration);\n      el.setAttribute(\"windows-motion-controls\", controlConfiguration);\n      el.setAttribute(\"daydream-controls\", controlConfiguration);\n      el.setAttribute(\"gearvr-controls\", controlConfiguration);\n    }\n  },\n\n  remove() {\n    const el = this.el;\n    el.removeEventListener(\"controllerconnected\", this.onControllerConnected);\n    el.removeEventListener(\"controllerdisconnected\", this.onControllerDisconnected);\n  },\n\n  updatePose(nextFingersDown) {\n    Object.assign(this.fingersDown, nextFingersDown);\n    const pose = this.determinePose();\n\n    if (pose !== this.pose) {\n      const previous = this.pose;\n      this.pose = pose;\n      this.el.emit(\"hand-pose\", { previous: previous, current: this.pose });\n    }\n  },\n\n  determinePose() {\n    const { thumb, index, middle, ring, pinky } = this.fingersDown;\n\n    if (!thumb && !index && !middle && !ring && !pinky) {\n      return POSES.open;\n    } else if (thumb && index && middle && ring && pinky) {\n      return POSES.fist;\n    } else if (!thumb && index && middle && ring && pinky) {\n      return POSES.thumbUp;\n    } else if (!thumb && !index && middle && ring && pinky) {\n      return POSES.mrpDown;\n    } else if (!thumb && index && !middle && !ring && !pinky) {\n      return POSES.indexDown;\n    } else if (thumb && !index && !middle && !ring && !pinky) {\n      return POSES.thumbDown;\n    } else if (thumb && index && !middle && !ring && !pinky) {\n      return POSES.pinch;\n    } else if (thumb && !index && middle && ring && pinky) {\n      return POSES.point;\n    }\n\n    console.warn(\"Did not find matching pose for \", this.fingersDown);\n\n    return POSES.open;\n  },\n\n  // Show controller when connected\n  onControllerConnected(e) {\n    this.connectedController = e.detail.name;\n    this.el.setAttribute(\"visible\", true);\n  },\n\n  // Hide controller on disconnect\n  onControllerDisconnected() {\n    this.connectedController = null;\n    this.el.setAttribute(\"visible\", false);\n  },\n\n  getControllerOffset() {\n    if (CONTROLLER_OFFSETS[this.connectedController] === undefined) {\n      return CONTROLLER_OFFSETS.default;\n    }\n\n    return CONTROLLER_OFFSETS[this.connectedController];\n  }\n});\n","export const Layers = {\n  // Layers 0 - 2 reserverd by ThreeJS and AFrame.\n  reflection: 3\n};\n\n/**\n * Sets layer flags on the underlying Object3D\n * @namespace environment\n * @component layers\n */\nAFRAME.registerComponent(\"layers\", {\n  schema: {\n    reflection: { type: \"boolean\", default: false }\n  },\n  init() {\n    this.update = this.update.bind(this);\n    this.el.addEventListener(\"model-loaded\", this.update);\n  },\n  update(oldData) {\n    if (this.data.reflection !== oldData.reflection) {\n      if (this.data.reflection) {\n        this.el.object3D.traverse(obj => {\n          obj.layers.enable(Layers.reflection);\n        });\n      } else {\n        this.el.object3D.traverse(obj => {\n          obj.layers.disable(Layers.reflection);\n        });\n      }\n    }\n  },\n  remove() {\n    this.el.removeEventListener(\"model-loaded\", this.update);\n  }\n});\n","/* global AFRAME, console, setTimeout, clearTimeout */\r\n\r\nexport const AppModes = Object.freeze({ DEFAULT: \"default\", HUD: \"hud\" });\r\n\r\n/**\r\n * Simple system for keeping track of a modal app state\r\n * @system app-mode\r\n */\r\nAFRAME.registerSystem(\"app-mode\", {\r\n  init() {\r\n    this.setMode(AppModes.DEFAULT);\r\n  },\r\n\r\n  setMode(newMode) {\r\n    if (Object.values(AppModes).includes(newMode) && newMode !== this.mode) {\r\n      this.mode = newMode;\r\n      this.el.emit(\"app-mode-change\", { mode: this.mode });\r\n    }\r\n  }\r\n});\r\n\r\n/**\r\n * Toggle the isPlaying state of a component based on app mode\r\n * @namespace app-mode\r\n * @component app-mode-toggle-playing\r\n */\r\nAFRAME.registerComponent(\"app-mode-toggle-playing\", {\r\n  multiple: true,\r\n  schema: {\r\n    mode: { type: \"string\" },\r\n    invert: { type: \"boolean\", default: false }\r\n  },\r\n\r\n  init() {\r\n    const AppModeSystem = this.el.sceneEl.systems[\"app-mode\"];\r\n    this.el.sceneEl.addEventListener(\"app-mode-change\", e => {\r\n      this.updateComponentState(e.detail.mode === this.data.mode);\r\n    });\r\n    this.updateComponentState(AppModeSystem.mode === this.data.mode);\r\n  },\r\n\r\n  updateComponentState(isModeActive) {\r\n    const componentName = this.id;\r\n    this.el.components[componentName][isModeActive !== this.data.invert ? \"play\" : \"pause\"]();\r\n  }\r\n});\r\n\r\n/**\r\n * Toggle a boolean property of a component based on app mode\r\n * @namespace app-mode\r\n * @component app-mode-toggle-attribute\r\n */\r\nAFRAME.registerComponent(\"app-mode-toggle-attribute\", {\r\n  multiple: true,\r\n  schema: {\r\n    mode: { type: \"string\" },\r\n    invert: { type: \"boolean\", default: false },\r\n    property: { type: \"string\" }\r\n  },\r\n\r\n  init() {\r\n    const AppModeSystem = this.el.sceneEl.systems[\"app-mode\"];\r\n    this.el.sceneEl.addEventListener(\"app-mode-change\", e => {\r\n      this.updateComponentState(e.detail.mode === this.data.mode);\r\n    });\r\n    this.updateComponentState(AppModeSystem.mode === this.data.mode);\r\n  },\r\n\r\n  updateComponentState(isModeActive) {\r\n    const componentName = this.id;\r\n    this.el.setAttribute(componentName, this.data.property, isModeActive !== this.data.invert);\r\n  }\r\n});\r\n\r\n/**\r\n * Toggle aframe input mappings action set based on app mode\r\n * @namespace app-mode\r\n * @component app-mode-input-mappings\r\n */\r\nAFRAME.registerComponent(\"app-mode-input-mappings\", {\r\n  schema: {\r\n    modes: { default: [] },\r\n    actionSets: { default: [] }\r\n  },\r\n  init() {\r\n    this.el.sceneEl.addEventListener(\"app-mode-change\", e => {\r\n      const { modes, actionSets } = this.data;\r\n      const idx = modes.indexOf(e.detail.mode);\r\n      if (idx != -1 && modes[idx] && actionSets[idx] && AFRAME.inputActions[actionSets[idx]]) {\r\n        // TODO: this assumes full control over current action set reguardless of what else might be manipulating it, this is obviously wrong\r\n        AFRAME.currentInputMapping = actionSets[idx];\r\n      } else {\r\n        console.error(`no valid action set for ${e.detail.mode}`);\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\n/**\r\n * Toggle visibility of an entity based on if the user is in vr mode or not\r\n * @namespace vr-mode\r\n * @component vr-mode-toggle-visibility\r\n */\r\nAFRAME.registerComponent(\"vr-mode-toggle-visibility\", {\r\n  schema: {\r\n    invert: { type: \"boolean\", default: false }\r\n  },\r\n\r\n  init() {\r\n    this.updateComponentState = this.updateComponentState.bind(this);\r\n  },\r\n\r\n  play() {\r\n    this.updateComponentState();\r\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  updateComponentState() {\r\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\r\n    this.el.setAttribute(\"visible\", inVRMode !== this.data.invert);\r\n  }\r\n});\r\n\r\n/**\r\n * Toggle the isPlaying state of a component based on app mode\r\n * @namespace vr-mode\r\n * @component vr-mode-toggle-playing\r\n */\r\nAFRAME.registerComponent(\"vr-mode-toggle-playing\", {\r\n  multiple: true,\r\n  schema: {\r\n    invert: { type: \"boolean\", default: false }\r\n  },\r\n\r\n  init() {\r\n    this.updateComponentState = this.updateComponentState.bind(this);\r\n  },\r\n\r\n  play() {\r\n    this.updateComponentState();\r\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  updateComponentState() {\r\n    const componentName = this.id;\r\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\r\n    this.el.components[componentName][inVRMode !== this.data.invert ? \"play\" : \"pause\"]();\r\n  }\r\n});\r\n","const rotation = new THREE.Euler();\nexport function getBox(entity, boxRoot) {\n  const box = new THREE.Box3();\n  rotation.copy(entity.object3D.rotation);\n  entity.object3D.rotation.set(0, 0, 0);\n  entity.object3D.updateMatrixWorld(true);\n  box.setFromObject(boxRoot);\n  entity.object3D.worldToLocal(box.min);\n  entity.object3D.worldToLocal(box.max);\n  entity.object3D.rotation.copy(rotation);\n  return box;\n}\n\nexport function getScaleCoefficient(length, box) {\n  const { max, min } = box;\n  const dX = Math.abs(max.x - min.x);\n  const dY = Math.abs(max.y - min.y);\n  const dZ = Math.abs(max.z - min.z);\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\n  return length / lengthOfLongestComponent;\n}\n","const { detect } = require(\"detect-browser\");\n\nconst browser = detect();\n\n// Precision on device detection is fuzzy -- we can sometimes know if a device is definitely\n// available, or definitely *not* available, and assume it may be available otherwise.\nexport const VR_DEVICE_AVAILABILITY = {\n  yes: \"yes\", // Implies VR can be launched into on this device immediately, in this browser\n  no: \"no\", // Implies this VR device is definitely not supported regardless of browser\n  maybe: \"maybe\" // Implies this device may support this VR platform, but may not be installed or in a compatible browser\n};\n\nfunction isMaybeGearVRCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\nfunction isMaybeDaydreamCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\n// Blacklist of VR device name regex matchers that we do not want to consider as valid VR devices\n// that can be entered into as a \"generic\" entry flow.\nconst GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST = [/cardboard/i];\n\n// Tries to determine VR entry compatibility regardless of the current browser.\n//\n// For each VR \"entry type\", returns VR_DEVICE_AVAILABILITY.yes if that type can be launched into directly from this browser\n// on this device, returns VR_DEVICE_AVAILABILITY.no if that type is known to not be possible to ever use on this device no matter what,\n// and VR_DEVICE_AVAILABILITY.maybe if the device potentially could support that type if a different browser was running, or if\n// the software was setup, an HMD was purchased, etc.\n//\n// When \"yes\" or \"maybe\", we should present the option. If \"maybe\", when chosen try to get them into a compatible browser.\n// Once in a compatible browser, we should assume it will work (if it doesn't, it's because they don't have the headset,\n// haven't installed the software, our guess about their phone was wrong, etc.)\n//\n// At the time of this writing there are the following VR \"entry types\" that will be validated by this method:\n//\n// - screen: Enter \"on-screen\" in 2D\n// - generic: Generic WebVR (platform/OS agnostic indicator if a general 'Enter VR' option should be presented.)\n// - daydream: Google Daydream\n// - gearvr: Oculus GearVR\n// - cardboard: Google Cardboard\n//\n// This function also detects if the user is already in a headset, and returns the isInHMD key to be `true` if so.\nexport async function getAvailableVREntryTypes() {\n  const ua = navigator.userAgent;\n  const isSamsungBrowser = browser.name === \"chrome\" && /SamsungBrowser/.test(ua);\n  const isOculusBrowser = /Oculus/.test(ua);\n\n  // This needs to be kept up-to-date with the latest browsers that can support VR and Hubs.\n  // Checking for navigator.getVRDisplays always passes b/c of polyfill.\n  const isWebVRCapableBrowser = window.hasNativeWebVRImplementation;\n\n  const isDaydreamCapableBrowser = !!(isWebVRCapableBrowser && browser.name === \"chrome\" && !isSamsungBrowser);\n  const isIDevice = AFRAME.utils.device.isIOS();\n  const isFirefoxBrowser = browser.name === \"firefox\";\n  const isUIWebView = typeof navigator.mediaDevices === \"undefined\";\n\n  const safari = isIDevice\n    ? !isUIWebView\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.maybe\n    : VR_DEVICE_AVAILABILITY.no;\n\n  const displays = isWebVRCapableBrowser ? await navigator.getVRDisplays() : [];\n  const isInHMD = isFirefoxBrowser || isOculusBrowser;\n\n  const screen = isInHMD\n    ? VR_DEVICE_AVAILABILITY.no\n    : isIDevice && isUIWebView\n      ? VR_DEVICE_AVAILABILITY.maybe\n      : VR_DEVICE_AVAILABILITY.yes;\n\n  // HACK -- we prompt the user to install firefox if they click the VR button on a non-WebVR compatible\n  // browser. once we change this (ie when Chrome has VR support) then this check can be removed. Without this\n  // check if you have FF on Mac/Linux you'll get the confusing flow of having a VR button but then\n  // being asked to download FF.\n  const isNonWebVRFirefox = !isWebVRCapableBrowser && isFirefoxBrowser;\n  let generic =\n    AFRAME.utils.device.isMobile() || isNonWebVRFirefox ? VR_DEVICE_AVAILABILITY.no : VR_DEVICE_AVAILABILITY.maybe;\n  let cardboard = VR_DEVICE_AVAILABILITY.no;\n\n  // We only consider GearVR support as \"maybe\" and never \"yes\". The only browser\n  // that will detect GearVR outside of VR is Samsung Internet, and we'd prefer to launch into Oculus\n  // Browser for now since Samsung Internet requires an additional WebVR installation + flag, so return \"maybe\".\n  //\n  // If we are in Oculus Browser (ie, we are literally wearing a GearVR) then return 'yes'.\n  let gearvr = VR_DEVICE_AVAILABILITY.no;\n  if (isMaybeGearVRCompatibleDevice(ua)) {\n    gearvr = isOculusBrowser ? VR_DEVICE_AVAILABILITY.yes : VR_DEVICE_AVAILABILITY.maybe;\n  }\n\n  // For daydream detection, we first check if they are on an Android compatible device, and assume they\n  // may support daydream *unless* this browser has WebVR capabilities, in which case we can do better.\n  let daydream =\n    isMaybeDaydreamCompatibleDevice(ua) && !isInHMD ? VR_DEVICE_AVAILABILITY.maybe : VR_DEVICE_AVAILABILITY.no;\n\n  if (isWebVRCapableBrowser) {\n    // Generic is supported for non-blacklisted devices and presentable HMDs.\n    generic = displays.find(\n      d => d.capabilities.canPresent && !GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST.find(r => r.test(d.displayName))\n    )\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n    cardboard =\n      !isIDevice &&\n      !isFirefoxBrowser &&\n      displays.find(d => d.capabilities.canPresent && /cardboard/i.test(d.displayName))\n        ? VR_DEVICE_AVAILABILITY.yes\n        : VR_DEVICE_AVAILABILITY.no;\n\n    // For daydream detection, in a WebVR browser we can increase confidence in daydream compatibility.\n    const hasDaydreamWebVRDevice = displays.find(d => /daydream/i.test(d.displayName));\n\n    if (hasDaydreamWebVRDevice) {\n      // If we detected daydream via WebVR\n      daydream = VR_DEVICE_AVAILABILITY.yes;\n      generic = VR_DEVICE_AVAILABILITY.no;\n    } else if (isDaydreamCapableBrowser) {\n      // If we didn't detect daydream in a daydream capable browser, we definitely can't run daydream at all.\n      daydream = VR_DEVICE_AVAILABILITY.no;\n    }\n  }\n\n  return { screen, generic, gearvr, daydream, cardboard, isInHMD, safari };\n}\n","console.log(`Hubs version: ${process.env.BUILD_VERSION || \"?\"}`);\n\nimport \"./assets/stylesheets/hub.scss\";\n\nimport \"aframe\";\nimport \"./utils/logging\";\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport screenfull from \"screenfull\";\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport \"networked-aframe/src/index\";\nimport \"naf-janus-adapter\";\nimport \"aframe-teleport-controls\";\nimport \"aframe-input-mapping-component\";\nimport \"aframe-billboard-component\";\nimport \"aframe-rounded\";\nimport \"webrtc-adapter\";\nimport \"aframe-slice9-component\";\nimport \"aframe-motion-capture-components\";\nimport \"./utils/audio-context-fix\";\n\nimport trackpad_dpad4 from \"./behaviours/trackpad-dpad4\";\nimport trackpad_scrolling from \"./behaviours/trackpad-scrolling\";\nimport joystick_dpad4 from \"./behaviours/joystick-dpad4\";\nimport msft_mr_axis_with_deadzone from \"./behaviours/msft-mr-axis-with-deadzone\";\nimport { PressedMove } from \"./activators/pressedmove\";\nimport { ReverseY } from \"./activators/reversey\";\nimport { ObjectContentOrigins } from \"./object-types\";\n\nimport \"./activators/shortpress\";\n\nimport \"./components/wasd-to-analog2d\"; //Might be a behaviour or activator in the future\nimport \"./components/mute-mic\";\nimport \"./components/audio-feedback\";\nimport \"./components/bone-mute-state-indicator\";\nimport \"./components/bone-visibility\";\nimport \"./components/in-world-hud\";\nimport \"./components/virtual-gamepad-controls\";\nimport \"./components/ik-controller\";\nimport \"./components/hand-controls2\";\nimport \"./components/character-controller\";\nimport \"./components/haptic-feedback\";\nimport \"./components/networked-video-player\";\nimport \"./components/offset-relative-to\";\nimport \"./components/water\";\nimport \"./components/skybox\";\nimport \"./components/layers\";\nimport \"./components/spawn-controller\";\nimport \"./components/hide-when-quality\";\nimport \"./components/player-info\";\nimport \"./components/debug\";\nimport \"./components/animation-mixer\";\nimport \"./components/loop-animation\";\nimport \"./components/hand-poses\";\nimport \"./components/gltf-model-plus\";\nimport \"./components/gltf-bundle\";\nimport \"./components/hud-controller\";\nimport \"./components/freeze-controller\";\nimport \"./components/icon-button\";\nimport \"./components/text-button\";\nimport \"./components/block-button\";\nimport \"./components/visible-while-frozen\";\nimport \"./components/stats-plus\";\nimport \"./components/networked-avatar\";\nimport \"./components/css-class\";\nimport \"./components/scene-shadow\";\nimport \"./components/avatar-replay\";\nimport \"./components/media-views\";\nimport \"./components/pinch-to-move\";\nimport \"./components/look-on-mobile\";\nimport \"./components/pitch-yaw-rotator\";\nimport \"./components/input-configurator\";\nimport \"./components/sticky-object\";\nimport \"./components/auto-scale-cannon-physics-body\";\nimport \"./components/position-at-box-shape-border\";\nimport \"./components/remove-networked-object-button\";\nimport \"./components/destroy-at-extreme-distances\";\nimport \"./components/media-loader\";\nimport \"./components/gamma-factor\";\nimport \"./components/ambient-light\";\nimport \"./components/directional-light\";\nimport \"./components/hemisphere-light\";\nimport \"./components/point-light\";\nimport \"./components/spot-light\";\nimport \"./components/visible-to-owner\";\n\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport UIRoot from \"./react-components/ui-root\";\nimport HubChannel from \"./utils/hub-channel\";\nimport LinkChannel from \"./utils/link-channel\";\nimport { connectToReticulum } from \"./utils/phoenix-utils\";\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\nimport { addMedia, resolveMedia } from \"./utils/media-utils\";\n\nimport \"./systems/nav\";\nimport \"./systems/personal-space-bubble\";\nimport \"./systems/app-mode\";\nimport \"./systems/exit-on-blur\";\n\nimport \"./gltf-component-mappings\";\nimport { DEFAULT_ENVIRONMENT_URL } from \"./assets/environments/environments\";\n\nimport { App } from \"./App\";\n\nwindow.APP = new App();\nwindow.APP.RENDER_ORDER = {\n  HUD_BACKGROUND: 1,\n  HUD_ICONS: 2,\n  CURSOR: 3\n};\nconst store = window.APP.store;\n\nconst qs = new URLSearchParams(location.search);\nconst isMobile = AFRAME.utils.device.isMobile();\n\nwindow.APP.quality = qs.get(\"quality\") || isMobile ? \"low\" : \"high\";\n\nimport \"aframe-physics-system\";\nimport \"aframe-physics-extras\";\nimport \"super-hands\";\nimport \"./components/super-networked-interactable\";\nimport \"./components/networked-counter\";\nimport \"./components/super-spawner\";\nimport \"./components/event-repeater\";\nimport \"./components/controls-shape-offset\";\nimport \"./components/duck\";\nimport \"./components/quack\";\nimport \"./components/grabbable-toggle\";\n\nimport \"./components/cardboard-controls\";\n\nimport \"./components/cursor-controller\";\n\nimport \"./components/nav-mesh-helper\";\nimport \"./systems/tunnel-effect\";\n\nimport \"./components/tools/pen\";\nimport \"./components/tools/networked-drawing\";\nimport \"./components/tools/drawing-manager\";\n\nimport registerNetworkSchemas from \"./network-schemas\";\nimport { inGameActions, config as inputConfig } from \"./input-mappings\";\nimport registerTelemetry from \"./telemetry\";\n\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"./utils/vr-caps-detect.js\";\nimport ConcurrentLoadDetector from \"./utils/concurrent-load-detector.js\";\n\nimport qsTruthy from \"./utils/qs_truthy\";\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isTelemetryDisabled = qsTruthy(\"disable_telemetry\");\nconst isDebug = qsTruthy(\"debug\");\n\nif (!isBotMode && !isTelemetryDisabled) {\n  registerTelemetry();\n}\n\ndisableiOSZoom();\n\nAFRAME.registerInputBehaviour(\"trackpad_dpad4\", trackpad_dpad4);\nAFRAME.registerInputBehaviour(\"trackpad_scrolling\", trackpad_scrolling);\nAFRAME.registerInputBehaviour(\"joystick_dpad4\", joystick_dpad4);\nAFRAME.registerInputBehaviour(\"msft_mr_axis_with_deadzone\", msft_mr_axis_with_deadzone);\nAFRAME.registerInputActivator(\"pressedmove\", PressedMove);\nAFRAME.registerInputActivator(\"reverseY\", ReverseY);\nAFRAME.registerInputMappings(inputConfig, true);\n\nconst concurrentLoadDetector = new ConcurrentLoadDetector();\n\nconcurrentLoadDetector.start();\n\nstore.init();\n\nfunction mountUI(scene, props = {}) {\n  const disableAutoExitOnConcurrentLoad = qsTruthy(\"allow_multi\");\n  const forcedVREntryType = qs.get(\"vr_entry_type\");\n  const enableScreenSharing = qsTruthy(\"enable_screen_sharing\");\n  const showProfileEntry = !store.state.activity.hasChangedName;\n\n  ReactDOM.render(\n    <UIRoot\n      {...{\n        scene,\n        isBotMode,\n        concurrentLoadDetector,\n        disableAutoExitOnConcurrentLoad,\n        forcedVREntryType,\n        enableScreenSharing,\n        store,\n        showProfileEntry,\n        ...props\n      }}\n    />,\n    document.getElementById(\"ui-root\")\n  );\n}\n\nfunction requestFullscreen() {\n  if (screenfull.enabled && !screenfull.isFullscreen) screenfull.request();\n}\n\nconst onReady = async () => {\n  const scene = document.querySelector(\"a-scene\");\n  const hubChannel = new HubChannel(store);\n  const linkChannel = new LinkChannel(store);\n\n  document.querySelector(\"canvas\").classList.add(\"blurred\");\n  window.APP.scene = scene;\n\n  registerNetworkSchemas();\n\n  let uiProps = { linkChannel };\n\n  mountUI(scene);\n\n  const remountUI = props => {\n    uiProps = { ...uiProps, ...props };\n    mountUI(scene, uiProps);\n  };\n\n  const applyProfileFromStore = playerRig => {\n    const displayName = store.state.profile.displayName;\n    playerRig.setAttribute(\"player-info\", {\n      displayName,\n      avatarSrc: \"#\" + (store.state.profile.avatarId || \"botdefault\")\n    });\n    const hudController = playerRig.querySelector(\"[hud-controller]\");\n    hudController.setAttribute(\"hud-controller\", { showTip: !store.state.activity.hasFoundFreeze });\n    document.querySelector(\"a-scene\").emit(\"username-changed\", { username: displayName });\n  };\n\n  const exitScene = () => {\n    if (NAF.connection.adapter && NAF.connection.adapter.localMediaStream) {\n      NAF.connection.adapter.localMediaStream.getTracks().forEach(t => t.stop());\n    }\n    if (hubChannel) {\n      hubChannel.disconnect();\n    }\n    const scene = document.querySelector(\"a-scene\");\n    if (scene) {\n      if (scene.renderer) {\n        scene.renderer.setAnimationLoop(null); // Stop animation loop, TODO A-Frame should do this\n      }\n      document.body.removeChild(scene);\n    }\n    document.body.removeEventListener(\"touchend\", requestFullscreen);\n  };\n\n  const enterScene = async (mediaStream, enterInVR, hubId) => {\n    const scene = document.querySelector(\"a-scene\");\n\n    // Get aframe inspector url using the webpack file-loader.\n    const aframeInspectorUrl = require(\"file-loader?name=assets/js/[name]-[hash].[ext]!aframe-inspector/dist/aframe-inspector.min.js\");\n    // Set the aframe-inspector url to our hosted copy.\n    scene.setAttribute(\"inspector\", { url: aframeInspectorUrl });\n\n    if (!isBotMode) {\n      scene.classList.add(\"no-cursor\");\n    }\n    const playerRig = document.querySelector(\"#player-rig\");\n    document.querySelector(\"canvas\").classList.remove(\"blurred\");\n    scene.render();\n\n    if (enterInVR) {\n      scene.enterVR();\n    } else if (AFRAME.utils.device.isMobile()) {\n      document.body.addEventListener(\"touchend\", requestFullscreen);\n    }\n\n    AFRAME.registerInputActions(inGameActions, \"default\");\n\n    scene.setAttribute(\"networked-scene\", {\n      room: hubId,\n      serverURL: process.env.JANUS_SERVER\n    });\n\n    if (isDebug) {\n      scene.setAttribute(\"networked-scene\", { debug: true });\n    }\n\n    scene.setAttribute(\"stats-plus\", false);\n\n    if (isMobile || qsTruthy(\"mobile\")) {\n      playerRig.setAttribute(\"virtual-gamepad-controls\", {});\n    }\n\n    const applyProfileOnPlayerRig = applyProfileFromStore.bind(null, playerRig);\n    applyProfileOnPlayerRig();\n    store.addEventListener(\"statechanged\", applyProfileOnPlayerRig);\n\n    const avatarScale = parseInt(qs.get(\"avatar_scale\"), 10);\n\n    if (avatarScale) {\n      playerRig.setAttribute(\"scale\", { x: avatarScale, y: avatarScale, z: avatarScale });\n    }\n\n    const videoTracks = mediaStream ? mediaStream.getVideoTracks() : [];\n    let sharingScreen = videoTracks.length > 0;\n\n    const screenEntityId = `${NAF.clientId}-screen`;\n    let screenEntity = document.getElementById(screenEntityId);\n\n    scene.addEventListener(\"action_share_screen\", () => {\n      sharingScreen = !sharingScreen;\n      if (sharingScreen) {\n        for (const track of videoTracks) {\n          mediaStream.addTrack(track);\n        }\n      } else {\n        for (const track of mediaStream.getVideoTracks()) {\n          mediaStream.removeTrack(track);\n        }\n      }\n      NAF.connection.adapter.setLocalMediaStream(mediaStream);\n      screenEntity.setAttribute(\"visible\", sharingScreen);\n    });\n\n    document.body.addEventListener(\"blocked\", ev => {\n      NAF.connection.entities.removeEntitiesOfClient(ev.detail.clientId);\n    });\n\n    document.body.addEventListener(\"unblocked\", ev => {\n      NAF.connection.entities.completeSync(ev.detail.clientId);\n    });\n\n    const offset = { x: 0, y: 0, z: -1.5 };\n\n    const spawnMediaInfrontOfPlayer = (src, contentOrigin) => {\n      const { entity, orientation } = addMedia(src, \"#interactable-media\", contentOrigin, true);\n\n      orientation.then(or => {\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#player-camera\",\n          offset,\n          orientation: or\n        });\n      });\n    };\n\n    scene.addEventListener(\"add_media\", e => {\n      const contentOrigin = e.detail instanceof File ? ObjectContentOrigins.FILE : ObjectContentOrigins.URL;\n\n      spawnMediaInfrontOfPlayer(e.detail, contentOrigin);\n    });\n\n    scene.addEventListener(\"object_spawned\", e => {\n      if (hubChannel) {\n        hubChannel.sendObjectSpawnedEvent(e.detail.objectType);\n      }\n    });\n\n    document.addEventListener(\"paste\", e => {\n      if (e.target.nodeName === \"INPUT\") return;\n\n      const url = e.clipboardData.getData(\"text\");\n      const files = e.clipboardData.files && e.clipboardData.files;\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.CLIPBOARD);\n        }\n      }\n    });\n\n    document.addEventListener(\"dragover\", e => {\n      e.preventDefault();\n    });\n\n    document.addEventListener(\"drop\", e => {\n      e.preventDefault();\n      const url = e.dataTransfer.getData(\"url\");\n      const files = e.dataTransfer.files;\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.FILE);\n        }\n      }\n    });\n\n    if (!qsTruthy(\"offline\")) {\n      document.body.addEventListener(\"connected\", () => {\n        if (!isBotMode) {\n          hubChannel.sendEntryEvent().then(() => {\n            store.update({ activity: { lastEnteredAt: new Date().toISOString() } });\n          });\n        }\n        remountUI({ occupantCount: NAF.connection.adapter.publisher.initialOccupants.length + 1 });\n      });\n\n      document.body.addEventListener(\"clientConnected\", () => {\n        remountUI({\n          occupantCount: Object.keys(NAF.connection.adapter.occupants).length + 1\n        });\n      });\n\n      document.body.addEventListener(\"clientDisconnected\", () => {\n        remountUI({\n          occupantCount: Object.keys(NAF.connection.adapter.occupants).length + 1\n        });\n      });\n\n      scene.components[\"networked-scene\"].connect().catch(connectError => {\n        // hacky until we get return codes\n        const isFull = connectError.error && connectError.error.msg.match(/\\bfull\\b/i);\n        console.error(connectError);\n        remountUI({ roomUnavailableReason: isFull ? \"full\" : \"connect_error\" });\n        exitScene();\n\n        return;\n      });\n\n      if (isDebug) {\n        NAF.connection.adapter.session.options.verbose = true;\n      }\n\n      if (isBotMode) {\n        playerRig.setAttribute(\"avatar-replay\", {\n          camera: \"#player-camera\",\n          leftController: \"#player-left-controller\",\n          rightController: \"#player-right-controller\"\n        });\n\n        const audioEl = document.createElement(\"audio\");\n        const audioInput = document.querySelector(\"#bot-audio-input\");\n        audioInput.onchange = () => {\n          audioEl.loop = true;\n          audioEl.muted = true;\n          audioEl.crossorigin = \"anonymous\";\n          audioEl.src = URL.createObjectURL(audioInput.files[0]);\n          document.body.appendChild(audioEl);\n        };\n        const dataInput = document.querySelector(\"#bot-data-input\");\n        dataInput.onchange = () => {\n          const url = URL.createObjectURL(dataInput.files[0]);\n          playerRig.setAttribute(\"avatar-replay\", { recordingUrl: url });\n        };\n        await new Promise(resolve => audioEl.addEventListener(\"canplay\", resolve));\n        mediaStream.addTrack(audioEl.captureStream().getAudioTracks()[0]);\n        audioEl.play();\n      }\n\n      if (mediaStream) {\n        NAF.connection.adapter.setLocalMediaStream(mediaStream);\n\n        if (screenEntity) {\n          screenEntity.setAttribute(\"visible\", sharingScreen);\n        } else if (sharingScreen) {\n          const sceneEl = document.querySelector(\"a-scene\");\n          screenEntity = document.createElement(\"a-entity\");\n          screenEntity.id = screenEntityId;\n          screenEntity.setAttribute(\"offset-relative-to\", {\n            target: \"#player-camera\",\n            offset: \"0 0 -2\",\n            on: \"action_share_screen\"\n          });\n          screenEntity.setAttribute(\"networked\", { template: \"#video-template\" });\n          sceneEl.appendChild(screenEntity);\n        }\n      }\n    }\n  };\n\n  const getPlatformUnsupportedReason = () => {\n    if (typeof RTCDataChannelEvent === \"undefined\") {\n      return \"no_data_channels\";\n    }\n\n    return null;\n  };\n\n  remountUI({ enterScene, exitScene });\n\n  const platformUnsupportedReason = getPlatformUnsupportedReason();\n\n  if (platformUnsupportedReason) {\n    remountUI({ platformUnsupportedReason: platformUnsupportedReason });\n    exitScene();\n    return;\n  }\n\n  if (qs.get(\"required_version\") && process.env.BUILD_VERSION) {\n    const buildNumber = process.env.BUILD_VERSION.split(\" \", 1)[0]; // e.g. \"123 (abcd5678)\"\n    if (qs.get(\"required_version\") !== buildNumber) {\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\n      setTimeout(() => document.location.reload(), 5000);\n      exitScene();\n      return;\n    }\n  }\n\n  getAvailableVREntryTypes().then(availableVREntryTypes => {\n    if (availableVREntryTypes.isInHMD) {\n      remountUI({ availableVREntryTypes, forcedVREntryType: \"vr\" });\n    } else if (availableVREntryTypes.gearvr === VR_DEVICE_AVAILABILITY.yes) {\n      remountUI({ availableVREntryTypes, forcedVREntryType: \"gearvr\" });\n    } else {\n      remountUI({ availableVREntryTypes });\n    }\n  });\n\n  const environmentRoot = document.querySelector(\"#environment-root\");\n\n  const initialEnvironmentEl = document.createElement(\"a-entity\");\n  initialEnvironmentEl.addEventListener(\"bundleloaded\", () => {\n    remountUI({ initialEnvironmentLoaded: true });\n    // We never want to stop the render loop when were running in \"bot\" mode.\n    if (!isBotMode) {\n      // Stop rendering while the UI is up. We restart the render loop in enterScene.\n      // Wait a tick plus some margin so that the environments actually render.\n      setTimeout(() => scene.renderer.setAnimationLoop(null), 100);\n    } else {\n      const noop = () => {};\n      // Replace renderer with a noop renderer to reduce bot resource usage.\n      scene.renderer = { setAnimationLoop: noop, render: noop };\n    }\n  });\n  environmentRoot.appendChild(initialEnvironmentEl);\n\n  const setRoom = (hubId, hubName) => {\n    if (!isBotMode) {\n      remountUI({ hubId, hubName });\n    } else {\n      const enterSceneImmediately = () => enterScene(new MediaStream(), false, hubId);\n      if (scene.hasLoaded) {\n        enterSceneImmediately();\n      } else {\n        scene.addEventListener(\"loaded\", enterSceneImmediately);\n      }\n    }\n  };\n\n  if (qs.has(\"room\")) {\n    // If ?room is set, this is `yarn start`, so just use a default environment and query string room.\n    setRoom(qs.get(\"room\") || \"default\");\n    initialEnvironmentEl.setAttribute(\"gltf-bundle\", {\n      src: DEFAULT_ENVIRONMENT_URL\n    });\n    return;\n  }\n\n  // Connect to reticulum over phoenix channels to get hub info.\n  const hubId = qs.get(\"hub_id\") || document.location.pathname.substring(1).split(\"/\")[0];\n  console.log(`Hub ID: ${hubId}`);\n\n  const socket = connectToReticulum();\n  const channel = socket.channel(`hub:${hubId}`, {});\n\n  channel\n    .join()\n    .receive(\"ok\", async data => {\n      const hub = data.hubs[0];\n      const defaultSpaceTopic = hub.topics[0];\n      const sceneUrl = defaultSpaceTopic.assets.find(a => a.asset_type === \"gltf_bundle\").src;\n      console.log(`Scene URL: ${sceneUrl}`);\n\n      if (/\\.gltf/i.test(sceneUrl) || /\\.glb/i.test(sceneUrl)) {\n        const resolved = await resolveMedia(sceneUrl, false, 0);\n        const gltfEl = document.createElement(\"a-entity\");\n        gltfEl.setAttribute(\"gltf-model-plus\", { src: resolved.raw, inflate: true });\n        gltfEl.addEventListener(\"model-loaded\", () => initialEnvironmentEl.emit(\"bundleloaded\"));\n        initialEnvironmentEl.appendChild(gltfEl);\n      } else {\n        // TODO remove, and remove bundleloaded event\n        initialEnvironmentEl.setAttribute(\"gltf-bundle\", `src: ${sceneUrl}`);\n      }\n\n      setRoom(hub.hub_id, hub.name);\n      hubChannel.setPhoenixChannel(channel);\n    })\n    .receive(\"error\", res => {\n      if (res.reason === \"closed\") {\n        exitScene();\n        remountUI({ roomUnavailableReason: \"closed\" });\n      }\n\n      console.error(res);\n    });\n\n  linkChannel.setSocket(socket);\n};\n\ndocument.addEventListener(\"DOMContentLoaded\", onReady);\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\n// via the query string.\nimport debug from \"debug\";\nimport qsTruthy from \"./qs_truthy\";\n\nconst qs = new URLSearchParams(location.search);\nconst isDebug = qsTruthy(\"debug\");\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*\");\n\nif (logFilter) {\n  debug.enable(logFilter);\n}\n","/**\n * Chrome and Safari will start Audio contexts in a \"suspended\" state.\n * A user interaction (touch/mouse event) is needed in order to resume the AudioContext.\n */\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const ctx = THREE.AudioContext.getContext();\n\n  function resume() {\n    ctx.resume();\n\n    setTimeout(function() {\n      if (ctx.state === \"running\") {\n        document.body.removeEventListener(\"touchend\", resume, false);\n        document.body.removeEventListener(\"mouseup\", resume, false);\n      }\n    }, 0);\n  }\n\n  document.body.addEventListener(\"touchend\", resume, false);\n  document.body.addEventListener(\"mouseup\", resume, false);\n});\n","import { angleTo4Direction } from \"../utils/dpad\";\n\nfunction trackpad_dpad4(el, outputPrefix) {\n  this.outputPrefix = outputPrefix;\n  this.lastDirection = \"\";\n  this.previous = \"\";\n  this.pressed = false;\n  this.emitDPad4 = this.emitDPad4.bind(this);\n  this.press = this.press.bind(this);\n  this.unpress = this.unpress.bind(this);\n  this.hapticIntensity = \"low\";\n  this.centerRadius = 0.6;\n  this.el = el;\n}\n\ntrackpad_dpad4.prototype = {\n  addEventListeners: function() {\n    this.el.addEventListener(\"axismove\", this.emitDPad4);\n    this.el.addEventListener(\"trackpaddown\", this.press);\n    this.el.addEventListener(\"trackpadup\", this.unpress);\n  },\n  removeEventListeners: function() {\n    this.el.removeEventListener(\"axismove\", this.emitDPad4);\n    this.el.removeEventListener(\"trackpaddown\", this.press);\n    this.el.removeEventListener(\"trackpadup\", this.unpress);\n  },\n  press: function() {\n    this.pressed = true;\n  },\n  unpress: function() {\n    this.pressed = false;\n  },\n  emitDPad4: function(event) {\n    const x = event.detail.axis[0];\n    const y = event.detail.axis[1];\n    const inCenter = Math.abs(x) < this.centerRadius && Math.abs(y) < this.centerRadius;\n    const direction = inCenter ? \"center\" : angleTo4Direction(Math.atan2(x, -y));\n    const pressed = this.pressed ? \"pressed_\" : \"\";\n    const current = `${pressed + direction}`; // e.g. \"pressed_north\"\n\n    // Real axismove events are not perfectly [0,0]...\n    // This is a touchend event.\n    if (x === 0 && y === 0) {\n      event.target.emit(`${this.outputPrefix}_dpad4_${this.previous}_up`);\n      this.previous = \"\"; // Clear this because the user has lifted their finger.\n      return;\n    }\n\n    if (current === this.previous) {\n      return;\n    }\n\n    if (this.previous !== \"\") {\n      event.target.emit(`${this.outputPrefix}_dpad4_${this.previous}_up`);\n    }\n\n    event.target.emit(`${this.outputPrefix}_dpad4_${current}_down`);\n    this.previous = current;\n  }\n};\n\nexport default trackpad_dpad4;\n","function trackpad_scrolling(el) {\n  this.el = el;\n  this.start = \"trackpadtouchstart\";\n  this.move = \"axismove\";\n  this.end = \"trackpadtouchend\";\n  this.isScrolling = false;\n  this.x = -10;\n  this.y = -10;\n  this.axis = [0, 0];\n  this.emittedEventDetail = { detail: { axis: this.axis } };\n\n  this.onStart = this.onStart.bind(this);\n  this.onMove = this.onMove.bind(this);\n  this.onEnd = this.onEnd.bind(this);\n}\n\ntrackpad_scrolling.prototype = {\n  addEventListeners: function() {\n    this.el.addEventListener(this.start, this.onStart);\n    this.el.addEventListener(this.move, this.onMove);\n    this.el.addEventListener(this.end, this.onEnd);\n  },\n  removeEventListeners: function() {\n    this.el.removeEventListener(this.start, this.onStart);\n    this.el.removeEventListener(this.move, this.onMove);\n    this.el.removeEventListener(this.end, this.onEnd);\n  },\n  onStart: function() {\n    this.isScrolling = true;\n  },\n  onMove: function(e) {\n    if (!this.isScrolling) return;\n    const x = e.detail.axis[0];\n    const y = e.detail.axis[1];\n    if (this.x === -10) {\n      this.x = x;\n      this.y = y;\n      return;\n    }\n\n    const scrollSpeed = 8;\n    this.axis[0] = (x - this.x) * scrollSpeed;\n    this.axis[1] = (y - this.y) * scrollSpeed;\n    this.emittedEventDetail.axis = this.axis;\n    e.target.emit(\"scroll\", this.emittedEventDetail);\n    this.x = x;\n    this.y = y;\n  },\n  onEnd: function() {\n    this.isScrolling = false;\n    this.x = -10;\n    this.y = -10;\n  }\n};\n\nexport default trackpad_scrolling;\n","import { angleTo4Direction } from \"../utils/dpad\";\n\n// @TODO specify 4 or 8 direction\nfunction joystick_dpad4(el, outputPrefix) {\n  this.angleToDirection = angleTo4Direction;\n  this.outputPrefix = outputPrefix;\n  this.centerRadius = 0.6;\n  this.previous = \"none\";\n  this.hapticIntensity = \"low\";\n  this.emitDPad4 = this.emitDPad4.bind(this);\n  this.el = el;\n}\n\njoystick_dpad4.prototype = {\n  addEventListeners: function() {\n    this.el.addEventListener(\"axismove\", this.emitDPad4);\n  },\n  removeEventListeners: function() {\n    this.el.removeEventListener(\"axismove\", this.emitDPad4);\n  },\n  emitDPad4: function(event) {\n    const x = event.detail.axis[0];\n    const y = event.detail.axis[1];\n    const inCenter = Math.abs(x) < this.centerRadius && Math.abs(y) < this.centerRadius;\n    const current = inCenter ? \"center\" : this.angleToDirection(Math.atan2(x, -y));\n    if (current !== this.previous) {\n      this.previous = current;\n      event.target.emit(`${this.outputPrefix}_dpad4_${current}`);\n      event.target.emit(\"haptic_pulse\", { intensity: this.hapticIntensity });\n    }\n  }\n};\n\nexport default joystick_dpad4;\n","function msft_mr_axis_with_deadzone(el, outputPrefix) {\n  this.el = el;\n  this.outputPrefix = outputPrefix;\n  this.deadzone = 0.1;\n  this.emitAxisMoveWithDeadzone = this.emitAxisMoveWithDeadzone.bind(this);\n}\n\nmsft_mr_axis_with_deadzone.prototype = {\n  addEventListeners: function() {\n    this.el.addEventListener(\"axismove\", this.emitAxisMoveWithDeadzone);\n  },\n  removeEventListeners: function() {\n    this.el.removeEventListener(\"axismove\", this.emitAxisMoveWithDeadzone);\n  },\n  emitAxisMoveWithDeadzone: function(event) {\n    const axis = event.detail.axis;\n    if (Math.abs(axis[0]) < this.deadzone && Math.abs(axis[1]) < this.deadzone) {\n      return;\n    }\n    // Reverse y\n    axis[1] = -axis[1];\n    this.el.emit(\"axisMoveWithDeadzone\", event.detail);\n  }\n};\n\nexport default msft_mr_axis_with_deadzone;\n","function PressedMove(el, button, onActivate) {\n  this.down = button + \"down\";\n  this.up = button + \"up\";\n  this.pressed = false;\n  this.onActivate = onActivate;\n  this.el = el;\n  this.onButtonDown = this.onButtonDown.bind(this);\n  this.onButtonUp = this.onButtonUp.bind(this);\n  this.onAxisMove = this.onAxisMove.bind(this);\n  el.addEventListener(this.down, this.onButtonDown);\n  el.addEventListener(this.up, this.onButtonUp);\n  el.addEventListener(\"axismove\", this.onAxisMove);\n}\n\nPressedMove.prototype = {\n  onAxisMove: function(event) {\n    if (this.pressed) {\n      this.onActivate(event);\n    }\n  },\n  onButtonDown: function() {\n    this.pressed = true;\n  },\n  onButtonUp: function() {\n    this.pressed = false;\n  },\n\n  removeListeners: function() {\n    this.el.addEventListener(this.down, this.onButtonDown);\n    this.el.addEventListener(this.up, this.onButtonUp);\n    this.el.addEventListener(\"axismove\", this.onAxisMove);\n  }\n};\n\nexport { PressedMove };\n","function ReverseY(el, button, onActivate) {\n  this.el = el;\n  this.emitReverseY = this.emitReverseY.bind(this);\n  this.onActivate = onActivate;\n  this.button = button;\n  this.removeListeners = this.removeListeners.bind(this);\n  el.addEventListener(button, this.emitReverseY);\n}\n\nReverseY.prototype = {\n  emitReverseY: function(event) {\n    event.detail.axis[1] *= -1;\n    this.onActivate(event);\n  },\n  removeListeners: function() {\n    this.el.removeEventListener(this.button, this.emitReverseY);\n  }\n};\n\nexport { ReverseY };\n","function ShortPress(el, button, onActivate) {\n  this.lastTime = 0;\n  this.timeOut = 500;\n  this.eventNameDown = button + \"down\";\n  this.eventNameUp = button + \"up\";\n\n  this.el = el;\n  this.onActivate = onActivate;\n\n  this.onButtonDown = this.onButtonDown.bind(this);\n  this.onButtonUp = this.onButtonUp.bind(this);\n\n  el.addEventListener(this.eventNameDown, this.onButtonDown);\n  el.addEventListener(this.eventNameUp, this.onButtonUp);\n}\n\nShortPress.prototype = {\n  onButtonDown(event) {\n    this.pressTimer = window.setTimeout(() => {\n      this.onActivate(event);\n    }, this.timeOut);\n  },\n\n  onButtonUp() {\n    clearTimeout(this.pressTimer);\n  },\n\n  removeListeners() {\n    this.el.removeEventListener(this.eventNameDown, this.onButtonDown);\n    this.el.removeEventListener(this.eventNameUp, this.onButtonUp);\n  }\n};\n\nAFRAME.registerInputActivator(\"shortpress\", ShortPress);\n","/**\n * Converts WASD keyboard inputs to simulated analog inputs.\n * @namespace user-input\n * @component wasd-to-analog2d\n */\nAFRAME.registerComponent(\"wasd-to-analog2d\", {\n  schema: {\n    analog2dOutputAction: { default: \"wasd_analog2d\" }\n  },\n\n  init: function() {\n    this.output = [0, 0];\n    this.vectors = {\n      w: [0, 1],\n      a: [-1, 0],\n      s: [0, -1],\n      d: [1, 0]\n    };\n    this.keys = {};\n\n    this.onWasd = this.onWasd.bind(this);\n    this.move = this.move.bind(this);\n    this.onBlur = this.onBlur.bind(this);\n  },\n\n  play: function() {\n    const eventNames = [\"w_down\", \"w_up\", \"a_down\", \"a_up\", \"s_down\", \"s_up\", \"d_down\", \"d_up\"];\n    for (const name of eventNames) {\n      this.el.sceneEl.addEventListener(name, this.onWasd);\n    }\n    // I listen to events that this component generates instead of emitting \"move\"\n    // directly because ideally this would live as an input mapping, but the events\n    // generated by this component won't actually get mapped.\n    this.el.sceneEl.addEventListener(this.data.analog2dOutputAction, this.move);\n    window.addEventListener(\"blur\", this.onBlur);\n  },\n\n  pause: function() {\n    this.el.sceneEl.removeEventListener(\"wasd\", this.onWasd);\n    this.el.sceneEl.removeEventListener(this.data.analog2dOutputAction, this.move);\n    window.removeEventListener(\"blur\", this.onBlur);\n    this.keys = {};\n  },\n\n  onBlur: function() {\n    this.keys = {};\n  },\n\n  move: function(event) {\n    this.el.emit(\"move\", { axis: event.detail.axis });\n  },\n\n  onWasd: function(event) {\n    const keyEvent = event.type;\n    const down = keyEvent.indexOf(\"down\") !== -1;\n    const key = keyEvent[0].toLowerCase();\n    this.keys[key] = down;\n  },\n\n  tick: function() {\n    this.target = [0, 0];\n\n    for (const key in this.keys) {\n      if (this.keys[key] && this.vectors[key]) {\n        this.target = [this.target[0] + this.vectors[key][0], this.target[1] + this.vectors[key][1]];\n      }\n    }\n\n    const targetMagnitude = Math.sqrt(this.target[0] * this.target[0] + this.target[1] * this.target[1]);\n    if (targetMagnitude !== 0) {\n      this.target[0] = this.target[0] / targetMagnitude;\n      this.target[1] = this.target[1] / targetMagnitude;\n    }\n\n    const epsilon = 0.01;\n    if (\n      Math.abs(this.output[0]) < epsilon &&\n      Math.abs(this.output[1]) < epsilon &&\n      this.target[0] === 0 &&\n      this.target[1] === 0\n    ) {\n      return; // Staying at [0,0] doesn't require new events.\n    }\n\n    const easeInSpeed = 0.25;\n    this.output = [\n      this.output[0] + easeInSpeed * (this.target[0] - this.output[0]),\n      this.output[1] + easeInSpeed * (this.target[1] - this.output[1])\n    ];\n\n    if (this.output !== [0, 0]) {\n      this.el.emit(this.data.analog2dOutputAction, {\n        axis: this.output\n      });\n    }\n  }\n});\n","const bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles the microphone on the current network connection based on the given events.\n * @namespace network\n * @component mute-mic\n */\nAFRAME.registerComponent(\"mute-mic\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    muteEvents: { type: \"array\" },\n    unmuteEvents: { type: \"array\" }\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    this.onMute = this.onMute.bind(this);\n    this.onUnmute = this.onUnmute.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    bindAllEvents(eventSrc, muteEvents, this.onMute);\n    bindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  pause: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    unbindAllEvents(eventSrc, muteEvents, this.onMute);\n    unbindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  onToggle: function() {\n    if (this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(true);\n      this.el.removeState(\"muted\");\n    } else {\n      NAF.connection.adapter.enableMicrophone(false);\n      this.el.addState(\"muted\");\n    }\n  },\n\n  onMute: function() {\n    if (!this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(false);\n      this.el.addState(\"muted\");\n    }\n  },\n\n  onUnmute: function() {\n    if (this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(true);\n      this.el.removeState(\"muted\");\n    }\n  }\n});\n","/**\n * Toggles the position of 2 bones into \"on\" and \"off\" positions to indicate mute state.\n * @namespace avatar\n * @component bone-mute-state-indicator\n */\nAFRAME.registerComponent(\"bone-mute-state-indicator\", {\n  schema: {\n    unmutedBoneName: { default: \"Watch_Joint_MicON\" },\n    mutedBoneName: { default: \"Watch_Joint_Muted\" },\n    onPos: { default: 0.81 },\n    offPos: { default: 0.5 }\n  },\n\n  init() {\n    this.onStateToggled = this.onStateToggled.bind(this);\n    this.el.addEventListener(\"model-loaded\", () => {\n      this.unmutedBone = this.el.object3D.getObjectByName(this.data.unmutedBoneName);\n      this.mutedBone = this.el.object3D.getObjectByName(this.data.mutedBoneName);\n      this.modelLoaded = true;\n\n      this.updateMuteState();\n    });\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateToggled);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateToggled);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateToggled);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateToggled);\n  },\n\n  onStateToggled(e) {\n    if (!e.detail.state === \"muted\") return;\n    this.updateMuteState();\n  },\n\n  updateMuteState() {\n    if (!this.modelLoaded) return;\n    const muted = this.el.sceneEl.is(\"muted\");\n    this.mutedBone.position.y = muted ? this.data.onPos : this.data.offPos;\n    this.unmutedBone.position.y = !muted ? this.data.onPos : this.data.offPos;\n  }\n});\n","/**\n * Scales an object to near-zero if the object is invisible. Useful for bones representing avatar body parts.\n * @namespace avatar\n * @component bone-visibility\n */\nAFRAME.registerComponent(\"bone-visibility\", {\n  tick() {\n    const { visible } = this.el.object3D;\n\n    if (this.lastVisible !== visible) {\n      if (visible) {\n        this.el.object3D.scale.set(1, 1, 1);\n      } else {\n        // Three.js doesn't like updating matrices with 0 scale, so we set it to a near zero number.\n        this.el.object3D.scale.set(0.00000001, 0.00000001, 0.00000001);\n      }\n\n      this.lastVisible = visible;\n    }\n  }\n});\n","/**\n * HUD panel for muting, freezing, and space bubble controls.\n * @namespace ui\n * @component in-world-hud\n */\nAFRAME.registerComponent(\"in-world-hud\", {\n  schema: {\n    haptic: { type: \"selector\" },\n    raycaster: { type: \"selector\" }\n  },\n  init() {\n    this.mic = this.el.querySelector(\".mic\");\n    this.freeze = this.el.querySelector(\".freeze\");\n    this.pen = this.el.querySelector(\".pen\");\n    this.background = this.el.querySelector(\".bg\");\n    const renderOrder = window.APP.RENDER_ORDER;\n    this.mic.object3DMap.mesh.renderOrder = renderOrder.HUD_ICONS;\n    this.freeze.object3DMap.mesh.renderOrder = renderOrder.HUD_ICONS;\n    this.pen.object3DMap.mesh.renderOrder = renderOrder.HUD_ICONS;\n    this.background.object3DMap.mesh.renderORder = renderOrder.HUD_BACKGROUND;\n\n    this.updateButtonStates = () => {\n      this.mic.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"muted\"));\n      this.freeze.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"frozen\"));\n      this.pen.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"pen\"));\n    };\n    this.updateButtonStates();\n\n    this.onStateChange = evt => {\n      if (!(evt.detail === \"muted\" || evt.detail === \"frozen\" || evt.detail === \"pen\")) return;\n      this.updateButtonStates();\n    };\n\n    this.onMicClick = () => {\n      this.el.emit(\"action_mute\");\n    };\n\n    this.onFreezeClick = () => {\n      this.el.emit(\"action_freeze\");\n    };\n\n    this.onPenClick = () => {\n      this.el.emit(\"spawn_pen\");\n    };\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n\n    this.mic.addEventListener(\"click\", this.onMicClick);\n    this.freeze.addEventListener(\"click\", this.onFreezeClick);\n    this.pen.addEventListener(\"mousedown\", this.onPenClick);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n\n    this.mic.removeEventListener(\"click\", this.onMicClick);\n    this.freeze.removeEventListener(\"click\", this.onFreezeClick);\n    this.pen.removeEventListener(\"mousedown\", this.onPenClick);\n  }\n});\n","import nipplejs from \"nipplejs\";\nimport styles from \"./virtual-gamepad-controls.css\";\n\n/**\n * Instantiates 2D virtual gamepads and emits associated events.\n * @namespace user-input\n * @component virtual-gamepad-controls\n */\nAFRAME.registerComponent(\"virtual-gamepad-controls\", {\n  schema: {},\n\n  init() {\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n    this.onFirstInteraction = this.onFirstInteraction.bind(this);\n    this.onMoveJoystickChanged = this.onMoveJoystickChanged.bind(this);\n    this.onMoveJoystickEnd = this.onMoveJoystickEnd.bind(this);\n    this.onLookJoystickChanged = this.onLookJoystickChanged.bind(this);\n    this.onLookJoystickEnd = this.onLookJoystickEnd.bind(this);\n\n    this.mockJoystickContainer = document.createElement(\"div\");\n    this.mockJoystickContainer.classList.add(styles.mockJoystickContainer);\n    const leftMock = document.createElement(\"div\");\n    leftMock.classList.add(styles.mockJoystick);\n    const leftMockSmall = document.createElement(\"div\");\n    leftMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    leftMock.appendChild(leftMockSmall);\n    this.mockJoystickContainer.appendChild(leftMock);\n    const rightMock = document.createElement(\"div\");\n    rightMock.classList.add(styles.mockJoystick);\n    const rightMockSmall = document.createElement(\"div\");\n    rightMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    rightMock.appendChild(rightMockSmall);\n    this.mockJoystickContainer.appendChild(rightMock);\n    document.body.appendChild(this.mockJoystickContainer);\n\n    // Setup gamepad elements\n    const leftTouchZone = document.createElement(\"div\");\n    leftTouchZone.classList.add(styles.touchZone, styles.left);\n    document.body.appendChild(leftTouchZone);\n\n    this.leftTouchZone = leftTouchZone;\n\n    this.leftStick = nipplejs.create({\n      zone: this.leftTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n\n    this.leftStick.on(\"start\", this.onFirstInteraction);\n    this.leftStick.on(\"move\", this.onMoveJoystickChanged);\n    this.leftStick.on(\"end\", this.onMoveJoystickEnd);\n\n    const rightTouchZone = document.createElement(\"div\");\n    rightTouchZone.classList.add(styles.touchZone, styles.right);\n    document.body.appendChild(rightTouchZone);\n\n    this.rightTouchZone = rightTouchZone;\n\n    this.rightStick = nipplejs.create({\n      zone: this.rightTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n\n    this.rightStick.on(\"start\", this.onFirstInteraction);\n    this.rightStick.on(\"move\", this.onLookJoystickChanged);\n    this.rightStick.on(\"end\", this.onLookJoystickEnd);\n\n    this.inVr = false;\n    this.moving = false;\n    this.rotating = false;\n\n    this.moveEvent = {\n      axis: [0, 0]\n    };\n    this.rotateYEvent = {\n      value: 0\n    };\n    this.rotateXEvent = {\n      value: 0\n    };\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.onEnterVr);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.onExitVr);\n  },\n\n  onFirstInteraction() {\n    this.leftStick.off(\"start\", this.onFirstInteraction);\n    this.rightStick.off(\"start\", this.onFirstInteraction);\n    document.body.removeChild(this.mockJoystickContainer);\n  },\n\n  onMoveJoystickChanged(event, joystick) {\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    const moveStrength = 0.85;\n    const x = Math.cos(angle) * force * moveStrength;\n    const z = Math.sin(angle) * force * moveStrength;\n    this.moving = true;\n    this.moveEvent.axis[0] = x;\n    this.moveEvent.axis[1] = z;\n  },\n\n  onMoveJoystickEnd() {\n    this.moving = false;\n    this.moveEvent.axis[0] = 0;\n    this.moveEvent.axis[1] = 0;\n    this.el.sceneEl.emit(\"move\", this.moveEvent);\n  },\n\n  onLookJoystickChanged(event, joystick) {\n    // Set pitch and yaw angles on right stick move\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    const turnStrength = 0.5;\n    this.rotating = true;\n    this.rotateYEvent.value = Math.cos(angle) * force * turnStrength;\n    this.rotateXEvent.value = Math.sin(angle) * force * turnStrength;\n  },\n\n  onLookJoystickEnd() {\n    this.rotating = false;\n    this.rotateYEvent.value = 0;\n    this.rotateXEvent.value = 0;\n    this.el.sceneEl.emit(\"rotateY\", this.rotateYEvent);\n    this.el.sceneEl.emit(\"rotateX\", this.rotateXEvent);\n  },\n\n  tick() {\n    if (!this.inVr) {\n      if (this.moving) {\n        this.el.sceneEl.emit(\"move\", this.moveEvent);\n      }\n\n      if (this.rotating) {\n        this.el.sceneEl.emit(\"rotateY\", this.rotateYEvent);\n        this.el.sceneEl.emit(\"rotateX\", this.rotateXEvent);\n      }\n    }\n  },\n\n  onEnterVr() {\n    // Hide the joystick controls\n    this.inVr = true;\n    this.leftTouchZone.style.display = \"none\";\n    this.rightTouchZone.style.display = \"none\";\n  },\n\n  onExitVr() {\n    // Show the joystick controls\n    this.inVr = false;\n    this.leftTouchZone.style.display = \"block\";\n    this.rightTouchZone.style.display = \"block\";\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"entervr\", this.onEnterVr);\n    this.el.sceneEl.removeEventListener(\"exitvr\", this.onExitVr);\n    document.body.removeChild(this.mockJoystickContainer);\n    document.body.removeChild(this.leftTouchZone);\n    document.body.removeChild(this.rightTouchZone);\n  }\n});\n","const { Vector3, Quaternion, Matrix4, Euler } = THREE;\n/**\n * Provides access to the end effectors for IK.\n * @namespace avatar\n * @component ik-root\n */\nAFRAME.registerComponent(\"ik-root\", {\n  schema: {\n    camera: { type: \"string\", default: \".camera\" },\n    leftController: { type: \"string\", default: \".left-controller\" },\n    rightController: { type: \"string\", default: \".right-controller\" }\n  },\n  update(oldData) {\n    if (this.data.camera !== oldData.camera) {\n      this.camera = this.el.querySelector(this.data.camera);\n    }\n\n    if (this.data.leftController !== oldData.leftController) {\n      this.leftController = this.el.querySelector(this.data.leftController);\n    }\n\n    if (this.data.rightController !== oldData.rightController) {\n      this.rightController = this.el.querySelector(this.data.rightController);\n    }\n  }\n});\n\nfunction findIKRoot(entity) {\n  while (entity && !(entity.components && entity.components[\"ik-root\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"ik-root\"];\n}\n\n/**\n * Performs IK on a hip-rooted skeleton to align the hip, head and hands with camera and controller inputs.\n * @namespace avatar\n * @component ik-controller\n */\nAFRAME.registerComponent(\"ik-controller\", {\n  schema: {\n    leftEye: { type: \"string\", default: \"LeftEye\" },\n    rightEye: { type: \"string\", default: \"RightEye\" },\n    head: { type: \"string\", default: \"Head\" },\n    neck: { type: \"string\", default: \"Neck\" },\n    leftHand: { type: \"string\", default: \"LeftHand\" },\n    rightHand: { type: \"string\", default: \"RightHand\" },\n    chest: { type: \"string\", default: \"Chest\" },\n    hips: { type: \"string\", default: \"Hips\" },\n    rotationSpeed: { default: 5 }\n  },\n\n  init() {\n    this.flipY = new Matrix4().makeRotationY(Math.PI);\n\n    this.cameraForward = new Matrix4();\n    this.headTransform = new Matrix4();\n    this.hipsPosition = new Vector3();\n\n    this.invHipsToHeadVector = new Vector3();\n\n    this.middleEyeMatrix = new Matrix4();\n    this.middleEyePosition = new Vector3();\n    this.invMiddleEyeToHead = new Matrix4();\n\n    this.cameraYRotation = new Euler();\n    this.cameraYQuaternion = new Quaternion();\n\n    this.invHipsQuaternion = new Quaternion();\n    this.headQuaternion = new Quaternion();\n\n    this.rootToChest = new Matrix4();\n    this.invRootToChest = new Matrix4();\n\n    this.ikRoot = findIKRoot(this.el);\n\n    this.hands = {\n      left: {\n        rotation: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0))\n      },\n      right: {\n        rotation: new Matrix4().makeRotationFromEuler(new Euler(Math.PI / 2, Math.PI / 2, 0))\n      }\n    };\n  },\n\n  update(oldData) {\n    if (this.data.leftEye !== oldData.leftEye) {\n      this.leftEye = this.el.object3D.getObjectByName(this.data.leftEye);\n    }\n\n    if (this.data.rightEye !== oldData.rightEye) {\n      this.rightEye = this.el.object3D.getObjectByName(this.data.rightEye);\n    }\n\n    if (this.data.head !== oldData.head) {\n      this.head = this.el.object3D.getObjectByName(this.data.head);\n    }\n\n    if (this.data.neck !== oldData.neck) {\n      this.neck = this.el.object3D.getObjectByName(this.data.neck);\n    }\n\n    if (this.data.leftHand !== oldData.leftHand) {\n      this.leftHand = this.el.object3D.getObjectByName(this.data.leftHand);\n    }\n\n    if (this.data.rightHand !== oldData.rightHand) {\n      this.rightHand = this.el.object3D.getObjectByName(this.data.rightHand);\n    }\n\n    if (this.data.chest !== oldData.chest) {\n      this.chest = this.el.object3D.getObjectByName(this.data.chest);\n    }\n\n    if (this.data.hips !== oldData.hips) {\n      this.hips = this.el.object3D.getObjectByName(this.data.hips);\n    }\n\n    // Set middleEye's position to be right in the middle of the left and right eyes.\n    this.middleEyePosition.addVectors(this.leftEye.position, this.rightEye.position);\n    this.middleEyePosition.divideScalar(2);\n    this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x, this.middleEyePosition.y, this.middleEyePosition.z);\n    this.invMiddleEyeToHead = this.middleEyeMatrix.getInverse(this.middleEyeMatrix);\n\n    this.invHipsToHeadVector\n      .addVectors(this.chest.position, this.neck.position)\n      .add(this.head.position)\n      .negate();\n  },\n\n  tick(time, dt) {\n    if (!this.ikRoot) {\n      return;\n    }\n\n    const { camera, leftController, rightController } = this.ikRoot;\n    const {\n      hips,\n      head,\n      chest,\n      cameraForward,\n      headTransform,\n      invMiddleEyeToHead,\n      invHipsToHeadVector,\n      flipY,\n      cameraYRotation,\n      cameraYQuaternion,\n      invHipsQuaternion,\n      leftHand,\n      rightHand,\n      rootToChest,\n      invRootToChest\n    } = this;\n\n    // Camera faces the -Z direction. Flip it along the Y axis so that it is +Z.\n    camera.object3D.updateMatrix();\n    cameraForward.multiplyMatrices(camera.object3D.matrix, flipY);\n\n    // Compute the head position such that the hmd position would be in line with the middleEye\n    headTransform.multiplyMatrices(cameraForward, invMiddleEyeToHead);\n\n    // Then position the hips such that the head is aligned with headTransform\n    // (which positions middleEye in line with the hmd)\n    hips.position.setFromMatrixPosition(headTransform).add(invHipsToHeadVector);\n\n    // Animate the hip rotation to follow the Y rotation of the camera with some damping.\n    cameraYRotation.setFromRotationMatrix(cameraForward, \"YXZ\");\n    cameraYRotation.x = 0;\n    cameraYRotation.z = 0;\n    cameraYQuaternion.setFromEuler(cameraYRotation);\n    Quaternion.slerp(hips.quaternion, cameraYQuaternion, hips.quaternion, (this.data.rotationSpeed * dt) / 1000);\n\n    // Take the head orientation computed from the hmd, remove the Y rotation already applied to it by the hips,\n    // and apply it to the head\n    invHipsQuaternion.copy(hips.quaternion).inverse();\n    head.quaternion.setFromRotationMatrix(headTransform).premultiply(invHipsQuaternion);\n\n    hips.updateMatrix();\n    rootToChest.multiplyMatrices(hips.matrix, chest.matrix);\n    invRootToChest.getInverse(rootToChest);\n\n    this.updateHand(this.hands.left, leftHand, leftController);\n    this.updateHand(this.hands.right, rightHand, rightController);\n  },\n\n  updateHand(handState, handObject3D, controller) {\n    const hand = handObject3D.el;\n    const handMatrix = handObject3D.matrix;\n    const controllerObject3D = controller.object3D;\n\n    // TODO: This coupling with personal-space-invader is not ideal.\n    // There should be some intermediate thing managing multiple opinions about object visibility\n    const spaceInvader = hand.components[\"personal-space-invader\"];\n    const handHiddenByPersonalSpace = spaceInvader && spaceInvader.invading;\n\n    handObject3D.visible = !handHiddenByPersonalSpace && controllerObject3D.visible;\n    if (controllerObject3D.visible) {\n      handMatrix.multiplyMatrices(this.invRootToChest, controllerObject3D.matrix);\n\n      const handControls = controller.components[\"hand-controls2\"];\n\n      if (handControls) {\n        handMatrix.multiply(handControls.getControllerOffset());\n      }\n\n      handMatrix.multiply(handState.rotation);\n\n      handObject3D.position.setFromMatrixPosition(handMatrix);\n      handObject3D.rotation.setFromRotationMatrix(handMatrix);\n    }\n  }\n});\n","const CLAMP_VELOCITY = 0.01;\nconst MAX_DELTA = 0.2;\nconst EPS = 10e-6;\n\n/**\n * Avatar movement controller that listens to move, rotate and teleportation events and moves the avatar accordingly.\n * The controller accounts for playspace offset and orientation and depends on the nav mesh system for translation.\n * @namespace avatar\n * @component character-controller\n */\nAFRAME.registerComponent(\"character-controller\", {\n  schema: {\n    groundAcc: { default: 5.5 },\n    easing: { default: 10 },\n    pivot: { type: \"selector\" },\n    snapRotationDegrees: { default: THREE.Math.DEG2RAD * 45 },\n    rotationSpeed: { default: -3 }\n  },\n\n  init: function() {\n    this.navZone = \"character\";\n    this.navGroup = null;\n    this.navNode = null;\n    this.velocity = new THREE.Vector3(0, 0, 0);\n    this.accelerationInput = new THREE.Vector3(0, 0, 0);\n    this.pendingSnapRotationMatrix = new THREE.Matrix4();\n    this.angularVelocity = 0; // Scalar value because we only allow rotation around Y\n    this.setAccelerationInput = this.setAccelerationInput.bind(this);\n    this.snapRotateLeft = this.snapRotateLeft.bind(this);\n    this.snapRotateRight = this.snapRotateRight.bind(this);\n    this.setAngularVelocity = this.setAngularVelocity.bind(this);\n    this.handleTeleport = this.handleTeleport.bind(this);\n  },\n\n  update: function() {\n    this.leftRotationMatrix = new THREE.Matrix4().makeRotationY(this.data.snapRotationDegrees);\n    this.rightRotationMatrix = new THREE.Matrix4().makeRotationY(-this.data.snapRotationDegrees);\n  },\n\n  play: function() {\n    const eventSrc = this.el.sceneEl;\n    eventSrc.addEventListener(\"move\", this.setAccelerationInput);\n    eventSrc.addEventListener(\"rotateY\", this.setAngularVelocity);\n    eventSrc.addEventListener(\"snap_rotate_left\", this.snapRotateLeft);\n    eventSrc.addEventListener(\"snap_rotate_right\", this.snapRotateRight);\n    eventSrc.addEventListener(\"teleported\", this.handleTeleport);\n  },\n\n  pause: function() {\n    const eventSrc = this.el.sceneEl;\n    eventSrc.removeEventListener(\"move\", this.setAccelerationInput);\n    eventSrc.removeEventListener(\"rotateY\", this.setAngularVelocity);\n    eventSrc.removeEventListener(\"snap_rotate_left\", this.snapRotateLeft);\n    eventSrc.removeEventListener(\"snap_rotate_right\", this.snapRotateRight);\n    eventSrc.removeEventListener(\"teleported\", this.handleTeleport);\n    this.reset();\n  },\n\n  reset() {\n    this.accelerationInput.set(0, 0, 0);\n    this.velocity.set(0, 0, 0);\n    this.angularVelocity = 0;\n    this.pendingSnapRotationMatrix.identity();\n  },\n\n  setAccelerationInput: function(event) {\n    const axes = event.detail.axis;\n    this.accelerationInput.set(axes[0], 0, axes[1]);\n  },\n\n  setAngularVelocity: function(event) {\n    this.angularVelocity = event.detail.value;\n  },\n\n  snapRotateLeft: function() {\n    this.pendingSnapRotationMatrix.copy(this.leftRotationMatrix);\n  },\n\n  snapRotateRight: function() {\n    this.pendingSnapRotationMatrix.copy(this.rightRotationMatrix);\n  },\n\n  handleTeleport: function(event) {\n    const position = event.detail.newPosition;\n    const navPosition = event.detail.hitPoint;\n    this.resetPositionOnNavMesh(position, navPosition, this.el.object3D);\n  },\n\n  tick: (function() {\n    const move = new THREE.Matrix4();\n    const trans = new THREE.Matrix4();\n    const transInv = new THREE.Matrix4();\n    const pivotPos = new THREE.Vector3();\n    const rotationAxis = new THREE.Vector3(0, 1, 0);\n    const yawMatrix = new THREE.Matrix4();\n    const rotationMatrix = new THREE.Matrix4();\n    const rotationInvMatrix = new THREE.Matrix4();\n    const pivotRotationMatrix = new THREE.Matrix4();\n    const pivotRotationInvMatrix = new THREE.Matrix4();\n    const startPos = new THREE.Vector3();\n    const startScale = new THREE.Vector3();\n\n    return function(t, dt) {\n      const deltaSeconds = dt / 1000;\n      const root = this.el.object3D;\n      const pivot = this.data.pivot.object3D;\n      const distance = this.data.groundAcc * deltaSeconds;\n      const rotationDelta = this.data.rotationSpeed * this.angularVelocity * deltaSeconds;\n\n      startScale.copy(root.scale);\n      startPos.copy(root.position);\n\n      // Other aframe components like teleport-controls set position/rotation/scale, not the matrix, so we need to make sure to compose them back into the matrix\n      root.updateMatrix();\n\n      pivotPos.copy(pivot.position);\n      pivotPos.applyMatrix4(root.matrix);\n      trans.setPosition(pivotPos);\n      transInv.makeTranslation(-pivotPos.x, -pivotPos.y, -pivotPos.z);\n      rotationMatrix.makeRotationAxis(rotationAxis, root.rotation.y);\n      rotationInvMatrix.makeRotationAxis(rotationAxis, -root.rotation.y);\n      pivotRotationMatrix.makeRotationAxis(rotationAxis, pivot.rotation.y);\n      pivotRotationInvMatrix.makeRotationAxis(rotationAxis, -pivot.rotation.y);\n      this.updateVelocity(deltaSeconds);\n      move.makeTranslation(this.velocity.x * distance, this.velocity.y * distance, this.velocity.z * distance);\n      yawMatrix.makeRotationAxis(rotationAxis, rotationDelta);\n\n      // Translate to middle of playspace (player rig)\n      root.matrix.premultiply(transInv);\n      // Zero playspace (player rig) rotation\n      root.matrix.premultiply(rotationInvMatrix);\n      // Zero pivot (camera/head) rotation\n      root.matrix.premultiply(pivotRotationInvMatrix);\n      // Apply joystick translation\n      root.matrix.premultiply(move);\n      // Apply joystick yaw rotation\n      root.matrix.premultiply(yawMatrix);\n      // Apply snap rotation if necessary\n      root.matrix.premultiply(this.pendingSnapRotationMatrix);\n      // Reapply pivot (camera/head) rotation\n      root.matrix.premultiply(pivotRotationMatrix);\n      // Reapply playspace (player rig) rotation\n      root.matrix.premultiply(rotationMatrix);\n      // Reapply playspace (player rig) translation\n      root.matrix.premultiply(trans);\n      // update pos/rot/scale\n      root.matrix.decompose(root.position, root.quaternion, root.scale);\n\n      // TODO: the above matrix trnsfomraitons introduce some floating point errors in scale, this reverts them to\n      // avoid spamming network with fake scale updates\n      root.scale.copy(startScale);\n\n      this.pendingSnapRotationMatrix.identity(); // Revert to identity\n\n      if (this.velocity.lengthSq() > EPS) {\n        this.setPositionOnNavMesh(startPos, root.position, root);\n      }\n    };\n  })(),\n\n  setPositionOnNavMesh: function(start, end, object3D) {\n    const pathfinder = this.el.sceneEl.systems.nav.pathfinder;\n    const zone = this.navZone;\n    if (zone in pathfinder.zones) {\n      if (this.navGroup == null) {\n        this.navGroup = pathfinder.getGroup(zone, end);\n      }\n      this.navNode = this.navNode || pathfinder.getClosestNode(end, zone, this.navGroup, true);\n      this.navNode = pathfinder.clampStep(start, end, this.navNode, zone, this.navGroup, object3D.position);\n    }\n  },\n\n  resetPositionOnNavMesh: function(position, navPosition, object3D) {\n    const pathfinder = this.el.sceneEl.systems.nav.pathfinder;\n    const zone = this.navZone;\n    if (zone in pathfinder.zones) {\n      this.navGroup = pathfinder.getGroup(zone, position);\n      this.navNode = pathfinder.getClosestNode(navPosition, zone, this.navGroup, true) || this.navNode;\n      this.navNode = pathfinder.clampStep(position, position, this.navNode, zone, this.navGroup, object3D.position);\n    }\n  },\n\n  updateVelocity: function(dt) {\n    const data = this.data;\n    const velocity = this.velocity;\n\n    // If FPS too low, reset velocity.\n    if (dt > MAX_DELTA) {\n      velocity.x = 0;\n      velocity.z = 0;\n      return;\n    }\n\n    // Decay velocity.\n    if (velocity.x !== 0) {\n      velocity.x -= velocity.x * data.easing * dt;\n    }\n    if (velocity.z !== 0) {\n      velocity.z -= velocity.z * data.easing * dt;\n    }\n    if (velocity.y !== 0) {\n      velocity.y -= velocity.y * data.easing * dt;\n    }\n\n    const dvx = data.groundAcc * dt * this.accelerationInput.x;\n    const dvz = data.groundAcc * dt * -this.accelerationInput.z;\n    velocity.x += dvx;\n    velocity.z += dvz;\n\n    const decay = 0.7;\n    this.accelerationInput.x = this.accelerationInput.x * decay;\n    this.accelerationInput.z = this.accelerationInput.z * decay;\n\n    if (Math.abs(velocity.x) < CLAMP_VELOCITY) {\n      velocity.x = 0;\n    }\n    if (Math.abs(velocity.y) < CLAMP_VELOCITY) {\n      velocity.y = 0;\n    }\n    if (Math.abs(velocity.z) < CLAMP_VELOCITY) {\n      velocity.z = 0;\n    }\n  }\n});\n","const strengthForIntensity = {\n  low: 0.07,\n  medium: 0.2,\n  high: 1\n};\n\n/**\n * Listens for haptic events and actuates hardware controllers accordingly\n * @namespace user-input\n * @component haptic-feedback\n */\nAFRAME.registerComponent(\"haptic-feedback\", {\n  schema: {\n    hapticEventName: { default: \"haptic_pulse\" }\n  },\n\n  init: function() {\n    this.handlePulse = this.handlePulse.bind(this);\n    this.getActuator = this.getActuator.bind(this);\n    this.getActuator().then(actuator => {\n      this.actuator = actuator;\n    });\n  },\n\n  getActuator() {\n    return new Promise(resolve => {\n      const tryGetActivator = () => {\n        const trackedControls = this.el.components[\"tracked-controls\"];\n        if (\n          trackedControls &&\n          trackedControls.controller &&\n          trackedControls.controller.hapticActuators &&\n          trackedControls.controller.hapticActuators.length\n        ) {\n          resolve(trackedControls.controller.hapticActuators[0]);\n        } else {\n          setTimeout(tryGetActivator, 1000);\n        }\n      };\n      setTimeout(tryGetActivator, 1000);\n    });\n  },\n\n  play: function() {\n    this.el.addEventListener(this.data.hapticEventName, this.handlePulse);\n  },\n  pause: function() {\n    this.el.removeEventListener(this.data.hapticEventName, this.handlePulse);\n  },\n\n  handlePulse: function(event) {\n    const { intensity } = event.detail;\n\n    if (strengthForIntensity[intensity]) {\n      this.pulse(strengthForIntensity[intensity]);\n    } else if (Number(intensity) === intensity) {\n      this.pulse(intensity);\n    } else {\n      console.warn(`Invalid intensity : ${intensity}`);\n    }\n  },\n\n  pulse: function(intensity) {\n    if (this.actuator) {\n      this.actuator.pulse(intensity, 15);\n    }\n  }\n});\n","import styles from \"./networked-video-player.css\";\n\nconst nafConnected = function() {\n  return new Promise(resolve => {\n    NAF.clientId ? resolve() : document.body.addEventListener(\"connected\", resolve);\n  });\n};\n\n/**\n * Instantiates and plays a network video stream, setting the video as the source material for this entity.\n * @namespace network\n * @component networked-video-player\n */\nAFRAME.registerComponent(\"networked-video-player\", {\n  schema: {},\n  async init() {\n    await nafConnected();\n\n    const networkedEl = await NAF.utils.getNetworkedEntity(this.el);\n    if (!networkedEl) {\n      throw new Error(\"Video player must be added on a node, or a child of a node, with the `networked` component.\");\n    }\n\n    const ownerId = networkedEl.components.networked.data.owner;\n\n    const qs = new URLSearchParams(location.search);\n    const rejectScreenShares = !qs.has(\"accept_screen_shares\");\n    if (ownerId !== NAF.clientId && rejectScreenShares) {\n      // Toggle material visibility since object visibility is network-synced\n      // TODO: There ought to be a better way to disable network syncs on a remote entity\n      this.el.setAttribute(\"material\", { visible: false });\n      return;\n    }\n\n    let container = document.getElementById(\"nvp-debug-container\");\n    if (!container) {\n      container = document.createElement(\"div\");\n      container.id = \"nvp-debug-container\";\n      container.classList.add(styles.container);\n      document.body.appendChild(container);\n    }\n\n    const stream = await NAF.connection.adapter.getMediaStream(ownerId, \"video\");\n    if (!stream) {\n      return;\n    }\n\n    const v = document.createElement(\"video\");\n    v.id = `nvp-video-${ownerId}`;\n    // muted and autoplay so that more restrictive browsers (e.g. Safari on iOS) will actually play the video.\n    v.muted = true;\n    v.autoplay = true;\n    v.playsInline = true;\n    v.classList.add(styles.video);\n    v.srcObject = new MediaStream(stream.getVideoTracks()); // We only want the video track so make a new MediaStream\n    container.appendChild(v);\n    v.play();\n\n    this.videoEl = v;\n\n    v.onloadedmetadata = () => {\n      const ratio = v.videoWidth / v.videoHeight;\n      this.el.setAttribute(\"geometry\", {\n        width: ratio * 1,\n        height: 1\n      });\n      this.el.setAttribute(\"material\", \"src\", v);\n    };\n  },\n\n  remove() {\n    if (this.videoEl) {\n      this.videoEl.parentNode.removeChild(this.videoEl);\n    }\n  }\n});\n","/**\n * Positions an entity relative to a given target when the given event is fired.\n * @component offset-relative-to\n */\nAFRAME.registerComponent(\"offset-relative-to\", {\n  schema: {\n    target: {\n      type: \"selector\"\n    },\n    offset: {\n      type: \"vec3\"\n    },\n    on: {\n      type: \"string\"\n    },\n    orientation: {\n      default: 1 // see doc/image_orientations.gif\n    },\n    selfDestruct: {\n      default: false\n    }\n  },\n  init() {\n    this.updateOffset = this.updateOffset.bind(this);\n    if (this.data.on) {\n      this.el.sceneEl.addEventListener(this.data.on, this.updateOffset);\n    } else {\n      this.updateOffset();\n    }\n  },\n\n  updateOffset: (function() {\n    const y = new THREE.Vector3(0, 1, 0);\n    const z = new THREE.Vector3(0, 0, -1);\n    const QUARTER_CIRCLE = Math.PI / 2;\n    const offsetVector = new THREE.Vector3();\n    return function() {\n      const obj = this.el.object3D;\n      const target = this.data.target.object3D;\n      offsetVector.copy(this.data.offset);\n      target.localToWorld(offsetVector);\n      if (obj.parent) {\n        obj.parent.worldToLocal(offsetVector);\n      }\n      obj.position.copy(offsetVector);\n      this.el.body && this.el.body.position.copy(obj.position);\n      target.getWorldQuaternion(obj.quaternion);\n      this.el.body && this.el.body.quaternion.copy(obj.quaternion);\n\n      // See doc/image_orientations.gif\n      switch (this.data.orientation) {\n        case 8:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          break;\n        case 7:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 6:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          break;\n        case 5:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 4:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 3:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          break;\n        case 2:\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 1:\n        default:\n          break;\n      }\n\n      if (this.data.selfDestruct) {\n        if (this.data.on) {\n          this.el.sceneEl.removeEventListener(this.data.on, this.updateOffset);\n        }\n        this.el.removeAttribute(\"offset-relative-to\");\n      }\n    };\n  })()\n});\n","import { Layers } from \"./layers\";\nimport \"../vendor/Water\";\n\n/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nfunction MobileWater(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: `\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    `,\n\n    fragmentShader: `\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk[\"common\"]}\n      ${THREE.ShaderChunk[\"packing\"]}\n      ${THREE.ShaderChunk[\"bsdfs\"]}\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: false,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n}\n\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\nMobileWater.prototype.constructor = THREE.Water;\n\nAFRAME.registerComponent(\"water\", {\n  schema: {\n    waterColor: { type: \"color\", default: \"#001e0f\" },\n    distortionScale: { type: \"number\", default: 3.7 },\n    sunColor: { type: \"color\", default: \"#ffffff\" },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0 },\n    distance: { type: \"number\", default: 1 },\n    speed: { type: \"number\", default: 0.1 },\n    forceMobile: { type: \"boolean\", default: false },\n    normalMap: { type: \"asset\", default: \"#water-normal-map\" }\n  },\n  init() {\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    const waterGeometry = waterMesh.geometry;\n\n    // Render THREE.Water shader instead of THREE.Mesh\n    waterMesh.visible = false;\n\n    const waterNormals = new THREE.Texture(this.data.normalMap);\n    waterNormals.wrapS = waterNormals.wrapT = THREE.RepeatWrapping;\n    waterNormals.needsUpdate = true;\n\n    const waterConfig = {\n      textureWidth: 512,\n      textureHeight: 512,\n      waterNormals: waterNormals,\n      sunDirection: this.data.sunDirection,\n      sunColor: new THREE.Color(this.data.sunColor),\n      waterColor: new THREE.Color(this.data.waterColor),\n      distortionScale: this.data.distortionScale,\n      fog: false\n    };\n\n    if (AFRAME.utils.device.isMobile() || this.data.forceMobile) {\n      this.water = new MobileWater(waterGeometry, waterConfig);\n    } else {\n      this.water = new THREE.Water(waterGeometry, waterConfig);\n      this.water.mirrorCamera.layers.set(Layers.reflection);\n    }\n\n    this.el.setObject3D(\"water\", this.water);\n  },\n\n  update(oldData) {\n    const uniforms = this.water.material.uniforms;\n\n    if (this.data.forceMobile !== oldData.forceMobile) {\n      this.el.removeObject3D(\"water\");\n      this.init();\n      return;\n    }\n\n    if (this.data.waterColor !== oldData.waterColor) {\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\n    }\n\n    if (this.data.distortionScale !== oldData.distortionScale) {\n      uniforms.distortionScale.value = this.data.distortionScale;\n    }\n\n    if (this.data.sunColor !== oldData.sunColor) {\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunDirection.value.set(x, y, z);\n    }\n  },\n\n  tick(time) {\n    this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\n  },\n\n  remove() {\n    this.el.removeObject3D(\"water\");\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    waterMesh.visible = true;\n  }\n});\n","/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n */\n\nTHREE.Sky = function() {\n  const shader = THREE.Sky.SkyShader;\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: shader.fragmentShader,\n    vertexShader: shader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(shader.uniforms),\n    side: THREE.BackSide\n  });\n\n  THREE.Mesh.call(this, new THREE.BoxBufferGeometry(1, 1, 1), material);\n};\n\nTHREE.Sky.prototype = Object.create(THREE.Mesh.prototype);\nTHREE.Sky.prototype.constructor = THREE.Sky;\n\nTHREE.Sky.SkyShader = {\n  uniforms: {\n    luminance: { value: 1 },\n    turbidity: { value: 2 },\n    rayleigh: { value: 1 },\n    mieCoefficient: { value: 0.005 },\n    mieDirectionalG: { value: 0.8 },\n    sunPosition: { value: new THREE.Vector3() }\n  },\n\n  vertexShader: [\n    \"uniform vec3 sunPosition;\",\n    \"uniform float rayleigh;\",\n    \"uniform float turbidity;\",\n    \"uniform float mieCoefficient;\",\n\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float e = 2.71828182845904523536028747135266249775724709369995957;\",\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    // wavelength of used primaries, according to preetham\n    \"const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\",\n    // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n    // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n    \"const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\",\n\n    // mie stuff\n    // K coefficient for the primaries\n    \"const float v = 4.0;\",\n    \"const vec3 K = vec3( 0.686, 0.678, 0.666 );\",\n    // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n    \"const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\",\n\n    // earth shadow hack\n    // cutoffAngle = pi / 1.95;\n    \"const float cutoffAngle = 1.6110731556870734;\",\n    \"const float steepness = 1.5;\",\n    \"const float EE = 1000.0;\",\n\n    \"float sunIntensity( float zenithAngleCos ) {\",\n    \"\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\",\n    \"\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\",\n    \"}\",\n\n    \"vec3 totalMie( float T ) {\",\n    \"\tfloat c = ( 0.2 * T ) * 10E-18;\",\n    \"\treturn 0.434 * c * MieConst;\",\n    \"}\",\n\n    \"void main() {\",\n\n    \"\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n    \"\tvWorldPosition = worldPosition.xyz;\",\n\n    \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n    \"\tvSunDirection = normalize( sunPosition );\",\n\n    \"\tvSunE = sunIntensity( dot( vSunDirection, up ) );\",\n\n    \"\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\",\n\n    \"\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\",\n\n    // extinction (absorbtion + out scattering)\n    // rayleigh coefficients\n    \"\tvBetaR = totalRayleigh * rayleighCoefficient;\",\n\n    // mie coefficients\n    \"\tvBetaM = totalMie( turbidity ) * mieCoefficient;\",\n\n    \"}\"\n  ].join(\"\\n\"),\n\n  fragmentShader: [\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"uniform float luminance;\",\n    \"uniform float mieDirectionalG;\",\n\n    \"const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    \"const float n = 1.0003;\", // refractive index of air\n    \"const float N = 2.545E25;\", // number of molecules per unit volume for air at\n    // 288.15K and 1013mb (sea level -45 celsius)\n\n    // optical length at zenith for molecules\n    \"const float rayleighZenithLength = 8.4E3;\",\n    \"const float mieZenithLength = 1.25E3;\",\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n    // 66 arc seconds -> degrees, and the cosine of that\n    \"const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\",\n\n    // 3.0 / ( 16.0 * pi )\n    \"const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\",\n    // 1.0 / ( 4.0 * pi )\n    \"const float ONE_OVER_FOURPI = 0.07957747154594767;\",\n\n    \"float rayleighPhase( float cosTheta ) {\",\n    \"\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\",\n    \"}\",\n\n    \"float hgPhase( float cosTheta, float g ) {\",\n    \"\tfloat g2 = pow( g, 2.0 );\",\n    \"\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\",\n    \"\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\",\n    \"}\",\n\n    // Filmic ToneMapping http://filmicgames.com/archives/75\n    \"const float A = 0.15;\",\n    \"const float B = 0.50;\",\n    \"const float C = 0.10;\",\n    \"const float D = 0.20;\",\n    \"const float E = 0.02;\",\n    \"const float F = 0.30;\",\n\n    \"const float whiteScale = 1.0748724675633854;\", // 1.0 / Uncharted2Tonemap(1000.0)\n\n    \"vec3 Uncharted2Tonemap( vec3 x ) {\",\n    \"\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\",\n    \"}\",\n\n    \"void main() {\",\n    // optical length\n    // cutoff angle at 90 to avoid singularity in next formula.\n    \"\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\",\n    \"\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\",\n    \"\tfloat sR = rayleighZenithLength * inverse;\",\n    \"\tfloat sM = mieZenithLength * inverse;\",\n\n    // combined extinction factor\n    \"\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\",\n\n    // in scattering\n    \"\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\",\n\n    \"\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\",\n    \"\tvec3 betaRTheta = vBetaR * rPhase;\",\n\n    \"\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );\",\n    \"\tvec3 betaMTheta = vBetaM * mPhase;\",\n\n    \"\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\",\n    \"\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\",\n\n    // nightsky\n    \"\tvec3 direction = normalize( vWorldPosition - cameraPos );\",\n    \"\tfloat theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\",\n    \"\tfloat phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\",\n    \"\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\",\n    \"\tvec3 L0 = vec3( 0.1 ) * Fex;\",\n\n    // composition + solar disc\n    \"\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\",\n    \"\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;\",\n\n    \"\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\",\n\n    \"\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\",\n    \"\tvec3 color = curr * whiteScale;\",\n\n    \"\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\",\n\n    \"\tgl_FragColor = vec4( retColor, 1.0 );\",\n\n    \"}\"\n  ].join(\"\\n\")\n};\n\nAFRAME.registerComponent(\"skybox\", {\n  schema: {\n    turbidity: { type: \"number\", default: 10 },\n    rayleigh: { type: \"number\", default: 2 },\n    luminance: { type: \"number\", default: 1 },\n    mieCoefficient: { type: \"number\", default: 0.005 },\n    mieDirectionalG: { type: \"number\", default: 0.8 },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0 },\n    distance: { type: \"number\", default: 8000 }\n  },\n\n  init() {\n    this.sky = new THREE.Sky();\n    this.el.setObject3D(\"mesh\", this.sky);\n  },\n\n  update(oldData) {\n    const uniforms = this.sky.material.uniforms;\n\n    if (this.data.turbidity !== oldData.turbidity) {\n      uniforms.turbidity.value = this.data.turbidity;\n    }\n\n    if (this.data.rayleigh !== oldData.rayleigh) {\n      uniforms.rayleigh.value = this.data.rayleigh;\n    }\n\n    if (this.data.luminance !== oldData.luminance) {\n      uniforms.luminance.value = this.data.luminance;\n    }\n\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\n      uniforms.mieCoefficient.value = this.data.mieCoefficient;\n    }\n\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\n      uniforms.mieDirectionalG.value = this.data.mieDirectionalG;\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunPosition.value.set(x, y, z).normalize();\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","/**\n * Used on a player-rig to move the player to a random spawn point on entry.\n * @namespace avatar\n * @component spawn-controller\n */\nAFRAME.registerComponent(\"spawn-controller\", {\n  schema: {\n    target: { type: \"selector\" },\n    loadedEvent: { type: \"string\" }\n  },\n  init() {\n    this.onLoad = this.onLoad.bind(this);\n    this.data.target.addEventListener(this.data.loadedEvent, this.onLoad);\n  },\n  onLoad() {\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\n\n    if (spawnPoints.length === 0) {\n      // Keep default position\n      return;\n    }\n\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\n    const spawnPoint = spawnPoints[spawnPointIndex];\n\n    spawnPoint.object3D.getWorldPosition(this.el.object3D.position);\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\n  }\n});\n\n/**\n * Marks an entity as a potential spawn point.\n * @namespace environment\n * @component spawn-point\n */\nAFRAME.registerComponent(\"spawn-point\", {});\n","/**\n * Hides entities based on the scene's quality mode\n * @namespace environment\n * @component hide-when-quality\n */\nAFRAME.registerComponent(\"hide-when-quality\", {\n  schema: { type: \"string\", default: \"low\" },\n\n  init() {\n    this.onQualityChanged = this.onQualityChanged.bind(this);\n    this.el.sceneEl.addEventListener(\"quality-changed\", this.onQualityChanged);\n  },\n\n  onQualityChanged(event) {\n    this.updateComponentState(event.detail);\n  },\n\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.updateComponentState(window.APP.quality);\n    }\n  },\n\n  updateComponentState(quality) {\n    this.el.setAttribute(\"visible\", quality !== this.data);\n  }\n});\n","/**\n * Sets player info state, including avatar choice and display name.\n * @namespace avatar\n * @component player-info\n */\nAFRAME.registerComponent(\"player-info\", {\n  schema: {\n    displayName: { type: \"string\" },\n    avatarSrc: { type: \"string\" }\n  },\n  init() {\n    this.applyProperties = this.applyProperties.bind(this);\n  },\n  play() {\n    this.el.addEventListener(\"model-loaded\", this.applyProperties);\n  },\n  pause() {\n    this.el.removeEventListener(\"model-loaded\", this.applyProperties);\n  },\n  update() {\n    this.applyProperties();\n  },\n  applyProperties() {\n    const nametagEl = this.el.querySelector(\".nametag\");\n    if (this.data.displayName && nametagEl) {\n      nametagEl.setAttribute(\"text\", {\n        value: this.data.displayName\n      });\n    }\n\n    const modelEl = this.el.querySelector(\".model\");\n    if (this.data.avatarSrc && modelEl) {\n      modelEl.setAttribute(\"gltf-model-plus\", \"src\", this.data.avatarSrc);\n    }\n  }\n});\n","AFRAME.registerComponent(\"lifecycle-checker\", {\n  schema: {\n    name: { type: \"string\" },\n    tick: { default: false }\n  },\n  init: function() {\n    this.log(\"init\");\n  },\n  update: function() {\n    this.log(\"update\");\n  },\n  tick: function() {\n    if (this.data.tick) {\n      this.log(\"tick\");\n    }\n  },\n  remove: function() {\n    this.log(\"remove\");\n  },\n  pause: function() {\n    this.log(\"pause\");\n  },\n  play: function() {\n    this.log(\"play\");\n  },\n\n  log: function(method) {\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\n  }\n});\n","const POSES = {\n  open: \"allOpen\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  mrpDown: \"mrpDown\",\n  thumbUp: \"thumbsUp\",\n  point: \"point\",\n  fist: \"allGrip\",\n  pinch: \"pinch\"\n};\n\nconst NETWORK_POSES = [\"allOpen\", \"thumbDown\", \"indexDown\", \"mrpDown\", \"thumbsUp\", \"point\", \"allGrip\", \"pinch\"];\n\n/**\n * Animates between poses based on networked pose state using an animation mixer.\n * @namespace avatar\n * @component hand-pose\n */\nAFRAME.registerComponent(\"hand-pose\", {\n  multiple: true,\n\n  init() {\n    this.pose = 0;\n    this.animatePose = this.animatePose.bind(this);\n    this.mixer = this.el.components[\"animation-mixer\"];\n    const object3DMap = this.mixer.el.object3DMap;\n    const rootObj = object3DMap.mesh || object3DMap.scene;\n    this.clipActionObject = rootObj.parent;\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.from = this.to = this.mixer.mixer.clipAction(POSES.open + suffix, this.clipActionObject);\n    this.from.play();\n\n    const getNetworkedAvatar = el => {\n      const networkedAvatar = el.components[\"networked-avatar\"];\n      if (networkedAvatar) {\n        return networkedAvatar;\n      }\n      return getNetworkedAvatar(el.parentEl);\n    };\n    this.networkedAvatar = getNetworkedAvatar(this.el);\n  },\n\n  tick() {\n    if (\n      !this.networkedAvatar ||\n      !this.networkedAvatar.data ||\n      this.networkedAvatar.data[`${this.id}_hand_pose`] === this.pose\n    ) {\n      return;\n    }\n\n    this.animatePose(NETWORK_POSES[this.pose], NETWORK_POSES[this.networkedAvatar.data[`${this.id}_hand_pose`]]);\n    this.pose = this.networkedAvatar.data[`${this.id}_hand_pose`];\n  },\n\n  animatePose(prev, curr) {\n    this.from.stop();\n    this.to.stop();\n\n    const duration = 0.065;\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.from = this.mixer.mixer.clipAction(prev + suffix, this.clipActionObject);\n    this.to = this.mixer.mixer.clipAction(curr + suffix, this.clipActionObject);\n\n    this.from.fadeOut(duration);\n    this.to.fadeIn(duration);\n    this.to.play();\n    this.from.play();\n\n    this.mixer.mixer.update(0.001);\n  }\n});\n\n/**\n * Sets the networked hand pose state based on hand-pose events.\n * @namespace avatar\n * @component hand-pose-controller\n */\nAFRAME.registerComponent(\"hand-pose-controller\", {\n  multiple: true,\n  schema: {\n    eventSrc: { type: \"selector\" },\n    networkedAvatar: { type: \"selector\" }\n  },\n  init: function() {\n    this.setHandPose = this.setHandPose.bind(this);\n  },\n\n  play: function() {\n    this.data.eventSrc.addEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  pause: function() {\n    this.data.eventSrc.removeEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  setHandPose: function(evt) {\n    this.data.networkedAvatar.setAttribute(\n      \"networked-avatar\",\n      `${this.id}_hand_pose`,\n      NETWORK_POSES.indexOf(POSES[evt.detail.current])\n    );\n  }\n});\n","/**\n * Instantiates GLTF models as specified in a bundle JSON.\n * @namespace gltf\n * @component gltf-bundle\n */\nAFRAME.registerComponent(\"gltf-bundle\", {\n  schema: {\n    src: { default: \"\" }\n  },\n\n  init: async function() {\n    this._addGltfEntitiesForBundleJson = this._addGltfEntitiesForBundleJson.bind(this);\n    this.baseURL = new URL(THREE.LoaderUtils.extractUrlBase(this.data.src), window.location.href);\n\n    const res = await fetch(this.data.src);\n    const data = await res.json();\n    this._addGltfEntitiesForBundleJson(data);\n  },\n\n  _addGltfEntitiesForBundleJson: function(bundleJson) {\n    const loaded = [];\n\n    for (let i = 0; i < bundleJson.assets.length; i++) {\n      const asset = bundleJson.assets[i];\n\n      // TODO: for now just skip resources, eventually we will want to hold on to a reference so that we can use them\n      if (asset.type === \"resource\") continue;\n\n      const src = new URL(asset.src, this.baseURL).href;\n      const gltfEl = document.createElement(\"a-entity\");\n      gltfEl.setAttribute(\"gltf-model-plus\", { src, inflate: true });\n      loaded.push(new Promise(resolve => gltfEl.addEventListener(\"model-loaded\", resolve)));\n      this.el.appendChild(gltfEl);\n    }\n\n    Promise.all(loaded).then(() => this.el.emit(\"bundleloaded\"));\n  }\n});\n","import { AppModes } from \"../systems/app-mode.js\";\n\nconst TWOPI = Math.PI * 2;\nfunction deltaAngle(a, b) {\n  const p = Math.abs(b - a) % TWOPI;\n  return p > Math.PI ? TWOPI - p : p;\n}\n\n/**\n * Positions the HUD and toggles app mode based on where the user is looking\n * @namespace ui\n * @component hud-controller\n */\nAFRAME.registerComponent(\"hud-controller\", {\n  schema: {\n    head: { type: \"selector\" },\n    offset: { default: 0.7 }, // distance from hud above head,\n    lookCutoff: { default: 20 }, // angle at which the hud should be \"on\",\n    animRange: { default: 30 }, // degrees over which to animate the hud into view\n    yawCutoff: { default: 50 }, // yaw degrees at wich the hud should reoirent even if the user is looking up\n    showTip: { type: \"bool\" }\n  },\n  init() {\n    this.isYLocked = false;\n    this.lockedHeadPositionY = 0;\n    this.lookDir = new THREE.Vector3();\n    this.lookEuler = new THREE.Euler();\n  },\n\n  pause() {\n    // TODO: this assumes full control over current app mode reguardless of what else might be manipulating it, this is obviously wrong\n    const AppModeSystem = this.el.sceneEl.systems[\"app-mode\"];\n    AppModeSystem.setMode(AppModes.DEFAULT);\n  },\n\n  tick() {\n    const hud = this.el.object3D;\n    const head = this.data.head.object3D;\n    const sceneEl = this.el.sceneEl;\n\n    const { offset, lookCutoff, animRange, yawCutoff, showTip } = this.data;\n\n    const pitch = head.rotation.x * THREE.Math.RAD2DEG;\n    const yawDif = deltaAngle(head.rotation.y, hud.rotation.y) * THREE.Math.RAD2DEG;\n\n    // animate the hud into place over animRange degrees as the user aproaches the lookCutoff angle\n    let t = 1 - THREE.Math.clamp(lookCutoff - pitch, 0, animRange) / animRange;\n\n    // HUD is locked down while showing tooltip\n    if (showTip) {\n      t = 1;\n    }\n\n    // Once the HUD is in place it should stay in place until you look sufficiently far down\n    if (t === 1) {\n      this.lockedHeadPositionY = head.position.y;\n      this.hudLocked = true;\n    } else if (this.hudLocked && pitch < lookCutoff - animRange / 2) {\n      this.hudLocked = false;\n    }\n\n    if (this.hudLocked) {\n      t = 1;\n    }\n\n    // Reorient the hud only if the user is looking away from the hud, for right now this arbitrarily means the hud is 1/2 way animated away\n    // TODO: come up with better huristics for this that maybe account for the user turning away from the hud \"too far\", also animate the position so that it doesnt just snap.\n    if (yawDif >= yawCutoff || pitch < lookCutoff - animRange / 2) {\n      this.lookDir.set(0, 0, -1);\n      this.lookDir.applyQuaternion(head.quaternion);\n      this.lookDir.add(head.position);\n      hud.position.x = this.lookDir.x;\n      hud.position.z = this.lookDir.z;\n      hud.rotation.copy(head.rotation);\n      hud.rotation.x = 0;\n      hud.rotation.z = 0;\n    }\n    hud.position.y = (this.isYLocked ? this.lockedHeadPositionY : head.position.y) + offset + (1 - t) * offset;\n    hud.rotation.x = (1 - t) * THREE.Math.DEG2RAD * 90;\n\n    // update the app mode when the HUD locks on or off\n    // TODO: this assumes full control over current app mode reguardless of what else might be manipulating it, this is obviously wrong\n    const AppModeSystem = sceneEl.systems[\"app-mode\"];\n    if (pitch > lookCutoff && AppModeSystem.mode !== AppModes.HUD) {\n      AppModeSystem.setMode(AppModes.HUD);\n    } else if (pitch < lookCutoff && AppModeSystem.mode === AppModes.HUD) {\n      AppModeSystem.setMode(AppModes.DEFAULT);\n    }\n  }\n});\n","/**\n * Toggles freezing of network traffic on the given event.\n * @namespace network\n * @component freeze-controller\n */\nAFRAME.registerComponent(\"freeze-controller\", {\n  schema: {\n    toggleEvent: { type: \"string\" }\n  },\n\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n  },\n\n  play: function() {\n    this.el.addEventListener(this.data.toggleEvent, this.onToggle);\n  },\n\n  pause: function() {\n    this.el.removeEventListener(this.data.toggleEvent, this.onToggle);\n  },\n\n  onToggle: function() {\n    window.APP.store.update({ activity: { hasFoundFreeze: true } });\n    NAF.connection.adapter.toggleFreeze();\n    if (NAF.connection.adapter.frozen) {\n      this.el.addState(\"frozen\");\n    } else {\n      this.el.removeState(\"frozen\");\n    }\n  }\n});\n","/**\n * A button with an image, tooltip, hover states and haptics.\n * @namespace ui\n * @component icon-button\n */\nAFRAME.registerComponent(\"icon-button\", {\n  schema: {\n    image: { type: \"string\" },\n    hoverImage: { type: \"string\" },\n    activeImage: { type: \"string\" },\n    activeHoverImage: { type: \"string\" },\n    active: { type: \"boolean\" },\n    haptic: { type: \"selector\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.onHover = () => {\n      this.hovering = true;\n      this.updateButtonState();\n      this.emitHapticPulse();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.updateButtonState();\n    };\n    this.onClick = () => {\n      this.emitHapticPulse();\n    };\n  },\n\n  emitHapticPulse() {\n    if (this.data.haptic) {\n      this.data.haptic.emit(\"haptic_pulse\", { intensity: \"low\" });\n    }\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.addEventListener(\"mouseover\", this.onHover);\n    this.el.addEventListener(\"mouseout\", this.onHoverOut);\n    this.el.addEventListener(\"click\", this.onClick);\n  },\n\n  pause() {\n    this.el.removeEventListener(\"mouseover\", this.onHover);\n    this.el.removeEventListener(\"mouseout\", this.onHoverOut);\n    this.el.removeEventListener(\"click\", this.onClick);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    const active = this.data.active;\n\n    const image = active ? (hovering ? \"activeHoverImage\" : \"activeImage\") : hovering ? \"hoverImage\" : \"image\";\n\n    this.el.setAttribute(\"src\", this.data[image]);\n\n    if (this.data.tooltip) {\n      this.data.tooltip.setAttribute(\"visible\", this.hovering);\n      this.data.tooltip\n        .querySelector(\"[text]\")\n        .setAttribute(\"text\", \"value\", this.data.active ? this.data.activeTooltipText : this.data.tooltipText);\n    }\n  }\n});\n","/**\n * A button with text and haptics\n * @namespace ui\n * @component text-button\n */\nAFRAME.registerComponent(\"text-button\", {\n  schema: {\n    haptic: { type: \"selector\" },\n    textHoverColor: { type: \"string\" },\n    textColor: { type: \"string\" },\n    backgroundHoverColor: { type: \"string\" },\n    backgroundColor: { type: \"string\" }\n  },\n\n  init() {\n    this.onHover = () => {\n      this.hovering = true;\n      this.updateButtonState();\n      this.emitHapticPulse();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.updateButtonState();\n    };\n    this.onClick = () => {\n      this.emitHapticPulse();\n    };\n    this.textEl = this.el.parentEl.querySelector(\"[text]\");\n  },\n\n  emitHapticPulse() {\n    if (this.data.haptic) {\n      this.data.haptic.emit(\"haptic_pulse\", { intensity: \"low\" });\n    }\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.addEventListener(\"mouseover\", this.onHover);\n    this.el.addEventListener(\"mouseout\", this.onHoverOut);\n    this.el.addEventListener(\"click\", this.onClick);\n  },\n\n  pause() {\n    this.el.removeEventListener(\"mouseover\", this.onHover);\n    this.el.removeEventListener(\"mouseout\", this.onHoverOut);\n    this.el.removeEventListener(\"click\", this.onClick);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    this.el.setAttribute(\"slice9\", \"color\", hovering ? this.data.backgroundHoverColor : this.data.backgroundColor);\n    this.textEl.setAttribute(\"text\", \"color\", hovering ? this.data.textHoverColor : this.data.textColor);\n  }\n});\n\nconst noop = function() {};\n// TODO: this should ideally be fixed upstream somehow but its pretty tricky since text is just a geometry not a different type of Object3D, and Object3D is what handles raycast checks.\nAFRAME.registerComponent(\"text-raycast-hack\", {\n  dependencies: [\"text\"],\n  init() {\n    this.el.getObject3D(\"text\").raycast = noop;\n  }\n});\n","/**\n * Registers a click handler and invokes the block method on the NAF adapter for the owner associated with its entity.\n * @namespace network\n * @component block-button\n */\nAFRAME.registerComponent(\"block-button\", {\n  init() {\n    this.onClick = () => {\n      this.block(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.addEventListener(\"click\", this.onClick);\n  },\n\n  pause() {\n    this.el.removeEventListener(\"click\", this.onClick);\n  },\n\n  block(clientId) {\n    NAF.connection.adapter.block(clientId);\n  },\n\n  // Currently unused\n  unblock(clientId) {\n    NAF.connection.adapter.unblock(clientId);\n    NAF.connection.entities.completeSync(clientId);\n  }\n});\n","/**\n * Toggles the visibility of this entity when the scene is frozen.\n * @namespace ui\n * @component visible-while-frozen\n */\nAFRAME.registerComponent(\"visible-while-frozen\", {\n  init() {\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.el.setAttribute(\"visible\", this.el.sceneEl.is(\"frozen\"));\n    };\n    this.el.setAttribute(\"visible\", this.el.sceneEl.is(\"frozen\"));\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n  }\n});\n\n/**\n * Toggles the interactivity of a UI entity while the scene is frozen.\n * @namespace ui\n * @component ui-class-while-frozen\n */\nAFRAME.registerComponent(\"ui-class-while-frozen\", {\n  init() {\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n    };\n    this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n  }\n});\n","import \"./stats-plus.css\";\n// Adapted from https://github.com/aframevr/aframe/blob/master/src/components/scene/stats.js\n\nfunction createStats(scene) {\n  const threeStats = new window.threeStats(scene.renderer);\n  const aframeStats = new window.aframeStats(scene);\n  const plugins = scene.isMobile ? [] : [threeStats, aframeStats];\n  return new window.rStats({\n    css: [], // Our stylesheet is injected from AFrame.\n    values: {\n      fps: { caption: \"fps\", below: 30 }\n    },\n    groups: [{ caption: \"Framerate\", values: [\"fps\", \"raf\"] }],\n    plugins: plugins\n  });\n}\n\nconst HIDDEN_CLASS = \"a-hidden\";\n\nAFRAME.registerComponent(\"stats-plus\", {\n  // Whether or not the stats panel is expanded.\n  // Shows FPS counter when collapsed.\n  schema: { default: false },\n  init() {\n    this.onExpand = this.onExpand.bind(this);\n    this.onCollapse = this.onCollapse.bind(this);\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n\n    const scene = this.el.sceneEl;\n    this.stats = createStats(scene);\n    this.statsEl = document.querySelector(\".rs-base\");\n\n    // Add header to stats panel so we can collapse it\n    const statsHeaderEl = document.createElement(\"div\");\n    statsHeaderEl.classList.add(\"rs-header\");\n\n    const statsTitleEl = document.createElement(\"h1\");\n    statsTitleEl.innerHTML = \"Stats\";\n    statsHeaderEl.appendChild(statsTitleEl);\n\n    const collapseEl = document.createElement(\"div\");\n    collapseEl.classList.add(\"rs-collapse-btn\");\n    collapseEl.innerHTML = \"X\";\n    collapseEl.addEventListener(\"click\", this.onCollapse);\n    statsHeaderEl.appendChild(collapseEl);\n\n    this.statsEl.insertBefore(statsHeaderEl, this.statsEl.firstChild);\n\n    // Add fps counter to the page\n    this.fpsEl = document.createElement(\"div\");\n    this.fpsEl.addEventListener(\"click\", this.onExpand);\n    this.fpsEl.classList.add(\"rs-fps-counter\");\n    document.body.appendChild(this.fpsEl);\n    this.lastFpsUpdate = performance.now();\n    this.lastFps = 0;\n    this.frameCount = 0;\n\n    if (scene.isMobile) {\n      this.statsEl.classList.add(\"rs-mobile\");\n      this.fpsEl.classList.add(\"rs-mobile\");\n    }\n\n    scene.addEventListener(\"enter-vr\", this.onEnterVr);\n    scene.addEventListener(\"exit-vr\", this.onExitVr);\n  },\n  update(oldData) {\n    if (oldData !== this.data) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n        this.fpsEl.classList.add(HIDDEN_CLASS);\n      } else {\n        this.statsEl.classList.add(HIDDEN_CLASS);\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  tick() {\n    if (this.data) {\n      // Update rStats\n      const stats = this.stats;\n      stats(\"rAF\").tick();\n      stats(\"FPS\").frame();\n      stats().update();\n    } else {\n      // Update the fps counter\n      const now = performance.now();\n      this.frameCount++;\n\n      // Update the fps counter text once a second\n      if (now >= this.lastFpsUpdate + 1000) {\n        const fps = Math.round(this.frameCount / ((now - this.lastFpsUpdate) / 1000));\n        if (fps !== this.lastFps) {\n          this.fpsEl.innerHTML = Math.round(fps) + \" FPS\";\n          this.lastFps = fps;\n        }\n        this.lastFpsUpdate = now;\n        this.frameCount = 0;\n      }\n    }\n  },\n  onEnterVr() {\n    // Hide all stats elements when entering VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      this.statsEl.classList.add(HIDDEN_CLASS);\n      this.fpsEl.classList.add(HIDDEN_CLASS);\n    }\n  },\n  onExitVr() {\n    // Revert to previous state whe exiting VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n      } else {\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  onExpand() {\n    this.el.setAttribute(this.name, true);\n  },\n  onCollapse() {\n    this.el.setAttribute(this.name, false);\n  },\n  remove() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.hide);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.show);\n\n    if (this.statsEl) {\n      this.statsEl.parentNode.removeChild(this.statsEl);\n      this.fpsEl.parentNode.removeChild(this.fpsEl);\n    }\n  }\n});\n","/**\n * Stores networked avatar state.\n * @namespace avatar\n * @component networked-avatar\n */\nAFRAME.registerComponent(\"networked-avatar\", {\n  schema: {\n    left_hand_pose: { default: 0 },\n    right_hand_pose: { default: 0 }\n  }\n});\n","/**\n * Sets the CSS class on an entity.\n * @component css-class\n */\nAFRAME.registerComponent(\"css-class\", {\n  schema: {\n    type: \"string\"\n  },\n  multiple: true,\n  init() {\n    this.el.classList.add(this.data);\n  },\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.el.classList.remove(oldData);\n      this.el.classList.add(this.data);\n    }\n  },\n  remove() {\n    this.el.classList.remove(this.data);\n  }\n});\n","/**\n * For use in environment gltf bundles to set scene shadow properties.\n * @namespace environment\n * @component scene-shadow\n */\nAFRAME.registerComponent(\"scene-shadow\", {\n  schema: {\n    type: {\n      type: \"string\",\n      default: \"pcf\"\n    }\n  },\n  init() {\n    this.originalShadowProperties = this.el.sceneEl.getAttribute(\"shadow\");\n  },\n  update() {\n    this.el.sceneEl.setAttribute(\"shadow\", this.data);\n  },\n  remove() {\n    this.el.sceneEl.setAttribute(\"shadow\", this.originalShadowProperties);\n  }\n});\n","// These controls are removed from the controller entities so that motion-capture-replayer is in full control of them.\nconst controlsBlacklist = [\n  \"tracked-controls\",\n  \"hand-controls2\",\n  \"vive-controls\",\n  \"oculus-touch-controls\",\n  \"windows-motion-controls\",\n  \"daydream-controls\",\n  \"gearvr-controls\"\n];\n\n/**\n * Replays a recorded motion capture with the given avatar body parts\n * @namespace avatar\n * @component avatar-replay\n */\nAFRAME.registerComponent(\"avatar-replay\", {\n  schema: {\n    camera: { type: \"selector\" },\n    leftController: { type: \"selector\" },\n    rightController: { type: \"selector\" },\n    recordingUrl: { type: \"string\" }\n  },\n  init: function() {\n    this.modelLoaded = new Promise(resolve => this.el.addEventListener(\"model-loaded\", resolve));\n  },\n\n  update: function() {\n    const { camera, leftController, rightController, recordingUrl } = this.data;\n    if (!recordingUrl) {\n      return;\n    }\n\n    const fetchRecording = fetch(recordingUrl).then(resp => resp.json());\n    camera.setAttribute(\"motion-capture-replayer\", { loop: true });\n    this._setupController(leftController);\n    this._setupController(rightController);\n\n    this.dataLoaded = Promise.all([fetchRecording, this.modelLoaded]).then(([recording]) => {\n      const cameraReplayer = camera.components[\"motion-capture-replayer\"];\n      cameraReplayer.startReplaying(recording.camera);\n      const leftControllerReplayer = leftController.components[\"motion-capture-replayer\"];\n      leftControllerReplayer.startReplaying(recording.left);\n      const rightControllerReplayer = rightController.components[\"motion-capture-replayer\"];\n      rightControllerReplayer.startReplaying(recording.right);\n    });\n  },\n\n  _setupController: function(controller) {\n    controlsBlacklist.forEach(controlsComponent => controller.removeAttribute(controlsComponent));\n    controller.setAttribute(\"visible\", true);\n    controller.setAttribute(\"motion-capture-replayer\", { loop: true });\n  }\n});\n","import GIFWorker from \"../workers/gifparsing.worker.js\";\nimport errorImageSrc from \"!!url-loader!../assets/images/media-error.gif\";\n\nclass GIFTexture extends THREE.Texture {\n  constructor(frames, delays, disposals) {\n    super(document.createElement(\"canvas\"));\n    this.image.width = frames[0].width;\n    this.image.height = frames[0].height;\n\n    this._ctx = this.image.getContext(\"2d\");\n\n    this.generateMipmaps = false;\n    this.isVideoTexture = true;\n    this.minFilter = THREE.NearestFilter;\n\n    this.frames = frames;\n    this.delays = delays;\n    this.disposals = disposals;\n\n    this.frame = 0;\n    this.frameStartTime = Date.now();\n  }\n\n  update() {\n    if (!this.frames || !this.delays || !this.disposals) return;\n    const now = Date.now();\n    if (now - this.frameStartTime > this.delays[this.frame]) {\n      if (this.disposals[this.frame] === 2) {\n        this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n      }\n      this.frame = (this.frame + 1) % this.frames.length;\n      this.frameStartTime = now;\n      this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n      this.needsUpdate = true;\n    }\n  }\n}\n\nasync function createGIFTexture(url) {\n  return new Promise((resolve, reject) => {\n    // TODO: pool workers\n    const worker = new GIFWorker();\n    worker.onmessage = e => {\n      const [success, frames, delays, disposals] = e.data;\n      if (!success) {\n        reject(`error loading gif: ${e.data[1]}`);\n        return;\n      }\n\n      let loadCnt = 0;\n      for (let i = 0; i < frames.length; i++) {\n        const img = new Image();\n        img.onload = e => {\n          loadCnt++;\n          frames[i] = e.target;\n          if (loadCnt === frames.length) {\n            const texture = new GIFTexture(frames, delays, disposals);\n            texture.image.src = url;\n            texture.encoding = THREE.sRGBEncoding;\n            texture.minFilter = THREE.LinearFilter;\n            resolve(texture);\n          }\n        };\n        img.src = frames[i];\n      }\n    };\n    fetch(url, { mode: \"cors\" })\n      .then(r => r.arrayBuffer())\n      .then(rawImageData => {\n        worker.postMessage(rawImageData, [rawImageData]);\n      })\n      .catch(reject);\n  });\n}\n\n/**\n * Create video element to be used as a texture.\n *\n * @param {string} src - Url to a video file.\n * @returns {Element} Video element.\n */\nfunction createVideoEl(src) {\n  const videoEl = document.createElement(\"video\");\n  videoEl.setAttribute(\"playsinline\", \"\");\n  videoEl.setAttribute(\"webkit-playsinline\", \"\");\n  videoEl.loop = true;\n  videoEl.preload = \"auto\";\n  videoEl.crossOrigin = \"anonymous\";\n  videoEl.src = src;\n  return videoEl;\n}\n\nfunction createVideoTexture(url) {\n  return new Promise((resolve, reject) => {\n    const videoEl = createVideoEl(url);\n\n    const texture = new THREE.VideoTexture(videoEl);\n    texture.minFilter = THREE.LinearFilter;\n    texture.encoding = THREE.sRGBEncoding;\n\n    videoEl.addEventListener(\"loadedmetadata\", () => resolve(texture), { once: true });\n    videoEl.onerror = reject;\n\n    // If iOS and video is HLS, do some hacks.\n    if (\n      AFRAME.utils.device.isIOS() &&\n      AFRAME.utils.material.isHLS(\n        videoEl.src || videoEl.getAttribute(\"src\"),\n        videoEl.type || videoEl.getAttribute(\"type\")\n      )\n    ) {\n      // Actually BGRA. Tell shader to correct later.\n      texture.format = THREE.RGBAFormat;\n      texture.needsCorrectionBGRA = true;\n      // Apparently needed for HLS. Tell shader to correct later.\n      texture.flipY = false;\n      texture.needsCorrectionFlipY = true;\n    }\n  });\n}\n\nfunction createPlaneMesh(texture) {\n  const material = new THREE.MeshBasicMaterial();\n  material.side = THREE.DoubleSide;\n  material.transparent = true;\n  material.map = texture;\n  material.needsUpdate = true;\n\n  const geometry = new THREE.PlaneGeometry();\n  return new THREE.Mesh(geometry, material);\n}\n\nfunction fitToTexture(el, texture) {\n  const ratio =\n    (texture.image.videoHeight || texture.image.height || 1.0) /\n    (texture.image.videoWidth || texture.image.width || 1.0);\n  const width = Math.min(1.0, 1.0 / ratio);\n  const height = Math.min(1.0, ratio);\n  el.object3DMap.mesh.scale.set(width, height, 1);\n  el.setAttribute(\"shape\", {\n    shape: \"box\",\n    halfExtents: { x: width / 2, y: height / 2, z: 0.05 }\n  });\n}\n\nconst textureLoader = new THREE.TextureLoader();\ntextureLoader.setCrossOrigin(\"anonymous\");\nfunction createImageTexture(url) {\n  return new Promise((resolve, reject) => {\n    textureLoader.load(\n      url,\n      texture => {\n        texture.encoding = THREE.sRGBEncoding;\n        texture.minFilter = THREE.LinearFilter;\n        resolve(texture);\n      },\n      null,\n      function(xhr) {\n        reject(`'${url}' could not be fetched (Error code: ${xhr.status}; Response: ${xhr.statusText})`);\n      }\n    );\n  });\n}\n\nfunction disposeTexture(texture) {\n  if (texture.image instanceof HTMLVideoElement) {\n    const video = texture.image;\n    video.pause();\n    video.src = \"\";\n    video.load();\n  }\n  texture.dispose();\n}\n\nclass TextureCache {\n  cache = new Map();\n\n  set(src, texture) {\n    this.cache.set(src, {\n      texture,\n      count: 0\n    });\n    this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src).texture;\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    // console.log(\"retain\", src, cacheItem.count);\n    return cacheItem.texture;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count--;\n    // console.log(\"release\", src, cacheItem.count);\n    if (cacheItem.count <= 0) {\n      // Unload the video element to prevent it from continuing to play in the background\n      disposeTexture(cacheItem.texture);\n      this.cache.delete(src);\n    }\n  }\n}\n\nconst textureCache = new TextureCache();\n\nconst errorImage = new Image();\nerrorImage.src = errorImageSrc;\nconst errorTexture = new THREE.Texture(errorImage);\nerrorTexture.magFilter = THREE.NearestFilter;\nerrorImage.onload = () => {\n  errorTexture.needsUpdate = true;\n};\n\nAFRAME.registerComponent(\"media-video\", {\n  schema: {\n    src: { type: \"string\" },\n    time: { type: \"number\" },\n    videoPaused: { type: \"boolean\" },\n    tickRate: { default: 1000 }, // ms interval to send time interval updates\n    syncTolerance: { default: 2 }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.togglePlayingIfOwner = this.togglePlayingIfOwner.bind(this);\n\n    this.lastUpdate = 0;\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n      this.updatePlaybackState();\n    });\n\n    // from a-sound\n    const sceneEl = this.el.sceneEl;\n    sceneEl.audioListener = sceneEl.audioListener || new THREE.AudioListener();\n    if (sceneEl.camera) {\n      sceneEl.camera.add(sceneEl.audioListener);\n    }\n    sceneEl.addEventListener(\"camera-set-active\", function(evt) {\n      evt.detail.cameraEl.getObject3D(\"camera\").add(sceneEl.audioListener);\n    });\n  },\n\n  // aframe component play, unrelated to video\n  play() {\n    this.el.addEventListener(\"click\", this.togglePlayingIfOwner);\n  },\n\n  // aframe component pause, unrelated to video\n  pause() {\n    this.el.removeEventListener(\"click\", this.togglePlayingIfOwner);\n  },\n\n  togglePlayingIfOwner() {\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl) && this.video) {\n      this.data.videoPaused ? this.video.play() : this.video.pause();\n    }\n  },\n\n  remove() {\n    if (this.mesh && this.mesh.material) {\n      disposeTexture(this.mesh.material.map);\n    }\n    if (this.video) {\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n      this.video.removeEventListener(\"play\", this.onPauseStateChange);\n    }\n  },\n\n  onPauseStateChange() {\n    this.el.setAttribute(\"media-video\", \"videoPaused\", this.video.paused);\n  },\n\n  async updateTexture(src) {\n    let texture;\n    try {\n      texture = await createVideoTexture(src);\n\n      // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\n      if (this.data.src !== src) {\n        disposeTexture(texture);\n        return;\n      }\n\n      texture.audioSource = this.el.sceneEl.audioListener.context.createMediaElementSource(texture.image);\n      this.video = texture.image;\n\n      this.video.addEventListener(\"pause\", this.onPauseStateChange);\n      this.video.addEventListener(\"play\", this.onPauseStateChange);\n\n      const sound = new THREE.PositionalAudio(this.el.sceneEl.audioListener);\n      sound.setNodeSource(texture.audioSource);\n      this.el.setObject3D(\"sound\", sound);\n    } catch (e) {\n      console.error(\"Error loading video\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    if (!this.mesh) {\n      this.mesh = createPlaneMesh(texture);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    } else {\n      const { material } = this.mesh;\n      material.map = texture;\n      material.needsUpdate = true;\n      this.mesh.needsUpdate = true;\n    }\n\n    fitToTexture(this.el, texture);\n\n    this.updatePlaybackState(true);\n\n    this.el.emit(\"video-loaded\");\n  },\n\n  updatePlaybackState(force) {\n    if (force || (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && this.video)) {\n      if (Math.abs(this.data.time - this.video.currentTime) > this.data.syncTolerance) {\n        this.video.currentTime = this.data.time;\n      }\n      this.data.videoPaused ? this.video.pause() : this.video.play();\n    }\n  },\n\n  update(oldData) {\n    const { src } = this.data;\n\n    this.updatePlaybackState();\n\n    if (!src || src === oldData.src) return;\n\n    this.remove();\n    if (this.mesh && this.mesh.material) {\n      this.mesh.material.map = null;\n      this.mesh.material.needsUpdate = true;\n    }\n\n    this.updateTexture(src);\n  },\n\n  tick() {\n    if (this.data.videoPaused || !this.video || !this.networkedEl || !NAF.utils.isMine(this.networkedEl)) return;\n\n    const now = performance.now();\n    if (now - this.lastUpdate > this.data.tickRate) {\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n      this.lastUpdate = now;\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-image\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" }\n  },\n\n  remove() {\n    textureCache.release(this.data.src);\n  },\n\n  async update(oldData) {\n    let texture;\n    try {\n      const { src, contentType } = this.data;\n      if (!src) return;\n\n      if (this.mesh && this.mesh.map) {\n        this.mesh.material.map = null;\n        this.mesh.material.needsUpdate = true;\n        if (this.mesh.map !== errorTexture) {\n          textureCache.release(oldData.src);\n        }\n      }\n\n      if (textureCache.has(src)) {\n        texture = textureCache.retain(src);\n      } else {\n        if (src === \"error\") {\n          texture = errorTexture;\n        } else if (contentType.includes(\"image/gif\")) {\n          texture = await createGIFTexture(src);\n        } else if (contentType.startsWith(\"image/\")) {\n          texture = await createImageTexture(src);\n        } else {\n          throw new Error(`Unknown image content type: ${contentType}`);\n        }\n\n        textureCache.set(src, texture);\n\n        // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\n        if (this.data.src !== src) {\n          textureCache.release(src);\n          return;\n        }\n      }\n    } catch (e) {\n      console.error(\"Error loading image\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    if (!this.mesh) {\n      this.mesh = createPlaneMesh(texture);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    } else {\n      const { material } = this.mesh;\n      material.map = texture;\n      material.needsUpdate = true;\n      this.mesh.needsUpdate = true;\n    }\n\n    fitToTexture(this.el, texture);\n\n    this.el.emit(\"image-loaded\");\n  }\n});\n","module.exports = \"data:image/gif;base64,R0lGODlhEAAQAIQaAAAAAAEBAQABBQEBAgEBBQMDAwAykwBk+wFk+/85Af47AwCIHgCJHgGJHgCKHgOJIPc63vc64Pc64YeHhwDySLu7wru8wru8w7y8wwD6/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAB8ALAAAAAAQABAAAAVl4AeMZDl9KAqkLDqd6YrN9HzC4jdbTUPDMBnGQWEAKphBYKTSYR6LRQE5y+VmlUAAc+lWrMIa4nBYxXQJcabMkkUUtLGhJZNA4BiC4HyVSCJpKRhgOktmgoRVLDSELY5mTHQlKyEAOw==\"","AFRAME.registerComponent(\"pinch-to-move\", {\n  schema: {\n    speed: { default: 0.25 }\n  },\n  init() {\n    this.onPinch = this.onPinch.bind(this);\n    this.axis = [0, 0];\n    this.pinch = 0;\n    this.prevPinch = 0;\n    this.needsMove = false;\n  },\n  play() {\n    this.el.addEventListener(\"pinch\", this.onPinch);\n  },\n  pause() {\n    this.el.removeEventListener(\"pinch\", this.onPinch);\n  },\n  tick() {\n    if (this.needsMove) {\n      const diff = this.pinch - this.prevPinch;\n      this.axis[1] = diff * this.data.speed;\n      this.el.emit(\"move\", { axis: this.axis });\n      this.prevPinch = this.pinch;\n    }\n    this.needsMove = false;\n  },\n  onPinch(e) {\n    const { isNewPinch, distance } = e.detail;\n    if (isNewPinch) {\n      this.prevPinch = distance;\n      return;\n    }\n    this.pinch = distance;\n    this.needsMove = true;\n  }\n});\n","const TWOPI = Math.PI * 2;\n\nclass CircularBuffer {\n  constructor(length) {\n    this.items = new Array(length).fill(0);\n    this.writePtr = 0;\n  }\n\n  push(item) {\n    this.items[this.writePtr] = item;\n    this.writePtr = (this.writePtr + 1) % this.items.length;\n  }\n}\n\nconst abs = Math.abs;\n// Input: two numbers between [-Math.PI, Math.PI]\n// Output: difference between them, where -Math.PI === Math.PI\nconst difference = (curr, prev) => {\n  const a = curr - prev;\n  const b = curr + TWOPI - prev;\n  const c = curr - (prev + TWOPI);\n  if (abs(a) < abs(b)) {\n    if (abs(a) < abs(c)) {\n      return a;\n    }\n  }\n  if (abs(b) < abs(c)) {\n    return b;\n  }\n\n  return c;\n};\n\nconst average = a => {\n  let sum = 0;\n  for (let i = 0; i < a.length; i++) {\n    const n = a[i];\n    sum += n;\n  }\n  return sum / a.length;\n};\n\nAFRAME.registerComponent(\"look-on-mobile\", {\n  schema: {\n    horizontalLookSpeedRatio: { default: 1.0 }, // motion applied to camera / motion of polyfill object\n    verticalLookSpeedRatio: { default: 1.0 }, // motion applied to camera / motion of polyfill object\n    camera: { type: \"selector\" }\n  },\n\n  init() {\n    this.hmdEuler = new THREE.Euler();\n    this.hmdQuaternion = new THREE.Quaternion();\n    this.prevX = this.hmdEuler.x;\n    this.prevY = this.hmdEuler.y;\n    this.pendingLookX = 0;\n    this.onRotateX = this.onRotateX.bind(this);\n    this.dXBuffer = new CircularBuffer(6);\n    this.dYBuffer = new CircularBuffer(6);\n    this.vrDisplay = window.webvrpolyfill.getPolyfillDisplays()[0];\n    this.frameData = new window.webvrpolyfill.constructor.VRFrameData();\n  },\n\n  play() {\n    this.el.addEventListener(\"rotateX\", this.onRotateX);\n  },\n\n  pause() {\n    this.el.removeEventListener(\"rotateX\", this.onRotateX);\n  },\n\n  update() {\n    this.cameraController = this.data.camera.components[\"pitch-yaw-rotator\"];\n  },\n\n  onRotateX(e) {\n    this.pendingLookX = e.detail.value;\n  },\n\n  tick() {\n    const hmdEuler = this.hmdEuler;\n    const { horizontalLookSpeedRatio, verticalLookSpeedRatio } = this.data;\n    this.vrDisplay.getFrameData(this.frameData);\n    if (this.frameData.pose.orientation !== null) {\n      this.hmdQuaternion.fromArray(this.frameData.pose.orientation);\n      hmdEuler.setFromQuaternion(this.hmdQuaternion, \"YXZ\");\n    }\n\n    const dX = THREE.Math.RAD2DEG * difference(hmdEuler.x, this.prevX);\n    const dY = THREE.Math.RAD2DEG * difference(hmdEuler.y, this.prevY);\n\n    this.dXBuffer.push(Math.abs(dX) < 0.001 ? 0 : dX);\n    this.dYBuffer.push(Math.abs(dY) < 0.001 ? 0 : dY);\n\n    const deltaYaw = average(this.dYBuffer.items) * horizontalLookSpeedRatio;\n    const deltaPitch = average(this.dXBuffer.items) * verticalLookSpeedRatio + this.pendingLookX;\n\n    this.cameraController.look(deltaPitch, deltaYaw);\n\n    this.prevX = hmdEuler.x;\n    this.prevY = hmdEuler.y;\n    this.pendingLookX = 0;\n  }\n});\n","const degToRad = THREE.Math.degToRad;\nAFRAME.registerComponent(\"pitch-yaw-rotator\", {\n  schema: {\n    minPitch: { default: -50 },\n    maxPitch: { default: 50 }\n  },\n\n  init() {\n    this.pitch = 0;\n    this.yaw = 0;\n  },\n\n  look(deltaPitch, deltaYaw) {\n    const { minPitch, maxPitch } = this.data;\n    this.pitch += deltaPitch;\n    this.pitch = Math.max(minPitch, Math.min(maxPitch, this.pitch));\n    this.yaw += deltaYaw;\n  },\n\n  tick() {\n    this.el.object3D.rotation.set(degToRad(this.pitch), degToRad(this.yaw), 0);\n    this.el.object3D.rotation.order = \"YXZ\";\n  }\n});\n","import TouchEventsHandler from \"../utils/touch-events-handler.js\";\nimport MouseEventsHandler from \"../utils/mouse-events-handler.js\";\nimport GearVRMouseEventsHandler from \"../utils/gearvr-mouse-events-handler.js\";\nimport ActionEventHandler from \"../utils/action-event-handler.js\";\n\nAFRAME.registerComponent(\"input-configurator\", {\n  schema: {\n    cursorController: { type: \"selector\" },\n    gazeTeleporter: { type: \"selector\" },\n    camera: { type: \"selector\" },\n    playerRig: { type: \"selector\" },\n    leftController: { type: \"selector\" },\n    rightController: { type: \"selector\" },\n    leftControllerRayObject: { type: \"string\" },\n    rightControllerRayObject: { type: \"string\" },\n    gazeCursorRayObject: { type: \"string\" }\n  },\n\n  init() {\n    this.inVR = this.el.sceneEl.is(\"vr-mode\");\n    this.isMobile = AFRAME.utils.device.isMobile();\n    this.eventHandlers = [];\n    this.controllerQueue = [];\n    this.hasPointingDevice = false;\n    this.cursor = this.data.cursorController.components[\"cursor-controller\"];\n    this.gazeTeleporter = this.data.gazeTeleporter.components[\"teleport-controls\"];\n    this.cameraController = this.data.camera.components[\"pitch-yaw-rotator\"];\n    this.playerRig = this.data.playerRig;\n    this.handedness = \"right\";\n\n    this.onEnterVR = this.onEnterVR.bind(this);\n    this.onExitVR = this.onExitVR.bind(this);\n    this.handleControllerConnected = this.handleControllerConnected.bind(this);\n    this.handleControllerDisconnected = this.handleControllerDisconnected.bind(this);\n\n    this.configureInput();\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"controllerconnected\", this.handleControllerConnected);\n    this.el.sceneEl.addEventListener(\"controllerdisconnected\", this.handleControllerDisconnected);\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.onEnterVR);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.onExitVR);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"controllerconnected\", this.handleControllerConnected);\n    this.el.sceneEl.removeEventListener(\"controllerdisconnected\", this.handleControllerDisconnected);\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.onEnterVR);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.onExitVR);\n  },\n\n  onEnterVR() {\n    this.inVR = true;\n    this.tearDown();\n    this.configureInput();\n    this.updateController();\n  },\n\n  onExitVR() {\n    this.inVR = false;\n    this.tearDown();\n    this.configureInput();\n    this.updateController();\n  },\n\n  tearDown() {\n    this.eventHandlers.forEach(h => h.tearDown());\n    this.eventHandlers = [];\n    this.actionEventHandler = null;\n    if (this.lookOnMobile) {\n      this.lookOnMobile.el.removeAttribute(\"look-on-mobile\");\n      this.lookOnMobile = null;\n    }\n    this.cursorRequiresManagement = false;\n  },\n\n  addLookOnMobile() {\n    const onAdded = e => {\n      if (e.detail.name !== \"look-on-mobile\") return;\n      this.lookOnMobile = this.el.sceneEl.components[\"look-on-mobile\"];\n    };\n    this.el.sceneEl.addEventListener(\"componentinitialized\", onAdded);\n    // This adds look-on-mobile to the scene\n    this.el.sceneEl.setAttribute(\"look-on-mobile\", \"camera\", this.data.camera);\n  },\n\n  configureInput() {\n    this.actionEventHandler = new ActionEventHandler(this.el.sceneEl, this.cursor);\n    this.eventHandlers.push(this.actionEventHandler);\n\n    this.cursor.el.setAttribute(\"cursor-controller\", \"useMousePos\", !this.inVR);\n\n    if (this.inVR) {\n      this.cameraController.pause();\n      this.cursorRequiresManagement = true;\n      this.cursor.el.setAttribute(\"cursor-controller\", \"minDistance\", 0);\n      if (this.isMobile) {\n        this.eventHandlers.push(new GearVRMouseEventsHandler(this.cursor, this.gazeTeleporter));\n      } else {\n        this.eventHandlers.push(new MouseEventsHandler(this.cursor, this.cameraController));\n      }\n    } else {\n      this.cameraController.play();\n      if (this.isMobile) {\n        this.cursor.setCursorVisibility(false);\n        this.eventHandlers.push(new TouchEventsHandler(this.cursor, this.cameraController, this.cursor.el));\n        this.addLookOnMobile();\n      } else {\n        this.eventHandlers.push(new MouseEventsHandler(this.cursor, this.cameraController));\n        this.cursor.el.setAttribute(\"cursor-controller\", \"minDistance\", 0.3);\n      }\n    }\n  },\n\n  tick() {\n    if (this.cursorRequiresManagement && this.controller) {\n      this.actionEventHandler.manageCursorEnabled();\n    }\n  },\n\n  handleControllerConnected: function(e) {\n    const data = {\n      controller: e.target,\n      handedness: e.detail.component.data.hand\n    };\n\n    if (data.handedness === this.handedness) {\n      this.controllerQueue.unshift(data);\n    } else {\n      this.controllerQueue.push(data);\n    }\n\n    this.updateController();\n  },\n\n  handleControllerDisconnected: function(e) {\n    for (let i = 0; i < this.controllerQueue.length; i++) {\n      if (e.target === this.controllerQueue[i].controller) {\n        this.controllerQueue.splice(i, 1);\n        this.updateController();\n        return;\n      }\n    }\n  },\n\n  updateController: function() {\n    this.hasPointingDevice = this.controllerQueue.length > 0 && this.inVR;\n    this.cursor.el.setAttribute(\"cursor-controller\", \"drawLine\", this.hasPointingDevice);\n\n    this.cursor.setCursorVisibility(true);\n\n    if (this.hasPointingDevice) {\n      const controllerData = this.controllerQueue[0];\n      const hand = controllerData.handedness;\n      this.controller = controllerData.controller;\n      this.cursor.el.setAttribute(\"cursor-controller\", {\n        rayObject: hand === \"left\" ? this.data.leftControllerRayObject : this.data.rightControllerRayObject\n      });\n    } else {\n      this.controller = null;\n      this.cursor.el.setAttribute(\"cursor-controller\", { rayObject: this.data.gazeCursorRayObject });\n    }\n\n    if (this.actionEventHandler && this.controller) {\n      this.actionEventHandler.setHandThatAlsoDrivesCursor(this.controller);\n    }\n  }\n});\n","const VIRTUAL_JOYSTICK_HEIGHT = 0.8;\nconst HORIZONTAL_LOOK_SPEED = 0.35;\nconst VERTICAL_LOOK_SPEED = 0.18;\n\nexport default class TouchEventsHandler {\n  constructor(cursor, cameraController, pinchEmitter) {\n    this.cursor = cursor;\n    this.cameraController = cameraController;\n    this.pinchEmitter = pinchEmitter;\n    this.touches = [];\n    this.touchReservedForCursor = null;\n    this.touchesReservedForPinch = [];\n    this.touchReservedForLookControls = null;\n    this.needsPinch = false;\n    this.pinchTouchId1 = -1;\n    this.pinchTouchId2 = -1;\n\n    this.handleTouchStart = this.handleTouchStart.bind(this);\n    this.singleTouchStart = this.singleTouchStart.bind(this);\n    this.handleTouchMove = this.handleTouchMove.bind(this);\n    this.singleTouchMove = this.singleTouchMove.bind(this);\n    this.handleTouchEnd = this.handleTouchEnd.bind(this);\n    this.singleTouchEnd = this.singleTouchEnd.bind(this);\n\n    this.addEventListeners();\n  }\n\n  addEventListeners() {\n    document.addEventListener(\"touchstart\", this.handleTouchStart);\n    document.addEventListener(\"touchmove\", this.handleTouchMove);\n    document.addEventListener(\"touchend\", this.handleTouchEnd);\n    document.addEventListener(\"touchcancel\", this.handleTouchEnd);\n  }\n\n  tearDown() {\n    document.removeEventListener(\"touchstart\", this.handleTouchStart);\n    document.removeEventListener(\"touchmove\", this.handleTouchMove);\n    document.removeEventListener(\"touchend\", this.handleTouchEnd);\n    document.removeEventListener(\"touchcancel\", this.handleTouchEnd);\n  }\n\n  handleTouchStart(e) {\n    for (let i = 0; i < e.changedTouches.length; i++) {\n      this.singleTouchStart(e.changedTouches[i]);\n    }\n  }\n\n  singleTouchStart(touch) {\n    if (touch.clientY / window.innerHeight >= VIRTUAL_JOYSTICK_HEIGHT) {\n      return;\n    }\n    if (!this.touchReservedForCursor) {\n      const targetX = (touch.clientX / window.innerWidth) * 2 - 1;\n      const targetY = -(touch.clientY / window.innerHeight) * 2 + 1;\n      this.cursor.moveCursor(targetX, targetY);\n      this.cursor.forceCursorUpdate();\n      if (this.cursor.startInteraction()) {\n        this.touchReservedForCursor = touch;\n      }\n    }\n    this.touches.push(touch);\n  }\n\n  handleTouchMove(e) {\n    for (let i = 0; i < e.touches.length; i++) {\n      this.singleTouchMove(e.touches[i]);\n    }\n    if (this.needsPinch) {\n      this.pinch();\n      this.needsPinch = false;\n    }\n  }\n\n  singleTouchMove(touch) {\n    if (this.touchReservedForCursor && touch.identifier === this.touchReservedForCursor.identifier) {\n      const targetX = (touch.clientX / window.innerWidth) * 2 - 1;\n      const targetY = -(touch.clientY / window.innerHeight) * 2 + 1;\n      this.cursor.moveCursor(targetX, targetY);\n      return;\n    }\n    if (touch.clientY / window.innerHeight >= VIRTUAL_JOYSTICK_HEIGHT) return;\n    if (!this.touches.some(t => touch.identifier === t.identifier)) {\n      return;\n    }\n\n    let pinchIndex = this.touchesReservedForPinch.findIndex(t => touch.identifier === t.identifier);\n    if (pinchIndex !== -1) {\n      this.touchesReservedForPinch[pinchIndex] = touch;\n    } else if (this.touchesReservedForPinch.length < 2) {\n      this.touchesReservedForPinch.push(touch);\n      pinchIndex = this.touchesReservedForPinch.length - 1;\n    }\n    if (this.touchesReservedForPinch.length == 2 && pinchIndex !== -1) {\n      if (this.touchReservedForLookControls && touch.identifier === this.touchReservedForLookControls.identifier) {\n        this.touchReservedForLookControls = null;\n      }\n      this.needsPinch = true;\n      return;\n    }\n\n    if (!this.touchReservedForLookControls) {\n      this.touchReservedForLookControls = touch;\n    }\n    if (touch.identifier === this.touchReservedForLookControls.identifier) {\n      if (!this.touchReservedForCursor) {\n        this.cursor.moveCursor(\n          (touch.clientX / window.innerWidth) * 2 - 1,\n          -(touch.clientY / window.innerHeight) * 2 + 1\n        );\n      }\n      this.look(this.touchReservedForLookControls, touch);\n      this.touchReservedForLookControls = touch;\n      return;\n    }\n  }\n\n  pinch() {\n    const t1 = this.touchesReservedForPinch[0];\n    const t2 = this.touchesReservedForPinch[1];\n    const isNewPinch = t1.identifier !== this.pinchTouchId1 || t2.identifier !== this.pinchTouchId2;\n    const pinchDistance = TouchEventsHandler.distance(t1.clientX, t1.clientY, t2.clientX, t2.clientY);\n    this.pinchEmitter.emit(\"pinch\", { isNewPinch: isNewPinch, distance: pinchDistance });\n    this.pinchTouchId1 = t1.identifier;\n    this.pinchTouchId2 = t2.identifier;\n  }\n\n  look(prevTouch, touch) {\n    const deltaPitch = (touch.clientY - prevTouch.clientY) * VERTICAL_LOOK_SPEED;\n    const deltaYaw = (touch.clientX - prevTouch.clientX) * HORIZONTAL_LOOK_SPEED;\n    this.cameraController.look(deltaPitch, deltaYaw);\n  }\n\n  handleTouchEnd(e) {\n    for (let i = 0; i < e.changedTouches.length; i++) {\n      this.singleTouchEnd(e.changedTouches[i]);\n    }\n  }\n\n  singleTouchEnd(touch) {\n    const touchIndex = this.touches.findIndex(t => touch.identifier === t.identifier);\n    if (touchIndex === -1) {\n      return;\n    }\n    this.touches.splice(touchIndex, 1);\n\n    if (this.touchReservedForCursor && touch.identifier === this.touchReservedForCursor.identifier) {\n      this.cursor.endInteraction(touch);\n      this.touchReservedForCursor = null;\n      return;\n    }\n\n    const pinchIndex = this.touchesReservedForPinch.findIndex(t => touch.identifier === t.identifier);\n    if (pinchIndex !== -1) {\n      this.touchesReservedForPinch.splice(pinchIndex, 1);\n      this.pinchTouchId1 = -1;\n      this.pinchTouchId2 = -1;\n    }\n\n    if (this.touchReservedForLookControls && touch.identifier === this.touchReservedForLookControls.identifier) {\n      this.touchReservedForLookControls = null;\n    }\n  }\n\n  static distance = (x1, y1, x2, y2) => {\n    const x = x1 - x2;\n    const y = y1 - y2;\n    return Math.sqrt(x * x + y * y);\n  };\n}\n","// TODO: Make look speed adjustable by the user\nconst HORIZONTAL_LOOK_SPEED = 0.1;\nconst VERTICAL_LOOK_SPEED = 0.06;\nconst VERTICAL_SCROLL_TIMEOUT = 50;\nconst HORIZONTAL_SCROLL_TIMEOUT = 50;\n\nexport default class MouseEventsHandler {\n  constructor(cursor, cameraController) {\n    this.cursor = cursor;\n    const cursorController = this.cursor.el.getAttribute(\"cursor-controller\");\n    this.superHand = cursorController.cursor.components[\"super-hands\"];\n    this.cameraController = cameraController;\n    this.isLeftButtonDown = false;\n    this.isLeftButtonHandledByCursor = false;\n    this.isPointerLocked = false;\n\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n    this.onMouseWheel = this.onMouseWheel.bind(this);\n\n    this.addEventListeners();\n\n    this.lastVerticalScrollTime = 0;\n    this.lastHorizontalScrollTime = 0;\n  }\n\n  tearDown() {\n    document.removeEventListener(\"mousedown\", this.onMouseDown);\n    document.removeEventListener(\"mousemove\", this.onMouseMove);\n    document.removeEventListener(\"mouseup\", this.onMouseUp);\n    document.removeEventListener(\"wheel\", this.onMouseWheel);\n    document.removeEventListener(\"contextmenu\", this.onContextMenu);\n  }\n\n  setInverseMouseLook(invert) {\n    this.invertMouseLook = invert;\n  }\n\n  addEventListeners() {\n    document.addEventListener(\"mousedown\", this.onMouseDown);\n    document.addEventListener(\"mousemove\", this.onMouseMove);\n    document.addEventListener(\"mouseup\", this.onMouseUp);\n    document.addEventListener(\"wheel\", this.onMouseWheel);\n    document.addEventListener(\"contextmenu\", this.onContextMenu);\n  }\n\n  onContextMenu(e) {\n    e.preventDefault();\n  }\n\n  onMouseDown(e) {\n    switch (e.button) {\n      case 0: //left button\n        this.onLeftButtonDown();\n        break;\n      case 1: //middle/scroll button\n        //TODO: rotation? scaling?\n        break;\n      case 2: //right button\n        this.onRightButtonDown();\n        break;\n    }\n  }\n\n  onLeftButtonDown() {\n    this.isLeftButtonDown = true;\n    if (this.isToggle(this.superHand.state.get(\"grab-start\"))) {\n      this.superHand.el.emit(\"secondary-cursor-grab\");\n    }\n    this.isLeftButtonHandledByCursor = this.cursor.startInteraction();\n  }\n\n  onRightButtonDown() {\n    this.isLeftButtonHandledByCursor = this.cursor.isInteracting();\n    if (!this.isLeftButtonHandledByCursor) {\n      if (this.isPointerLocked) {\n        document.exitPointerLock();\n        this.isPointerLocked = false;\n      } else {\n        document.body.requestPointerLock();\n        this.isPointerLocked = true;\n      }\n    }\n  }\n\n  onMouseWheel(e) {\n    let changed = true;\n    if (!e.altKey && !e.shiftKey) {\n      changed = this.cursor.changeDistanceMod(this.getScrollMod(e.deltaY, e.deltaMode));\n    }\n\n    if (\n      (!changed || e.shiftKey) &&\n      (this.lastVerticalScrollTime === 0 || this.lastVerticalScrollTime + VERTICAL_SCROLL_TIMEOUT < Date.now())\n    ) {\n      this.superHand.el.emit(e.deltaY > 0 ? \"scroll_up\" : \"scroll_down\");\n      this.superHand.el.emit(\"vertical_scroll_release\");\n      this.lastVerticalScrollTime = Date.now();\n    }\n\n    const delta = e.altKey ? e.deltaY : e.deltaX;\n    if (\n      Math.abs(delta) > 0 &&\n      (this.lastHorizontalScrollTime === 0 || this.lastHorizontalScrollTime + HORIZONTAL_SCROLL_TIMEOUT < Date.now())\n    ) {\n      this.superHand.el.emit(delta < 0 ? \"scroll_left\" : \"scroll_right\");\n      this.superHand.el.emit(\"horizontal_scroll_release\");\n      this.lastHorizontalScrollTime = Date.now();\n    }\n\n    if (e.altKey) e.preventDefault(); //prevent forward/back on firefox\n  }\n\n  getScrollMod(delta, deltaMode) {\n    switch (deltaMode) {\n      case WheelEvent.DOM_DELTA_PIXEL:\n        return delta / 500;\n      case WheelEvent.DOM_DELTA_LINE:\n        return delta / 10;\n      case WheelEvent.DOM_DELTA_PAGE:\n        return delta / 2;\n    }\n  }\n\n  onMouseMove(e) {\n    const shouldLook =\n      this.isPointerLocked ||\n      (!this.superHand.state.get(\"grab-start\") && this.isLeftButtonDown && !this.isLeftButtonHandledByCursor);\n    if (shouldLook) {\n      this.look(e);\n    }\n\n    this.cursor.moveCursor((e.clientX / window.innerWidth) * 2 - 1, -(e.clientY / window.innerHeight) * 2 + 1);\n  }\n\n  onMouseUp(e) {\n    switch (e.button) {\n      case 0: //left button\n        if (this.isToggle(this.superHand.state.get(\"grab-start\"))) {\n          this.superHand.el.emit(\"secondary-cursor-release\");\n        } else {\n          this.endInteraction();\n        }\n        this.isLeftButtonDown = false;\n        break;\n      case 1: //middle/scroll button\n        break;\n      case 2: //right button\n        this.endInteraction();\n        break;\n    }\n  }\n\n  endInteraction() {\n    this.cursor.endInteraction();\n    this.isLeftButtonHandledByCursor = false;\n  }\n\n  isToggle(el) {\n    return el && el.matches(\".toggle, .toggle *\");\n  }\n\n  look(e) {\n    const sign = this.invertMouseLook ? 1 : -1;\n    const deltaPitch = e.movementY * VERTICAL_LOOK_SPEED * sign;\n    const deltaYaw = e.movementX * HORIZONTAL_LOOK_SPEED * sign;\n    this.cameraController.look(deltaPitch, deltaYaw);\n  }\n}\n","export default class GearVRMouseEventsHandler {\n  constructor(cursor, gazeTeleporter) {\n    this.cursor = cursor;\n    this.gazeTeleporter = gazeTeleporter;\n    this.isMouseDownHandledByCursor = false;\n    this.isMouseDownHandledByGazeTeleporter = false;\n\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n    this.addEventListeners();\n  }\n\n  addEventListeners() {\n    document.addEventListener(\"mousedown\", this.onMouseDown);\n    document.addEventListener(\"mouseup\", this.onMouseUp);\n  }\n\n  tearDown() {\n    document.removeEventListener(\"mousedown\", this.onMouseDown);\n    document.removeEventListener(\"mouseup\", this.onMouseUp);\n  }\n\n  onMouseDown() {\n    this.isMouseDownHandledByCursor = this.cursor.startInteraction();\n    if (this.isMouseDownHandledByCursor) {\n      return;\n    }\n\n    this.cursor.setCursorVisibility(false);\n\n    const button = this.gazeTeleporter.data.button;\n    this.gazeTeleporter.el.emit(button + \"down\");\n    this.isMouseDownHandledByGazeTeleporter = true;\n  }\n\n  onMouseUp() {\n    if (this.isMouseDownHandledByCursor) {\n      this.cursor.endInteraction();\n      this.isMouseDownHandledByCursor = false;\n    }\n\n    this.cursor.setCursorVisibility(true);\n\n    if (this.isMouseDownHandledByGazeTeleporter) {\n      const button = this.gazeTeleporter.data.button;\n      this.gazeTeleporter.el.emit(button + \"up\");\n      this.isMouseDownHandledByGazeTeleporter = false;\n    }\n  }\n}\n","const VERTICAL_SCROLL_TIMEOUT = 150;\nconst HORIZONTAL_SCROLL_TIMEOUT = 150;\nconst SCROLL_THRESHOLD = 0.05;\nconst SCROLL_MODIFIER = 0.1;\n\nexport default class ActionEventHandler {\n  constructor(scene, cursor) {\n    this.scene = scene;\n    this.cursor = cursor;\n    this.cursorHand = this.cursor.data.cursor.components[\"super-hands\"];\n    this.isCursorInteracting = false;\n    this.isTeleporting = false;\n    this.handThatAlsoDrivesCursor = null;\n    this.hovered = false;\n\n    this.gotPrimaryDown = false;\n\n    this.onPrimaryDown = this.onPrimaryDown.bind(this);\n    this.onPrimaryUp = this.onPrimaryUp.bind(this);\n    this.onSecondaryDown = this.onSecondaryDown.bind(this);\n    this.onSecondaryUp = this.onSecondaryUp.bind(this);\n    this.onPrimaryGrab = this.onPrimaryGrab.bind(this);\n    this.onPrimaryRelease = this.onPrimaryRelease.bind(this);\n    this.onSecondaryGrab = this.onSecondaryGrab.bind(this);\n    this.onSecondaryRelease = this.onSecondaryRelease.bind(this);\n    this.onCardboardButtonDown = this.onCardboardButtonDown.bind(this);\n    this.onCardboardButtonUp = this.onCardboardButtonUp.bind(this);\n    this.onScrollMove = this.onScrollMove.bind(this);\n    this.addEventListeners();\n\n    this.lastVerticalScrollTime = 0;\n    this.lastHorizontalScrollTime = 0;\n  }\n\n  addEventListeners() {\n    this.scene.addEventListener(\"action_primary_down\", this.onPrimaryDown);\n    this.scene.addEventListener(\"action_primary_up\", this.onPrimaryUp);\n    this.scene.addEventListener(\"action_secondary_down\", this.onSecondaryDown);\n    this.scene.addEventListener(\"action_secondary_up\", this.onSecondaryUp);\n    this.scene.addEventListener(\"primary_action_grab\", this.onPrimaryGrab);\n    this.scene.addEventListener(\"primary_action_release\", this.onPrimaryRelease);\n    this.scene.addEventListener(\"secondary_action_grab\", this.onSecondaryGrab);\n    this.scene.addEventListener(\"secondary_action_release\", this.onSecondaryRelease);\n    this.scene.addEventListener(\"scroll_move\", this.onScrollMove);\n    this.scene.addEventListener(\"cardboardbuttondown\", this.onCardboardButtonDown); // TODO: These should be actions\n    this.scene.addEventListener(\"cardboardbuttonup\", this.onCardboardButtonUp);\n  }\n\n  tearDown() {\n    this.scene.removeEventListener(\"action_primary_down\", this.onPrimaryDown);\n    this.scene.removeEventListener(\"action_primary_up\", this.onPrimaryUp);\n    this.scene.removeEventListener(\"action_secondary_down\", this.onSecondaryDown);\n    this.scene.removeEventListener(\"action_secondary_up\", this.onSecondaryUp);\n    this.scene.removeEventListener(\"primary_action_grab\", this.onPrimaryGrab);\n    this.scene.removeEventListener(\"primary_action_release\", this.onPrimaryRelease);\n    this.scene.removeEventListener(\"secondary_action_grab\", this.onSecondaryGrab);\n    this.scene.removeEventListener(\"secondary_action_release\", this.onSecondaryRelease);\n    this.scene.removeEventListener(\"scroll_move\", this.onScrollMove);\n    this.scene.removeEventListener(\"cardboardbuttondown\", this.onCardboardButtonDown);\n    this.scene.removeEventListener(\"cardboardbuttonup\", this.onCardboardButtonUp);\n  }\n\n  onScrollMove(e) {\n    let scrollY = e.detail.axis[1] * SCROLL_MODIFIER;\n    scrollY = Math.abs(scrollY) > SCROLL_THRESHOLD ? scrollY : 0;\n    const changed = this.cursor.changeDistanceMod(-scrollY); //TODO: don't negate this for certain controllers\n\n    let scrollX = e.detail.axis[0] * SCROLL_MODIFIER;\n    scrollX = Math.abs(scrollX) > SCROLL_THRESHOLD ? scrollX : 0;\n\n    this.isCursorInteracting = this.cursor.isInteracting();\n\n    if (\n      Math.abs(scrollY) > 0 &&\n      (this.lastVerticalScrollTime === 0 || this.lastVerticalScrollTime + VERTICAL_SCROLL_TIMEOUT < Date.now())\n    ) {\n      if (!changed && this.isCursorInteracting && this.isHandThatAlsoDrivesCursor(e.target)) {\n        this.cursorHand.el.emit(scrollY < 0 ? \"scroll_up\" : \"scroll_down\");\n        this.cursorHand.el.emit(\"vertical_scroll_release\");\n      } else {\n        e.target.emit(scrollY < 0 ? \"scroll_up\" : \"scroll_down\");\n        e.target.emit(\"vertical_scroll_release\");\n      }\n      this.lastVerticalScrollTime = Date.now();\n    }\n\n    if (\n      Math.abs(scrollX) > 0 &&\n      (this.lastHorizontalScrollTime === 0 || this.lastHorizontalScrollTime + HORIZONTAL_SCROLL_TIMEOUT < Date.now())\n    ) {\n      if (this.isCursorInteracting && this.isHandThatAlsoDrivesCursor(e.target)) {\n        this.cursorHand.el.emit(scrollX < 0 ? \"scroll_left\" : \"scroll_right\");\n        this.cursorHand.el.emit(\"horizontal_scroll_release\");\n      } else {\n        e.target.emit(scrollX < 0 ? \"scroll_left\" : \"scroll_right\");\n        e.target.emit(\"horizontal_scroll_release\");\n      }\n      this.lastHorizontalScrollTime = Date.now();\n    }\n  }\n\n  setHandThatAlsoDrivesCursor(handThatAlsoDrivesCursor) {\n    this.handThatAlsoDrivesCursor = handThatAlsoDrivesCursor;\n  }\n\n  isToggle(el) {\n    return el && el.matches(\".toggle, .toggle *\");\n  }\n\n  isHandThatAlsoDrivesCursor(el) {\n    return this.handThatAlsoDrivesCursor === el;\n  }\n\n  onGrab(e, event) {\n    event = event || e.type;\n    const superHand = e.target.components[\"super-hands\"];\n    const isCursorHand = this.isHandThatAlsoDrivesCursor(e.target);\n    this.isCursorInteracting = this.cursor.isInteracting();\n    if (isCursorHand && !this.isCursorInteracting) {\n      if (superHand.state.has(\"hover-start\") || superHand.state.get(\"grab-start\")) {\n        e.target.emit(event);\n      } else {\n        this.isCursorInteracting = this.cursor.startInteraction();\n      }\n    } else if (isCursorHand && this.isCursorInteracting) {\n      this.cursorHand.el.emit(event);\n    } else {\n      e.target.emit(event);\n    }\n  }\n\n  onRelease(e, event) {\n    event = event || e.type;\n    const isCursorHand = this.isHandThatAlsoDrivesCursor(e.target);\n    if (this.isCursorInteracting && isCursorHand) {\n      //need to check both grab-start and hover-start in the case that the spawner is being grabbed this frame\n      if (this.isToggle(this.cursorHand.state.get(\"grab-start\") || this.cursorHand.state.get(\"hover-start\"))) {\n        this.cursorHand.el.emit(event);\n        this.isCursorInteracting = this.cursor.isInteracting();\n      } else {\n        this.isCursorInteracting = false;\n        this.cursor.endInteraction();\n      }\n    } else {\n      e.target.emit(event);\n    }\n  }\n\n  onPrimaryGrab(e) {\n    this.onGrab(e, \"primary_hand_grab\");\n  }\n\n  onPrimaryRelease(e) {\n    this.onRelease(e, \"primary_hand_release\");\n  }\n\n  onSecondaryGrab(e) {\n    this.onGrab(e, \"secondary_hand_grab\");\n  }\n\n  onSecondaryRelease(e) {\n    this.onRelease(e, \"secondary_hand_release\");\n  }\n\n  onDown(e, event) {\n    this.onGrab(e, event);\n\n    if (\n      this.isHandThatAlsoDrivesCursor(e.target) &&\n      !this.isCursorInteracting &&\n      !this.cursorHand.state.get(\"grab-start\")\n    ) {\n      this.cursor.setCursorVisibility(false);\n      const button = e.target.components[\"teleport-controls\"].data.button;\n      e.target.emit(button + \"down\");\n      this.isTeleporting = true;\n    }\n  }\n\n  onUp(e, event) {\n    if (this.isTeleporting && this.isHandThatAlsoDrivesCursor(e.target)) {\n      const superHand = e.target.components[\"super-hands\"];\n      this.cursor.setCursorVisibility(!superHand.state.has(\"hover-start\"));\n      const button = e.target.components[\"teleport-controls\"].data.button;\n      e.target.emit(button + \"up\");\n      this.isTeleporting = false;\n    } else {\n      this.onRelease(e, event);\n    }\n  }\n\n  onPrimaryDown(e) {\n    if (!this.gotPrimaryDown) {\n      this.onDown(e, \"primary_hand_grab\");\n      this.gotPrimaryDown = true;\n    }\n  }\n\n  onPrimaryUp(e) {\n    if (this.gotPrimaryDown) {\n      this.onUp(e, \"primary_hand_release\");\n    } else if (this.isToggle(this.cursorHand.state.get(\"grab-start\") || this.cursorHand.state.get(\"hover-start\"))) {\n      this.onUp(e, \"secondary_hand_release\");\n    }\n    this.gotPrimaryDown = false;\n  }\n\n  onSecondaryDown(e) {\n    this.onDown(e, \"secondary_hand_grab\");\n  }\n\n  onSecondaryUp(e) {\n    this.onUp(e, \"secondary_hand_release\");\n  }\n\n  onCardboardButtonDown(e) {\n    this.isCursorInteracting = this.cursor.startInteraction();\n    if (this.isCursorInteracting) {\n      return;\n    }\n\n    this.cursor.setCursorVisibility(false);\n\n    const gazeTeleport = e.target.querySelector(\"#gaze-teleport\");\n    const button = gazeTeleport.components[\"teleport-controls\"].data.button;\n    gazeTeleport.emit(button + \"down\");\n    this.isTeleporting = true;\n  }\n\n  onCardboardButtonUp(e) {\n    if (this.isCursorInteracting) {\n      this.isCursorInteracting = false;\n      this.cursor.endInteraction();\n      return;\n    }\n\n    this.cursor.setCursorVisibility(true);\n\n    const gazeTeleport = e.target.querySelector(\"#gaze-teleport\");\n    const button = gazeTeleport.components[\"teleport-controls\"].data.button;\n    gazeTeleport.emit(button + \"up\");\n    this.isTeleporting = false;\n  }\n\n  manageCursorEnabled() {\n    const handState = this.handThatAlsoDrivesCursor.components[\"super-hands\"].state;\n    const handHoveredThisFrame = !this.hovered && handState.has(\"hover-start\") && !this.isCursorInteracting;\n    const handStoppedHoveringThisFrame =\n      this.hovered === true && !handState.has(\"hover-start\") && !handState.has(\"grab-start\");\n    if (handHoveredThisFrame) {\n      this.hovered = true;\n      this.cursor.disable();\n    } else if (handStoppedHoveringThisFrame) {\n      this.hovered = false;\n      this.cursor.enable();\n      this.cursor.setCursorVisibility(!this.isTeleporting);\n    }\n  }\n}\n","/* global THREE, CANNON, AFRAME */\nAFRAME.registerComponent(\"sticky-object\", {\n  dependencies: [\"body\"],\n\n  schema: {\n    autoLockOnLoad: { default: false },\n    autoLockOnRelease: { default: false },\n    autoLockSpeedLimit: { default: 0.25 }\n  },\n\n  init() {\n    this._onGrab = this._onGrab.bind(this);\n    this._onRelease = this._onRelease.bind(this);\n    this._onBodyLoaded = this._onBodyLoaded.bind(this);\n  },\n\n  play() {\n    this.el.addEventListener(\"grab-start\", this._onGrab);\n    this.el.addEventListener(\"grab-end\", this._onRelease);\n\n    if (this.hasSetupBodyLoaded) return;\n    this.hasSetupBodyLoaded = true;\n\n    if (this.el.body) {\n      this._onBodyLoaded();\n    } else {\n      this.el.addEventListener(\"body-loaded\", this._onBodyLoaded, { once: true });\n    }\n  },\n\n  pause() {\n    this.el.removeEventListener(\"grab-start\", this._onGrab);\n    this.el.removeEventListener(\"grab-end\", this._onRelease);\n  },\n\n  setLocked(locked) {\n    if (this.el.components.networked && !NAF.utils.isMine(this.el)) return;\n\n    this.locked = locked;\n    this.el.setAttribute(\"body\", { type: locked ? \"static\" : \"dynamic\" });\n  },\n\n  _onBodyLoaded() {\n    if (this.data.autoLockOnLoad) {\n      this.setLocked(true);\n    }\n  },\n\n  _onRelease() {\n    if (\n      !this.el.is(\"grabbed\") &&\n      this.data.autoLockOnRelease &&\n      this.el.body.velocity.lengthSquared() < this.data.autoLockSpeedLimit * this.data.autoLockSpeedLimit\n    ) {\n      this.setLocked(true);\n    }\n  },\n\n  _onGrab() {\n    this.setLocked(false);\n  },\n\n  remove() {\n    this.el.removeEventListener(\"body-loaded\", this._onBodyLoaded);\n    if (this.stuckTo) {\n      const stuckTo = this.stuckTo;\n      delete this.stuckTo;\n      stuckTo._unstickObject();\n    }\n  }\n});\n\nAFRAME.registerComponent(\"sticky-object-zone\", {\n  dependencies: [\"physics\"],\n  init() {\n    // TODO: position/rotation/impulse need to get updated if the sticky-object-zone moves\n    this.worldQuaternion = new THREE.Quaternion();\n    this.worldPosition = new THREE.Vector3();\n    this.el.object3D.getWorldQuaternion(this.worldQuaternion);\n    this.el.object3D.getWorldPosition(this.worldPosition);\n\n    const dir = new THREE.Vector3(0, 0, 5).applyQuaternion(this.el.object3D.quaternion);\n    this.bootImpulsePosition = new CANNON.Vec3(0, 0, 0);\n    this.bootImpulse = new CANNON.Vec3();\n    this.bootImpulse.copy(dir);\n\n    this._onCollisions = this._onCollisions.bind(this);\n    this.el.addEventListener(\"collisions\", this._onCollisions);\n  },\n\n  remove() {\n    this.el.removeEventListener(\"collisions\", this._onCollisions);\n  },\n\n  _onCollisions(e) {\n    e.detail.els.forEach(el => {\n      const stickyObject = el.components[\"sticky-object\"];\n      if (!stickyObject) return;\n      this._setStuckObject(stickyObject);\n    });\n    if (this.stuckObject) {\n      e.detail.clearedEls.forEach(el => {\n        if (this.stuckObject && this.stuckObject.el === el) {\n          this._unstickObject();\n        }\n      });\n    }\n  },\n\n  _setStuckObject(stickyObject) {\n    stickyObject.setLocked(true);\n    stickyObject.el.object3D.position.copy(this.worldPosition);\n    stickyObject.el.object3D.quaternion.copy(this.worldQuaternion);\n    stickyObject.el.body.collisionResponse = false;\n    stickyObject.stuckTo = this;\n\n    if (this.stuckObject && NAF.utils.isMine(this.stuckObject.el)) {\n      const el = this.stuckObject.el;\n      this._unstickObject();\n      el.body.applyImpulse(this.bootImpulse, this.bootImpulsePosition);\n    }\n\n    this.stuckObject = stickyObject;\n  },\n\n  _unstickObject() {\n    // this condition will be false when dragging an object directly from one sticky zone to another\n    if (this.stuckObject.stuckTo === this) {\n      this.stuckObject.setLocked(false);\n      this.stuckObject.el.body.collisionResponse = true;\n      delete this.stuckObject.stuckTo;\n    }\n    delete this.stuckObject;\n  }\n});\n","function almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"auto-scale-cannon-physics-body\", {\n  dependencies: [\"body\"],\n  schema: {\n    equalityEpsilon: { default: 0.001 },\n    debounceDelay: { default: 100 }\n  },\n\n  init() {\n    this.body = this.el.components[\"body\"];\n    this.prevScale = this.el.object3D.scale.clone();\n    this.nextUpdateTime = -1;\n  },\n\n  tick(t) {\n    const scale = this.el.object3D.scale;\n    // Note: This only checks if the LOCAL scale of the object3D changes.\n    if (!almostEquals(this.data.equalityEpsilon, scale, this.prevScale)) {\n      this.prevScale.copy(scale);\n      this.nextUpdateTime = t + this.data.debounceDelay;\n    }\n\n    if (this.nextUpdateTime > 0 && t > this.nextUpdateTime) {\n      this.nextUpdateTime = -1;\n      this.body.updateCannonScale();\n    }\n  }\n});\n","import { getBox } from \"../utils/auto-box-collider.js\";\n\nconst PI = Math.PI;\nconst HALF_PI = PI / 2;\nconst THREE_HALF_PI = 3 * HALF_PI;\nconst right = new THREE.Vector3(1, 0, 0);\nconst forward = new THREE.Vector3(0, 0, 1);\nconst left = new THREE.Vector3(-1, 0, 0);\nconst back = new THREE.Vector3(0, 0, -1);\nconst dirs = {\n  left: {\n    dir: left,\n    rotation: THREE_HALF_PI,\n    halfExtent: \"x\"\n  },\n  right: {\n    dir: right,\n    rotation: HALF_PI,\n    halfExtent: \"x\"\n  },\n  forward: {\n    dir: forward,\n    rotation: 0,\n    halfExtent: \"z\"\n  },\n  back: {\n    dir: back,\n    rotation: PI,\n    halfExtent: \"z\"\n  }\n};\n\nconst inverseHalfExtents = {\n  x: \"z\",\n  z: \"x\"\n};\n\nAFRAME.registerComponent(\"position-at-box-shape-border\", {\n  schema: {\n    target: { type: \"string\" },\n    dirs: { default: [\"left\", \"right\", \"forward\", \"back\"] }\n  },\n\n  init() {\n    this.cam = this.el.sceneEl.camera.el.object3D;\n    this.halfExtents = new THREE.Vector3();\n  },\n\n  update() {\n    this.dirs = this.data.dirs.map(d => dirs[d]);\n  },\n\n  tick: (function() {\n    const camWorldPos = new THREE.Vector3();\n    const targetPosition = new THREE.Vector3();\n    const pointOnBoxFace = new THREE.Vector3();\n    return function() {\n      if (!this.target) {\n        this.target = this.el.querySelector(this.data.target).object3D;\n        if (!this.target) return;\n      }\n      if (!this.el.getObject3D(\"mesh\")) {\n        return;\n      }\n      if (!this.halfExtents || this.mesh !== this.el.getObject3D(\"mesh\") || this.shape !== this.el.components.shape) {\n        this.mesh = this.el.getObject3D(\"mesh\");\n        if (this.el.components.shape) {\n          this.shape = this.el.components.shape;\n          this.halfExtents.copy(this.shape.data.halfExtents);\n        } else {\n          const box = getBox(this.el, this.mesh);\n          this.halfExtents = box.min\n            .clone()\n            .negate()\n            .add(box.max)\n            .multiplyScalar(0.51 / this.el.object3D.scale.x);\n        }\n      }\n      this.cam.getWorldPosition(camWorldPos);\n\n      let minSquareDistance = Infinity;\n      let targetDir = this.dirs[0].dir;\n      let targetHalfExtentStr = this.dirs[0].halfExtent;\n      let targetHalfExtent = this.halfExtents[targetHalfExtentStr];\n      let targetRotation = this.dirs[0].rotation;\n\n      for (let i = 0; i < this.dirs.length; i++) {\n        const dir = this.dirs[i].dir;\n        const halfExtentStr = this.dirs[i].halfExtent;\n        const halfExtent = this.halfExtents[halfExtentStr];\n        pointOnBoxFace.copy(dir).multiplyScalar(halfExtent);\n        this.el.object3D.localToWorld(pointOnBoxFace);\n        const squareDistance = pointOnBoxFace.distanceToSquared(camWorldPos);\n        if (squareDistance < minSquareDistance) {\n          minSquareDistance = squareDistance;\n          targetDir = dir;\n          targetHalfExtent = halfExtent;\n          targetRotation = this.dirs[i].rotation;\n          targetHalfExtentStr = halfExtentStr;\n        }\n      }\n\n      this.target.position.copy(targetPosition.copy(targetDir).multiplyScalar(targetHalfExtent));\n      this.target.rotation.set(0, targetRotation, 0);\n      this.target.scale.setScalar(this.halfExtents[inverseHalfExtents[targetHalfExtentStr]] * 4);\n    };\n  })()\n});\n","AFRAME.registerComponent(\"remove-networked-object-button\", {\n  init() {\n    this.onClick = () => {\n      this.targetEl.parentNode.removeChild(this.targetEl);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.addEventListener(\"click\", this.onClick);\n  },\n\n  pause() {\n    this.el.removeEventListener(\"click\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"destroy-at-extreme-distances\", {\n  schema: {\n    xMin: { default: -1000 },\n    xMax: { default: 1000 },\n    yMin: { default: -1000 },\n    yMax: { default: 1000 },\n    zMin: { default: -1000 },\n    zMax: { default: 1000 }\n  },\n\n  tick: (function() {\n    const pos = new THREE.Vector3();\n    return function() {\n      const { xMin, xMax, yMin, yMax, zMin, zMax } = this.data;\n      this.el.object3D.getWorldPosition(pos);\n      this.el.parentNode === this.el.sceneEl\n        ? pos.copy(this.el.object3D.position)\n        : this.el.object3D.getWorldPosition(pos);\n      if (pos.x < xMin || pos.x > xMax || pos.y < yMin || pos.y > yMax || pos.z < zMin || pos.z > zMax) {\n        this.el.parentNode.removeChild(this.el);\n      }\n    };\n  })()\n});\n","import { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport { resolveMedia, fetchMaxContentIndex } from \"../utils/media-utils\";\n\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport loadingObjectSrc from \"../assets/LoadingObject_Atom.glb\";\nconst gltfLoader = new THREE.GLTFLoader();\nlet loadingObject;\ngltfLoader.load(loadingObjectSrc, gltf => {\n  loadingObject = gltf;\n});\n\nAFRAME.registerComponent(\"media-loader\", {\n  schema: {\n    src: { type: \"string\" },\n    index: { type: \"number\" },\n    resize: { default: false }\n  },\n\n  init() {\n    this.onError = this.onError.bind(this);\n    this.showLoader = this.showLoader.bind(this);\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\n    this.shapeAdded = false;\n    this.hasBakedShapes = false;\n  },\n\n  setShapeAndScale(resize) {\n    const mesh = this.el.getObject3D(\"mesh\");\n    const box = getBox(this.el, mesh);\n    const scaleCoefficient = resize ? getScaleCoefficient(0.5, box) : 1;\n    this.el.object3DMap.mesh.scale.multiplyScalar(scaleCoefficient);\n    if (this.el.body && this.shapeAdded && this.el.body.shapes.length > 1) {\n      this.el.removeAttribute(\"shape\");\n      this.shapeAdded = false;\n    } else if (!this.hasBakedShapes) {\n      const center = new THREE.Vector3();\n      const { min, max } = box;\n      const halfExtents = {\n        x: (Math.abs(min.x - max.x) / 2) * scaleCoefficient,\n        y: (Math.abs(min.y - max.y) / 2) * scaleCoefficient,\n        z: (Math.abs(min.z - max.z) / 2) * scaleCoefficient\n      };\n      center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\n      mesh.position.sub(center);\n      this.el.setAttribute(\"shape\", {\n        shape: \"box\",\n        halfExtents: halfExtents\n      });\n      this.shapeAdded = true;\n    }\n  },\n\n  tick(t, dt) {\n    if (this.loaderMixer) {\n      this.loaderMixer.update(dt / 1000);\n    }\n  },\n\n  onError() {\n    this.el.removeAttribute(\"gltf-model-plus\");\n    this.el.removeAttribute(\"media-pager\");\n    this.el.removeAttribute(\"media-video\");\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\n    clearTimeout(this.showLoaderTimeout);\n    delete this.showLoaderTimeout;\n  },\n\n  showLoader() {\n    const useFancyLoader = !!loadingObject;\n    const mesh = useFancyLoader\n      ? loadingObject.scene.clone()\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\n    if (useFancyLoader) {\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\n      this.loadingClip = this.loaderMixer.clipAction(loadingObject.animations[0]);\n      this.loadingClip.play();\n    }\n    this.el.setObject3D(\"mesh\", mesh);\n    this.hasBakedShapes = !!(this.el.body && this.el.body.shapes.length > 0);\n    this.setShapeAndScale(true);\n    delete this.showLoaderTimeout;\n  },\n\n  clearLoadingTimeout() {\n    clearTimeout(this.showLoaderTimeout);\n    if (this.loaderMixer) {\n      this.loadingClip.stop();\n      delete this.loaderMixer;\n    }\n    delete this.showLoaderTimeout;\n  },\n\n  async update(oldData) {\n    try {\n      const { src, index } = this.data;\n\n      if (src !== oldData.src && !this.showLoaderTimeout) {\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\n      }\n\n      if (!src) return;\n\n      const { raw, origin, images, contentType } = await resolveMedia(src, false, index);\n\n      // We don't want to emit media_resolved for index updates.\n      if (src !== oldData.src) {\n        this.el.emit(\"media_resolved\", { src, raw, origin, contentType });\n      }\n\n      const isPDF = contentType.startsWith(\"application/pdf\");\n      if (contentType.startsWith(\"video/\") || contentType.startsWith(\"audio/\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.addEventListener(\"video-loaded\", this.clearLoadingTimeout, { once: true });\n        this.el.setAttribute(\"media-video\", { src: raw });\n        this.el.setAttribute(\"position-at-box-shape-border\", { dirs: [\"forward\", \"back\"] });\n      } else if (contentType.startsWith(\"image/\") || isPDF) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          async () => {\n            this.clearLoadingTimeout();\n            if (isPDF) {\n              const maxIndex = await fetchMaxContentIndex(src, images.png);\n              this.el.setAttribute(\"media-pager\", { index, maxIndex });\n            }\n          },\n          { once: true }\n        );\n        const imageSrc = isPDF ? images.png : raw;\n        const imageContentType = isPDF ? \"image/png\" : contentType;\n\n        if (!isPDF) {\n          this.el.removeAttribute(\"media-pager\");\n        }\n\n        this.el.setAttribute(\"media-image\", { src: imageSrc, contentType: imageContentType });\n        this.el.setAttribute(\"position-at-box-shape-border\", { dirs: [\"forward\", \"back\"] });\n      } else if (\n        contentType.includes(\"application/octet-stream\") ||\n        contentType.includes(\"x-zip-compressed\") ||\n        contentType.startsWith(\"model/gltf\") ||\n        src.endsWith(\".gltf\") ||\n        src.endsWith(\".glb\")\n      ) {\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"model-loaded\",\n          () => {\n            this.clearLoadingTimeout();\n            this.hasBakedShapes = !!(this.el.body && this.el.body.shapes.length > (this.shapeAdded ? 1 : 0));\n            this.setShapeAndScale(this.data.resize);\n          },\n          { once: true }\n        );\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\n        this.el.setAttribute(\"gltf-model-plus\", {\n          src: raw,\n          contentType: contentType,\n          inflate: true\n        });\n      } else {\n        throw new Error(`Unsupported content type: ${contentType}`);\n      }\n    } catch (e) {\n      console.error(\"Error adding media\", e);\n      this.onError();\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-pager\", {\n  schema: {\n    index: { type: \"string\" },\n    maxIndex: { type: \"string\" }\n  },\n\n  init() {\n    this.onNext = this.onNext.bind(this);\n    this.onPrev = this.onPrev.bind(this);\n\n    const template = document.getElementById(\"paging-toolbar\");\n    this.el.appendChild(document.importNode(template.content, true));\n    this.toolbar = this.el.querySelector(\".paging-toolbar\");\n    // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n    setTimeout(() => {\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\n      this.pageLabel = this.el.querySelector(\".page-label\");\n\n      this.nextButton.addEventListener(\"click\", this.onNext);\n      this.prevButton.addEventListener(\"click\", this.onPrev);\n\n      this.update();\n    }, 0);\n  },\n\n  update() {\n    if (!this.pageLabel) return;\n    this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.data.maxIndex + 1}`);\n    this.repositionToolbar();\n  },\n\n  remove() {\n    this.nextButton.removeEventListener(\"click\", this.onNext);\n    this.prevButton.removeEventListener(\"click\", this.onPrev);\n    this.el.removeChild(this.toolbar);\n  },\n\n  onNext() {\n    this.el.setAttribute(\"media-loader\", \"index\", Math.min(this.data.index + 1, this.data.maxIndex));\n  },\n\n  onPrev() {\n    this.el.setAttribute(\"media-loader\", \"index\", Math.max(this.data.index - 1, 0));\n  },\n\n  repositionToolbar() {\n    this.toolbar.object3D.position.y = -this.el.getAttribute(\"shape\").halfExtents.y - 0.2;\n  }\n});\n","module.exports = __webpack_public_path__ + \"assets/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb\";","AFRAME.registerComponent(\"ambient-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.AmbientLight();\n    this.el.setObject3D(\"ambient-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"ambient-light\");\n  }\n});\n","AFRAME.registerComponent(\"directional-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    castShadow: { default: true }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.DirectionalLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.el.setObject3D(\"directional-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      this.light.castShadow = this.data.castShadow;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"directional-light\");\n  }\n});\n","AFRAME.registerComponent(\"hemisphere-light\", {\n  schema: {\n    skyColor: { type: \"color\" },\n    groundColor: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.HemisphereLight();\n    this.light.position.set(0, 0, 0);\n    this.el.setObject3D(\"hemisphere-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.skyColor !== prevData.skyColor) {\n      this.light.color.set(this.data.skyColor);\n    }\n\n    if (this.data.groundColor !== prevData.groundColor) {\n      this.light.groundColor.set(this.data.groundColor);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"hemisphere-light\");\n  }\n});\n","AFRAME.registerComponent(\"point-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    castShadow: { default: true }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.PointLight();\n    this.light.decay = 2;\n    this.el.setObject3D(\"point-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      this.light.distance = this.data.range;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      this.light.castShadow = this.data.castShadow;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"point-light\");\n  }\n});\n","AFRAME.registerComponent(\"spot-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    innerConeAngle: { default: 0 },\n    outerConeAngle: { default: Math.PI / 4.0 },\n    castShadow: { default: true }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.SpotLight();\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.light.decay = 2;\n    this.el.setObject3D(\"spot-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      this.light.distance = this.data.range;\n    }\n\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\n      this.light.angle = this.data.outerConeAngle;\n      this.light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      this.light.castShadow = this.data.castShadow;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"spot-light\");\n  }\n});\n","/**\n * Toggles the visibility of this entity based on networked ownership\n * @namespace ui\n * @component visible-while-frozen\n */\nAFRAME.registerComponent(\"visible-to-owner\", {\n  init() {\n    this.onStateChange = e => {\n      this.el.setAttribute(\"visible\", e.detail.newOwner === NAF.clientId);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\n      el.addEventListener(\"ownership-changed\", this.onStateChange);\n      this.el.setAttribute(\"visible\", NAF.utils.isMine(el));\n    });\n  }\n});\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { VR_DEVICE_AVAILABILITY } from \"../utils/vr-caps-detect\";\nimport { IntlProvider, FormattedMessage, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\nimport MovingAverage from \"moving-average\";\nimport screenfull from \"screenfull\";\nimport styles from \"../assets/stylesheets/ui-root.scss\";\nimport entryStyles from \"../assets/stylesheets/entry.scss\";\n\nimport { lang, messages } from \"../utils/i18n\";\nimport AutoExitWarning from \"./auto-exit-warning\";\nimport {\n  TwoDEntryButton,\n  DeviceEntryButton,\n  GenericEntryButton,\n  DaydreamEntryButton,\n  SafariEntryButton\n} from \"./entry-buttons.js\";\nimport { ProfileInfoHeader } from \"./profile-info-header.js\";\nimport ProfileEntryPanel from \"./profile-entry-panel\";\nimport InfoDialog from \"./info-dialog.js\";\nimport TwoDHUD from \"./2d-hud\";\nimport { faUsers } from \"@fortawesome/free-solid-svg-icons/faUsers\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faQuestion } from \"@fortawesome/free-solid-svg-icons/faQuestion\";\n\naddLocaleData([...en]);\n\nconst ENTRY_STEPS = {\n  start: \"start\",\n  mic_grant: \"mic_grant\",\n  mic_granted: \"mic_granted\",\n  audio_setup: \"audio_setup\",\n  finished: \"finished\"\n};\n\n// This is a list of regexes that match the microphone labels of HMDs.\n//\n// If entering VR mode, and if any of these regexes match an audio device,\n// the user will be prevented from entering VR until one of those devices is\n// selected as the microphone.\n//\n// Note that this doesn't have to be exhaustive: if no devices match any regex\n// then we rely upon the user to select the proper mic.\nconst HMD_MIC_REGEXES = [/\\Wvive\\W/i, /\\Wrift\\W/i];\n\nasync function grantedMicLabels() {\n  const mediaDevices = await navigator.mediaDevices.enumerateDevices();\n  return mediaDevices.filter(d => d.label && d.kind === \"audioinput\").map(d => d.label);\n}\n\nconst AUTO_EXIT_TIMER_SECONDS = 10;\n\nclass UIRoot extends Component {\n  static propTypes = {\n    enterScene: PropTypes.func,\n    exitScene: PropTypes.func,\n    concurrentLoadDetector: PropTypes.object,\n    disableAutoExitOnConcurrentLoad: PropTypes.bool,\n    forcedVREntryType: PropTypes.string,\n    enableScreenSharing: PropTypes.bool,\n    isBotMode: PropTypes.bool,\n    store: PropTypes.object,\n    scene: PropTypes.object,\n    linkChannel: PropTypes.object,\n    showProfileEntry: PropTypes.bool,\n    availableVREntryTypes: PropTypes.object,\n    initialEnvironmentLoaded: PropTypes.bool,\n    roomUnavailableReason: PropTypes.string,\n    platformUnsupportedReason: PropTypes.string,\n    hubId: PropTypes.string,\n    hubName: PropTypes.string,\n    occupantCount: PropTypes.number\n  };\n\n  state = {\n    entryStep: ENTRY_STEPS.start,\n    enterInVR: false,\n    infoDialogType: null,\n    linkCode: null,\n    linkCodeCancel: null,\n\n    shareScreen: false,\n    requestedScreen: false,\n    mediaStream: null,\n    videoTrack: null,\n    audioTrack: null,\n\n    toneInterval: null,\n    tonePlaying: false,\n\n    micLevel: 0,\n    micDevices: [],\n    micUpdateInterval: null,\n\n    profileNamePending: \"Hello\",\n\n    autoExitTimerStartedAt: null,\n    autoExitTimerInterval: null,\n    secondsRemainingBeforeAutoExit: Infinity,\n\n    muted: false,\n    frozen: false,\n    spacebubble: true,\n\n    exited: false,\n\n    showProfileEntry: false\n  };\n\n  constructor(props) {\n    super(props);\n    this.state.showProfileEntry = this.props.showProfileEntry;\n  }\n\n  componentDidMount() {\n    this.props.concurrentLoadDetector.addEventListener(\"concurrentload\", this.onConcurrentLoad);\n    this.micLevelMovingAverage = MovingAverage(100);\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.addEventListener(\"stateadded\", this.onAframeStateChanged);\n    this.props.scene.addEventListener(\"stateremoved\", this.onAframeStateChanged);\n    this.props.scene.addEventListener(\"exit\", this.exit);\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.removeEventListener(\"exit\", this.exit);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.availableVREntryTypes && prevProps.availableVREntryTypes !== this.props.availableVREntryTypes) {\n      this.handleForcedVREntryType();\n    }\n  }\n\n  onSceneLoaded = () => {\n    this.setState({ sceneLoaded: true });\n  };\n\n  // TODO: we need to come up with a cleaner way to handle the shared state between aframe and react than emmitting events and setting state on the scene\n  onAframeStateChanged = e => {\n    if (!(e.detail === \"muted\" || e.detail === \"frozen\" || e.detail === \"spacebubble\")) return;\n    this.setState({\n      [e.detail]: this.props.scene.is(e.detail)\n    });\n  };\n\n  toggleMute = () => {\n    this.props.scene.emit(\"action_mute\");\n  };\n\n  toggleFreeze = () => {\n    this.props.scene.emit(\"action_freeze\");\n  };\n\n  toggleSpaceBubble = () => {\n    this.props.scene.emit(\"action_space_bubble\");\n  };\n\n  spawnPen = () => {\n    this.props.scene.emit(\"spawn_pen\");\n  };\n\n  handleForcedVREntryType = () => {\n    if (!this.props.forcedVREntryType) return;\n\n    if (this.props.forcedVREntryType.startsWith(\"daydream\")) {\n      this.enterDaydream();\n    } else if (this.props.forcedVREntryType.startsWith(\"vr\")) {\n      this.enterVR();\n    } else if (this.props.forcedVREntryType.startsWith(\"2d\")) {\n      this.enter2D();\n    }\n  };\n\n  playTestTone = () => {\n    const toneClip = document.querySelector(\"#test-tone\");\n    toneClip.currentTime = 0;\n    toneClip.play();\n    clearTimeout(this.testToneTimeout);\n    this.setState({ tonePlaying: true });\n    const toneLength = 1393;\n    this.testToneTimeout = setTimeout(() => {\n      this.setState({ tonePlaying: false });\n    }, toneLength);\n  };\n\n  stopTestTone = () => {\n    const toneClip = document.querySelector(\"#test-tone\");\n    toneClip.pause();\n    toneClip.currentTime = 0;\n    this.setState({ tonePlaying: false });\n  };\n\n  onConcurrentLoad = () => {\n    if (this.props.disableAutoExitOnConcurrentLoad) return;\n\n    const autoExitTimerInterval = setInterval(() => {\n      let secondsRemainingBeforeAutoExit = Infinity;\n\n      if (this.state.autoExitTimerStartedAt) {\n        const secondsSinceStart = (new Date() - this.state.autoExitTimerStartedAt) / 1000;\n        secondsRemainingBeforeAutoExit = Math.max(0, Math.floor(AUTO_EXIT_TIMER_SECONDS - secondsSinceStart));\n      }\n\n      this.setState({ secondsRemainingBeforeAutoExit });\n      this.checkForAutoExit();\n    }, 500);\n\n    this.setState({ autoExitTimerStartedAt: new Date(), autoExitTimerInterval });\n  };\n\n  checkForAutoExit = () => {\n    if (this.state.secondsRemainingBeforeAutoExit !== 0) return;\n    this.endAutoExitTimer();\n    this.exit();\n  };\n\n  exit = () => {\n    this.props.exitScene();\n    this.setState({ exited: true });\n  };\n\n  isWaitingForAutoExit = () => {\n    return this.state.secondsRemainingBeforeAutoExit <= AUTO_EXIT_TIMER_SECONDS;\n  };\n\n  endAutoExitTimer = () => {\n    clearInterval(this.state.autoExitTimerInterval);\n    this.setState({\n      autoExitTimerStartedAt: null,\n      autoExitTimerInterval: null,\n      secondsRemainingBeforeAutoExit: Infinity\n    });\n  };\n\n  hasGrantedMicPermissions = async () => {\n    if (this.state.requestedScreen) {\n      // There is no way to tell if you've granted mic permissions in a previous session if we've\n      // already prompted for screen sharing permissions, so we have to assume that we've never granted permissions.\n      // Fortunately, if you *have* granted permissions permanently, there won't be a second browser prompt, but we\n      // can't determine that before hand.\n      // See https://bugzilla.mozilla.org/show_bug.cgi?id=1449783 for a potential solution in the future.\n      return false;\n    } else {\n      // If we haven't requested the screen in this session, check if we've granted permissions in a previous session.\n      return (await grantedMicLabels()).length > 0;\n    }\n  };\n\n  performDirectEntryFlow = async enterInVR => {\n    this.setState({ enterInVR });\n\n    const hasGrantedMic = await this.hasGrantedMicPermissions();\n\n    if (hasGrantedMic) {\n      await this.setMediaStreamToDefault();\n      this.beginOrSkipAudioSetup();\n    } else {\n      this.setState({ entryStep: ENTRY_STEPS.mic_grant });\n    }\n  };\n\n  enter2D = async () => {\n    await this.performDirectEntryFlow(false);\n  };\n\n  linkSafari = async () => {\n    this.setState({ infoDialogType: InfoDialog.dialogTypes.safari });\n  };\n\n  enterVR = async () => {\n    if (this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.maybe) {\n      await this.performDirectEntryFlow(true);\n    } else {\n      this.setState({ infoDialogType: InfoDialog.dialogTypes.webvr_recommend });\n    }\n  };\n\n  enterDaydream = async () => {\n    if (this.props.availableVREntryTypes.daydream == VR_DEVICE_AVAILABILITY.maybe) {\n      this.exit();\n\n      // We are not in mobile chrome, so launch into chrome via an Intent URL\n      const location = window.location;\n      const qs = new URLSearchParams(location.search);\n      qs.set(\"vr_entry_type\", \"daydream\"); // Auto-choose 'daydream' after landing in chrome\n\n      const intentUrl =\n        `intent://${location.host}${location.pathname}?` +\n        `${qs}#Intent;scheme=${location.protocol.replace(\":\", \"\")};` +\n        `action=android.intent.action.VIEW;package=com.android.chrome;end;`;\n\n      window.location = intentUrl;\n    } else {\n      await this.performDirectEntryFlow(true);\n    }\n  };\n\n  micDeviceChanged = async ev => {\n    const constraints = { audio: { deviceId: { exact: [ev.target.value] } } };\n    await this.fetchAudioTrack(constraints);\n    await this.setupNewMediaStream();\n  };\n\n  setMediaStreamToDefault = async () => {\n    let hasAudio = false;\n    const { lastUsedMicDeviceId } = this.props.store.state.settings;\n\n    // Try to fetch last used mic, if there was one.\n    if (lastUsedMicDeviceId) {\n      hasAudio = await this.fetchAudioTrack({ audio: { deviceId: { ideal: lastUsedMicDeviceId } } });\n    } else {\n      hasAudio = await this.fetchAudioTrack({ audio: true });\n    }\n\n    await this.setupNewMediaStream();\n\n    return { hasAudio };\n  };\n\n  setStateAndRequestScreen = async e => {\n    const checked = e.target.checked;\n    await this.setState({ requestedScreen: true, shareScreen: checked });\n    if (checked) {\n      this.fetchVideoTrack({\n        video: {\n          mediaSource: \"screen\",\n          // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n          // other than your current monitor that has a different aspect ratio.\n          width: 720 * (screen.width / screen.height),\n          height: 720,\n          frameRate: 30\n        }\n      });\n    } else {\n      this.setState({ videoTrack: null });\n    }\n  };\n\n  fetchVideoTrack = async constraints => {\n    const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\n    this.setState({ videoTrack: mediaStream.getVideoTracks()[0] });\n  };\n\n  fetchAudioTrack = async constraints => {\n    if (this.state.audioTrack) {\n      this.state.audioTrack.stop();\n    }\n\n    try {\n      const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\n      this.setState({ audioTrack: mediaStream.getAudioTracks()[0] });\n      return true;\n    } catch (e) {\n      // Error fetching audio track, most likely a permission denial.\n      this.setState({ audioTrack: null });\n      return false;\n    }\n  };\n\n  setupNewMediaStream = async () => {\n    const mediaStream = new MediaStream();\n\n    await this.fetchMicDevices();\n\n    if (this.state.videoTrack) {\n      mediaStream.addTrack(this.state.videoTrack);\n    }\n\n    // we should definitely have an audioTrack at this point unless they denied mic access\n    if (this.state.audioTrack) {\n      mediaStream.addTrack(this.state.audioTrack);\n\n      const AudioContext = window.AudioContext || window.webkitAudioContext;\n      const micLevelAudioContext = new AudioContext();\n      const micSource = micLevelAudioContext.createMediaStreamSource(mediaStream);\n      const analyser = micLevelAudioContext.createAnalyser();\n      analyser.fftSize = 32;\n      const levels = new Uint8Array(analyser.frequencyBinCount);\n\n      micSource.connect(analyser);\n\n      const micUpdateInterval = setInterval(() => {\n        analyser.getByteTimeDomainData(levels);\n        let v = 0;\n        for (let x = 0; x < levels.length; x++) {\n          v = Math.max(levels[x] - 128, v);\n        }\n        const level = v / 128.0;\n        // Multiplier to increase visual indicator.\n        const multiplier = 6;\n        // We use a moving average to smooth out the visual animation or else it would twitch too fast for\n        // the css renderer to keep up.\n        this.micLevelMovingAverage.push(Date.now(), level * multiplier);\n        const average = this.micLevelMovingAverage.movingAverage();\n        this.setState(state => {\n          if (Math.abs(average - state.micLevel) > 0.0001) {\n            return { micLevel: average };\n          }\n        });\n      }, 50);\n\n      const micDeviceId = this.micDeviceIdForMicLabel(this.micLabelForMediaStream(mediaStream));\n\n      if (micDeviceId) {\n        this.props.store.update({ settings: { lastUsedMicDeviceId: micDeviceId } });\n      }\n\n      this.setState({ micLevelAudioContext, micUpdateInterval });\n    }\n\n    this.setState({ mediaStream });\n  };\n\n  onMicGrantButton = async () => {\n    if (this.state.entryStep == ENTRY_STEPS.mic_grant) {\n      const { hasAudio } = await this.setMediaStreamToDefault();\n\n      if (hasAudio) {\n        this.setState({ entryStep: ENTRY_STEPS.mic_granted });\n      } else {\n        this.beginOrSkipAudioSetup();\n      }\n    } else {\n      this.beginOrSkipAudioSetup();\n    }\n  };\n\n  onProfileFinished = () => {\n    this.setState({ showProfileEntry: false });\n  };\n\n  beginOrSkipAudioSetup = () => {\n    if (!this.props.forcedVREntryType || !this.props.forcedVREntryType.endsWith(\"_now\")) {\n      this.setState({ entryStep: ENTRY_STEPS.audio_setup });\n    } else {\n      setTimeout(this.onAudioReadyButton, 3000); // Need to wait otherwise input doesn't work :/\n    }\n  };\n\n  fetchMicDevices = () => {\n    return new Promise(resolve => {\n      navigator.mediaDevices.enumerateDevices().then(mediaDevices => {\n        this.setState(\n          {\n            micDevices: mediaDevices\n              .filter(d => d.kind === \"audioinput\")\n              .map(d => ({ deviceId: d.deviceId, label: d.label }))\n          },\n          resolve\n        );\n      });\n    });\n  };\n\n  shouldShowHmdMicWarning = () => {\n    if (AFRAME.utils.device.isMobile()) return false;\n    if (!this.state.enterInVR) return false;\n    if (!this.hasHmdMicrophone()) return false;\n\n    return !HMD_MIC_REGEXES.find(r => this.selectedMicLabel().match(r));\n  };\n\n  hasHmdMicrophone = () => {\n    return !!this.state.micDevices.find(d => HMD_MIC_REGEXES.find(r => d.label.match(r)));\n  };\n\n  micLabelForMediaStream = mediaStream => {\n    return (mediaStream && mediaStream.getAudioTracks().length > 0 && mediaStream.getAudioTracks()[0].label) || \"\";\n  };\n\n  selectedMicLabel = () => {\n    return this.micLabelForMediaStream(this.state.mediaStream);\n  };\n\n  micDeviceIdForMicLabel = label => {\n    return this.state.micDevices.filter(d => d.label === label).map(d => d.deviceId)[0];\n  };\n\n  selectedMicDeviceId = () => {\n    return this.micDeviceIdForMicLabel(this.selectedMicLabel());\n  };\n\n  onAudioReadyButton = () => {\n    if (AFRAME.utils.device.isMobile() && !this.state.enterInVR && screenfull.enabled) {\n      screenfull.request();\n    }\n\n    this.props.enterScene(this.state.mediaStream, this.state.enterInVR, this.props.hubId);\n\n    const mediaStream = this.state.mediaStream;\n\n    if (mediaStream) {\n      if (mediaStream.getAudioTracks().length > 0) {\n        console.log(`Using microphone: ${mediaStream.getAudioTracks()[0].label}`);\n      }\n\n      if (mediaStream.getVideoTracks().length > 0) {\n        console.log(\"Screen sharing enabled.\");\n      }\n    }\n\n    this.stopTestTone();\n    clearTimeout(this.testToneTimeout);\n\n    if (this.state.micLevelAudioContext) {\n      this.state.micLevelAudioContext.close();\n      clearInterval(this.state.micUpdateInterval);\n    }\n\n    this.setState({ entryStep: ENTRY_STEPS.finished });\n  };\n\n  attemptLink = async () => {\n    this.setState({ infoDialogType: InfoDialog.dialogTypes.link });\n    const { code, cancel, onFinished } = await this.props.linkChannel.generateCode();\n    this.setState({ linkCode: code, linkCodeCancel: cancel });\n    onFinished.then(this.handleCloseDialog);\n  };\n\n  handleCloseDialog = async () => {\n    if (this.state.linkCodeCancel) {\n      this.state.linkCodeCancel();\n    }\n\n    this.setState({ infoDialogType: null, linkCode: null, linkCodeCancel: null });\n  };\n\n  handleCreateObject = media => {\n    this.props.scene.emit(\"add_media\", media);\n  };\n\n  render() {\n    if (this.state.exited || this.props.roomUnavailableReason || this.props.platformUnsupportedReason) {\n      let subtitle = null;\n      if (this.props.roomUnavailableReason === \"closed\") {\n        // TODO i18n, due to links and markup\n        subtitle = (\n          <div>\n            Sorry, this room is no longer available.\n            <p />\n            A room may be closed if we receive reports that it violates our{\" \"}\n            <a target=\"_blank\" rel=\"noreferrer noopener\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n              Terms of Use\n            </a>.\n            <br />\n            If you have questions, contact us at <a href=\"mailto:hubs@mozilla.com\">hubs@mozilla.com</a>.\n            <p />\n            If you&apos;d like to run your own server, hubs&apos;s source code is available on{\" \"}\n            <a href=\"https://github.com/mozilla/hubs\">GitHub</a>.\n          </div>\n        );\n      } else if (this.props.platformUnsupportedReason === \"no_data_channels\") {\n        // TODO i18n, due to links and markup\n        subtitle = (\n          <div>\n            Your browser does not support{\" \"}\n            <a\n              href=\"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createDataChannel#Browser_compatibility\"\n              rel=\"noreferrer noopener\"\n            >\n              WebRTC Data Channels\n            </a>, which is required to use Hubs.<br />If you&quot;d like to use Hubs with Oculus or SteamVR, you can{\" \"}\n            <a href=\"https://www.mozilla.org/firefox\" rel=\"noreferrer noopener\">\n              Download Firefox\n            </a>.\n          </div>\n        );\n      } else {\n        const reason = this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\n        const exitSubtitleId = `exit.subtitle.${this.state.exited ? \"exited\" : reason}`;\n        subtitle = (\n          <div>\n            <FormattedMessage id={exitSubtitleId} />\n            <p />\n            {this.props.roomUnavailableReason && (\n              <div>\n                You can also <a href=\"/\">create a new room</a>.\n              </div>\n            )}\n          </div>\n        );\n      }\n\n      return (\n        <IntlProvider locale={lang} messages={messages}>\n          <div className=\"exited-panel\">\n            <img className=\"exited-panel__logo\" src=\"../assets/images/logo.svg\" />\n            <div className=\"exited-panel__subtitle\">{subtitle}</div>\n          </div>\n        </IntlProvider>\n      );\n    }\n\n    if (this.props.isBotMode) {\n      return (\n        <div className=\"loading-panel\">\n          <img className=\"loading-panel__logo\" src=\"../assets/images/logo.svg\" />\n          <input type=\"file\" id=\"bot-audio-input\" accept=\"audio/*\" />\n          <input type=\"file\" id=\"bot-data-input\" accept=\"application/json\" />\n        </div>\n      );\n    }\n\n    if (!this.props.initialEnvironmentLoaded || !this.props.availableVREntryTypes || !this.props.hubId) {\n      return (\n        <IntlProvider locale={lang} messages={messages}>\n          <div className=\"loading-panel\">\n            <div className=\"loader-wrap\">\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n\n            <img className=\"loading-panel__logo\" src=\"../assets/images/logo.svg\" />\n          </div>\n        </IntlProvider>\n      );\n    }\n\n    // Only show this in desktop firefox since other browsers/platforms will ignore the \"screen\" media constraint and\n    // will attempt to share your webcam instead!\n    const screenSharingCheckbox = this.props.enableScreenSharing &&\n      !AFRAME.utils.device.isMobile() &&\n      /firefox/i.test(navigator.userAgent) && (\n        <label className={entryStyles.screenSharing}>\n          <input\n            className={entryStyles.checkbox}\n            type=\"checkbox\"\n            value={this.state.shareScreen}\n            onChange={this.setStateAndRequestScreen}\n          />\n          <FormattedMessage id=\"entry.enable-screen-sharing\" />\n        </label>\n      );\n\n    const entryPanel =\n      this.state.entryStep === ENTRY_STEPS.start ? (\n        <div className={entryStyles.entryPanel}>\n          <div className={entryStyles.buttonContainer}>\n            {false /* TODO */ && (\n              <div className={entryStyles.presenceInfo}>\n                <span className={entryStyles.people}>2 people</span> have joined\n              </div>\n            )}\n            {this.props.availableVREntryTypes.screen === VR_DEVICE_AVAILABILITY.yes && (\n              <TwoDEntryButton onClick={this.enter2D} />\n            )}\n            {this.props.availableVREntryTypes.safari === VR_DEVICE_AVAILABILITY.maybe && (\n              <SafariEntryButton onClick={this.linkSafari} />\n            )}\n            {this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no && (\n              <GenericEntryButton onClick={this.enterVR} />\n            )}\n            {this.props.availableVREntryTypes.daydream !== VR_DEVICE_AVAILABILITY.no && (\n              <DaydreamEntryButton\n                onClick={this.enterDaydream}\n                subtitle={\n                  this.props.availableVREntryTypes.daydream == VR_DEVICE_AVAILABILITY.maybe\n                    ? \"entry.daydream-via-chrome\"\n                    : null\n                }\n              />\n            )}\n            <DeviceEntryButton onClick={this.attemptLink} isInHMD={this.props.availableVREntryTypes.isInHMD} />\n            {this.props.availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no && (\n              <div className={entryStyles.secondary} onClick={this.enterVR}>\n                <FormattedMessage id=\"entry.cardboard\" />\n              </div>\n            )}\n            {screenSharingCheckbox}\n            <button\n              className={entryStyles.inviteButton}\n              onClick={() => this.setState({ infoDialogType: InfoDialog.dialogTypes.invite })}\n            >\n              <FormattedMessage id=\"entry.invite-others\" />\n            </button>\n          </div>\n        </div>\n      ) : null;\n\n    const micPanel =\n      this.state.entryStep === ENTRY_STEPS.mic_grant || this.state.entryStep === ENTRY_STEPS.mic_granted ? (\n        <div className=\"mic-grant-panel\">\n          <div className=\"mic-grant-panel__grant-container\">\n            <div className=\"mic-grant-panel__title\">\n              <FormattedMessage\n                id={this.state.entryStep == ENTRY_STEPS.mic_grant ? \"audio.grant-title\" : \"audio.granted-title\"}\n              />\n            </div>\n            <div className=\"mic-grant-panel__subtitle\">\n              <FormattedMessage\n                id={this.state.entryStep == ENTRY_STEPS.mic_grant ? \"audio.grant-subtitle\" : \"audio.granted-subtitle\"}\n              />\n            </div>\n            <div className=\"mic-grant-panel__button-container\">\n              {this.state.entryStep == ENTRY_STEPS.mic_grant ? (\n                <button className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\n                  <img src=\"../assets/images/mic_denied.png\" srcSet=\"../assets/images/mic_denied@2x.png 2x\" />\n                </button>\n              ) : (\n                <button className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\n                  <img src=\"../assets/images/mic_granted.png\" srcSet=\"../assets/images/mic_granted@2x.png 2x\" />\n                </button>\n              )}\n            </div>\n          </div>\n          <div className=\"mic-grant-panel__next-container\">\n            <button className={classNames(\"mic-grant-panel__next\")} onClick={this.onMicGrantButton}>\n              <FormattedMessage id=\"audio.granted-next\" />\n            </button>\n          </div>\n        </div>\n      ) : null;\n\n    const maxLevelHeight = 111;\n    const micClip = {\n      clip: `rect(${maxLevelHeight - Math.floor(this.state.micLevel * maxLevelHeight)}px, 111px, 111px, 0px)`\n    };\n    const speakerClip = { clip: `rect(${this.state.tonePlaying ? 0 : maxLevelHeight}px, 111px, 111px, 0px)` };\n    const subtitleId = AFRAME.utils.device.isMobile() ? \"audio.subtitle-mobile\" : \"audio.subtitle-desktop\";\n    const audioSetupPanel =\n      this.state.entryStep === ENTRY_STEPS.audio_setup ? (\n        <div className=\"audio-setup-panel\">\n          <div>\n            <div className=\"audio-setup-panel__title\">\n              <FormattedMessage id=\"audio.title\" />\n            </div>\n            <div className=\"audio-setup-panel__subtitle\">\n              {(AFRAME.utils.device.isMobile() || this.state.enterInVR) && <FormattedMessage id={subtitleId} />}\n            </div>\n            <div className=\"audio-setup-panel__levels\">\n              <div className=\"audio-setup-panel__levels__icon\">\n                <img\n                  src=\"../assets/images/level_background.png\"\n                  srcSet=\"../assets/images/level_background@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                />\n                <img\n                  src=\"../assets/images/level_fill.png\"\n                  srcSet=\"../assets/images/level_fill@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                  style={micClip}\n                />\n                {this.state.audioTrack ? (\n                  <img\n                    src=\"../assets/images/mic_level.png\"\n                    srcSet=\"../assets/images/mic_level@2x.png 2x\"\n                    className=\"audio-setup-panel__levels__icon-part\"\n                  />\n                ) : (\n                  <img\n                    src=\"../assets/images/mic_denied.png\"\n                    srcSet=\"../assets/images/mic_denied@2x.png 2x\"\n                    className=\"audio-setup-panel__levels__icon-part\"\n                  />\n                )}\n              </div>\n              <div className=\"audio-setup-panel__levels__icon\" onClick={this.playTestTone}>\n                <img\n                  src=\"../assets/images/level_background.png\"\n                  srcSet=\"../assets/images/level_background@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                />\n                <img\n                  src=\"../assets/images/level_fill.png\"\n                  srcSet=\"../assets/images/level_fill@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                  style={speakerClip}\n                />\n                <img\n                  src=\"../assets/images/speaker_level.png\"\n                  srcSet=\"../assets/images/speaker_level@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                />\n              </div>\n            </div>\n            {this.state.audioTrack && (\n              <div className=\"audio-setup-panel__device-chooser\">\n                <select\n                  className=\"audio-setup-panel__device-chooser__dropdown\"\n                  value={this.selectedMicDeviceId()}\n                  onChange={this.micDeviceChanged}\n                >\n                  {this.state.micDevices.map(d => (\n                    <option key={d.deviceId} value={d.deviceId}>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{d.label}\n                    </option>\n                  ))}\n                </select>\n                <img\n                  className=\"audio-setup-panel__device-chooser__mic-icon\"\n                  src=\"../assets/images/mic_small.png\"\n                  srcSet=\"../assets/images/mic_small@2x.png 2x\"\n                />\n                <img\n                  className=\"audio-setup-panel__device-chooser__dropdown-arrow\"\n                  src=\"../assets/images/dropdown_arrow.png\"\n                  srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\n                />\n              </div>\n            )}\n            {this.shouldShowHmdMicWarning() && (\n              <div className=\"audio-setup-panel__hmd-mic-warning\">\n                <img\n                  src=\"../assets/images/warning_icon.png\"\n                  srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n                  className=\"audio-setup-panel__hmd-mic-warning__icon\"\n                />\n                <span className=\"audio-setup-panel__hmd-mic-warning__label\">\n                  <FormattedMessage id=\"audio.hmd-mic-warning\" />\n                </span>\n              </div>\n            )}\n          </div>\n          <div className=\"audio-setup-panel__enter-button-container\">\n            <button className=\"audio-setup-panel__enter-button\" onClick={this.onAudioReadyButton}>\n              <FormattedMessage id=\"audio.enter-now\" />\n            </button>\n          </div>\n        </div>\n      ) : null;\n\n    const dialogContents = this.isWaitingForAutoExit() ? (\n      <AutoExitWarning secondsRemaining={this.state.secondsRemainingBeforeAutoExit} onCancel={this.endAutoExitTimer} />\n    ) : (\n      <div className={entryStyles.entryDialog}>\n        <ProfileInfoHeader\n          name={this.props.store.state.profile.displayName}\n          onClickName={() => this.setState({ showProfileEntry: true })}\n          onClickHelp={() => this.setState({ infoDialogType: InfoDialog.dialogTypes.help })}\n        />\n        {entryPanel}\n        {micPanel}\n        {audioSetupPanel}\n      </div>\n    );\n\n    const dialogBoxClassNames = classNames({ \"ui-interactive\": !this.state.infoDialogType, \"ui-dialog-box\": true });\n\n    const dialogBoxContentsClassNames = classNames({\n      \"ui-dialog-box-contents\": true,\n      \"ui-dialog-box-contents--backgrounded\": this.state.showProfileEntry\n    });\n\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className=\"ui\">\n          <InfoDialog\n            dialogType={this.state.infoDialogType}\n            linkCode={this.state.linkCode}\n            onSubmittedEmail={() => this.setState({ infoDialogType: InfoDialog.dialogTypes.email_submitted })}\n            onCloseDialog={this.handleCloseDialog}\n            onCreateObject={this.handleCreateObject}\n          />\n\n          {this.state.entryStep === ENTRY_STEPS.finished && (\n            <button\n              onClick={() => this.setState({ infoDialogType: InfoDialog.dialogTypes.help })}\n              className=\"ui__help-icon\"\n            >\n              <i className=\"ui__help-icon__icon\">\n                <FontAwesomeIcon icon={faQuestion} />\n              </i>\n            </button>\n          )}\n\n          {this.state.entryStep === ENTRY_STEPS.finished && (\n            <div className={styles.presenceInfo}>\n              <FontAwesomeIcon icon={faUsers} />\n              <span className={styles.occupantCount}>{this.props.occupantCount || \"-\"}</span>\n            </div>\n          )}\n\n          <div className=\"ui-dialog\">\n            {(this.state.entryStep !== ENTRY_STEPS.finished || this.isWaitingForAutoExit()) && (\n              <div className={dialogBoxClassNames}>\n                <div className={dialogBoxContentsClassNames}>{dialogContents}</div>\n\n                {this.state.showProfileEntry && (\n                  <ProfileEntryPanel finished={this.onProfileFinished} store={this.props.store} />\n                )}\n              </div>\n            )}\n          </div>\n          {this.state.entryStep === ENTRY_STEPS.finished ? (\n            <div>\n              <TwoDHUD.TopHUD\n                muted={this.state.muted}\n                frozen={this.state.frozen}\n                spacebubble={this.state.spacebubble}\n                onToggleMute={this.toggleMute}\n                onToggleFreeze={this.toggleFreeze}\n                onToggleSpaceBubble={this.toggleSpaceBubble}\n                onSpawnPen={this.spawnPen}\n              />\n              {!this.props.availableVREntryTypes.isInHMD &&\n                this.props.occupantCount <= 1 && (\n                  <div className={styles.nagButton}>\n                    <button onClick={() => this.setState({ infoDialogType: InfoDialog.dialogTypes.invite })}>\n                      <FormattedMessage id=\"entry.invite-others-nag\" />\n                    </button>\n                  </div>\n                )}\n              {this.props.availableVREntryTypes.isInHMD && (\n                <div className={styles.nagButton}>\n                  <button onClick={() => this.props.scene.enterVR()}>\n                    <FormattedMessage id=\"entry.return-to-vr\" />\n                  </button>\n                </div>\n              )}\n              <TwoDHUD.BottomHUD\n                onCreateObject={() => this.setState({ infoDialogType: InfoDialog.dialogTypes.create_object })}\n                showPhotoPicker={AFRAME.utils.device.isMobile()}\n                onMediaPicked={this.handleCreateObject}\n              />\n            </div>\n          ) : null}\n        </div>\n      </IntlProvider>\n    );\n  }\n}\n\nexport default UIRoot;\n","module.exports = __webpack_public_path__ + \"assets/images/mic_denied-6f265ac615c120127ea96a42e622cabc.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_denied@2x-7b31e5ffc307062fc2c609a33d918b9d.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted-6a5d269f341348577b687a24aeea12f2.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted@2x-1a2a0c515fdcfdd6ce5ee6be6f17d64f.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_background-009d04c7e0ca03ce73c117b3e469ac49.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_background@2x-8f7d48a15bfad5d8f61a146eb7ad5945.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_fill-338fe47928b89e96b82cc651023d0dfd.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_fill@2x-dc5ec005319ba99f27e4011db035292e.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level-65069cdb2a680e44a7888ee019abee23.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level@2x-921d16c1ae1419c3df154ffb44166839.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level-c9f33814b00c63cd9d8b7676f262ac6d.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level@2x-bf22116041d89f49b1b3bcf7ade958da.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small-48ba900577e5d1e9dacab139ef787103.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small@2x-48ba900577e5d1e9dacab139ef787103.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow-427fb8d451998f4eec0ad543165f2a91.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow@2x-c16ca622a5bd77aec0faa2761ab8dcd6.png\";","module.exports = __webpack_public_path__ + \"assets/images/warning_icon-6763c155fea2391899e9e5faa44d5f4d.png\";","module.exports = __webpack_public_path__ + \"assets/images/warning_icon@2x-a585508ac0c8b1fbfed0bc762c628830.png\";","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nconst AutoExitWarning = props => (\n  <div className=\"autoexit-panel\">\n    <div className=\"autoexit-panel__title\">\n      <FormattedMessage id=\"autoexit.title\" />\n      <span>{props.secondsRemaining}</span>\n      <FormattedMessage id=\"autoexit.title_units\" />\n    </div>\n    <div className=\"autoexit-panel__subtitle\">\n      <FormattedMessage id=\"autoexit.subtitle\" />\n    </div>\n    <div className=\"autoexit-panel__cancel-button\" onClick={props.onCancel}>\n      <FormattedMessage id=\"autoexit.cancel\" />\n    </div>\n  </div>\n);\n\nAutoExitWarning.propTypes = {\n  secondsRemaining: PropTypes.number,\n  onCancel: PropTypes.func\n};\n\nexport default AutoExitWarning;\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nimport MobileScreenEntryImg from \"../assets/images/mobile_screen_entry.svg\";\nimport DesktopScreenEntryImg from \"../assets/images/desktop_screen_entry.svg\";\nimport GenericVREntryImg from \"../assets/images/generic_vr_entry.svg\";\nimport GearVREntryImg from \"../assets/images/gearvr_entry.svg\";\nimport DaydreamEntryImg from \"../assets/images/daydream_entry.svg\";\nimport DeviceEntryImg from \"../assets/images/device_entry.svg\";\nimport styles from \"../assets/stylesheets/entry.scss\";\n\nconst EntryButton = props => (\n  <button className={styles.entryButton} onClick={props.onClick}>\n    <img src={props.iconSrc} className={styles.icon} />\n    <div className={styles.label}>\n      <div className={styles.contents}>\n        <span>\n          <FormattedMessage id={props.prefixMessageId} />\n        </span>\n        <span className={styles.bolded}>\n          <FormattedMessage id={props.mediumMessageId} />\n        </span>\n        {props.subtitle && (\n          <div className={styles.subtitle}>\n            <FormattedMessage id={props.subtitle} />\n          </div>\n        )}\n      </div>\n    </div>\n  </button>\n);\n\nEntryButton.propTypes = {\n  onClick: PropTypes.func,\n  iconSrc: PropTypes.string,\n  prefixMessageId: PropTypes.string,\n  mediumMessageId: PropTypes.string,\n  subtitle: PropTypes.string,\n  isInHMD: PropTypes.bool\n};\n\nexport const TwoDEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: AFRAME.utils.device.isMobile() ? MobileScreenEntryImg : DesktopScreenEntryImg,\n    prefixMessageId: \"entry.screen-prefix\",\n    mediumMessageId: AFRAME.utils.device.isMobile() ? \"entry.mobile-screen\" : \"entry.desktop-screen\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const GenericEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: GenericVREntryImg,\n    prefixMessageId: \"entry.generic-prefix\",\n    mediumMessageId: \"entry.generic-medium\",\n    subtitle: AFRAME.utils.device.isMobile() ? null : \"entry.generic-subtitle-desktop\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const GearVREntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: GearVREntryImg,\n    prefixMessageId: \"entry.gearvr-prefix\",\n    mediumMessageId: \"entry.gearvr-medium\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const DaydreamEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: DaydreamEntryImg,\n    prefixMessageId: \"entry.daydream-prefix\",\n    mediumMessageId: \"entry.daydream-medium\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const SafariEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: MobileScreenEntryImg,\n    prefixMessageId: \"entry.screen-prefix\",\n    mediumMessageId: \"entry.mobile-safari\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const DeviceEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: DeviceEntryImg,\n    prefixMessageId: AFRAME.utils.device.isMobile() ? \"entry.device-prefix-mobile\" : \"entry.device-prefix-desktop\",\n    mediumMessageId: \"entry.device-medium\"\n  };\n\n  entryButtonProps.subtitle = entryButtonProps.isInHMD\n    ? \"entry.device-subtitle-vr\"\n    : AFRAME.utils.device.isMobile()\n      ? \"entry.device-subtitle-mobile\"\n      : \"entry.device-subtitle-desktop\";\n\n  return <EntryButton {...entryButtonProps} />;\n};\n","module.exports = __webpack_public_path__ + \"assets/images/mobile_screen_entry-56571ad6d8e70df95a684842b96621ff.svg\";","module.exports = __webpack_public_path__ + \"assets/images/desktop_screen_entry-6e77d74d066138048b1151fd64e14e32.svg\";","module.exports = __webpack_public_path__ + \"assets/images/generic_vr_entry-69dd6f2bbef1834ed4e3ff46bd6422df.svg\";","module.exports = __webpack_public_path__ + \"assets/images/gearvr_entry-dcea59d35d7fae4c8b9c4985c1743851.svg\";","module.exports = __webpack_public_path__ + \"assets/images/daydream_entry-4fe9ced9f15163d2095c43bf64edad7b.svg\";","module.exports = __webpack_public_path__ + \"assets/images/device_entry-d3f3d960fab9d2ba5f868c6b671653ca.svg\";","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faQuestion } from \"@fortawesome/free-solid-svg-icons/faQuestion\";\n\nexport const ProfileInfoHeader = props => (\n  <div className=\"profile-info-header\">\n    <div className=\"profile-info-header__menu-buttons\">\n      <button className=\"profile-info-header__menu-buttons__menu-button\" onClick={props.onClickHelp}>\n        <i className=\"profile-info-header__menu-buttons__menu-button__icon\">\n          <FontAwesomeIcon icon={faQuestion} />\n        </i>\n      </button>\n    </div>\n    <div className=\"profile-info-header__profile_display_name\">\n      <img src=\"../assets/images/account.svg\" onClick={props.onClickName} className=\"profile-info-header__icon\" />\n      <div onClick={props.onClickName} title={props.name}>\n        {props.name}\n      </div>\n    </div>\n  </div>\n);\n\nProfileInfoHeader.propTypes = {\n  onClickName: PropTypes.func,\n  onClickHelp: PropTypes.func,\n  name: PropTypes.string\n};\n","module.exports = __webpack_public_path__ + \"assets/images/account-b19d3eb256285a254dc8756d5c38235e.svg\";","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport { SCHEMA } from \"../storage/store\";\n\nclass ProfileEntryPanel extends Component {\n  static propTypes = {\n    store: PropTypes.object,\n    messages: PropTypes.object,\n    finished: PropTypes.func,\n    intl: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n    const { displayName, avatarId } = this.props.store.state.profile;\n    this.state = { displayName, avatarId };\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n  }\n\n  storeUpdated = () => {\n    const { avatarId, displayName } = this.props.store.state.profile;\n    this.setState({ avatarId, displayName });\n  };\n\n  saveStateAndFinish = e => {\n    e.preventDefault();\n\n    const { displayName } = this.props.store.state.profile;\n    const { hasChangedName } = this.props.store.state.activity;\n\n    const hasChangedNowOrPreviously = hasChangedName || this.state.displayName !== displayName;\n    this.props.store.update({\n      activity: {\n        hasChangedName: hasChangedNowOrPreviously\n      },\n      profile: {\n        ...this.state\n      }\n    });\n    this.props.finished();\n  };\n\n  stopPropagation = e => {\n    e.stopPropagation();\n  };\n\n  setAvatarStateFromIframeMessage = e => {\n    if (e.source !== this.avatarSelector.contentWindow) {\n      return;\n    }\n    this.setState({ avatarId: e.data.avatarId });\n  };\n\n  componentDidMount() {\n    // stop propagation so that avatar doesn't move when wasd'ing during text input.\n    this.nameInput.addEventListener(\"keydown\", this.stopPropagation);\n    this.nameInput.addEventListener(\"keypress\", this.stopPropagation);\n    this.nameInput.addEventListener(\"keyup\", this.stopPropagation);\n    window.addEventListener(\"message\", this.setAvatarStateFromIframeMessage);\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.nameInput.removeEventListener(\"keydown\", this.stopPropagation);\n    this.nameInput.removeEventListener(\"keypress\", this.stopPropagation);\n    this.nameInput.removeEventListener(\"keyup\", this.stopPropagation);\n    window.removeEventListener(\"message\", this.setAvatarStateFromIframeMessage);\n  }\n\n  render() {\n    const { formatMessage } = this.props.intl;\n\n    return (\n      <div className=\"profile-entry\">\n        <form onSubmit={this.saveStateAndFinish} className=\"profile-entry__form\">\n          <div className=\"profile-entry__box profile-entry__box--darkened\">\n            <label htmlFor=\"#profile-entry-display-name\" className=\"profile-entry__subtitle\">\n              <FormattedMessage id=\"profile.header\" />\n            </label>\n            <label>\n              <input\n                id=\"profile-entry-display-name\"\n                className=\"profile-entry__form-field-text\"\n                value={this.state.displayName}\n                onFocus={e => e.target.select()}\n                onChange={e => this.setState({ displayName: e.target.value })}\n                required\n                spellCheck=\"false\"\n                pattern={SCHEMA.definitions.profile.properties.displayName.pattern}\n                title={formatMessage({ id: \"profile.display_name.validation_warning\" })}\n                ref={inp => (this.nameInput = inp)}\n              />\n            </label>\n            <div className=\"profile-entry__avatar-selector-container\">\n              <div className=\"loading-panel\">\n                <div className=\"loader-wrap\">\n                  <div className=\"loader\">\n                    <div className=\"loader-center\" />\n                  </div>\n                </div>\n              </div>\n              <iframe\n                className=\"profile-entry__avatar-selector\"\n                src={`/avatar-selector.html#avatar_id=${this.state.avatarId}`}\n                ref={ifr => (this.avatarSelector = ifr)}\n              />\n            </div>\n            <input className=\"profile-entry__form-submit\" type=\"submit\" value={formatMessage({ id: \"profile.save\" })} />\n            <div className=\"profile-entry__box__links\">\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n                <FormattedMessage id=\"profile.terms_of_use\" />\n              </a>\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                href=\"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"\n              >\n                <FormattedMessage id=\"profile.privacy_notice\" />\n              </a>\n            </div>\n          </div>\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(ProfileEntryPanel);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport cx from \"classnames\";\n\nimport styles from \"../assets/stylesheets/2d-hud.scss\";\n\nconst TopHUD = ({ muted, frozen, onToggleMute, onToggleFreeze, onSpawnPen }) => (\n  <div className={cx(styles.container, styles.top, styles.unselectable)}>\n    <div className={cx(\"ui-interactive\", styles.panel, styles.left)}>\n      <div\n        className={cx(styles.iconButton, styles.mute, { [styles.active]: muted })}\n        title={muted ? \"Unmute Mic\" : \"Mute Mic\"}\n        onClick={onToggleMute}\n      />\n    </div>\n    <div\n      className={cx(\"ui-interactive\", styles.iconButton, styles.large, styles.freeze, { [styles.active]: frozen })}\n      title={frozen ? \"Resume\" : \"Pause\"}\n      onClick={onToggleFreeze}\n    />\n    <div className={cx(\"ui-interactive\", styles.panel, styles.right)}>\n      <div className={cx(styles.iconButton, styles.spawn_pen)} title={\"Drawing Pen\"} onClick={onSpawnPen} />\n    </div>\n  </div>\n);\n\nTopHUD.propTypes = {\n  muted: PropTypes.bool,\n  frozen: PropTypes.bool,\n  onToggleMute: PropTypes.func,\n  onToggleFreeze: PropTypes.func,\n  onSpawnPen: PropTypes.func\n};\n\nconst BottomHUD = ({ onCreateObject, showPhotoPicker, onMediaPicked }) => (\n  <div className={cx(styles.container, styles.column, styles.bottom, styles.unselectable)}>\n    {showPhotoPicker ? (\n      <div className={cx(\"ui-interactive\", styles.panel, styles.up)}>\n        <input\n          id=\"media-picker-input\"\n          className={cx(styles.hide)}\n          type=\"file\"\n          accept=\"image/*\"\n          multiple\n          onChange={e => {\n            for (const file of e.target.files) {\n              onMediaPicked(file);\n            }\n          }}\n        />\n        <label htmlFor=\"media-picker-input\">\n          <div className={cx(styles.iconButton, styles.mobileMediaPicker)} title={\"Pick Media\"} />\n        </label>\n      </div>\n    ) : (\n      <div />\n    )}\n    <div>\n      <div\n        className={cx(\"ui-interactive\", styles.iconButton, styles.large, styles.createObject)}\n        title={\"Create Object\"}\n        onClick={onCreateObject}\n      />\n    </div>\n  </div>\n);\n\nBottomHUD.propTypes = {\n  onCreateObject: PropTypes.func,\n  showPhotoPicker: PropTypes.bool,\n  onMediaPicked: PropTypes.func\n};\n\nexport default { TopHUD, BottomHUD };\n","const MS_PER_DAY = 1000 * 60 * 60 * 24;\nconst MS_PER_MONTH = 1000 * 60 * 60 * 24 * 30;\n\nfunction isSameMonth(da, db) {\n  return da.getFullYear() == db.getFullYear() && da.getMonth() == db.getMonth();\n}\n\nfunction isSameDay(da, db) {\n  return isSameMonth(da, db) && da.getDate() == db.getDate();\n}\n\nexport default class HubChannel {\n  constructor(store) {\n    this.store = store;\n  }\n\n  setPhoenixChannel = channel => {\n    this.channel = channel;\n  };\n\n  sendEntryEvent = async () => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before room entry.\");\n      return;\n    }\n\n    let entryDisplayType = \"Screen\";\n\n    if (navigator.getVRDisplays) {\n      const vrDisplay = (await navigator.getVRDisplays()).find(d => d.isPresenting);\n\n      if (vrDisplay) {\n        entryDisplayType = vrDisplay.displayName;\n      }\n    }\n\n    // This is fairly hacky, but gets the # of initial occupants\n    let initialOccupantCount = 0;\n\n    if (NAF.connection.adapter && NAF.connection.adapter.publisher) {\n      initialOccupantCount = NAF.connection.adapter.publisher.initialOccupants.length;\n    }\n\n    const entryTimingFlags = this.getEntryTimingFlags();\n\n    const entryEvent = {\n      ...entryTimingFlags,\n      initialOccupantCount,\n      entryDisplayType,\n      userAgent: navigator.userAgent\n    };\n\n    this.channel.push(\"events:entered\", entryEvent);\n  };\n\n  getEntryTimingFlags = () => {\n    const entryTimingFlags = { isNewDaily: true, isNewMonthly: true, isNewDayWindow: true, isNewMonthWindow: true };\n    const storedLastEnteredAt = this.store.state.activity.lastEnteredAt;\n\n    if (!storedLastEnteredAt) {\n      return entryTimingFlags;\n    }\n\n    const now = new Date();\n    const lastEntered = new Date(storedLastEnteredAt);\n    const msSinceLastEntered = now - lastEntered;\n\n    // note that new daily and new monthly is based on client local time\n    entryTimingFlags.isNewDaily = !isSameDay(now, lastEntered);\n    entryTimingFlags.isNewMonthly = !isSameMonth(now, lastEntered);\n    entryTimingFlags.isNewDayWindow = msSinceLastEntered > MS_PER_DAY;\n    entryTimingFlags.isNewMonthWindow = msSinceLastEntered > MS_PER_MONTH;\n\n    return entryTimingFlags;\n  };\n\n  sendObjectSpawnedEvent = objectType => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before object spawn.\");\n      return;\n    }\n\n    const spawnEvent = {\n      object_type: objectType\n    };\n\n    this.channel.push(\"events:object_spawned\", spawnEvent);\n  };\n\n  disconnect = () => {\n    if (this.channel) {\n      this.channel.socket.disconnect();\n    }\n  };\n}\n","const { Pathfinding } = require(\"three-pathfinding\");\n\nAFRAME.registerSystem(\"nav\", {\n  init: function() {\n    this.pathfinder = new Pathfinding();\n  },\n\n  loadMesh: function(mesh, zone) {\n    this.el.object3D.updateMatrixWorld();\n    const geometry = new THREE.Geometry().fromBufferGeometry(mesh.geometry);\n    geometry.applyMatrix(mesh.matrixWorld);\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\n  }\n});\n","const invaderPos = new AFRAME.THREE.Vector3();\nconst bubblePos = new AFRAME.THREE.Vector3();\n\n/**\n * Iterates through bubbles and invaders on every tick and sets invader state accordingly.\n * testing multiline things\n * @namespace avatar/personal-space-bubble\n * @system personal-space-bubble\n */\nAFRAME.registerSystem(\"personal-space-bubble\", {\n  schema: {\n    debug: { default: false },\n    enabled: { default: true }\n  },\n\n  init() {\n    this.invaders = [];\n    this.bubbles = [];\n\n    this.el.addEventListener(\"action_space_bubble\", () => {\n      this.el.setAttribute(\"personal-space-bubble\", { enabled: !this.data.enabled });\n    });\n  },\n\n  registerBubble(bubble) {\n    this.bubbles.push(bubble);\n  },\n\n  unregisterBubble(bubble) {\n    const index = this.bubbles.indexOf(bubble);\n\n    if (index !== -1) {\n      this.bubbles.splice(index, 1);\n    }\n  },\n\n  registerInvader(invader) {\n    NAF.utils.getNetworkedEntity(invader.el).then(networkedEl => {\n      const owner = NAF.utils.getNetworkOwner(networkedEl);\n\n      if (owner !== NAF.clientId) {\n        this.invaders.push(invader);\n      }\n    });\n  },\n\n  unregisterInvader(invader) {\n    const index = this.invaders.indexOf(invader);\n\n    if (index !== -1) {\n      this.invaders.splice(index, 1);\n    }\n  },\n\n  update() {\n    for (let i = 0; i < this.bubbles.length; i++) {\n      this.bubbles[i].updateDebug();\n    }\n\n    for (let i = 0; i < this.invaders.length; i++) {\n      this.invaders[i].updateDebug();\n      if (!this.data.enabled) {\n        this.invaders[i].setInvading(false);\n      }\n    }\n\n    if (this.data.enabled) {\n      this.el.addState(\"spacebubble\");\n    } else {\n      this.el.removeState(\"spacebubble\");\n    }\n  },\n\n  tick() {\n    if (!this.data.enabled) return;\n\n    // precondition for this stuff -- the bubbles and invaders need updated world matrices.\n    // right now this is satisfied because we update the world matrices in the character controller\n\n    for (let i = 0; i < this.invaders.length; i++) {\n      this.invaders[i].setInvading(false);\n    }\n\n    // Loop through all of the space bubbles (usually one)\n    for (let i = 0; i < this.bubbles.length; i++) {\n      const bubble = this.bubbles[i];\n\n      bubblePos.setFromMatrixPosition(bubble.el.object3D.matrixWorld);\n\n      // Hide the invader if inside the bubble\n      for (let j = 0; j < this.invaders.length; j++) {\n        const invader = this.invaders[j];\n\n        invaderPos.setFromMatrixPosition(invader.el.object3D.matrixWorld);\n\n        const distanceSquared = bubblePos.distanceToSquared(invaderPos);\n        const radiusSum = bubble.data.radius + invader.data.radius;\n        if (distanceSquared < radiusSum * radiusSum) {\n          invader.setInvading(true);\n        }\n      }\n    }\n  }\n});\n\nfunction createSphereGizmo(radius) {\n  const geometry = new THREE.SphereBufferGeometry(radius, 10, 10);\n  const wireframe = new THREE.WireframeGeometry(geometry);\n  const line = new THREE.LineSegments(wireframe);\n  line.material.opacity = 0.5;\n  line.material.transparent = true;\n  return line;\n}\n\n// TODO: we need to come up with a more generic way of doing this as this is very specific to our avatars.\n/**\n * Specifies a mesh associated with an invader.\n * @namespace avatar/personal-space-bubble\n * @component space-invader-mesh\n */\nAFRAME.registerComponent(\"space-invader-mesh\", {\n  schema: {\n    meshName: { type: \"string\" }\n  },\n  update() {\n    this.targetMesh = this.el.object3D.getObjectByName(this.data.meshName);\n  }\n});\n\nfunction findInvaderMesh(entity) {\n  while (entity && !(entity.components && entity.components[\"space-invader-mesh\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"space-invader-mesh\"].targetMesh;\n}\n\nconst DEBUG_OBJ = \"psb-debug\";\n\n/**\n * Represents an entity that can invade a personal space bubble\n * @namespace avatar/personal-space-bubble\n * @component personal-space-invader\n */\nAFRAME.registerComponent(\"personal-space-invader\", {\n  schema: {\n    radius: { type: \"number\", default: 0.1 },\n    useMaterial: { default: false },\n    debug: { default: false },\n    invadingOpacity: { default: 0.3 }\n  },\n\n  init() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    system.registerInvader(this);\n    if (this.data.useMaterial) {\n      const mesh = findInvaderMesh(this.el);\n      if (mesh) {\n        this.targetMaterial = mesh.material;\n      }\n    }\n    this.invading = false;\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    if (system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"personal-space-bubble\"].unregisterInvader(this);\n  },\n\n  setInvading(invading) {\n    if (this.targetMaterial) {\n      this.targetMaterial.opacity = invading ? this.data.invadingOpacity : 1;\n      this.targetMaterial.transparent = invading;\n    } else {\n      this.el.object3D.visible = !invading;\n    }\n    this.invading = invading;\n  }\n});\n\n/**\n * Represents a personal space bubble on an entity.\n * @namespace avatar/personal-space-bubble\n * @component personal-space-bubble\n */\nAFRAME.registerComponent(\"personal-space-bubble\", {\n  schema: {\n    radius: { type: \"number\", default: 0.8 },\n    debug: { default: false }\n  },\n  init() {\n    this.system.registerBubble(this);\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    if (this.system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.system.unregisterBubble(this);\n  }\n});\n","/**\n * Emits an \"exit\" event when a user has stopped using the app for a certain period of time\n * @system exit-on-blur\n */\nAFRAME.registerSystem(\"exit-on-blur\", {\n  init() {\n    this.onBlur = this.onBlur.bind(this);\n    this.onFocus = this.onFocus.bind(this);\n    this.onTimeout = this.onTimeout.bind(this);\n    this.onEnterVR = this.onEnterVR.bind(this);\n\n    this.isOculusBrowser = navigator.userAgent.match(/Oculus/);\n    this.enteredVR = false;\n\n    window.addEventListener(\"blur\", this.onBlur);\n    window.addEventListener(\"focus\", this.onFocus);\n    this.el.addEventListener(\"enter-vr\", this.onEnterVR);\n\n    this.exitTimeout = null;\n  },\n\n  tick() {\n    // This is a hack to detect when an Oculus Go user has taken off the headset and the headset has\n    // entered standby mode. Currently Oculus Browser is not emitting a blur, vrdisplaydeactivate,\n    // vrdisplayblur, visibilitychange, or vrdisplaypresentchange event, so we wait 15 seconds after\n    // the last requestAnimationFrame callback to determine if the headset has gone into standby mode.\n    // We also check that you have entered VR so that this timeout does not occur in the setup UI.\n    if (this.isOculusBrowser && this.enteredVR) {\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 15 * 1000);\n    }\n  },\n\n  onEnterVR() {\n    this.enteredVR = true;\n  },\n\n  onBlur() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\n    }\n  },\n\n  onFocus() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n    }\n  },\n\n  onTimeout() {\n    this.el.dispatchEvent(new CustomEvent(\"exit\"));\n  },\n\n  remove() {\n    clearTimeout(this.exitTimeout);\n    window.removeEventListener(\"blur\", this.onBlur);\n  }\n});\n","/**\n * Manages ownership and haptics on an interatable\n * @namespace network\n * @component super-networked-interactable\n */\nAFRAME.registerComponent(\"super-networked-interactable\", {\n  schema: {\n    hapticsMassVelocityFactor: { default: 0.1 },\n    counter: { type: \"selector\" },\n    scrollScaleDelta: { default: 0.1 },\n    minScale: { default: 0.1 },\n    maxScale: { default: 100 }\n  },\n\n  init: function() {\n    this.system = this.el.sceneEl.systems.physics;\n    this.counter = this.data.counter.components[\"networked-counter\"];\n    this.hand = null;\n    this.currentScale = new THREE.Vector3();\n    this.currentScale.copy(this.el.getAttribute(\"scale\"));\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n      if (!NAF.utils.isMine(networkedEl)) {\n        this.el.setAttribute(\"body\", { type: \"static\" });\n      } else {\n        this.counter.register(networkedEl);\n      }\n    });\n\n    this._stateAdded = this._stateAdded.bind(this);\n    this._onGrabStart = this._onGrabStart.bind(this);\n    this._onGrabEnd = this._onGrabEnd.bind(this);\n    this._onOwnershipLost = this._onOwnershipLost.bind(this);\n    this.el.addEventListener(\"grab-start\", this._onGrabStart);\n    this.el.addEventListener(\"grab-end\", this._onGrabEnd);\n    this.el.addEventListener(\"ownership-lost\", this._onOwnershipLost);\n    this.el.addEventListener(\"stateadded\", this._stateAdded);\n    this.system.addComponent(this);\n  },\n\n  remove: function() {\n    this.counter.deregister(this.el);\n    this.el.removeEventListener(\"grab-start\", this._onGrabStart);\n    this.el.removeEventListener(\"grab-end\", this._onGrabEnd);\n    this.el.removeEventListener(\"ownership-lost\", this._onOwnershipLost);\n    this.el.removeEventListener(\"stateadded\", this._stateAdded);\n    this.system.removeComponent(this);\n  },\n\n  _onGrabStart: function(e) {\n    this.hand = e.detail.hand;\n    this.hand.emit(\"haptic_pulse\", { intensity: \"high\" });\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl)) {\n      if (NAF.utils.takeOwnership(this.networkedEl)) {\n        this.el.setAttribute(\"body\", { type: \"dynamic\" });\n        this.counter.register(this.networkedEl);\n      } else {\n        this.el.emit(\"grab-end\", { hand: this.hand });\n        this.hand = null;\n      }\n    }\n    this.currentScale.copy(this.el.getAttribute(\"scale\"));\n  },\n\n  _onGrabEnd: function(e) {\n    if (e.detail.hand) e.detail.hand.emit(\"haptic_pulse\", { intensity: \"high\" });\n  },\n\n  _onOwnershipLost: function() {\n    this.el.setAttribute(\"body\", { type: \"static\" });\n    this.el.emit(\"grab-end\", { hand: this.hand });\n    this.hand = null;\n    this.counter.deregister(this.el);\n  },\n\n  _changeScale: function(delta) {\n    if (this.el.is(\"grabbed\") && this.el.components.hasOwnProperty(\"stretchable\")) {\n      this.currentScale.addScalar(delta).clampScalar(this.data.minScale, this.data.maxScale);\n      this.el.setAttribute(\"scale\", this.currentScale);\n      this.el.components[\"stretchable\"].stretchBody(this.el, this.currentScale);\n    }\n  },\n\n  _stateAdded(evt) {\n    switch (evt.detail) {\n      case \"scaleUp\":\n        this._changeScale(-this.data.scrollScaleDelta);\n        break;\n      case \"scaleDown\":\n        this._changeScale(this.data.scrollScaleDelta);\n        break;\n      default:\n        break;\n    }\n  }\n});\n","/**\n * Limits networked interactables to a maximum number at any given time\n * @namespace network\n * @component networked-counter\n */\nAFRAME.registerComponent(\"networked-counter\", {\n  schema: {\n    max: { default: 3 },\n    ttl: { default: 0 },\n    grab_event: { type: \"string\", default: \"grab-start\" },\n    release_event: { type: \"string\", default: \"grab-end\" }\n  },\n\n  init() {\n    this.registeredEls = new Map();\n  },\n\n  remove() {\n    this.registeredEls.forEach(({ onGrabHandler, onReleaseHandler, timeout }, el) => {\n      el.removeEventListener(this.data.grab_event, onGrabHandler);\n      el.removeEventListener(this.data.release_event, onReleaseHandler);\n      clearTimeout(timeout);\n    });\n    this.registeredEls.clear();\n  },\n\n  register(el) {\n    if (this.data.max <= 0 || this.registeredEls.has(el)) return;\n\n    const grabEventListener = this._onGrabbed.bind(this, el);\n    const releaseEventListener = this._onReleased.bind(this, el);\n\n    this.registeredEls.set(el, {\n      ts: Date.now(),\n      onGrabHandler: grabEventListener,\n      onReleaseHandler: releaseEventListener\n    });\n\n    el.addEventListener(this.data.grab_event, grabEventListener);\n    el.addEventListener(this.data.release_event, releaseEventListener);\n\n    if (!el.is(\"grabbed\")) {\n      this._startTimer(el);\n    }\n\n    this._destroyOldest();\n  },\n\n  deregister(el) {\n    if (this.registeredEls.has(el)) {\n      const { onGrabHandler, onReleaseHandler, timeout } = this.registeredEls.get(el);\n      el.removeEventListener(this.data.grab_event, onGrabHandler);\n      el.removeEventListener(this.data.release_event, onReleaseHandler);\n      clearTimeout(timeout);\n      this.registeredEls.delete(el);\n    }\n  },\n\n  _onGrabbed(el) {\n    clearTimeout(this.registeredEls.get(el).timeout);\n  },\n\n  _onReleased(el) {\n    this._startTimer(el);\n    this.registeredEls.get(el).ts = Date.now();\n  },\n\n  _destroyOldest() {\n    if (this.registeredEls.size > this.data.max) {\n      let oldestEl = null,\n        minTs = Number.MAX_VALUE;\n      this.registeredEls.forEach(({ ts }, el) => {\n        if (ts < minTs && !el.is(\"grabbed\")) {\n          oldestEl = el;\n          minTs = ts;\n        }\n      });\n      this._destroy(oldestEl);\n    }\n  },\n\n  _startTimer(el) {\n    if (!this.data.ttl) return;\n    clearTimeout(this.registeredEls.get(el).timeout);\n    this.registeredEls.get(el).timeout = setTimeout(() => {\n      this._destroy(el);\n    }, this.data.ttl * 1000);\n  },\n\n  _destroy(el) {\n    // networked-interactable's remvoe will also call deregister, but it will happen async so we do it here as well.\n    this.deregister(el);\n    el.parentNode.removeChild(el);\n  }\n});\n","import { addMedia } from \"../utils/media-utils\";\nimport { waitForEvent } from \"../utils/async-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\n\nlet nextGrabId = 0;\n/**\n * Spawns networked objects when grabbed or when a specified event is fired.\n * @namespace network\n * @component super-spawner\n */\nAFRAME.registerComponent(\"super-spawner\", {\n  schema: {\n    /**\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\n     */\n    src: { default: \"\" },\n\n    /**\n     * The template to use for this object\n     */\n    template: { default: \"\" },\n\n    /**\n     * Spawn the object at a custom position, rather than at the center of the spanwer.\n     */\n    useCustomSpawnPosition: { default: false },\n    spawnPosition: { type: \"vec3\" },\n\n    /**\n     * Spawn the object with a custom orientation, rather than copying that of the spawner.\n     */\n    useCustomSpawnRotation: { default: false },\n    spawnRotation: { type: \"vec4\" },\n\n    /**\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\n     */\n    useCustomSpawnScale: { default: false },\n    spawnScale: { type: \"vec3\" },\n\n    /**\n     * The events to emit for programmatically grabbing and releasing objects\n     */\n    grabEvents: { default: [\"cursor-grab\", \"primary_hand_grab\"] },\n    releaseEvents: { default: [\"cursor-release\", \"primary_hand_release\"] },\n\n    /**\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\n     */\n    spawnCooldown: { default: 1 },\n\n    /**\n     * Center the spawned object on the hand that grabbed it after it finishes loading. By default the object will be grabbed relative to where the spawner was grabbed\n     */\n    centerSpawnedObject: { default: false },\n\n    /**\n     * Optional event to listen for to spawn an object on the preferred superHand\n     */\n    spawnEvent: { type: \"string\" },\n\n    /**\n     * The superHand to use if an object is spawned via spawnEvent\n     */\n    superHand: { type: \"selector\" },\n\n    /**\n     * The cursor superHand to use if an object is spawned via spawnEvent\n     */\n    cursorSuperHand: { type: \"selector\" }\n  },\n\n  init() {\n    this.heldEntities = new Map();\n    this.cooldownTimeout = null;\n    this.onGrabStart = this.onGrabStart.bind(this);\n    this.onGrabEnd = this.onGrabEnd.bind(this);\n\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\n\n    this.sceneEl = document.querySelector(\"a-scene\");\n  },\n\n  play() {\n    this.el.addEventListener(\"grab-start\", this.onGrabStart);\n    this.el.addEventListener(\"grab-end\", this.onGrabEnd);\n    if (this.data.spawnEvent) {\n      this.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n  },\n\n  pause() {\n    this.el.removeEventListener(\"grab-start\", this.onGrabStart);\n    this.el.removeEventListener(\"grab-end\", this.onGrabEnd);\n    if (this.data.spawnEvent) {\n      this.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n\n    if (this.cooldownTimeout) {\n      clearTimeout(this.cooldownTimeout);\n      this.cooldownTimeout = null;\n      this.el.setAttribute(\"visible\", true);\n      this.el.classList.add(\"interactable\");\n    }\n  },\n\n  remove() {\n    this.heldEntities.clear();\n  },\n\n  async onSpawnEvent() {\n    const controllerCount = this.el.sceneEl.components[\"input-configurator\"].controllerQueue.length;\n    const using6DOF = controllerCount > 1 && this.el.sceneEl.is(\"vr-mode\");\n    const hand = using6DOF ? this.data.superHand : this.data.cursorSuperHand;\n\n    if (this.cooldownTimeout || !hand) {\n      return;\n    }\n\n    const entity = addMedia(this.data.src, this.data.template, ObjectContentOrigins.SPAWNER).entity;\n\n    hand.object3D.getWorldPosition(entity.object3D.position);\n    hand.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    if (this.data.useCustomSpawnScale) {\n      entity.object3D.scale.copy(this.data.spawnScale);\n    }\n\n    this.activateCooldown();\n\n    await waitForEvent(\"body-loaded\", entity);\n\n    hand.object3D.getWorldPosition(entity.object3D.position);\n\n    if (!using6DOF) {\n      for (let i = 0; i < this.data.grabEvents.length; i++) {\n        hand.emit(this.data.grabEvents[i], { targetEntity: entity });\n      }\n    }\n  },\n\n  async onGrabStart(e) {\n    if (this.cooldownTimeout) {\n      return;\n    }\n\n    // This tells super-hands we are handling this grab. The user is now \"grabbing\" the spawner\n    e.preventDefault();\n\n    const hand = e.detail.hand;\n    const thisGrabId = nextGrabId++;\n    this.heldEntities.set(hand, thisGrabId);\n\n    const entity = addMedia(this.data.src, this.data.template, ObjectContentOrigins.SPAWNER).entity;\n\n    entity.object3D.position.copy(\n      this.data.useCustomSpawnPosition ? this.data.spawnPosition : this.el.object3D.position\n    );\n    entity.object3D.rotation.copy(\n      this.data.useCustomSpawnRotation ? this.data.spawnRotation : this.el.object3D.rotation\n    );\n    entity.object3D.scale.copy(this.data.useCustomSpawnScale ? this.data.spawnScale : this.el.object3D.scale);\n\n    this.activateCooldown();\n\n    await waitForEvent(\"body-loaded\", entity);\n\n    // If we are still holding the spawner with the hand that grabbed to create this entity, release the spawner and grab the entity\n    if (this.heldEntities.get(hand) === thisGrabId) {\n      if (this.data.centerSpawnedObject) {\n        entity.body.position.copy(hand.object3D.position);\n      }\n      for (let i = 0; i < this.data.grabEvents.length; i++) {\n        hand.emit(this.data.releaseEvents[i]);\n        hand.emit(this.data.grabEvents[i], { targetEntity: entity });\n      }\n    }\n  },\n\n  onGrabEnd(e) {\n    this.heldEntities.delete(e.detail.hand);\n    // This tells super-hands we are handling this release\n    e.preventDefault();\n  },\n\n  activateCooldown() {\n    if (this.data.spawnCooldown > 0) {\n      this.el.setAttribute(\"visible\", false);\n      this.el.classList.remove(\"interactable\");\n      this.cooldownTimeout = setTimeout(() => {\n        this.el.setAttribute(\"visible\", true);\n        this.el.classList.add(\"interactable\");\n        this.cooldownTimeout = null;\n      }, this.data.spawnCooldown * 1000);\n    }\n  }\n});\n","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n","/**\n * Listens to events from an event source and re-emits them on this entity\n * @component event-repeater\n */\nAFRAME.registerComponent(\"event-repeater\", {\n  schema: {\n    eventSource: { type: \"selector\" },\n    events: { type: \"array\" }\n  },\n\n  play: function() {\n    this.data.eventListeners = [];\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\n    }\n  },\n\n  pause: function() {\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\n    }\n    this.data.eventListeners = [];\n  },\n\n  _handleEvent: function(event, e) {\n    this.el.emit(event, e.detail);\n  }\n});\n","import { CONTROLLER_OFFSETS } from \"./hand-controls2.js\";\n\n/**\n * Sets the offset of the aframe-physics shape on this entity based on the current VR controller type\n * @namespace user-input\n * @component controls-shape-offset\n */\nAFRAME.registerComponent(\"controls-shape-offset\", {\n  schema: {\n    additionalOffset: { type: \"vec3\", default: { x: 0, y: -0.03, z: -0.04 } }\n  },\n  init: function() {\n    this.controller = null;\n    this.shapeAdded = false;\n\n    this._handleControllerConnected = this._handleControllerConnected.bind(this);\n    this.el.addEventListener(\"controllerconnected\", this._handleControllerConnected);\n  },\n\n  remove: function() {\n    this.el.removeEventListener(\"controllerconnected\", this._handleControllerConnected);\n  },\n\n  tick: function() {\n    if (!this.shapeAdded && this.controller) {\n      this.shapeAdded = true;\n      const hasOffset = CONTROLLER_OFFSETS.hasOwnProperty(this.controller);\n      const offset = hasOffset ? CONTROLLER_OFFSETS[this.controller] : CONTROLLER_OFFSETS.default;\n      const position = new THREE.Vector3();\n      const quaternion = new THREE.Quaternion();\n      const scale = new THREE.Vector3();\n      offset.decompose(position, quaternion, scale);\n      position.add(this.data.additionalOffset);\n      quaternion.conjugate();\n\n      const shape = {\n        shape: \"sphere\",\n        radius: \"0.02\",\n        orientation: quaternion,\n        offset: position\n      };\n\n      this.el.setAttribute(\"shape\", shape);\n    }\n  },\n\n  _handleControllerConnected: function(e) {\n    this.controller = e.detail.name;\n  }\n});\n","/* global CANNON */\n/**\n * Floats a duck based on its scale.\n * @component duck\n */\nAFRAME.registerComponent(\"duck\", {\n  schema: {\n    initialForce: { default: 0 },\n    maxForce: { default: 6.5 },\n    maxScale: { default: 5 }\n  },\n\n  init: function() {\n    this.physicsSystem = this.el.sceneEl.systems.physics;\n    this.hasBody = false;\n    this.position = new CANNON.Vec3();\n    this.force = new CANNON.Vec3(0, this.data.initialForce, 0);\n    this.initialScale = this.el.object3D.scale.x;\n    this.maxScale = this.data.maxScale * this.initialScale;\n  },\n\n  play: function() {\n    this.physicsSystem.addComponent(this);\n  },\n\n  pause: function() {\n    this.physicsSystem.removeComponent(this);\n  },\n\n  beforeStep: function() {\n    if (this.el.body && NAF.utils.isMine(this.el)) {\n      const currentScale = this.el.object3D.scale.x;\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\n      const force = ratio * this.data.maxForce;\n      if (force > 0) {\n        const angle = Math.random() * Math.PI * 2;\n        const x = Math.cos(angle);\n        const z = Math.sin(angle);\n        this.force.set(x, force, z);\n        this.position.set(x * 0.01, 0, z * 0.01);\n        this.el.body.applyForce(this.force, this.position);\n      }\n    }\n  }\n});\n","AFRAME.registerComponent(\"quack\", {\n  schema: {\n    quackPercentage: { default: 1 },\n    specialQuackPercentage: { default: 0.01 }\n  },\n\n  init: function() {\n    this._handleGrabStart = this._handleGrabStart.bind(this);\n  },\n\n  play: function() {\n    this.el.addEventListener(\"grab-start\", this._handleGrabStart);\n  },\n\n  pause: function() {\n    this.el.removeEventListener(\"grab-start\", this._handleGrabStart);\n  },\n\n  _handleGrabStart: function() {\n    const rand = Math.random();\n    if (rand < this.data.specialQuackPercentage) {\n      this.el.emit(\"specialquack\");\n    } else if (rand < this.data.quackPercentage) {\n      this.el.emit(\"quack\");\n    }\n  }\n});\n","/* global AFRAME, THREE */\nconst inherit = AFRAME.utils.extendDeep;\nconst physicsCore = require(\"super-hands/reaction_components/prototypes/physics-grab-proto.js\");\nconst buttonsCore = require(\"super-hands/reaction_components/prototypes/buttons-proto.js\");\n// new object with all core modules\nconst base = inherit({}, physicsCore, buttonsCore);\nAFRAME.registerComponent(\n  \"grabbable-toggle\",\n  inherit(base, {\n    schema: {\n      maxGrabbers: { type: \"int\", default: NaN },\n      invert: { default: false },\n      suppressY: { default: false },\n      primaryReleaseEvents: { default: [\"primary_hand_release\"] },\n      secondaryReleaseEvents: { default: [\"secondary_hand_release\"] }\n    },\n    init: function() {\n      this.GRABBED_STATE = \"grabbed\";\n      this.GRAB_EVENT = \"grab-start\";\n      this.UNGRAB_EVENT = \"grab-end\";\n      this.grabbed = false;\n      this.grabbers = [];\n      this.constraints = new Map();\n      this.deltaPositionIsValid = false;\n      this.grabDistance = undefined;\n      this.grabDirection = { x: 0, y: 0, z: -1 };\n      this.grabOffset = { x: 0, y: 0, z: 0 };\n      // persistent object speeds up repeat setAttribute calls\n      this.destPosition = { x: 0, y: 0, z: 0 };\n      this.deltaPosition = new THREE.Vector3();\n      this.targetPosition = new THREE.Vector3();\n      this.physicsInit();\n\n      this.el.addEventListener(this.GRAB_EVENT, e => this.start(e));\n      this.el.addEventListener(this.UNGRAB_EVENT, e => this.end(e));\n      this.el.addEventListener(\"mouseout\", e => this.lostGrabber(e));\n\n      this.toggle = false;\n      this.lastGrabber = null;\n    },\n    update: function() {\n      this.physicsUpdate();\n      this.xFactor = this.data.invert ? -1 : 1;\n      this.zFactor = this.data.invert ? -1 : 1;\n      this.yFactor = (this.data.invert ? -1 : 1) * !this.data.suppressY;\n    },\n    tick: (function() {\n      const q = new THREE.Quaternion();\n      const v = new THREE.Vector3();\n\n      return function() {\n        let entityPosition;\n        if (this.grabber) {\n          // reflect on z-axis to point in same direction as the laser\n          this.targetPosition.copy(this.grabDirection);\n          this.targetPosition\n            .applyQuaternion(this.grabber.object3D.getWorldQuaternion(q))\n            .setLength(this.grabDistance)\n            .add(this.grabber.object3D.getWorldPosition(v))\n            .add(this.grabOffset);\n          if (this.deltaPositionIsValid) {\n            // relative position changes work better with nested entities\n            this.deltaPosition.sub(this.targetPosition);\n            entityPosition = this.el.getAttribute(\"position\");\n            this.destPosition.x = entityPosition.x - this.deltaPosition.x * this.xFactor;\n            this.destPosition.y = entityPosition.y - this.deltaPosition.y * this.yFactor;\n            this.destPosition.z = entityPosition.z - this.deltaPosition.z * this.zFactor;\n            this.el.setAttribute(\"position\", this.destPosition);\n          } else {\n            this.deltaPositionIsValid = true;\n          }\n          this.deltaPosition.copy(this.targetPosition);\n        }\n      };\n    })(),\n    remove: function() {\n      this.el.removeEventListener(this.GRAB_EVENT, this.start);\n      this.el.removeEventListener(this.UNGRAB_EVENT, this.end);\n      this.physicsRemove();\n    },\n    start: function(evt) {\n      if (evt.defaultPrevented || !this.startButtonOk(evt)) {\n        return;\n      }\n      // room for more grabbers?\n      let grabAvailable = !Number.isFinite(this.data.maxGrabbers) || this.grabbers.length < this.data.maxGrabbers;\n      if (Number.isFinite(this.data.maxGrabbers) && !grabAvailable && this.grabbed) {\n        this.grabbers[0].components[\"super-hands\"].onGrabEndButton();\n        grabAvailable = true;\n      }\n      if (this.grabbers.indexOf(evt.detail.hand) === -1 && grabAvailable) {\n        if (!evt.detail.hand.object3D) {\n          console.warn(\"grabbable entities must have an object3D\");\n          return;\n        }\n        this.grabbers.push(evt.detail.hand);\n        // initiate physics if available, otherwise manual\n        if (!this.physicsStart(evt) && !this.grabber) {\n          this.grabber = evt.detail.hand;\n          this.resetGrabber();\n        }\n        // notify super-hands that the gesture was accepted\n        if (evt.preventDefault) {\n          evt.preventDefault();\n        }\n        this.grabbed = true;\n        this.el.addState(this.GRABBED_STATE);\n      }\n    },\n    end: function(evt) {\n      const handIndex = this.grabbers.indexOf(evt.detail.hand);\n      if (evt.defaultPrevented || !this.endButtonOk(evt)) {\n        return;\n      }\n\n      const type = evt.detail && evt.detail.buttonEvent ? evt.detail.buttonEvent.type : null;\n\n      if (this.toggle && this.lastGrabber !== this.grabbers[0]) {\n        this.toggle = false;\n        this.lastGrabber = null;\n      }\n\n      if (handIndex !== -1) {\n        this.grabber = this.grabbers[0];\n      }\n\n      if ((this.isPrimaryRelease(type) && !this.toggle) || this.isSecondaryRelease(type)) {\n        this.toggle = true;\n        this.lastGrabber = this.grabbers[0];\n        return;\n      } else if (this.toggle && this.isPrimaryRelease(type)) {\n        this.toggle = false;\n        this.lastGrabber = null;\n      }\n\n      if (handIndex !== -1) {\n        this.grabbers.splice(handIndex, 1);\n        this.grabber = this.grabbers[0];\n      }\n\n      this.physicsEnd(evt);\n      if (!this.resetGrabber()) {\n        this.grabbed = false;\n        this.el.removeState(this.GRABBED_STATE);\n      }\n      if (evt.preventDefault) {\n        evt.preventDefault();\n      }\n    },\n    resetGrabber: (() => {\n      const objPos = new THREE.Vector3();\n      const grabPos = new THREE.Vector3();\n      return function() {\n        if (!this.grabber) {\n          return false;\n        }\n        const raycaster = this.grabber.getAttribute(\"raycaster\");\n        this.deltaPositionIsValid = false;\n        this.grabDistance = this.el.object3D\n          .getWorldPosition(objPos)\n          .distanceTo(this.grabber.object3D.getWorldPosition(grabPos));\n        if (raycaster) {\n          this.grabDirection = raycaster.direction;\n          this.grabOffset = raycaster.origin;\n        }\n        return true;\n      };\n    })(),\n    lostGrabber: function(evt) {\n      const i = this.grabbers.indexOf(evt.relatedTarget);\n      // if a queued, non-physics grabber leaves the collision zone, forget it\n      if (i !== -1 && evt.relatedTarget !== this.grabber && !this.physicsIsConstrained(evt.relatedTarget)) {\n        this.grabbers.splice(i, 1);\n      }\n    },\n\n    isPrimaryRelease(type) {\n      return this.data.primaryReleaseEvents.indexOf(type) !== -1;\n    },\n\n    isSecondaryRelease(type) {\n      return this.data.secondaryReleaseEvents.indexOf(type) !== -1;\n    }\n  })\n);\n","const CARDBOARD_BUTTON_GAMEPAD_ID = \"Cardboard Button\";\n\n/**\n * Polls the Gamepad API for Cardboard Button input and emits cardboardbutton events.\n * @namespace user-input\n * @component cardboard-controls\n */\nmodule.exports = AFRAME.registerComponent(\"cardboard-controls\", {\n  init: function() {\n    this.buttons = {};\n    this.gamepad = null;\n    this.isMobile = AFRAME.utils.device.isMobile();\n    this.isVR = false;\n\n    this._handleEnterVR = this._handleEnterVR.bind(this);\n    this._handleExitVR = this._handleExitVR.bind(this);\n  },\n\n  play: function() {\n    window.addEventListener(\"enter-vr\", this._handleEnterVR);\n    window.addEventListener(\"exit-vr\", this._handleExitVR);\n  },\n\n  pause: function() {\n    window.removeEventListener(\"enter-vr\", this._handleEnterVR);\n    window.removeEventListener(\"exit-vr\", this._handleExitVR);\n  },\n\n  tick: function() {\n    if (!this.inVR || !this.isMobile) {\n      return;\n    }\n\n    this.gamepad = this.gamepad || this._getGamepad();\n    if (this.gamepad) {\n      for (let i = 0; i < this.gamepad.buttons.length; i++) {\n        if (this.gamepad.buttons[i].pressed && !this.buttons[i]) {\n          this.el.emit(\"cardboardbuttondown\", {});\n        } else if (!this.gamepad.buttons[i].pressed && this.buttons[i]) {\n          this.el.emit(\"cardboardbuttonup\", {});\n        }\n        this.buttons[i] = this.gamepad.buttons[i].pressed;\n      }\n    } else if (Object.keys(this.buttons).length) {\n      this.buttons = {};\n    }\n  },\n\n  _getGamepad: function() {\n    if (!navigator.getGamepads) {\n      return null;\n    }\n\n    const gamepads = navigator.getGamepads();\n    for (let i = 0; i < gamepads.length; i++) {\n      if (gamepads[i] && gamepads[i].id === CARDBOARD_BUTTON_GAMEPAD_ID) {\n        return gamepads[i];\n      }\n    }\n    return null;\n  },\n\n  _handleEnterVR: function() {\n    this.inVR = true;\n  },\n\n  _handleExitVR: function() {\n    this.inVR = false;\n  }\n});\n","const TARGET_TYPE_NONE = 1;\nconst TARGET_TYPE_INTERACTABLE = 2;\nconst TARGET_TYPE_UI = 4;\nconst TARGET_TYPE_INTERACTABLE_OR_UI = TARGET_TYPE_INTERACTABLE | TARGET_TYPE_UI;\n\nAFRAME.registerComponent(\"cursor-controller\", {\n  dependencies: [\"raycaster\", \"line\"],\n  schema: {\n    cursor: { type: \"selector\" },\n    camera: { type: \"selector\" },\n    maxDistance: { default: 3 },\n    minDistance: { default: 0 },\n    cursorColorHovered: { default: \"#2F80ED\" },\n    cursorColorUnhovered: { default: \"#FFFFFF\" },\n    rayObject: { type: \"selector\" },\n    useMousePos: { default: true },\n    drawLine: { default: false }\n  },\n\n  init: function() {\n    this.enabled = true;\n    this.inVR = false;\n    this.isMobile = AFRAME.utils.device.isMobile();\n    this.currentTargetType = TARGET_TYPE_NONE;\n    this.currentDistance = this.data.maxDistance;\n    this.currentDistanceMod = 0;\n    this.mousePos = new THREE.Vector2();\n    this.wasCursorHovered = false;\n    this.origin = new THREE.Vector3();\n    this.direction = new THREE.Vector3();\n    this.raycasterAttr = this.el.getAttribute(\"raycaster\");\n    this.controllerQuaternion = new THREE.Quaternion();\n    this.data.cursor.setAttribute(\"material\", { color: this.data.cursorColorUnhovered });\n\n    this._handleCursorLoaded = this._handleCursorLoaded.bind(this);\n    this.data.cursor.addEventListener(\"loaded\", this._handleCursorLoaded);\n  },\n\n  enable: function() {\n    this.enabled = true;\n  },\n\n  disable: function() {\n    this.enabled = false;\n    this.setCursorVisibility(false);\n  },\n\n  updateRay: function() {\n    this.raycasterAttr.origin = this.origin;\n    this.raycasterAttr.direction = this.direction;\n    this.el.setAttribute(\"raycaster\", this.raycasterAttr, true);\n  },\n\n  tick: (() => {\n    const rayObjectRotation = new THREE.Quaternion();\n    const cameraPos = new THREE.Vector3();\n\n    return function() {\n      if (!this.enabled) {\n        return;\n      }\n\n      if (this.data.useMousePos) {\n        this.setRaycasterWithMousePos();\n      } else if (this.data.rayObject != null) {\n        const rayObject = this.data.rayObject.object3D;\n        rayObjectRotation.setFromRotationMatrix(rayObject.matrixWorld);\n        this.direction\n          .set(0, 0, -1)\n          .applyQuaternion(rayObjectRotation)\n          .normalize();\n        this.origin.setFromMatrixPosition(rayObject.matrixWorld);\n        this.updateRay();\n      }\n\n      const isGrabbing = this.isInteracting();\n      if (isGrabbing) {\n        const distance = Math.min(\n          this.data.maxDistance,\n          Math.max(this.data.minDistance, this.currentDistance - this.currentDistanceMod)\n        );\n        this.direction.multiplyScalar(distance);\n        this.data.cursor.object3D.position.addVectors(this.origin, this.direction);\n      } else {\n        this.currentDistanceMod = 0;\n        this.updateDistanceAndTargetType();\n\n        const isTarget = this._isTargetOfType(TARGET_TYPE_INTERACTABLE_OR_UI);\n        if (isTarget && !this.wasCursorHovered) {\n          this.wasCursorHovered = true;\n          this.data.cursor.setAttribute(\"material\", { color: this.data.cursorColorHovered });\n        } else if (!isTarget && this.wasCursorHovered) {\n          this.wasCursorHovered = false;\n          this.data.cursor.setAttribute(\"material\", { color: this.data.cursorColorUnhovered });\n        }\n      }\n\n      if (this.data.drawLine) {\n        this.el.setAttribute(\"line\", { start: this.origin.clone(), end: this.data.cursor.object3D.position.clone() });\n      }\n\n      // The cursor will always be oriented towards the player about its Y axis, so objects held by the cursor will rotate towards the player.\n      this.data.camera.object3D.getWorldPosition(cameraPos);\n      cameraPos.y = this.data.cursor.object3D.position.y;\n      this.data.cursor.object3D.lookAt(cameraPos);\n    };\n  })(),\n\n  setRaycasterWithMousePos: function() {\n    const camera = this.data.camera.components.camera.camera;\n    const raycaster = this.el.components.raycaster.raycaster;\n    raycaster.setFromCamera(this.mousePos, camera);\n    this.origin.copy(raycaster.ray.origin);\n    this.direction.copy(raycaster.ray.direction);\n    this.updateRay();\n  },\n\n  updateDistanceAndTargetType: function() {\n    let intersection = null;\n    const intersections = this.el.components.raycaster.intersections;\n    if (intersections.length > 0 && intersections[0].distance <= this.data.maxDistance) {\n      intersection = intersections[0];\n      this.data.cursor.object3D.position.copy(intersection.point);\n      this.currentDistance = intersections[0].distance;\n    } else {\n      this.currentDistance = this.data.maxDistance;\n      this.direction.multiplyScalar(this.currentDistance);\n      this.data.cursor.object3D.position.addVectors(this.origin, this.direction);\n    }\n\n    if (!intersection) {\n      this.currentTargetType = TARGET_TYPE_NONE;\n    } else if (intersection.object.el.matches(\".interactable, .interactable *\")) {\n      this.currentTargetType = TARGET_TYPE_INTERACTABLE;\n    } else if (intersection.object.el.matches(\".ui, .ui *\")) {\n      this.currentTargetType = TARGET_TYPE_UI;\n    }\n  },\n\n  _isTargetOfType: function(mask) {\n    return (this.currentTargetType & mask) === this.currentTargetType;\n  },\n\n  setCursorVisibility: function(visible) {\n    this.data.cursor.setAttribute(\"visible\", visible);\n    this.el.setAttribute(\"line\", { visible: visible && this.data.drawLine });\n  },\n\n  forceCursorUpdate: function() {\n    this.setRaycasterWithMousePos();\n    this.el.components.raycaster.checkIntersections();\n    this.updateDistanceAndTargetType();\n    this.data.cursor.components[\"static-body\"].syncToPhysics();\n  },\n\n  isInteracting: function() {\n    return this.data.cursor.components[\"super-hands\"].state.has(\"grab-start\");\n  },\n\n  startInteraction: function() {\n    if (this._isTargetOfType(TARGET_TYPE_INTERACTABLE_OR_UI)) {\n      this.data.cursor.emit(\"cursor-grab\", {});\n      return true;\n    }\n    return false;\n  },\n\n  moveCursor: function(x, y) {\n    this.mousePos.set(x, y);\n  },\n\n  endInteraction: function() {\n    this.data.cursor.emit(\"cursor-release\", {});\n  },\n\n  changeDistanceMod: function(delta) {\n    const { minDistance, maxDistance } = this.data;\n    const targetDistanceMod = this.currentDistanceMod + delta;\n    const moddedDistance = this.currentDistance - targetDistanceMod;\n    if (moddedDistance > maxDistance || moddedDistance < minDistance) {\n      return false;\n    }\n\n    this.currentDistanceMod = targetDistanceMod;\n    return true;\n  },\n\n  _handleCursorLoaded: function() {\n    this.data.cursor.object3DMap.mesh.renderOrder = window.APP.RENDER_ORDER.CURSOR;\n    this.data.cursor.removeEventListener(\"loaded\", this._handleCursorLoaded);\n  },\n\n  remove: function() {\n    this.data.cursor.removeEventListener(\"loaded\", this._handleCursorLoaded);\n  }\n});\n","/**\n * Initializes teleport-controls when the environment bundle has loaded.\n * @namespace environment\n * @component nav-mesh-helper\n */\nAFRAME.registerComponent(\"nav-mesh-helper\", {\n  schema: {\n    teleportControls: { type: \"selectorAll\", default: \"[teleport-controls]\" }\n  },\n\n  init: function() {\n    const teleportControls = this.data.teleportControls;\n    this.el.addEventListener(\"bundleloaded\", () => {\n      if (!teleportControls) return;\n\n      for (let i = 0; i < teleportControls.length; i++) {\n        teleportControls[i].components[\"teleport-controls\"].queryCollisionEntities();\n      }\n    });\n  }\n});\n","import \"../utils/postprocessing/EffectComposer\";\nimport \"../utils/postprocessing/RenderPass\";\nimport \"../utils/postprocessing/ShaderPass\";\nimport \"../utils/postprocessing/MaskPass\";\nimport \"../utils/shaders/CopyShader\";\nimport \"../utils/shaders/VignetteShader\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nconst disabledByQueryString = qsTruthy(\"disableTunnel\");\nconst CLAMP_SPEED = 0.01;\nconst CLAMP_RADIUS = 0.001;\nconst NO_TUNNEL_RADIUS = 10.0;\nconst NO_TUNNEL_SOFTNESS = 0.0;\n\nfunction lerp(start, end, t) {\n  return (1 - t) * start + t * end;\n}\n\nfunction f(t) {\n  const x = t - 1;\n  return 1 + x * x * x * x * x;\n}\n\nAFRAME.registerSystem(\"tunneleffect\", {\n  schema: {\n    targetComponent: { type: \"string\", default: \"character-controller\" },\n    radius: { type: \"number\", default: 1.0, min: 0.25 },\n    minRadius: { type: \"number\", default: 0.25, min: 0.1 },\n    maxSpeed: { type: \"number\", default: 0.5, min: 0.1 },\n    softest: { type: \"number\", default: 0.1, min: 0.0 },\n    opacity: { type: \"number\", default: 1, min: 0.0 }\n  },\n\n  init: function() {\n    this.scene = this.el;\n    this.isMoving = false;\n    this.isVR = false;\n    this.dt = 0;\n    this.isPostProcessingReady = false;\n    this.characterEl = document.querySelector(`a-entity[${this.data.targetComponent}]`);\n    if (this.characterEl) {\n      this._initPostProcessing = this._initPostProcessing.bind(this);\n      this.characterEl.addEventListener(\"componentinitialized\", this._initPostProcessing);\n    } else {\n      console.warn(\"Could not find target component.\");\n    }\n    this._enterVR = this._enterVR.bind(this);\n    this._exitVR = this._exitVR.bind(this);\n    this.scene.addEventListener(\"enter-vr\", this._enterVR);\n    this.scene.addEventListener(\"exit-vr\", this._exitVR);\n  },\n\n  pause: function() {\n    if (!this.characterEl) {\n      return;\n    }\n    this.characterEl.removeEventListener(\"componentinitialized\", this._initPostProcessing);\n    this.scene.removeEventListener(\"enter-vr\", this._enterVR);\n    this.scene.removeEventListener(\"exit-vr\", this._exitVR);\n  },\n\n  play: function() {\n    this.scene.addEventListener(\"enter-vr\", this._enterVR);\n    this.scene.addEventListener(\"exit-vr\", this._exitVR);\n  },\n\n  tick: function(t, dt) {\n    this.dt = dt;\n\n    if (disabledByQueryString || !this.isPostProcessingReady || !this.isVR) {\n      return;\n    }\n\n    const { maxSpeed, minRadius, softest } = this.data;\n    const characterSpeed = this.characterComponent.velocity.length();\n    const shaderRadius = this.vignettePass.uniforms[\"radius\"].value || NO_TUNNEL_RADIUS;\n    if (!this.enabled && characterSpeed > CLAMP_SPEED) {\n      this.enabled = true;\n      this._bindRenderFunc();\n    } else if (\n      this.enabled &&\n      characterSpeed < CLAMP_SPEED &&\n      Math.abs(NO_TUNNEL_RADIUS - shaderRadius) < CLAMP_RADIUS\n    ) {\n      this.enabled = false;\n      this._exitTunnel();\n    }\n    if (this.enabled) {\n      const clampedSpeed = characterSpeed > maxSpeed ? maxSpeed : characterSpeed;\n      const speedRatio = clampedSpeed / maxSpeed;\n      this.targetRadius = lerp(NO_TUNNEL_RADIUS, minRadius, f(speedRatio));\n      this.targetSoftness = lerp(NO_TUNNEL_SOFTNESS, softest, f(speedRatio));\n      this._updateVignettePass(this.targetRadius, this.targetSoftness, this.data.opacity);\n    }\n  },\n\n  _exitTunnel: function() {\n    this.scene.renderer.render = this.originalRenderFunc;\n    this.isMoving = false;\n  },\n\n  _initPostProcessing: function(event) {\n    if (event.detail.name === this.data.targetComponent) {\n      this.characterEl.removeEventListener(\"componentinitialized\", this._initPostProcessing);\n      this.characterComponent = this.characterEl.components[this.data.targetComponent];\n      this._initComposer();\n    }\n  },\n\n  _enterVR: function() {\n    this.isVR = true; //TODO: This is called in 2D mode when you press \"f\", which is bad\n  },\n\n  _exitVR: function() {\n    this._exitTunnel();\n    this.isVR = false;\n  },\n\n  _initComposer: function() {\n    this.renderer = this.scene.renderer;\n    this.camera = this.scene.camera;\n    this.originalRenderFunc = this.scene.renderer.render;\n    this.isDigest = false;\n    const render = this.scene.renderer.render;\n    const system = this;\n    this.postProcessingRenderFunc = function() {\n      if (system.isDigest) {\n        render.apply(this, arguments);\n      } else {\n        system.isDigest = true;\n        system.composer.render(system.dt);\n        system.isDigest = false;\n      }\n    };\n    this.composer = new THREE.EffectComposer(this.renderer);\n    this.composer.resize();\n    this.scenePass = new THREE.RenderPass(this.scene.object3D, this.camera);\n    this.vignettePass = new THREE.ShaderPass(THREE.VignetteShader);\n    this._updateVignettePass(this.data.radius, this.data.softness, this.data.opacity);\n    this.composer.addPass(this.scenePass);\n    this.composer.addPass(this.vignettePass);\n    this.isPostProcessingReady = true;\n  },\n\n  _updateVignettePass: function(radius, softness, opacity) {\n    const { width, height } = this.renderer.getSize();\n    const pixelRatio = this.renderer.getPixelRatio();\n    this.vignettePass.uniforms[\"radius\"].value = radius;\n    this.vignettePass.uniforms[\"softness\"].value = softness;\n    this.vignettePass.uniforms[\"opacity\"].value = opacity;\n    this.vignettePass[\"resolution\"] = new THREE.Uniform(new THREE.Vector2(width * pixelRatio, height * pixelRatio));\n    if (!this.vignettePass.renderToScreen) {\n      this.vignettePass.renderToScreen = true;\n    }\n  },\n\n  /**\n   * use the render func of the effect composer when we need the postprocessing\n   */\n  _bindRenderFunc: function() {\n    this.scene.renderer.render = this.postProcessingRenderFunc;\n  }\n});\n","THREE.EffectComposer = function(renderer, renderTarget) {\n  this.renderer = renderer;\n  this.delta = 0;\n  window.addEventListener(\"vrdisplaypresentchange\", this.resize.bind(this));\n\n  if (renderTarget === undefined) {\n    const parameters = {\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.LinearFilter,\n      format: THREE.RGBAFormat,\n      stencilBuffer: false\n    };\n\n    const size = renderer.getDrawingBufferSize();\n    renderTarget = new THREE.WebGLRenderTarget(size.width, size.height, parameters);\n    renderTarget.texture.name = \"EffectComposer.rt1\";\n  }\n\n  this.renderTarget1 = renderTarget;\n  this.renderTarget2 = renderTarget.clone();\n  this.renderTarget2.texture.name = \"EffectComposer.rt2\";\n\n  this.writeBuffer = this.renderTarget1;\n  this.readBuffer = this.renderTarget2;\n\n  this.passes = [];\n  this.maskActive = false;\n\n  // dependencies\n\n  if (THREE.CopyShader === undefined) {\n    console.error(\"THREE.EffectComposer relies on THREE.CopyShader\");\n  }\n\n  if (THREE.ShaderPass === undefined) {\n    console.error(\"THREE.EffectComposer relies on THREE.ShaderPass\");\n  }\n\n  this.copyPass = new THREE.ShaderPass(THREE.CopyShader);\n};\n\nObject.assign(THREE.EffectComposer.prototype, {\n  swapBuffers: function(pass) {\n    if (pass.needsSwap) {\n      if (this.maskActive) {\n        const context = this.renderer.context;\n        context.stencilFunc(context.NOTEQUAL, 1, 0xffffffff);\n        this.copyPass.render(this.renderer, this.writeBuffer, this.readBuffer, this.delta);\n        context.stencilFunc(context.EQUAL, 1, 0xffffffff);\n      }\n\n      const tmp = this.readBuffer;\n      this.readBuffer = this.writeBuffer;\n      this.writeBuffer = tmp;\n    }\n\n    if (THREE.MaskPass !== undefined) {\n      if (pass instanceof THREE.MaskPass) {\n        this.maskActive = true;\n      } else if (pass instanceof THREE.ClearMaskPass) {\n        this.maskActive = false;\n      }\n    }\n  },\n\n  addPass: function(pass) {\n    this.passes.push(pass);\n    const size = this.renderer.getDrawingBufferSize();\n    pass.setSize(size.width, size.height);\n  },\n\n  insertPass: function(pass, index) {\n    this.passes.splice(index, 0, pass);\n  },\n\n  render: function(delta, starti) {\n    const maskActive = this.maskActive;\n    let pass;\n    let i;\n    const il = this.passes.length;\n    const scope = this;\n    let currentOnAfterRender;\n    this.delta = delta;\n\n    for (i = starti || 0; i < il; i++) {\n      pass = this.passes[i];\n      if (pass.enabled === false) continue;\n\n      // If VR mode is enabled and rendering the whole scene is required.\n      // The pass renders the scene and and postprocessing is resumed before\n      // submitting the frame to the headset by using the onAfterRender callback.\n      if (this.renderer.vr.enabled && pass.scene) {\n        currentOnAfterRender = pass.scene.onAfterRender;\n        pass.scene.onAfterRender = function() {\n          // Disable stereo rendering when doing postprocessing\n          // on a render target.\n          scope.renderer.vr.enabled = false;\n          scope.render(delta, i + 1, maskActive);\n\n          // Renable vr mode.\n          scope.renderer.vr.enabled = true;\n        };\n\n        pass.render(this.renderer, this.writeBuffer, this.readBuffer);\n\n        // Restore onAfterRender\n        pass.scene.onAfterRender = currentOnAfterRender;\n        this.swapBuffers(pass);\n        return;\n      }\n\n      pass.render(this.renderer, this.writeBuffer, this.readBuffer);\n      this.swapBuffers(pass);\n    }\n  },\n\n  reset: function(renderTarget) {\n    if (renderTarget === undefined) {\n      const size = this.renderer.getDrawingBufferSize();\n      renderTarget = this.renderTarget1.clone();\n      renderTarget.setSize(size.width, size.height);\n    }\n\n    this.renderTarget1.dispose();\n    this.renderTarget2.dispose();\n    this.renderTarget1 = renderTarget;\n    this.renderTarget2 = renderTarget.clone();\n\n    this.writeBuffer = this.renderTarget1;\n    this.readBuffer = this.renderTarget2;\n  },\n\n  setSize: function(width, height) {\n    this.renderTarget1.setSize(width, height);\n    this.renderTarget2.setSize(width, height);\n    for (let i = 0; i < this.passes.length; i++) {\n      this.passes[i].setSize(width, height);\n    }\n  },\n\n  resize: function() {\n    const rendererSize = this.renderer.getDrawingBufferSize();\n    this.setSize(rendererSize.width, rendererSize.height);\n  }\n});\n\nTHREE.Pass = function() {\n  // if set to true, the pass is processed by the composer\n  this.enabled = true;\n\n  // if set to true, the pass indicates to swap read and write buffer after rendering\n  this.needsSwap = true;\n\n  // if set to true, the pass clears its buffer before rendering\n  this.clear = false;\n\n  // if set to true, the result of the pass is rendered to screen\n  this.renderToScreen = false;\n};\n\nObject.assign(THREE.Pass.prototype, {\n  setSize: function() {},\n\n  render: function() {\n    console.error(\"THREE.Pass: .render() must be implemented in derived pass.\");\n  }\n});\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.RenderPass = function(scene, camera, overrideMaterial, clearColor, clearAlpha) {\n  THREE.Pass.call(this);\n\n  this.scene = scene;\n  this.camera = camera;\n\n  this.overrideMaterial = overrideMaterial;\n\n  this.clearColor = clearColor;\n  this.clearAlpha = clearAlpha !== undefined ? clearAlpha : 0;\n\n  this.clear = true;\n  this.clearDepth = false;\n  this.needsSwap = false;\n};\n\nTHREE.RenderPass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {\n  constructor: THREE.RenderPass,\n\n  render: function(renderer, writeBuffer, readBuffer) {\n    const oldAutoClear = renderer.autoClear;\n    renderer.autoClear = false;\n\n    this.scene.overrideMaterial = this.overrideMaterial;\n\n    let oldClearColor, oldClearAlpha;\n\n    if (this.clearColor) {\n      oldClearColor = renderer.getClearColor().getHex();\n      oldClearAlpha = renderer.getClearAlpha();\n\n      renderer.setClearColor(this.clearColor, this.clearAlpha);\n    }\n\n    if (this.clearDepth) {\n      renderer.clearDepth();\n    }\n\n    renderer.render(this.scene, this.camera, this.renderToScreen ? null : readBuffer, this.clear);\n\n    if (this.clearColor) {\n      renderer.setClearColor(oldClearColor, oldClearAlpha);\n    }\n\n    this.scene.overrideMaterial = null;\n    renderer.autoClear = oldAutoClear;\n  }\n});\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.ShaderPass = function(shader, textureID) {\n  THREE.Pass.call(this);\n  this.textureID = textureID !== undefined ? textureID : \"tDiffuse\";\n  if (shader instanceof THREE.ShaderMaterial) {\n    this.uniforms = shader.uniforms;\n    this.material = shader;\n  } else if (shader) {\n    this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);\n    this.material = new THREE.ShaderMaterial({\n      defines: Object.assign({}, shader.defines),\n      uniforms: this.uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader\n    });\n  }\n\n  this.camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);\n  this.scene = new THREE.Scene();\n\n  this.quad = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), null);\n  this.quad.frustumCulled = false; // Avoid getting clipped\n  this.scene.add(this.quad);\n};\n\nTHREE.ShaderPass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {\n  constructor: THREE.ShaderPass,\n  render: function(renderer, writeBuffer, readBuffer) {\n    if (this.uniforms[this.textureID]) {\n      this.uniforms[this.textureID].value = readBuffer.texture;\n    }\n\n    this.quad.material = this.material;\n\n    if (this.renderToScreen) {\n      renderer.render(this.scene, this.camera);\n    } else {\n      renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n    }\n  }\n});\n","/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.MaskPass = function(scene, camera) {\n  THREE.Pass.call(this);\n\n  this.scene = scene;\n  this.camera = camera;\n\n  this.clear = true;\n  this.needsSwap = false;\n\n  this.inverse = false;\n};\n\nTHREE.MaskPass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {\n  constructor: THREE.MaskPass,\n\n  render: function(renderer, writeBuffer, readBuffer) {\n    const context = renderer.context;\n    const state = renderer.state;\n\n    // don't update color or depth\n\n    state.buffers.color.setMask(false);\n    state.buffers.depth.setMask(false);\n\n    // lock buffers\n\n    state.buffers.color.setLocked(true);\n    state.buffers.depth.setLocked(true);\n\n    // set up stencil\n\n    let writeValue, clearValue;\n\n    if (this.inverse) {\n      writeValue = 0;\n      clearValue = 1;\n    } else {\n      writeValue = 1;\n      clearValue = 0;\n    }\n\n    state.buffers.stencil.setTest(true);\n    state.buffers.stencil.setOp(context.REPLACE, context.REPLACE, context.REPLACE);\n    state.buffers.stencil.setFunc(context.ALWAYS, writeValue, 0xffffffff);\n    state.buffers.stencil.setClear(clearValue);\n\n    // draw into the stencil buffer\n\n    renderer.render(this.scene, this.camera, readBuffer, this.clear);\n    renderer.render(this.scene, this.camera, writeBuffer, this.clear);\n\n    // unlock color and depth buffer for subsequent rendering\n\n    state.buffers.color.setLocked(false);\n    state.buffers.depth.setLocked(false);\n\n    // only render where stencil is set to 1\n\n    state.buffers.stencil.setFunc(context.EQUAL, 1, 0xffffffff); // draw if == 1\n    state.buffers.stencil.setOp(context.KEEP, context.KEEP, context.KEEP);\n  }\n});\n\nTHREE.ClearMaskPass = function() {\n  THREE.Pass.call(this);\n\n  this.needsSwap = false;\n};\n\nTHREE.ClearMaskPass.prototype = Object.create(THREE.Pass.prototype);\n\nObject.assign(THREE.ClearMaskPass.prototype, {\n  render: function(renderer) {\n    renderer.state.buffers.stencil.setTest(false);\n  }\n});\n","/**\n * @author alteredq / http://alteredqualia.com/\n *\n * Full-screen textured quad shader\n */\n\nTHREE.CopyShader = {\n  uniforms: {\n    tDiffuse: { value: null },\n    opacity: { value: 1.0 }\n  },\n\n  vertexShader: [\n    \"varying vec2 vUv;\",\n\n    \"void main() {\",\n\n    \"vUv = uv;\",\n    \"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n    \"}\"\n  ].join(\"\\n\"),\n\n  fragmentShader: [\n    \"uniform float opacity;\",\n\n    \"uniform sampler2D tDiffuse;\",\n\n    \"varying vec2 vUv;\",\n\n    \"void main() {\",\n\n    \"vec4 texel = texture2D( tDiffuse, vUv );\",\n    \"gl_FragColor = opacity * texel;\",\n\n    \"}\"\n  ].join(\"\\n\")\n};\n","THREE.VignetteShader = {\n  uniforms: {\n    tDiffuse: { value: null },\n    radius: { value: 0.65 },\n    opacity: { value: 0.9 },\n    softness: { value: 0.2 },\n    resolution: new THREE.Uniform(new THREE.Vector2(1920, 1080))\n  },\n\n  vertexShader: [\n    \"varying vec2 vUv;\",\n    \"void main() {\",\n    \"vUv = uv;\",\n    \"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n    \"}\"\n  ].join(\"\\n\"),\n\n  fragmentShader: [\n    \"uniform sampler2D tDiffuse;\",\n    \"uniform float radius;\",\n    \"uniform float opacity;\",\n    \"uniform float softness;\",\n    \"uniform vec2 resolution;\",\n\n    \"varying vec2 vUv;\",\n\n    \"void main() {\",\n    \"vec4 texel = texture2D( tDiffuse, vUv);\",\n    \"float ratio = resolution.x / resolution.y;\",\n    \"float centerXOffset = radius / ratio;\",\n    \"float leftX = (0.3 + centerXOffset >= 0.5) ? 0.5 - centerXOffset : 0.3;\",\n    \"float rightX = (0.7 - centerXOffset <= 0.5) ? 0.5 + centerXOffset : 0.7;\",\n    \"vec2 uvLeft = (vUv.xy) - vec2(leftX, 0.5);\",\n    \"vec2 uvRight = (vUv.xy) - vec2(rightX, 0.5);\",\n    \"uvLeft.x *= ratio;\",\n    \"uvRight.x *= ratio;\",\n    \"float lenLeft = length(uvLeft);\",\n    \"float lenRight = length(uvRight);\",\n    \"float vignetteLeft = smoothstep(radius, radius-softness, lenLeft);\",\n    \"float vignetteRight = smoothstep(radius, radius-softness, lenRight);\",\n    \"float vignette = vignetteLeft + vignetteRight;\",\n    \"vec3 final = mix (texel.rgb, texel.rgb * vignette, opacity);\",\n    \"gl_FragColor = vec4(final.rgb, 1.0);\",\n    \"}\"\n  ].join(\"\\n\")\n};\n","/**\n * Pen tool\n * A tool that allows drawing on networked-drawing components.\n * @namespace drawing\n * @component pen\n */\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"pen\", {\n  schema: {\n    drawFrequency: { default: 5 }, //frequency of polling for drawing points\n    minDistanceBetweenPoints: { default: 0.01 }, //minimum distance to register new drawing point\n    camera: { type: \"selector\" },\n    drawingManager: { type: \"string\" },\n    color: { type: \"color\", default: \"#FF0033\" },\n    availableColors: {\n      default: [\n        \"#FF0033\",\n        \"#FFFF00\",\n        \"#0099FF\",\n        \"#00FF33\",\n        \"#9900FF\",\n        \"#FF6600\",\n        \"#8D5524\",\n        \"#C68642\",\n        \"#E0AC69\",\n        \"#F1C27D\",\n        \"#FFDBAC\",\n        \"#FFFFFF\",\n        \"#222222\",\n        \"#111111\",\n        \"#000000\"\n      ]\n    },\n    radius: { default: 0.01 }, //drawing geometry radius\n    minRadius: { default: 0.005 },\n    maxRadius: { default: 0.2 }\n  },\n\n  init() {\n    this._stateAdded = this._stateAdded.bind(this);\n    this._stateRemoved = this._stateRemoved.bind(this);\n\n    this.timeSinceLastDraw = 0;\n\n    this.lastPosition = new THREE.Vector3();\n    this.lastPosition.copy(this.el.object3D.position);\n\n    this.direction = new THREE.Vector3(1, 0, 0);\n\n    this.currentDrawing = null;\n\n    this.normal = new THREE.Vector3();\n\n    this.worldPosition = new THREE.Vector3();\n\n    this.colorIndex = 0;\n\n    this.grabbed = false;\n  },\n\n  play() {\n    this.drawingManager = document.querySelector(this.data.drawingManager).components[\"drawing-manager\"];\n\n    this.el.parentNode.addEventListener(\"stateadded\", this._stateAdded);\n    this.el.parentNode.addEventListener(\"stateremoved\", this._stateRemoved);\n  },\n\n  pause() {\n    this.el.parentNode.removeEventListener(\"stateadded\", this._stateAdded);\n    this.el.parentNode.removeEventListener(\"stateremoved\", this._stateRemoved);\n  },\n\n  update(prevData) {\n    if (prevData.color != this.data.color) {\n      this.el.setAttribute(\"color\", this.data.color);\n    }\n    if (prevData.radius != this.data.radius) {\n      this.el.setAttribute(\"radius\", this.data.radius);\n    }\n  },\n\n  tick(t, dt) {\n    this.el.object3D.getWorldPosition(this.worldPosition);\n\n    if (!almostEquals(0.005, this.worldPosition, this.lastPosition)) {\n      this.direction.subVectors(this.worldPosition, this.lastPosition).normalize();\n      this.lastPosition.copy(this.worldPosition);\n    }\n\n    if (this.currentDrawing) {\n      const time = this.timeSinceLastDraw + dt;\n      if (\n        time >= this.data.drawFrequency &&\n        this.currentDrawing.getLastPoint().distanceTo(this.worldPosition) >= this.data.minDistanceBetweenPoints\n      ) {\n        this._getNormal(this.normal, this.worldPosition, this.direction);\n        this.currentDrawing.draw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n      }\n\n      this.timeSinceLastDraw = time % this.data.drawFrequency;\n    }\n  },\n\n  //helper function to get normal of direction of drawing cross direction to camera\n  _getNormal: (() => {\n    const directionToCamera = new THREE.Vector3();\n    return function(normal, position, direction) {\n      directionToCamera.subVectors(position, this.data.camera.object3D.position).normalize();\n      normal.crossVectors(direction, directionToCamera);\n    };\n  })(),\n\n  _startDraw() {\n    this.currentDrawing = this.drawingManager.getDrawing(this);\n    if (this.currentDrawing) {\n      this.el.object3D.getWorldPosition(this.worldPosition);\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n\n      this.currentDrawing.startDraw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n    }\n  },\n\n  _endDraw() {\n    if (this.currentDrawing) {\n      this.timeSinceLastDraw = 0;\n      this.el.object3D.getWorldPosition(this.worldPosition);\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.endDraw(this.worldPosition, this.direction, this.normal);\n      this.drawingManager.returnDrawing(this);\n      this.currentDrawing = null;\n    }\n  },\n\n  _changeColor(mod) {\n    this.colorIndex = (this.colorIndex + mod + this.data.availableColors.length) % this.data.availableColors.length;\n    this.data.color = this.data.availableColors[this.colorIndex];\n    this.el.setAttribute(\"color\", this.data.color);\n  },\n\n  _changeRadius(mod) {\n    this.data.radius = Math.max(this.data.minRadius, Math.min(this.data.radius + mod, this.data.maxRadius));\n    this.el.setAttribute(\"radius\", this.data.radius);\n  },\n\n  _stateAdded(evt) {\n    switch (evt.detail) {\n      case \"activated\":\n        this._startDraw();\n        break;\n      case \"colorNext\":\n        this._changeColor(1);\n        break;\n      case \"colorPrev\":\n        this._changeColor(-1);\n        break;\n      case \"radiusUp\":\n        this._changeRadius(this.data.minRadius);\n        break;\n      case \"radiusDown\":\n        this._changeRadius(-this.data.minRadius);\n        break;\n      case \"grabbed\":\n        this.grabbed = true;\n        break;\n      default:\n        break;\n    }\n  },\n\n  _stateRemoved(evt) {\n    switch (evt.detail) {\n      case \"activated\":\n        this._endDraw();\n        break;\n      case \"grabbed\":\n        this.grabbed = false;\n        this._endDraw();\n        break;\n      default:\n        break;\n    }\n  }\n});\n","/* global THREE */\n/**\n * Networked Drawing\n * Creates procedurally generated 'lines' (or tubes) that are networked.\n * @namespace drawing\n * @component networked-drawing\n */\n\nimport SharedBufferGeometryManager from \"../../utils/sharedbuffergeometrymanager\";\n\nconst MSG_CONFIRM_CONNECT = 0;\nconst MSG_BUFFER_DATA = 1;\nconst MSG_BUFFER_DATA_FULL = 2;\n\nfunction copyData(fromArray, toArray, fromIndex, toIndex) {\n  let i = fromIndex - 1;\n  let j = -1;\n  while (i + 1 <= toIndex) {\n    toArray[++j] = fromArray[++i];\n  }\n}\n\nAFRAME.registerComponent(\"networked-drawing\", {\n  schema: {\n    segments: { default: 8 }, //the number of \"sides\" the procedural tube should have\n    defaultRadius: { default: 0.01 }, //the radius of the procedural tube\n    minDrawTimeout: { default: 5000 }, //the minimum time a drawn line will live\n    maxDrawTimeout: { default: 600000 }, //the maximum time a drawn line will live\n    maxLines: { default: 50 }, //how many lines can persist before lines older than minDrawTime are removed\n    maxPointsPerLine: { default: 250 } //the max number of points a single line can have\n  },\n\n  init() {\n    this._receiveData = this._receiveData.bind(this);\n\n    this.networkBuffer = [];\n\n    this.sendNetworkBufferQueue = [];\n\n    this.drawStarted = false;\n    this.lineStarted = false;\n    this.remoteLineStarted = false;\n\n    this.receivedBufferParts = 0;\n    this.bufferIndex = 0;\n    this.connectedToOwner = false;\n    this.networkBufferInitialized = false;\n\n    const options = {\n      vertexColors: THREE.VertexColors\n    };\n\n    this.color = new THREE.Color();\n    this.radius = this.data.defaultRadius;\n    this.segments = this.data.segments;\n\n    const material = new THREE.MeshStandardMaterial(options);\n    this.sharedBufferGeometryManager = new SharedBufferGeometryManager();\n    this.sharedBufferGeometryManager.addSharedBuffer(0, material, THREE.TriangleStripDrawMode);\n\n    this.lastPoint = new THREE.Vector3();\n\n    this.lastSegments = [];\n    this.currentSegments = [];\n    for (let x = 0; x < this.segments; x++) {\n      this.lastSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n      this.currentSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n    }\n\n    this.sharedBuffer = this.sharedBufferGeometryManager.getSharedBuffer(0);\n    this.drawing = this.sharedBuffer.drawing;\n    const sceneEl = document.querySelector(\"a-scene\");\n    this.scene = sceneEl.object3D;\n    this.scene.add(this.drawing);\n\n    this.prevIdx = Object.assign({}, this.sharedBuffer.idx);\n    this.idx = Object.assign({}, this.sharedBuffer.idx);\n    this.vertexCount = 0; //number of vertices added for current line (used for line deletion).\n    this.networkBufferCount = 0; //number of items added to networkBuffer for current line (used for line deletion).\n    this.currentPointCount = 0; //number of points added for current line (used for maxPointsPerLine).\n    this.networkBufferHistory = []; //tracks vertexCount and networkBufferCount so that lines can be deleted.\n\n    NAF.connection.onConnect(() => {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n        this.networkedEl = networkedEl;\n        this.networkId = NAF.utils.getNetworkId(this.networkedEl);\n        this.drawingId = \"drawing-\" + this.networkId;\n        NAF.connection.subscribeToDataChannel(this.drawingId, this._receiveData);\n      });\n    });\n  },\n\n  remove() {\n    NAF.connection.unsubscribeToDataChannel(this.drawingId, this._receiveData);\n\n    this.scene.remove(this.drawing);\n  },\n\n  tick() {\n    const connected = NAF.connection.isConnected() && this.networkedEl;\n    const isMine = connected && NAF.utils.isMine(this.networkedEl);\n\n    if (!this.connectedToOwner && connected) {\n      const owner = NAF.utils.getNetworkOwner(this.networkedEl);\n      if (!isMine && NAF.connection.hasActiveDataChannel(owner)) {\n        NAF.connection.sendDataGuaranteed(owner, this.drawingId, {\n          type: MSG_CONFIRM_CONNECT,\n          clientId: NAF.clientId\n        });\n        this.connectedToOwner = true;\n      }\n    }\n\n    if (this.networkBuffer.length > 0 && connected) {\n      if (!isMine) {\n        this._drawFromNetwork();\n      } else if (this.bufferIndex < this.networkBuffer.length) {\n        this._broadcastDrawing();\n      }\n    }\n\n    //TODO: handle possibility that a clientId gets stuck in sendNetworkBufferQueue\n    //if that client disconnects before this executes and an activeDataChannel is opened.\n    if (isMine && this.sendNetworkBufferQueue.length > 0) {\n      const connected = [];\n      for (let i = 0; i < this.sendNetworkBufferQueue.length; i++) {\n        if (NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[i])) {\n          connected.push(this.sendNetworkBufferQueue[i]);\n        }\n      }\n      for (let j = 0; j < connected.length; j++) {\n        const pos = this.sendNetworkBufferQueue.indexOf(connected[j]);\n        this._sendNetworkBuffer(connected[j]);\n        this.sendNetworkBufferQueue.splice(pos, 1);\n      }\n    }\n\n    this._deleteLines();\n  },\n\n  _broadcastDrawing: (() => {\n    const copyArray = [];\n    return function() {\n      copyArray.length = 0;\n      copyData(this.networkBuffer, copyArray, this.bufferIndex, this.networkBuffer.length - 1);\n      this.bufferIndex = this.networkBuffer.length;\n      NAF.connection.broadcastDataGuaranteed(this.drawingId, { type: MSG_BUFFER_DATA, buffer: copyArray });\n    };\n  })(),\n\n  _drawFromNetwork: (() => {\n    const position = new THREE.Vector3();\n    const direction = new THREE.Vector3();\n    const normal = new THREE.Vector3();\n    return function() {\n      const head = this.networkBuffer[0];\n      let didWork = false;\n      while (head != null && this.networkBuffer.length >= 10) {\n        position.set(this.networkBuffer[0], this.networkBuffer[1], this.networkBuffer[2]);\n        direction.set(this.networkBuffer[3], this.networkBuffer[4], this.networkBuffer[5]);\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\n        direction.normalize();\n        normal.set(this.networkBuffer[6], this.networkBuffer[7], this.networkBuffer[8]);\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\n        normal.normalize();\n\n        this.networkBuffer.splice(0, 9);\n\n        if (!this.remoteLineStarted) {\n          this.startDraw(position, direction, normal);\n          this.remoteLineStarted = true;\n        }\n\n        if (this.networkBuffer[0] === null) {\n          this._endDraw(position, direction, normal);\n          this.remoteLineStarted = false;\n          this.networkBuffer.shift();\n        } else {\n          this._draw(position, direction, normal);\n          didWork = true;\n        }\n      }\n      if (didWork) this._updateBuffer();\n    };\n  })(),\n\n  _deleteLines() {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const now = Date.now();\n      const time = this.networkBufferHistory[0].time;\n      if (\n        (length > this.data.maxLines && time + this.data.minDrawTimeout <= now) ||\n        time + this.data.maxDrawTimeout <= now\n      ) {\n        const datum = this.networkBufferHistory[0];\n        if (length > 1) {\n          datum.idxLength += 2 - (this.segments % 2);\n          this.networkBufferHistory[1].idxLength -= 2 - (this.segments % 2);\n        }\n        this.idx.position = datum.idxLength;\n        this.idx.uv = datum.idxLength;\n        this.idx.normal = datum.idxLength;\n        this.idx.color = datum.idxLength;\n        this.sharedBuffer.remove(this.prevIdx, this.idx);\n        this.networkBufferHistory.shift();\n        if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n          this.networkBuffer.splice(0, datum.networkBufferCount);\n          this.bufferIndex -= datum.networkBufferCount;\n        }\n      }\n    }\n  },\n\n  _sendNetworkBuffer: (() => {\n    const copyArray = [];\n    //This number needs to be approx. < ~6000 based on napkin math\n    //see: https://github.com/webrtc/adapter/blob/682e0f2439e139da6c0c406370eae820637b8sc1a/src/js/common_shim.js#L157\n    const chunkAmount = 3000;\n    return function(clientId) {\n      if (NAF.utils.isMine(this.networkedEl)) {\n        if (this.networkBuffer.length <= chunkAmount) {\n          NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n            type: MSG_BUFFER_DATA_FULL,\n            parts: 1,\n            buffer: this.networkBuffer\n          });\n        } else {\n          let start = 0;\n          let end = 0;\n          while (end < this.networkBuffer.length) {\n            end = Math.min(end + chunkAmount, this.networkBuffer.length);\n            copyArray.length = 0;\n            copyData(this.networkBuffer, copyArray, start, end - 1);\n            start = end;\n            NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n              type: MSG_BUFFER_DATA_FULL,\n              parts: Math.ceil(this.networkBuffer.length / chunkAmount),\n              buffer: copyArray\n            });\n          }\n        }\n      }\n    };\n  })(),\n\n  _receiveData(_, dataType, data) {\n    switch (data.type) {\n      case MSG_CONFIRM_CONNECT:\n        this.sendNetworkBufferQueue.push(data.clientId);\n        break;\n      case MSG_BUFFER_DATA:\n        if (this.networkBufferInitialized) {\n          this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        }\n        break;\n      case MSG_BUFFER_DATA_FULL:\n        this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        if (++this.receivedBufferParts >= data.parts) {\n          this.networkBufferInitialized = true;\n        }\n        break;\n    }\n  },\n\n  getLastPoint() {\n    return this.lastPoint;\n  },\n\n  startDraw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected()) {\n      return;\n    }\n\n    this.drawStarted = true;\n\n    if (color) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this.lastPoint.copy(position);\n    this._addToNetworkBuffer(position, direction, normal);\n  },\n\n  draw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected() || !this.drawStarted) {\n      return;\n    }\n\n    if (color && color != \"#\" + this.color.getHexString().toUpperCase()) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this._addToNetworkBuffer(position, direction, normal);\n    this._draw(position, direction, normal);\n\n    this._updateBuffer();\n  },\n\n  _draw: (() => {\n    const capNormal = new THREE.Vector3();\n    return function(position, direction, normal, radiusMultiplier = 1.0) {\n      if (!this.lineStarted) {\n        this._generateSegments(this.lastSegments, position, direction, normal, this.radius * radiusMultiplier);\n\n        if (this.networkBufferHistory.length === 0) {\n          //start with CW faceculling order\n          this._addDegenerateTriangle();\n        } else {\n          //only do the following if the sharedBuffer is not empty\n          this._restartPrimitive();\n          this._addDegenerateTriangle();\n          if (this.segments % 2 === 0) {\n            //flip faceculling order if even numbered segments\n            this._addDegenerateTriangle();\n          }\n        }\n\n        //get normal for tip of cap\n        capNormal.copy(direction).negate();\n        //get normals for rim of cap\n        for (let i = 0; i < this.segments; i++) {\n          this.lastSegments[i].normal.add(capNormal).multiplyScalar(0.5);\n        }\n\n        this._drawCap(this.lastPoint, this.lastSegments, capNormal);\n        if (this.segments % 2 !== 0) {\n          //flip faceculling order if odd numbered segments\n          this._addDegenerateTriangle();\n        }\n\n        this.lineStarted = true;\n      } else {\n        this._generateSegments(this.currentSegments, position, direction, normal, this.radius * radiusMultiplier);\n        this._drawCylinder();\n\n        if (this.currentPointCount > this.data.maxPointsPerLine) {\n          this._drawEndCap(position, direction);\n          this._endLine();\n        }\n      }\n      this.lastPoint.copy(position);\n    };\n  })(),\n\n  endDraw(position, direction, normal) {\n    this._endDraw(position, direction, normal);\n    this._updateBuffer();\n  },\n\n  _endDraw(position, direction, normal) {\n    if (!this.lineStarted && this.drawStarted) {\n      this._drawPoint(position);\n    } else if (this.lineStarted && this.drawStarted) {\n      this._addToNetworkBuffer(position, direction, normal);\n      this._draw(position, direction, normal);\n      this._drawEndCap(position, direction);\n    }\n    this._endLine();\n  },\n\n  _drawEndCap: (() => {\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position, direction) {\n      if (this.lineStarted && this.drawStarted) {\n        projectedDirection.copy(direction).multiplyScalar(this.radius);\n        projectedPoint.copy(position).add(projectedDirection);\n        this._addDegenerateTriangle(); //flip faceculling order before drawing end-cap\n        this._drawCap(projectedPoint, this.lastSegments, direction);\n      }\n    };\n  })(),\n\n  _endLine() {\n    if (!this.drawStarted) return;\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) this._pushToNetworkBuffer(null);\n\n    const datum = {\n      networkBufferCount: this.networkBufferCount,\n      idxLength: this.vertexCount - 1,\n      time: Date.now()\n    };\n    this.networkBufferHistory.push(datum);\n    this.vertexCount = 0;\n    this.networkBufferCount = 0;\n    this.currentPointCount = 0;\n    this.lineStarted = false;\n    this.drawStarted = false;\n  },\n\n  _addToNetworkBuffer: (() => {\n    const copyDirection = new THREE.Vector3();\n    const copyNormal = new THREE.Vector3();\n    return function(position, direction, normal) {\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        ++this.currentPointCount;\n        this._pushToNetworkBuffer(position.x);\n        this._pushToNetworkBuffer(position.y);\n        this._pushToNetworkBuffer(position.z);\n        copyDirection.copy(direction);\n        copyDirection.setLength(this.radius); //encode radius as length of direction vector\n        this._pushToNetworkBuffer(copyDirection.x);\n        this._pushToNetworkBuffer(copyDirection.y);\n        this._pushToNetworkBuffer(copyDirection.z);\n        copyNormal.copy(normal);\n        copyNormal.setLength(this.color.getHex() + 1); //encode color as length, add one in case color is black\n        this._pushToNetworkBuffer(copyNormal.x);\n        this._pushToNetworkBuffer(copyNormal.y);\n        this._pushToNetworkBuffer(copyNormal.z);\n      }\n    };\n  })(),\n\n  _pushToNetworkBuffer(val) {\n    ++this.networkBufferCount;\n    this.networkBuffer.push(val);\n  },\n\n  //draw a cylinder from last to current segments\n  _drawCylinder() {\n    //average the normals with the normals from the lastSegment\n    //not a perfect normal calculation, but works well enough\n    for (let i = 0; i < this.segments; i++) {\n      this.currentSegments[i].normal.add(this.lastSegments[i].normal).multiplyScalar(0.5);\n    }\n\n    for (let i = 0; i != this.segments + 1; i++) {\n      this._addVertex(this.lastSegments[i % this.segments]);\n      this._addVertex(this.currentSegments[i % this.segments]);\n    }\n\n    for (let i = 0; i < this.segments; i++) {\n      this.lastSegments[i].position.copy(this.currentSegments[i].position);\n      this.lastSegments[i].normal.copy(this.currentSegments[i].normal);\n    }\n  },\n\n  //draw a standalone point in space\n  _drawPoint: (() => {\n    const up = new THREE.Vector3(0, 1, 0);\n    const down = new THREE.Vector3(0, -1, 0);\n    const left = new THREE.Vector3(1, 0, 0);\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position) {\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n      this.lastPoint.copy(projectedPoint);\n\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      this._draw(position, down, left);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n\n      this._addDegenerateTriangle(); //discarded\n      this._drawCap(projectedPoint, this.lastSegments, down);\n    };\n  })(),\n\n  //draw a cap to start/end a line\n  _drawCap(point, segments, normal) {\n    let segmentIndex = 0;\n    for (let i = 0; i < this.segments * 2 - (this.segments % 2); i++) {\n      if ((i - 2) % 4 === 0) {\n        this._addVertex({ position: point, normal: normal });\n      } else {\n        this._addVertex(segments[segmentIndex % this.segments]);\n        if ((i + 1) % 5 !== 0) {\n          ++segmentIndex;\n        }\n      }\n    }\n  },\n\n  _restartPrimitive() {\n    this.sharedBuffer.restartPrimitive();\n    ++this.vertexCount;\n  },\n\n  _updateBuffer() {\n    this.sharedBuffer.update();\n  },\n\n  _addVertex(segment) {\n    const point = segment.position;\n    const normal = segment.normal;\n    this.sharedBuffer.addVertex(point.x, point.y, point.z);\n    this.sharedBuffer.addColor(this.color.r, this.color.g, this.color.b);\n\n    if (normal) {\n      this.sharedBuffer.addNormal(normal.x, normal.y, normal.z);\n    } else {\n      ++this.sharedBuffer.idx.normal;\n    }\n\n    ++this.sharedBuffer.idx.uv;\n    ++this.vertexCount;\n  },\n\n  _addDegenerateTriangle() {\n    this._addVertex(this.lastSegments[0]);\n  },\n\n  //calculate the segments for a given point\n  _generateSegments(segmentsList, point, forward, up, radius) {\n    const angleIncrement = (Math.PI * 2) / this.segments;\n    for (let i = 0; i < this.segments; i++) {\n      const segment = segmentsList[i].position;\n      this._rotatePointAroundAxis(segment, point, forward, up, angleIncrement * i, radius);\n      segmentsList[i].normal.subVectors(segment, point).normalize();\n    }\n  },\n\n  _rotatePointAroundAxis: (() => {\n    const calculatedDirection = new THREE.Vector3();\n    return function(out, point, axis, up, angle, radius) {\n      calculatedDirection.copy(up);\n      calculatedDirection.applyAxisAngle(axis, angle);\n      out.copy(point).add(calculatedDirection.normalize().multiplyScalar(radius));\n    };\n  })()\n});\n","import SharedBufferGeometry from \"./sharedbuffergeometry\";\n\nexport default class SharedBufferGeometryManager {\n  constructor() {\n    this.sharedBuffers = {};\n  }\n\n  addSharedBuffer(name, material, primitiveMode) {\n    this.sharedBuffers[name] = new SharedBufferGeometry(material, primitiveMode);\n  }\n\n  getSharedBuffer(name) {\n    return this.sharedBuffers[name];\n  }\n}\n","export default class SharedBufferGeometry {\n  constructor(material, primitiveMode) {\n    this.material = material;\n    this.primitiveMode = primitiveMode;\n\n    this.maxBufferSize = 1000000;\n    this.geometries = [];\n    this.current = null;\n    this.drawing = new THREE.Object3D();\n    this.addBuffer(false);\n  }\n\n  restartPrimitive() {\n    if (this.idx.position >= this.current.attributes.position.count) {\n      this.addBuffer(false);\n    } else if (this.idx.position !== 0) {\n      let prev = (this.idx.position - 1) * 3;\n      const position = this.current.attributes.position.array;\n      this.addVertex(position[prev++], position[prev++], position[prev++]);\n\n      this.idx.color++;\n      this.idx.normal++;\n    }\n  }\n\n  remove(prevIdx, idx) {\n    // Loop through all the attributes: position, color, normal,...\n    if (this.idx.position > idx.position) {\n      for (const key in this.idx) {\n        const componentSize = 3;\n        let pos = prevIdx[key] * componentSize;\n        const start = (idx[key] + 1) * componentSize;\n        const end = this.idx[key] * componentSize;\n        for (let i = start; i < end; i++) {\n          this.current.attributes[key].array[pos++] = this.current.attributes[key].array[i];\n        }\n        const diff = idx[key] - prevIdx[key] + 1;\n        this.idx[key] -= diff;\n      }\n    } else {\n      for (const key in this.idx) {\n        const diff = idx[key] - prevIdx[key];\n        this.idx[key] -= diff;\n      }\n    }\n\n    this.update();\n  }\n\n  undo(prevIdx) {\n    this.idx = prevIdx;\n    this.update();\n  }\n\n  addBuffer(copyLast) {\n    const geometry = new THREE.BufferGeometry();\n\n    const vertices = new Float32Array(this.maxBufferSize * 3);\n    const normals = new Float32Array(this.maxBufferSize * 3);\n    const colors = new Float32Array(this.maxBufferSize * 3);\n\n    const mesh = new THREE.Mesh(geometry, this.material);\n\n    mesh.drawMode = this.primitiveMode;\n\n    mesh.frustumCulled = false;\n    mesh.vertices = vertices;\n\n    const object3D = new THREE.Object3D();\n    this.drawing.add(object3D);\n    object3D.add(mesh);\n\n    geometry.setDrawRange(0, 0);\n    geometry.addAttribute(\"position\", new THREE.BufferAttribute(vertices, 3).setDynamic(true));\n    geometry.addAttribute(\"normal\", new THREE.BufferAttribute(normals, 3).setDynamic(true));\n    geometry.addAttribute(\"color\", new THREE.BufferAttribute(colors, 3).setDynamic(true));\n\n    this.previous = null;\n    if (this.geometries.length > 0) {\n      this.previous = this.current;\n    }\n\n    this.idx = {\n      position: 0,\n      normal: 0,\n      color: 0\n    };\n\n    this.geometries.push(geometry);\n    this.current = geometry;\n\n    if (this.previous && copyLast) {\n      let prev = (this.maxBufferSize - 2) * 3;\n      let col = (this.maxBufferSize - 2) * 3;\n      let norm = (this.maxBufferSize - 2) * 3;\n\n      const position = this.previous.attributes.position.array;\n      this.addVertex(position[prev++], position[prev++], position[prev++]);\n      this.addVertex(position[prev++], position[prev++], position[prev++]);\n\n      const normal = this.previous.attributes.normal.array;\n      this.addNormal(normal[norm++], normal[norm++], normal[norm++]);\n      this.addNormal(normal[norm++], normal[norm++], normal[norm++]);\n\n      const color = this.previous.attributes.color.array;\n      this.addColor(color[col++], color[col++], color[col++]);\n      this.addColor(color[col++], color[col++], color[col++]);\n    }\n  }\n\n  addColor(r, g, b) {\n    this.current.attributes.color.setXYZ(this.idx.color++, r, g, b);\n  }\n\n  addNormal(x, y, z) {\n    this.current.attributes.normal.setXYZ(this.idx.normal++, x, y, z);\n  }\n\n  addVertex(x, y, z) {\n    let buffer = this.current.attributes.position;\n    if (this.idx.position === buffer.count) {\n      this.addBuffer(true);\n      buffer = this.current.attributes.position;\n    }\n    buffer.setXYZ(this.idx.position++, x, y, z);\n  }\n\n  update() {\n    this.current.setDrawRange(0, this.idx.position);\n\n    this.current.attributes.color.needsUpdate = true;\n    this.current.attributes.normal.needsUpdate = true;\n    this.current.attributes.position.needsUpdate = true;\n  }\n}\n","/**\n * Drawing Manager\n * Manages what networked-drawings are available to pen components\n * @namespace drawing\n * @component drawing-manager\n */\nAFRAME.registerComponent(\"drawing-manager\", {\n  init() {\n    this._onComponentInitialized = this._onComponentInitialized.bind(this);\n\n    this.drawingToPen = new Map();\n\n    this.drawingEl = document.createElement(\"a-entity\");\n    this.drawingEl.setAttribute(\"networked\", \"template: #interactable-drawing\");\n    this.el.sceneEl.appendChild(this.drawingEl);\n\n    this.drawingEl.addEventListener(\"componentinitialized\", this._onComponentInitialized);\n  },\n\n  remove() {\n    this.drawingEl.removeEventListener(\"componentinitialized\", this._onComponentInitialized);\n  },\n\n  _onComponentInitialized(e) {\n    if (e.detail.name == \"networked-drawing\") {\n      this.drawing = this.drawingEl.components[\"networked-drawing\"];\n    }\n  },\n\n  getDrawing(pen) {\n    //TODO: future handling of multiple drawings\n    if (this.drawing && (!this.drawingToPen.has(this.drawing) || this.drawingToPen.get(this.drawing) === pen)) {\n      this.drawingToPen.set(this.drawing, pen);\n      return this.drawing;\n    }\n\n    return null;\n  },\n\n  returnDrawing(pen) {\n    if (this.drawingToPen.has(this.drawing) && this.drawingToPen.get(this.drawing) === pen) {\n      this.drawingToPen.delete(this.drawing);\n    }\n  }\n});\n","function registerNetworkSchemas() {\n  const vectorRequiresUpdate = epsilon => {\n    let prev = null;\n    return curr => {\n      if (prev === null) {\n        prev = new THREE.Vector3(curr.x, curr.y, curr.z);\n        return true;\n      } else if (!NAF.utils.almostEqualVec3(prev, curr, epsilon)) {\n        prev.copy(curr);\n        return true;\n      }\n      return false;\n    };\n  };\n\n  NAF.schemas.add({\n    template: \"#remote-avatar-template\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"player-info\",\n      \"networked-avatar\",\n      {\n        selector: \".camera\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".camera\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"visible\"\n      },\n      {\n        selector: \".right-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"visible\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#video-template\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"visible\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-media\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-drawing\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"networked-drawing\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#pen-interactable\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"media-loader\",\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"radius\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"color\"\n      }\n    ]\n  });\n}\n\nexport default registerNetworkSchemas;\n","const inGameActions = {\n  // Define action sets here.\n  // An action set separates \"driving\" controls from \"menu\" controls.\n  // Only one action set is active at a time.\n  default: {\n    move: { label: \"Move\" },\n    snap_rotate_left: { label: \"Snap Rotate Left\" },\n    snap_rotate_right: { label: \"Snap Rotate Right\" },\n    action_mute: { label: \"Mute\" },\n    action_teleport_down: { label: \"Teleport Aim\" },\n    action_teleport_up: { label: \"Teleport\" },\n    action_share_screen: { label: \"Share Screen\" }\n  },\n  hud: {\n    action_ui_select_down: { label: \"Select UI item\" },\n    action_ui_select_up: { label: \"Select UI item\" }\n  }\n};\n\nconst config = {\n  behaviours: {\n    default: {\n      \"oculus-touch-controls\": {\n        joystick: \"joystick_dpad4\"\n      },\n      \"vive-controls\": {\n        trackpad: \"trackpad_dpad4\",\n        trackpad_scrolling: \"trackpad_scrolling\"\n      },\n      \"windows-motion-controls\": {\n        joystick: \"joystick_dpad4\",\n        axisMoveWithDeadzone: \"msft_mr_axis_with_deadzone\"\n      },\n      \"daydream-controls\": {\n        trackpad: \"trackpad_dpad4\",\n        axisMoveWithDeadzone: \"msft_mr_axis_with_deadzone\"\n      },\n      \"gearvr-controls\": {\n        trackpad: \"trackpad_dpad4\",\n        trackpad_scrolling: \"trackpad_scrolling\"\n      },\n      \"oculus-go-controls\": {\n        trackpad: \"trackpad_dpad4\",\n        trackpad_scrolling: \"trackpad_scrolling\"\n      }\n    }\n  },\n  mappings: {\n    default: {\n      \"vive-controls\": {\n        \"trackpad.pressedmove\": { left: \"move\" },\n        trackpad_dpad4_pressed_west_down: { right: \"snap_rotate_left\" },\n        trackpad_dpad4_pressed_east_down: { right: \"snap_rotate_right\" },\n        trackpad_dpad4_pressed_center_down: { right: \"action_primary_down\" },\n        trackpad_dpad4_pressed_north_down: { right: \"action_primary_down\" },\n        trackpad_dpad4_pressed_south_down: { right: \"action_primary_down\" },\n        trackpadup: { left: \"action_primary_up\", right: \"action_primary_up\" },\n        menudown: \"thumb_down\",\n        menuup: \"thumb_up\",\n        gripdown: [\"primary_action_grab\", \"middle_ring_pinky_down\"],\n        gripup: [\"primary_action_release\", \"middle_ring_pinky_up\"],\n        trackpadtouchstart: \"thumb_down\",\n        trackpadtouchend: \"thumb_up\",\n        triggerdown: [\"secondary_action_grab\", \"index_down\"],\n        triggerup: [\"secondary_action_release\", \"index_up\"],\n        scroll: { left: \"scroll_move\", right: \"scroll_move\" }\n      },\n      \"oculus-touch-controls\": {\n        joystick_dpad4_west: { right: \"snap_rotate_left\" },\n        joystick_dpad4_east: { right: \"snap_rotate_right\" },\n        gripdown: [\"primary_action_grab\", \"middle_ring_pinky_down\"],\n        gripup: [\"primary_action_release\", \"middle_ring_pinky_up\"],\n        abuttontouchstart: [\"thumb_down\", \"increase_radius\"],\n        abuttontouchend: \"thumb_up\",\n        bbuttontouchstart: [\"thumb_down\", \"decrease_radius\"],\n        bbuttontouchend: \"thumb_up\",\n        xbuttontouchstart: [\"thumb_down\", \"increase_radius\"],\n        xbuttontouchend: \"thumb_up\",\n        ybuttontouchstart: [\"thumb_down\", \"decrease_radius\"],\n        ybuttontouchend: \"thumb_up\",\n        surfacetouchstart: [\"thumb_down\", \"next_color\"],\n        surfacetouchend: \"thumb_up\",\n        thumbsticktouchstart: \"thumb_down\",\n        thumbsticktouchend: \"thumb_up\",\n        triggerdown: [\"secondary_action_grab\", \"index_down\"],\n        triggerup: [\"secondary_action_release\", \"index_up\"],\n        \"axismove.reverseY\": { left: \"move\", right: \"scroll_move\" },\n        abuttondown: \"action_primary_down\",\n        abuttonup: \"action_primary_up\"\n      },\n      \"windows-motion-controls\": {\n        joystick_dpad4_west: {\n          right: \"snap_rotate_left\"\n        },\n        joystick_dpad4_east: {\n          right: \"snap_rotate_right\"\n        },\n        \"trackpad.pressedmove\": { left: \"move\" },\n        joystick_dpad4_pressed_west_down: { right: \"snap_rotate_left\" },\n        joystick_dpad4_pressed_east_down: { right: \"snap_rotate_right\" },\n        trackpaddown: { right: \"action_primary_down\" },\n        trackpadup: { left: \"action_primary_up\", right: \"action_primary_up\" },\n        menudown: \"thumb_down\",\n        menuup: \"thumb_up\",\n        gripdown: [\"primary_action_grab\", \"middle_ring_pinky_down\"],\n        gripup: [\"primary_action_release\", \"middle_ring_pinky_up\"],\n        trackpadtouchstart: \"thumb_down\",\n        trackpadtouchend: \"thumb_up\",\n        triggerdown: [\"secondary_action_grab\", \"index_down\"],\n        triggerup: [\"secondary_action_release\", \"index_up\"],\n        axisMoveWithDeadzone: { left: \"move\", right: \"scroll_move\" }\n      },\n      \"daydream-controls\": {\n        trackpad_dpad4_pressed_west_down: \"snap_rotate_left\",\n        trackpad_dpad4_pressed_east_down: \"snap_rotate_right\",\n        trackpad_dpad4_pressed_center_down: [\"action_primary_down\"],\n        trackpad_dpad4_pressed_north_down: [\"action_primary_down\"],\n        trackpad_dpad4_pressed_south_down: [\"action_primary_down\"],\n        trackpadup: [\"action_primary_up\"],\n        axisMoveWithDeadzone: \"scroll_move\"\n      },\n      \"gearvr-controls\": {\n        trackpad_dpad4_pressed_west_down: \"snap_rotate_left\",\n        trackpad_dpad4_pressed_east_down: \"snap_rotate_right\",\n        trackpad_dpad4_pressed_center_down: [\"action_primary_down\"],\n        trackpad_dpad4_pressed_north_down: [\"action_primary_down\"],\n        trackpad_dpad4_pressed_south_down: [\"action_primary_down\"],\n        trackpadup: [\"action_primary_up\"],\n        triggerdown: [\"action_secondary_down\"],\n        triggerup: [\"action_secondary_up\"],\n        scroll: \"scroll_move\"\n      },\n      \"oculus-go-controls\": {\n        trackpad_dpad4_pressed_west_down: \"snap_rotate_left\",\n        trackpad_dpad4_pressed_east_down: \"snap_rotate_right\",\n        trackpad_dpad4_pressed_center_down: [\"action_primary_down\"],\n        trackpad_dpad4_pressed_north_down: [\"action_primary_down\"],\n        trackpad_dpad4_pressed_south_down: [\"action_primary_down\"],\n        trackpadup: [\"action_primary_up\"],\n        triggerdown: [\"action_secondary_down\"],\n        triggerup: [\"action_secondary_up\"],\n        scroll: \"scroll_move\"\n      },\n      keyboard: {\n        m_press: \"action_mute\",\n        q_press: \"snap_rotate_left\",\n        e_press: \"snap_rotate_right\",\n        b_press: \"action_share_screen\",\n\n        // We can't create a keyboard behaviour with AFIM yet,\n        // so these will get captured by wasd-to-analog2d\n        w_down: \"w_down\",\n        w_up: \"w_up\",\n        a_down: \"a_down\",\n        a_up: \"a_up\",\n        s_down: \"s_down\",\n        s_up: \"s_up\",\n        d_down: \"d_down\",\n        d_up: \"d_up\",\n        arrowup_down: \"w_down\",\n        arrowup_up: \"w_up\",\n        arrowleft_down: \"a_down\",\n        arrowleft_up: \"a_up\",\n        arrowdown_down: \"s_down\",\n        arrowdown_up: \"s_up\",\n        arrowright_down: \"d_down\",\n        arrowright_up: \"d_up\"\n      }\n    }\n  }\n};\n\nexport { inGameActions, config };\n","// Detects if another instance of ConcurrentLoadDetector is start()'ed by in the same local storage\n// context with the same instance key. Once a duplicate run is detected this will not fire any additional\n// events.\n\nconst LOCAL_STORE_KEY = \"___concurrent_load_detector\";\nimport { EventTarget } from \"event-target-shim\";\n\nexport default class ConcurrentLoadDetector extends EventTarget {\n  constructor(instanceKey) {\n    super();\n\n    this.interval = null;\n    this.startedAt = null;\n    this.instanceKey = instanceKey || \"global\";\n  }\n\n  start = () => {\n    this.startedAt = new Date();\n    localStorage.setItem(this.localStorageKey(), JSON.stringify({ started_at: this.startedAt }));\n\n    // Check for concurrent load every second\n    this.interval = setInterval(this._step, 1000);\n  };\n\n  stop = () => {\n    if (this.interval) {\n      clearInterval(this.interval);\n    }\n  };\n\n  localStorageKey = () => {\n    return `${LOCAL_STORE_KEY}_${this.instanceKey}`;\n  };\n\n  _step = () => {\n    const currentState = JSON.parse(localStorage.getItem(this.localStorageKey()));\n    const maxStartedAt = new Date(currentState.started_at);\n\n    if (maxStartedAt.getTime() !== this.startedAt.getTime()) {\n      this.dispatchEvent(new CustomEvent(\"concurrentload\"));\n      this.stop();\n    }\n  };\n}\n","// removed by extract-text-webpack-plugin\nmodule.exports = {\"domain\":\"link-dialog__domain__1WbPJ\",\"code\":\"link-dialog__code__259RI\",\"keep-open\":\"link-dialog__keep-open__DYcUI\",\"keepOpen\":\"link-dialog__keep-open__DYcUI\",\"digit\":\"link-dialog__digit___zoC4\",\"code-loading-panel\":\"link-dialog__code-loading-panel__WKkNk\",\"codeLoadingPanel\":\"link-dialog__code-loading-panel__WKkNk\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"action-button\":\"create-object-dialog__action-button__3OIJQ\",\"actionButton\":\"create-object-dialog__action-button__3OIJQ\",\"input-border\":\"create-object-dialog__input-border__1N9AV\",\"inputBorder\":\"create-object-dialog__input-border__1N9AV\",\"add-media-form\":\"create-object-dialog__add-media-form__10Wh-\",\"addMediaForm\":\"create-object-dialog__add-media-form__10Wh-\",\"buttons\":\"create-object-dialog__buttons__1zA-b\",\"small-button\":\"create-object-dialog__small-button__7UxXQ\",\"smallButton\":\"create-object-dialog__small-button__7UxXQ\",\"cancel-icon\":\"create-object-dialog__cancel-icon__yD-8A\",\"cancelIcon\":\"create-object-dialog__cancel-icon__yD-8A\",\"upload-icon\":\"create-object-dialog__upload-icon__19g9k\",\"uploadIcon\":\"create-object-dialog__upload-icon__19g9k\",\"left-side-of-input\":\"create-object-dialog__left-side-of-input__zyV06\",\"leftSideOfInput\":\"create-object-dialog__left-side-of-input__zyV06\",\"hide-file-input\":\"create-object-dialog__hide-file-input__2myDe\",\"hideFileInput\":\"create-object-dialog__hide-file-input__2myDe\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"nag-button\":\"hub__nag-button__3iQyC\",\"nagButton\":\"hub__nag-button__3iQyC\",\"entry-panel\":\"hub__entry-panel__cCmIv\",\"entryPanel\":\"hub__entry-panel__cCmIv\",\"button-container\":\"hub__button-container__38FOc\",\"buttonContainer\":\"hub__button-container__38FOc\",\"invite-button\":\"hub__invite-button__2DMgC\",\"inviteButton\":\"hub__invite-button__2DMgC\",\"entry-button\":\"hub__entry-button__1e9jM\",\"entryButton\":\"hub__entry-button__1e9jM\",\"label\":\"hub__label__1kjp1\",\"icon\":\"hub__icon__1pzf7\",\"screen-sharing\":\"hub__screen-sharing__2VF91\",\"screenSharing\":\"hub__screen-sharing__2VF91\",\"checkbox\":\"hub__checkbox__32dyv\",\"presence-info\":\"hub__presence-info__dqWyo\",\"presenceInfo\":\"hub__presence-info__dqWyo\",\"occupant-count\":\"hub__occupant-count__3eAEj\",\"occupantCount\":\"hub__occupant-count__3eAEj\",\"entry-dialog\":\"hub__entry-dialog__2Ljux\",\"entryDialog\":\"hub__entry-dialog__2Ljux\",\"bolded\":\"hub__bolded__2MYLZ\",\"subtitle\":\"hub__subtitle__3kYcd\",\"people\":\"hub__people__1veY3\",\"webvr-link-container\":\"hub__webvr-link-container__1Vq5m\",\"webvrLinkContainer\":\"hub__webvr-link-container__1Vq5m\",\"webvr-link\":\"hub__webvr-link__xW04U\",\"webvrLink\":\"hub__webvr-link__xW04U\",\"secondary\":\"hub__secondary__22yt_\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"touchZone\":\"virtual-gamepad-controls__touchZone__1KF_C\",\"left\":\"virtual-gamepad-controls__left__1-URB\",\"right\":\"virtual-gamepad-controls__right__1cgnU\",\"mockJoystickContainer\":\"virtual-gamepad-controls__mockJoystickContainer__1aH3e\",\"mockJoystick\":\"virtual-gamepad-controls__mockJoystick__2CuCG\",\"inner\":\"virtual-gamepad-controls__inner__1Bn3C\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"video\":\"networked-video-player__video__2PrBt\",\"container\":\"networked-video-player__container__2SqNi\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"nag-button\":\"ui-root__nag-button__2t6K2\",\"nagButton\":\"ui-root__nag-button__2t6K2\",\"presence-info\":\"ui-root__presence-info__3cieq\",\"presenceInfo\":\"ui-root__presence-info__3cieq\",\"occupant-count\":\"ui-root__occupant-count__34rGX\",\"occupantCount\":\"ui-root__occupant-count__34rGX\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"entry-panel\":\"entry__entry-panel__34CD9\",\"entryPanel\":\"entry__entry-panel__34CD9\",\"button-container\":\"entry__button-container__3Blog\",\"buttonContainer\":\"entry__button-container__3Blog\",\"invite-button\":\"entry__invite-button__3J4Qk\",\"inviteButton\":\"entry__invite-button__3J4Qk\",\"entry-button\":\"entry__entry-button__G7PQF\",\"entryButton\":\"entry__entry-button__G7PQF\",\"label\":\"entry__label__fUhpb\",\"icon\":\"entry__icon__3JiUl\",\"screen-sharing\":\"entry__screen-sharing__NBXQu\",\"screenSharing\":\"entry__screen-sharing__NBXQu\",\"checkbox\":\"entry__checkbox__3SoPk\",\"entry-dialog\":\"entry__entry-dialog__30kMs\",\"entryDialog\":\"entry__entry-dialog__30kMs\",\"bolded\":\"entry__bolded__13B4f\",\"subtitle\":\"entry__subtitle__1BC2y\",\"presence-info\":\"entry__presence-info__zbA7o\",\"presenceInfo\":\"entry__presence-info__zbA7o\",\"people\":\"entry__people__1tY6W\",\"webvr-link-container\":\"entry__webvr-link-container__3scWP\",\"webvrLinkContainer\":\"entry__webvr-link-container__3scWP\",\"webvr-link\":\"entry__webvr-link__3eWuZ\",\"webvrLink\":\"entry__webvr-link__3eWuZ\",\"secondary\":\"entry__secondary__3uhYE\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"unselectable\":\"_2d-hud__unselectable__2QGn5\",\"container\":\"_2d-hud__container__66GRt\",\"top\":\"_2d-hud__top__3PiNe\",\"column\":\"_2d-hud__column__1y7XY\",\"bottom\":\"_2d-hud__bottom__2jUcT\",\"hide\":\"_2d-hud__hide__3HJO8\",\"panel\":\"_2d-hud__panel__2oM_T\",\"left\":\"_2d-hud__left__20b8y\",\"right\":\"_2d-hud__right__1vrba\",\"up\":\"_2d-hud__up__1lyhr\",\"iconButton\":\"_2d-hud__iconButton__3faJz\",\"small\":\"_2d-hud__small__2rqgF\",\"large\":\"_2d-hud__large__2bHqH\",\"mute\":\"_2d-hud__mute__25kHI\",\"active\":\"_2d-hud__active__1TMB8\",\"bubble\":\"_2d-hud__bubble__2oTt2\",\"spawn_pen\":\"_2d-hud__spawn_pen__1F_c6\",\"spawnPen\":\"_2d-hud__spawn_pen__1F_c6\",\"freeze\":\"_2d-hud__freeze__26rlJ\",\"create-object\":\"_2d-hud__create-object__27TcL\",\"createObject\":\"_2d-hud__create-object__27TcL\",\"mobile-media-picker\":\"_2d-hud__mobile-media-picker__3ZXHc\",\"mobileMediaPicker\":\"_2d-hud__mobile-media-picker__3ZXHc\"};"],"sourceRoot":""}