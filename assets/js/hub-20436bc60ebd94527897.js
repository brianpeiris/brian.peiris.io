!function(e){function t(t){for(var n,r,s=t[0],l=t[1],c=t[2],u=0,h=[];u<s.length;u++)r=s[u],a[r]&&h.push(a[r][0]),a[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(d&&d(t);h.length;)h.shift()();return o.push.apply(o,c||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,s=1;s<i.length;s++){var l=i[s];0!==a[l]&&(n=!1)}n&&(o.splice(t--,1),e=r(r.s=i[0]))}return e}var n={},a={3:0},o=[];function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;o.push([175,1,0]),i()}([,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){o.default.config("https://013d6a364fed43cdb0539a61d520597a@sentry.prod.mozaws.net/370").install()};var n,a=i(37),o=(n=a,n&&n.__esModule?n:{default:n})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messages=t.lang=void 0;var n,a=i(16),o=(n=a,n&&n.__esModule?n:{default:n});var r=(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage).toLowerCase().split(/[_-]+/)[0],s=t.lang=o.default[r]&&r||"en";t.messages=o.default[s]||o.default.en},function(e){e.exports={en:{"entry.screen-prefix":"Enter on ","entry.desktop-screen":"Screen","entry.mobile-screen":"Phone","entry.mobile-safari":"Safari","entry.generic-prefix":"Enter with ","entry.generic-medium":"PC VR","entry.generic-subtitle-desktop":"Oculus or SteamVR","entry.gearvr-prefix":"Enter on ","entry.gearvr-medium":"Gear VR","entry.device-prefix-desktop":"Use a ","entry.device-prefix-mobile":"Use a ","entry.device-medium":"Mobile Headset","entry.device-subtitle-desktop":"Standalone or Phone Clip-in","entry.device-subtitle-mobile":"Standalone or Phone Clip-in","entry.device-subtitle-vr":"Phone or PC","entry.cardboard":"Enter on Google Cardboard","entry.daydream-prefix":"Enter on ","entry.daydream-medium":"Daydream","entry.daydream-via-chrome":"Using Google Chrome","entry.invite-others":"invite others","entry.invite-others-nag":"invite others to join","entry.enable-screen-sharing":"Share my desktop","entry.return-to-vr":"Enter in VR","profile.save":"save","profile.display_name.validation_warning":"Alphanumerics and hyphens. At least 3 characters, no more than 32","profile.header":"Your display name:","profile.avatar-selector.loading":"Loading Avatars...","profile.terms_of_use":"Terms of Use","profile.privacy_notice":"Privacy Notice","audio.title":"Test your audio","audio.subtitle-desktop":"Confirm HMD speaker output","audio.subtitle-mobile":"Earphones are recommended","audio.enter-now":"enter now","audio.hmd-mic-warning":"Your HMD mic is not chosen","audio.grant-title":"Grant mic permissions","audio.grant-subtitle":"Mic access needed to be heard by others","audio.granted-title":"Mic permissions granted","audio.granted-subtitle":"You can still mute yourself in-game","audio.granted-next":"next","exit.subtitle.exited":"Your session has ended. Refresh your browser to start a new one.","exit.subtitle.closed":"This room is no longer available.","exit.subtitle.full":"This room is full, please try again later.","exit.subtitle.connect_error":"Unable to connect to this room, please try again later.","exit.subtitle.version_mismatch":"The version you deployed is not available yet. Your browser will refresh in 5 seconds.","autoexit.title":"Auto-ending session in ","autoexit.title_units":" seconds","autoexit.subtitle":"You have started another session.","autoexit.cancel":"CANCEL","home.room_create_options":"options","home.room_create_button":"create a room","home.create_name.validation_warning":"Invalid name, limited to 4 to 64 characters and limited symbols.","home.join_us":"Join the Conversation","home.report_issue":"Report Issues","home.source_link":"source","home.about_link":"about","home.privacy_notice":"Privacy Notice","home.terms_of_use":"Terms of Use","home.get_updates":"Get Updates","home.hero_title":"A new way to get together online.","home.hero_subtitle":"Laugh, play, get stuff done, or just hang out.","home.made_with_love":"made with ðŸ¦† by ","home.environment_author_by":" by ","home.dialog.close":"CLOSE","home.have_entry_code":"have a link code?","mailing_list.privacy_label":"I'm okay with Mozilla handling my info as explained in","mailing_list.privacy_link":"this Privacy Notice","link.in_your_browser":"In your headset's browser, go to:","link.enter_code":"Then, enter this link code:","link.do_not_close":"Keep this dialog open to use this code.","link.link_page_header":"Enter your code:","link.dont_have_a_code":"Don't have a code?","link.create_a_room":"Create a Room","link.try_again":"We couldn't find that code. Please try again.","help.report_issue":"Report an Issue"}}},,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCHEMA=void 0;var n,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(79),s=i(82),l=(n=s,n&&n.__esModule?n:{default:n}),c=i(43),d=i(30);var u="___hubs_store",h=Symbol(),f=new r.Validator,p=t.SCHEMA={id:"/HubsStore",definitions:{profile:{type:"object",additionalProperties:!1,properties:{displayName:{type:"string",pattern:"^[A-Za-z0-9-]{3,32}$"},avatarId:{type:"string"}}},activity:{type:"object",additionalProperties:!1,properties:{hasFoundFreeze:{type:"boolean"},hasChangedName:{type:"boolean"},lastEnteredAt:{type:"string"}}},settings:{type:"object",additionalProperties:!1,properties:{lastUsedMicDeviceId:{type:"string"}}}},type:"object",properties:{profile:{$ref:"#/definitions/profile"},activity:{$ref:"#/definitions/activity"},settings:{$ref:"#/definitions/settings"}},additionalProperties:!1},m=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.init=function(){e.update({activity:{},settings:{},profile:a({},(0,d.generateDefaultProfile)(),e.state.profile||{})}),e.state.activity.hasChangedName||e.update({profile:{displayName:(0,d.generateRandomName)()}})},null===localStorage.getItem(u)&&localStorage.setItem(u,JSON.stringify({})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"update",value:function(e){var t=(0,l.default)(this.state,e),i=f.validate(t,p).valid;if(!i)throw new Error("Write of "+JSON.stringify(t)+" to store failed schema validation.");return localStorage.setItem(u,JSON.stringify(t)),delete this[h],this.dispatchEvent(new CustomEvent("statechanged")),t}},{key:"state",get:function(){return this.hasOwnProperty(h)||(this[h]=JSON.parse(localStorage.getItem(u))),this[h]}}]),t}(c.EventTarget);t.default=m},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.avatars=[{id:"botdefault",model:"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf"},{id:"botbobo",model:"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf"},{id:"botdom",model:"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf"},{id:"botgreg",model:"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf"},{id:"botguest",model:"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf"},{id:"botjim",model:"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf"},{id:"botkev",model:"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf"},{id:"botpinky",model:"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf"},{id:"botrobert",model:"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf"},{id:"botwoody",model:"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf"}]},,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(53),o=w(a),r=i(54),s=w(r),l=i(1),c=_(l),d=i(102),u=_(d),h=i(0),f=_(h),p=i(5),m=i(103),v=_(m),g=i(55),y=_(g),b=i(56),E=_(b);function _(e){return e&&e.__esModule?e:{default:e}}function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var k=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i,n,a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.onContainerClicked=function(e){e.currentTarget===e.target&&a.props.onCloseDialog()},a.onCustomSceneClicked=function(){a.props.onCustomScene(a.state.customRoomName,a.state.customSceneUrl),a.props.onCloseDialog()},a.shareLinkClicked=function(){navigator.share({title:document.title,url:a.shareLink})},a.copyLinkClicked=function(e){(0,u.default)(e),a.setState({copyLinkButtonText:"copied!"})},a.state={mailingListEmail:"",mailingListPrivacy:!1,copyLinkButtonText:"copy",createObjectUrl:"",customRoomName:"",customSceneUrl:""},a.signUpForMailingList=(i=function*(e){if(e.preventDefault(),e.stopPropagation(),a.state.mailingListPrivacy){var t={email:a.state.mailingListEmail,newsletters:"hubs",privacy:!0,fmt:"H",source_url:document.location.href};yield fetch("https://www.mozilla.org/en-US/newsletter/",{body:(0,v.default)(t),method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"}}).then(a.props.onSubmittedEmail)}},n=function(){var e=i.apply(this,arguments);return new Promise(function(t,i){return function n(a,o){try{var r=e[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(e){return n.apply(this,arguments)});var o=document.location;return a.shareLink=o.protocol+"//"+o.host+o.pathname,a.onKeyDown=a.onKeyDown.bind(a),a.onContainerClicked=a.onContainerClicked.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.onKeyDown)}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.props.onCloseDialog()}},{key:"render",value:function(){var e=this;if(!this.props.dialogType)return c.default.createElement("div",null);var i=null,n=null;switch(this.props.dialogType){case t.dialogTypes.slack:i="Get in Touch",n=c.default.createElement("span",null,c.default.createElement("p",null,"Want to join the conversation?"),c.default.createElement("p",null,"Join us on the"," ",c.default.createElement("a",{href:"https://webvr-slack.herokuapp.com/",target:"_blank",rel:"noopener noreferrer"},"WebVR Slack")," ","in the"," ",c.default.createElement("a",{href:"https://webvr.slack.com/messages/social",target:"_blank",rel:"noopener noreferrer"},"#social")," ","channel.",c.default.createElement("br",null),"VR meetups every Friday at noon PDT!"),c.default.createElement("p",null,"Or, tweet at"," ",c.default.createElement("a",{href:"https://twitter.com/mozillareality",target:"_blank",rel:"noopener noreferrer"},"@mozillareality")," ","on Twitter."));break;case t.dialogTypes.email_submitted:i="",n="Great! Please check your e-mail to confirm your subscription.";break;case t.dialogTypes.invite:i="Invite Others",n=c.default.createElement("div",null,c.default.createElement("div",null,"Just share the link and they'll join you:"),c.default.createElement("div",{className:"invite-form"},c.default.createElement("input",{type:"text",readOnly:!0,onFocus:function(e){return e.target.select()},value:this.shareLink,className:"invite-form__link_field"}),c.default.createElement("div",{className:"invite-form__buttons"},navigator.share&&c.default.createElement("button",{className:"invite-form__action-button",onClick:this.shareLinkClicked},c.default.createElement("span",null,"share")),c.default.createElement("button",{className:"invite-form__action-button",onClick:this.copyLinkClicked.bind(this,this.shareLink)},c.default.createElement("span",null,this.state.copyLinkButtonText)))));break;case t.dialogTypes.safari:i="Open in Safari",n=c.default.createElement("div",null,c.default.createElement("div",null,"Hubs does not support your current browser on iOS. Copy and paste this link directly in Safari."),c.default.createElement("div",{className:"invite-form"},c.default.createElement("input",{type:"text",readOnly:!0,onFocus:function(e){return e.target.select()},value:document.location,className:"invite-form__link_field"}),c.default.createElement("div",{className:"invite-form__buttons"},c.default.createElement("button",{className:"invite-form__action-button",onClick:this.copyLinkClicked.bind(this,document.location)},c.default.createElement("span",null,this.state.copyLinkButtonText)))));break;case t.dialogTypes.create_object:i="Create Object",n=c.default.createElement(E.default,{onCreateObject:this.props.onCreateObject,onCloseDialog:this.props.onCloseDialog});break;case t.dialogTypes.custom_scene:i="Create a Room",n=c.default.createElement("div",null,c.default.createElement("div",null,"Choose a name and GLTF URL for your room's scene:"),c.default.createElement("form",{onSubmit:this.onCustomSceneClicked},c.default.createElement("div",{className:"custom-scene-form"},c.default.createElement("input",{type:"text",placeholder:"Room name",className:"custom-scene-form__link_field",value:this.state.customRoomName,pattern:"^[A-Za-z0-9-'\":!@#$%^&*(),.?~ ]{4,64}$",title:"Invalid name, limited to 4 to 64 characters and limited symbols.",onChange:function(t){return e.setState({customRoomName:t.target.value})},required:!0}),c.default.createElement("input",{type:"url",placeholder:"URL to Scene GLTF or GLB (Optional)",className:"custom-scene-form__link_field",value:this.state.customSceneUrl,onChange:function(t){return e.setState({customSceneUrl:t.target.value})}}),c.default.createElement("div",{className:"custom-scene-form__buttons"},c.default.createElement("button",{className:"custom-scene-form__action-button"},c.default.createElement("span",null,"create"))))));break;case t.dialogTypes.updates:i="",n=c.default.createElement("span",null,c.default.createElement("p",null,"Sign up to get updates about new features in Hubs."),c.default.createElement("form",{onSubmit:this.signUpForMailingList},c.default.createElement("div",{className:"mailing-list-form"},c.default.createElement("input",{type:"email",value:this.state.mailingListEmail,onChange:function(t){return e.setState({mailingListEmail:t.target.value})},className:"mailing-list-form__email_field",required:!0,placeholder:"Your email here"}),c.default.createElement("label",{className:"mailing-list-form__privacy"},c.default.createElement("input",{className:"mailing-list-form__privacy_checkbox",type:"checkbox",required:!0,value:this.state.mailingListPrivacy,onChange:function(t){return e.setState({mailingListPrivacy:t.target.checked})}}),c.default.createElement("span",{className:"mailing-list-form__privacy_label"},c.default.createElement(p.FormattedMessage,{id:"mailing_list.privacy_label"})," ",c.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://www.mozilla.org/en-US/privacy/"},c.default.createElement(p.FormattedMessage,{id:"mailing_list.privacy_link"})))),c.default.createElement("input",{className:"mailing-list-form__submit",type:"submit",value:"Sign Up Now"}))));break;case t.dialogTypes.report:i="Report an Issue",n=c.default.createElement("span",null,c.default.createElement("p",null,"Need to report a problem?"),c.default.createElement("p",null,"You can file a"," ",c.default.createElement("a",{href:"https://github.com/mozilla/hubs/issues",target:"_blank",rel:"noopener noreferrer"},"GitHub Issue")," ","or e-mail us for support at ",c.default.createElement("a",{href:"mailto:hubs@mozilla.com"},"hubs@mozilla.com"),"."),c.default.createElement("p",null,"You can also find us in"," ",c.default.createElement("a",{href:"https://webvr.slack.com/messages/social",target:"_blank",rel:"noopener noreferrer"},"#social")," ","on the"," ",c.default.createElement("a",{href:"https://webvr-slack.herokuapp.com/",target:"_blank",rel:"noopener noreferrer"},"WebVR Slack"),"."));break;case t.dialogTypes.help:i="Getting Started",n=c.default.createElement("div",{className:"info-dialog__help"},c.default.createElement("p",null,"When in a room, other avatars can see and hear you."),c.default.createElement("p",null,"Use your controller's action button to teleport from place to place. If it has a trigger, use it to pick up objects."),c.default.createElement("p",{style:{textAlign:"center"}},"In VR, ",c.default.createElement("b",null,"look up")," to find your menu:",c.default.createElement("img",{className:"info-dialog__help__hud",src:o.default,srcSet:s.default+" 2x"})),c.default.createElement("p",null,"The ",c.default.createElement("b",null,"Mic Toggle")," mutes your mic."),c.default.createElement("p",null,"The ",c.default.createElement("b",null,"Pause/Resume Toggle")," pauses all other avatars. You can then block them from having further interactions with you."),c.default.createElement("p",null,"The ",c.default.createElement("b",null,"Bubble Toggle")," hides avatars that enter your personal space."),c.default.createElement("p",{className:"dialog__box__contents__links"},c.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/blob/master/TERMS.md"},c.default.createElement(p.FormattedMessage,{id:"profile.terms_of_use"})),c.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/blob/master/PRIVACY.md"},c.default.createElement(p.FormattedMessage,{id:"profile.privacy_notice"})),c.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"/?report"},c.default.createElement(p.FormattedMessage,{id:"help.report_issue"}))));break;case t.dialogTypes.webvr_recommend:i="Enter in VR",n=c.default.createElement("div",null,c.default.createElement("p",null,"To enter Hubs with Oculus or SteamVR, you can use Firefox."),c.default.createElement("a",{className:"info-dialog--action-button",href:"https://www.mozilla.org/firefox"},"Download Firefox"),c.default.createElement("p",{style:{fontSize:"0.8em"}},"For a full list of browsers with experimental VR support, visit"," ",c.default.createElement("a",{href:"https://webvr.rocks",target:"_blank",rel:"noopener noreferrer"},"WebVR Rocks"),"."));break;case t.dialogTypes.link:i="Open on Headset",n=c.default.createElement(y.default,{linkCode:this.props.linkCode})}return c.default.createElement("div",{className:"dialog-overlay"},c.default.createElement("div",{className:"dialog",onClick:this.onContainerClicked},c.default.createElement("div",{className:"dialog__box"},c.default.createElement("div",{className:"dialog__box__contents"},c.default.createElement("button",{className:"dialog__box__contents__close",onClick:this.props.onCloseDialog},c.default.createElement("span",null,"Ã—")),c.default.createElement("div",{className:"dialog__box__contents__title"},i),c.default.createElement("div",{className:"dialog__box__contents__body"},n),c.default.createElement("div",{className:"dialog__box__contents__button-container"})))))}}]),t}(l.Component);k.dialogTypes={slack:Symbol("slack"),email_submitted:Symbol("email_submitted"),invite:Symbol("invite"),safari:Symbol("safari"),updates:Symbol("updates"),report:Symbol("report"),help:Symbol("help"),link:Symbol("link"),webvr_recommend:Symbol("webvr_recommend"),create_object:Symbol("create_object"),custom_scene:Symbol("custom_scene")},k.propTypes={dialogType:f.default.oneOf(Object.values(k.dialogTypes)),onCloseDialog:f.default.func,onSubmittedEmail:f.default.func,onCreateObject:f.default.func,onCustomScene:f.default.func,linkCode:f.default.string},t.default=k},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.avatarIds=void 0,t.generateRandomName=function(){return o(a)+"-"+Math.floor(1e4+1e4*Math.random())},t.generateDefaultProfile=function(){return{avatarId:o(r)}};var n=i(22),a=["Baers-Pochard","Baikal-Teal","Barrows-Goldeneye","Blue-Billed","Blue-Duck","Blue-Winged","Brown-Teal","Bufflehead","Canvasback","Cape-Shoveler","Chestnut-Teal","Chiloe-Wigeon","Cinnamon-Teal","Comb-Duck","Common-Eider","Common-Goldeneye","Common-Merganser","Common-Pochard","Common-Scoter","Common-Shelduck","Cotton-Pygmy","Crested-Duck","Crested-Shelduck","Eatons-Pintail","Falcated","Ferruginous","Freckled-Duck","Gadwall","Garganey","Greater-Scaup","Green-Pygmy","Grey-Teal","Hardhead","Harlequin","Hartlaubs","Hooded-Merganser","Hottentot-Teal","Kelp-Goose","King-Eider","Lake-Duck","Laysan-Duck","Lesser-Scaup","Long-Tailed","Maccoa-Duck","Mallard","Mandarin","Marbled-Teal","Mellers-Duck","Merganser","Northern-Pintail","Orinoco-Goose","Paradise-Shelduck","Plumed-Whistler","Puna-Teal","Pygmy-Goose","Radjah-Shelduck","Red-Billed","Red-Crested","Red-Shoveler","Ring-Necked","Ringed-Teal","Rosy-Billed","Ruddy-Shelduck","Salvadoris-Teal","Scaly-Sided","Shelduck","Shoveler","Silver-Teal","Smew","Spectacled-Eider","Spot-Billed","Spotted-Whistler","Steamerduck","Stellers-Eider","Sunda-Teal","Surf-Scoter","Tufted-Duck","Velvet-Scoter","Wandering-Whistler","Whistling-duck","White-Backed","White-Cheeked","White-Winged","Wigeon","Wood-Duck","Yellow-Billed"];function o(e){return e[Math.floor(Math.random()*e.length)]}var r=t.avatarIds=n.avatars.map(function(e){return e.id})},,,,function(e,t){},,,,function(e,t){},function(e,t){},,,function(e,t,i){"use strict";var n,a,o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=(n=k(function*(){var e=[u.default,f.default,m.default,g.default,b.default,_.default],t=yield(new THREE.CubeTextureLoader).load(e);return t.format=THREE.RGBFormat,t}),function(){return n.apply(this,arguments)}),s=(a=k(function*(e,t,i,n){var a=e,s=void 0;(t.includes("model/gltf+zip")||t.includes("application/x-zip-compressed"))&&(s=yield function(e){return new Promise(function(t,i){var n=new c.default;n.onmessage=function(e){var n=o(e.data,2),a=n[0],r=n[1];(a?t:i)(r)},n.postMessage(e)})}(a),a=s["scene.gtlf"]);var l=new THREE.GLTFLoader;l.setLazy(!0);var d=yield new Promise(function(e,t){return l.load(a,e,n,t)}),u=d.parser,h=u.json.materials;if(h)for(var f=0;f<h.length;f++){var p=h[f];if(p.extensions&&p.extensions.MOZ_alt_materials&&void 0!==p.extensions.MOZ_alt_materials[i]){var m=p.extensions.MOZ_alt_materials[i];h[f]=h[m]}}R||(R=r());var v=yield new Promise(function(e,t){return u.parse(function(t,i,n,a,o){e({scene:t,scenes:i,cameras:n,animations:a,json:o})},function(e){t(e)})}),g=yield R;return v.scene.traverse(function(e){e.material&&"MeshStandardMaterial"===e.material.type&&(e.material.envMap=g,e.material.needsUpdate=!0)}),s&&Object.keys(s).forEach(URL.revokeObjectURL),v}),function(e,t,i,n){return a.apply(this,arguments)}),l=i(113),c=w(l),d=i(69),u=w(d),h=i(70),f=w(h),p=i(71),m=w(p),v=i(72),g=w(v),y=i(73),b=w(y),E=i(74),_=w(E);function w(e){return e&&e.__esModule?e:{default:e}}function k(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var A={},R=null;function C(e,t,i){if(!AFRAME.components[t])throw new Error('Inflator failed. "'+t+'" component does not exist.');if(AFRAME.components[t].multiple&&Array.isArray(i))for(var n=0;n<i.length;n++)e.setAttribute(t+"__"+n,i[n]);else e.setAttribute(t,i)}AFRAME.GLTFModelPlus={components:{},registerComponent:function(e,t,i){i=i||C,AFRAME.GLTFModelPlus.components[e]={inflator:i,componentName:t}}};function M(e,t,i){var n=e.querySelectorAll("."+t),a=!0,o=!1,r=void 0;try{for(var s,l=n[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value,d=i.cloneNode(!0),u=!0,h=!1,f=void 0;try{for(var p,m=d.attributes[Symbol.iterator]();!(u=(p=m.next()).done);u=!0){var v=p.value,g=v.name,y=v.value;c.setAttribute(g,y)}}catch(e){h=!0,f=e}finally{try{!u&&m.return&&m.return()}finally{if(h)throw f}}for(;d.children.length>0;)c.appendChild(d.children[0])}}catch(e){o=!0,r=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw r}}}AFRAME.registerComponent("gltf-model-plus",{schema:{src:{type:"string"},contentType:{type:"string"},inflate:{default:!1}},init:function(){this.preferredTechnique=window.APP&&"low"===window.APP.quality?"KHR_materials_unlit":"pbrMetallicRoughness",this.loadTemplates()},update:function(){this.applySrc(this.data.src,this.data.contentType)},loadTemplates:function(){var e=this;this.templates={},this.el.querySelectorAll(":scope > template").forEach(function(t){var i=document.importNode(t.firstElementChild||t.content.firstElementChild,!0);e.templates[t.getAttribute("data-name")]=i})},applySrc:function(){var e=k(function*(e,t){try{if(e&&"#"===e.charAt(0)){var i=document.getElementById(e.substring(1));e=i.getAttribute("src")}if(e===this.lastSrc)return;if(this.lastSrc=e,!e)return void(this.inflatedEl&&(console.warn("gltf-model-plus set to an empty source, unloading inflated model."),this.removeInflatedEl()));A[e]||(A[e]=s(e,t,this.preferredTechnique));var n=function(e){var t={};e.scene.traverse(function(e){e.name||(e.name=e.uuid),e.isSkinnedMesh&&(t[e.name]=e)});var i={animations:e.animations,scene:e.scene.clone(!0)},n={},a={};for(var o in i.scene.traverse(function(e){e.isBone&&(n[e.name]=e),e.isSkinnedMesh&&(a[e.name]=e)}),t){for(var r=t[o],s=r.skeleton,l=a[o],c=[],d=0;d<s.bones.length;++d){var u=n[s.bones[d].name];c.push(u)}l.bind(new THREE.Skeleton(c,s.boneInverses),l.matrixWorld),l.material=r.material.clone()}return i}(yield A[e]);if(e!=this.lastSrc)return;this.removeInflatedEl(),this.model=n.scene||n.scenes[0],this.model.animations=n.animations;var a=this.model;if(this.data.inflate&&(this.inflatedEl=function e(t,i,n){var a=[],o=t.children.slice(0),r=!0,s=!1,l=void 0;try{for(var c,d=o[Symbol.iterator]();!(r=(c=d.next()).done);r=!0){var u=c.value,h=e(u,i);h&&a.push(h)}}catch(e){s=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(s)throw l}}var f=t.userData.components||t.name in i;if(!f&&!a.length&&!n)return null;var p=document.createElement("a-entity");p.append.apply(p,a);var m=(t.name||t.uuid).replace(/[^\w-]/g,"");p.classList.add(m),"YXZ"!==t.rotation.order&&t.rotation.setFromQuaternion(t.quaternion,"YXZ"),p.setAttribute("position",{x:t.position.x,y:t.position.y,z:t.position.z}),p.setAttribute("rotation",{x:t.rotation.x*THREE.Math.RAD2DEG,y:t.rotation.y*THREE.Math.RAD2DEG,z:t.rotation.z*THREE.Math.RAD2DEG}),p.setAttribute("scale",{x:t.scale.x,y:t.scale.y,z:t.scale.z}),t.matrixAutoUpdate=!1,t.matrix.identity(),p.setObject3D(t.type.toLowerCase(),t),t.userData.components&&"nav-mesh"in t.userData.components&&p.setObject3D("mesh",t),p.object3D.name=t.name,t.animations&&(t.parent.animations=t.animations);var v=t.userData.components;if(v)for(var g in v)if(v.hasOwnProperty(g)&&AFRAME.GLTFModelPlus.components.hasOwnProperty(g)){var y=AFRAME.GLTFModelPlus.components[g],b=y.componentName,E=y.inflator;E(p,b,v[g])}return p}(this.model,this.templates,!0))){if(this.el.appendChild(this.inflatedEl),a=this.inflatedEl.object3D,yield new Promise(function(e){setTimeout(e,0)}),e!=this.lastSrc)return;for(var o in this.templates)M(this.el,o,this.templates[o])}this.el.setObject3D("mesh",a),this.el.emit("model-loaded",{format:"gltf",model:this.model})}catch(t){delete A[e],console.error("Failed to load glTF model",t,this),this.el.emit("model-error",{format:"gltf",src:e})}});return function(t,i){return e.apply(this,arguments)}}(),removeInflatedEl:function(){this.inflatedEl&&(this.inflatedEl.parentNode.removeChild(this.inflatedEl),delete this.inflatedEl)}})},,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[],a=n.concat(["/rooms/meetingroom/MeetingRoom.bundle.json","/rooms/atrium/Atrium.bundle.json","/rooms/MedievalFantasyBook/MedievalFantasyBook.bundle.json","/rooms/rooftopbuilding1/RooftopBuilding1.bundle.json","/rooms/wideopenspace/WideOpenSpace.bundle.json"]),o=t.ENVIRONMENT_URLS=a.map(function(e){return"https://asset-bundles-prod.reticulum.io"+e});t.DEFAULT_ENVIRONMENT_URL=o[0]},function(e,t,i){e.exports=i.p+"assets/images/help-hud-4f396aacecdeab9acb5c53b63f707a87.png"},function(e,t,i){e.exports=i.p+"assets/images/help-hud@2x-6bf5636b37144ec3d8e4a27af324f0eb.png"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(1),o=f(a),r=i(0),s=f(r),l=i(9),c=f(l),d=i(5),u=i(439),h=f(u);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"render",value:function(){return this.props.linkCode?o.default.createElement("div",null,o.default.createElement("div",null,o.default.createElement(d.FormattedMessage,{id:"link.in_your_browser"})),o.default.createElement("a",{href:"https://hub.link",className:h.default.domain,target:"_blank",rel:"noopener noreferrer"},"hub.link"),o.default.createElement("div",null,o.default.createElement(d.FormattedMessage,{id:"link.enter_code"})),o.default.createElement("div",{className:h.default.code},this.props.linkCode.split("").map(function(e,t){return o.default.createElement("span",{className:h.default.digit,key:"link_code_"+t},e)})),o.default.createElement("div",{className:h.default.keepOpen},o.default.createElement(d.FormattedMessage,{id:"link.do_not_close"}))):o.default.createElement("div",null,o.default.createElement("div",{className:(0,c.default)("loading-panel",h.default.codeLoadingPanel)},o.default.createElement("div",{className:"loader-wrap"},o.default.createElement("div",{className:"loader"},o.default.createElement("div",{className:"loader-center"})))))}}]),t}(a.Component);p.propTypes={linkCode:s.default.string},t.default=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(1),o=g(a);i(41);var r=i(0),s=g(r),l=i(57),c=g(l),d=i(19),u=i(104),h=i(105),f=i(441),p=g(f),m=i(9),v=g(m);function g(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var b={"giphy.com":c.default,"media.giphy.com":c.default},E="https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf",_=AFRAME.utils.device.isMobile(),w=o.default.createElement("div",null,"Paste a URL or upload a file."),k=o.default.createElement("div",null,o.default.createElement("p",null,"Paste a URL or upload a file."),o.default.createElement("p",null,"Tip: You can paste links directly into Hubs with Ctrl+V")),A="",R=function(e){function t(){var e,i,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];return n=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i=n,n.state={url:"",file:null,fileName:""},n.onUrlChange=function(e){var t=n.state.attributionImage;if(e.target&&e.target.value&&e.target.validity.valid){var i=new URL(e.target.value);t=b[i.hostname]}n.setState({url:e.target&&e.target.value,attributionImage:t})},n.onFileChange=function(e){n.setState({file:e.target.files[0],fileName:e.target.files[0].name})},n.onCreateClicked=function(e){e.preventDefault(),n.props.onCreateObject(n.state.file||n.state.url||E),n.props.onCloseDialog()},n.reset=function(e){e.preventDefault(),n.setState({url:"",file:null,fileName:""}),n.fileInput.value=null},a=i,y(n,a)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentDidMount",value:function(){this.setState({url:A})}},{key:"componentWillUnmount",value:function(){A=this.state.url}},{key:"render",value:function(){var e=this,t=o.default.createElement("label",{className:(0,v.default)(p.default.smallButton,p.default.cancelIcon),onClick:this.reset},o.default.createElement(d.FontAwesomeIcon,{icon:h.faTimes})),i=o.default.createElement("label",{htmlFor:"file-input",className:(0,v.default)(p.default.smallButton,p.default.uploadIcon)},o.default.createElement(d.FontAwesomeIcon,{icon:u.faPaperclip})),n=o.default.createElement("label",{className:(0,v.default)(p.default.leftSideOfInput)},this.state.fileName),a=o.default.createElement("input",{className:(0,v.default)(p.default.leftSideOfInput),placeholder:"Image/Video/glTF URL",onChange:this.onUrlChange,type:"url",value:this.state.url});return o.default.createElement("div",null,_?w:k,o.default.createElement("form",{onSubmit:this.onCreateClicked},o.default.createElement("div",{className:p.default.addMediaForm},o.default.createElement("input",{id:"file-input",ref:function(t){return e.fileInput=t},className:p.default.hideFileInput,type:"file",onChange:this.onFileChange}),o.default.createElement("div",{className:p.default.inputBorder},this.state.file?n:a,this.state.url||this.state.fileName?t:i),o.default.createElement("div",{className:p.default.buttons},o.default.createElement("button",{className:p.default.actionButton},o.default.createElement("span",null,"create"))),this.state.attributionImage?o.default.createElement("div",null,o.default.createElement("img",{src:this.state.attributionImage})):null)))}}]),t}(a.Component);R.propTypes={onCreateObject:s.default.func,onCloseDialog:s.default.func},t.default=R},function(e,t,i){e.exports=i.p+"assets/images/giphy_logo-439da1ed3ca70fb090eb98698485c21e.png"},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=n.get(e);return""===t||/1|on|true/i.test(t)};var n=new URLSearchParams(location.search)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.patchWebGLRenderingContext=function(){if(/Android.+Firefox/.test(navigator.userAgent)){var e=WebGLRenderingContext.prototype.getExtension,t=function(){var e=new n.WebGLRenderer,t=new n.Scene,i=new Float32Array(16),a=new n.DataTexture(i,2,2,n.RGBAFormat,n.FloatType),o=new n.Mesh(new n.PlaneBufferGeometry(1,1),new n.MeshBasicMaterial({map:a}));o.material.map.needsUpdate=!0,t.add(o),e.render(t,new n.Camera);var r=0===e.context.getError();return e.dispose(),r}();WebGLRenderingContext.prototype.getExtension=function(i){return"OES_texture_float"!==i||t?e.call(this,i):null}}};var n=AFRAME.THREE},,,,,function(e,t,i){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectTypeForOriginAndContentType=function(e,t){for(var i in s)if(t.startsWith(i)){var a=s[i];return r.apply(void 0,[e].concat(n(a)))}return o.UNKNOWN};var a=t.ObjectContentOrigins={URL:1,FILE:2,CLIPBOARD:3,SPAWNER:4},o={URL_IMAGE:0,URL_VIDEO:1,URL_MODEL:2,URL_PDF:3,URL_AUDIO:4,FILE_IMAGE:8,FILE_VIDEO:9,FILE_MODEL:10,FILE_PDF:11,FILE_AUDIO:12,CLIPBOARD_IMAGE:16,CLIPBOARD_VIDEO:17,CLIPBOARD_MODEL:18,CLIPBOARD_PDF:19,CLIPBOARD_AUDIO:20,SPAWNER_IMAGE:24,SPAWNER_VIDEO:25,SPAWNER_MODEL:26,SPAWNER_PDF:27,SPAWNER_AUDIO:28,UNKNOWN:31};function r(e,t,i,n,o){return e===a.URL?t:e===a.FILE?i:e===a.CLIPBOARD?n:o}var s={"image/":[o.URL_IMAGE,o.FILE_IMAGE,o.CLIPBOARD_IMAGE,o.SPAWNER_IMAGE],"model/":[o.URL_MODEL,o.FILE_MODEL,o.CLIPBOARD_MODEL,o.SPAWNER_MODEL],"application/x-zip-compressed":[o.URL_MODEL,o.FILE_MODEL,o.CLIPBOARD_MODEL,o.SPAWNER_MODEL],"video/":[o.URL_VIDEO,o.FILE_VIDEO,o.CLIPBOARD_VIDEO,o.SPAWNER_VIDEO],"audio/":[o.URL_AUDIO,o.FILE_AUDIO,o.CLIPBOARD_AUDIO,o.SPAWNER_AUDIO],"application/pdf":[o.URL_PDF,o.FILE_PDF,o.CLIPBOARD_PDF,o.SPAWNER_PDF]}},function(e,t,i){"use strict";AFRAME.registerComponent("networked-audio-analyser",{init:function(){var e,t=(e=function*(){var e=this;this.volume=0,this.prevVolume=0,this.smoothing=.3,this.threshold=.01,this.el.addEventListener("sound-source-set",function(t){var i=THREE.AudioContext.getContext();e.analyser=i.createAnalyser(),e.analyser.fftSize=32,e.levels=new Uint8Array(e.analyser.frequencyBinCount),t.detail.soundSource.connect(e.analyser)})},function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})});return function(){return t.apply(this,arguments)}}(),tick:function(){if(this.analyser){this.analyser.getByteTimeDomainData(this.levels);for(var e=0,t=0;t<this.levels.length;t++){var i=(this.levels[t]-128)/128;e+=i*i}var n=Math.sqrt(e/this.levels.length);n<this.threshold&&(n=0),this.volume=this.smoothing*n+(1-this.smoothing)*this.prevVolume,this.prevVolume=this.volume}}}),AFRAME.registerComponent("scale-audio-feedback",{schema:{minScale:{default:1},maxScale:{default:2}},tick:function(){if(this.el.object3D.visible){var e=this.data,t=e.minScale,i=e.maxScale,n=this.el.components["networked-audio-analyser"];if(n){var a=Math.min(i,t+(i-t)*n.volume*8);this.el.object3D.scale.setScalar(a)}}}})},function(e,t,i){"use strict";AFRAME.registerComponent("animation-mixer",{init:function(){this.mixer=null;var e=this.el.object3DMap,t=e.mesh||e.scene;t?this.setAnimationMixer(t):(this.onModelLoaded=this.onModelLoaded.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded))},onModelLoaded:function(e){var t=e.detail.model;this.setAnimationMixer(t),this.el.removeEventListener(this.onModelLoaded)},setAnimationMixer:function(e){this.mixer=new THREE.AnimationMixer(e)},tick:function(e,t){this.mixer&&this.mixer.update(t/1e3)},destroy:function(){this.el.removeEventListener(this.onModelLoaded)}})},function(e,t,i){"use strict";AFRAME.registerComponent("loop-animation",{dependencies:["animation-mixer"],schema:{clip:{type:"string",required:!0}},init:function(){var e=this.el.object3DMap;this.model=e.mesh||e.scene,this.model?this.mixer=this.el.components["animation-mixer"].mixer:(this.onModelLoaded=this.onModelLoaded.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded))},onModelLoaded:function(e){var t=this.el.components["animation-mixer"];this.model=e.detail.model,this.mixer=t.mixer,this.updateClipState(!0),this.el.removeEventListener(this.onModelLoaded)},update:function(e){e.clip!==this.data.clip&&this.model&&this.updateClipState(!0)},updateClipState:function(e){var t=this.model,i=this.data.clip,n=!0,a=!1,o=void 0;try{for(var r,s=this.model.animations[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;if(l.name===i){var c=this.mixer.clipAction(l,t.parent);e?(c.enabled=!0,c.setLoop(THREE.LoopRepeat,1/0).play()):c.stop();break}}}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}},destroy:function(){this.updateClipState(!1),this.el.removeEventListener(this.onModelLoaded)}})},function(e,t,i){e.exports=i.p+"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg"},function(e,t,i){e.exports=i.p+"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addMedia=t.upload=t.resolveMedia=t.fetchMaxContentIndex=void 0;var n=i(65);function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var o="/api/v1/media";o="https://dev.reticulum.io"+o;var r,s,l,c=(r=a(function*(e){return fetch(e,{method:"HEAD"}).then(function(e){return e.headers.get("content-type")})}),function(e){return r.apply(this,arguments)}),d=new Map,u=(t.fetchMaxContentIndex=(s=a(function*(e,t){if(d.has(e))return d.get(e);var i=yield fetch(t).then(function(e){return parseInt(e.headers.get("x-max-content-index"))});return d.set(e,i),i}),function(e,t){return s.apply(this,arguments)}),new Map),h=(t.resolveMedia=(l=a(function*(e,t,i){var n=new URL(e),a=e+"|"+i;if(u.has(a))return u.get(a);var r="http:"===n.protocol||"https:"===n.protocol,s=r?yield fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({media:{url:e,index:i}})}).then(function(e){return e.json()}):{raw:e,origin:e};if(r&&!t){var l=s.meta&&s.meta.expected_content_type||(yield c(s.raw));s.contentType=l}return u.set(a,s),s}),function(e,t,i){return l.apply(this,arguments)}),t.upload=function(e){var t=new FormData;return t.append("media",e),fetch(o,{method:"POST",body:t}).then(function(e){return e.json()})});var f=0;t.addMedia=function(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=AFRAME.scenes[0],r=document.createElement("a-entity");r.id="interactable-media-"+f++,r.setAttribute("networked",{template:t}),r.setAttribute("media-loader",{resize:a,src:"string"==typeof e?e:""}),o.appendChild(r);var s=new Promise(function(t){var i,n,a;e instanceof File?(i=e,n=function(e){t(e)},a=new FileReader,a.onload=function(e){var t=new DataView(e.target.result);if(65496!=t.getUint16(0,!1))return n(-2);for(var i=t.byteLength,a=2;a<i;){if(t.getUint16(a+2,!1)<=8)return n(-1);var o=t.getUint16(a,!1);if(a+=2,65505==o){if(1165519206!=t.getUint32(a+=2,!1))return n(-1);var r=18761==t.getUint16(a+=6,!1);a+=t.getUint32(a+4,r);var s=t.getUint16(a,r);a+=2;for(var l=0;l<s;l++)if(274==t.getUint16(a+12*l,r))return n(t.getUint16(a+12*l+8,r))}else{if(65280!=(65280&o))break;a+=t.getUint16(a,!1)}}return n(-1)},a.readAsArrayBuffer(i)):t(1)});return e instanceof File&&h(e).then(function(e){var t=new URL(e.raw);t.searchParams.set("token",e.meta.access_token),r.setAttribute("media-loader",{src:t.href})}).catch(function(){r.setAttribute("media-loader",{src:"error"})}),r.addEventListener("media_resolved",function(e){var t=e.detail,a=(0,n.objectTypeForOriginAndContentType)(i,t.contentType);o.emit("object_spawned",{objectType:a})}),{entity:r,orientation:s}}},function(e,t,i){"use strict";AFRAME.registerComponent("gamma-factor",{schema:{gammaFactor:{type:"number",default:2.2}},init:function(){var e=this.el;e.isScene||console.warn("gamma-factor component can only be applied to <a-scene>")},update:function(e){var t=this.data,i=this.el,n=i.renderer,a=!1;t.gammaFactor!==e.gammaFactor&&(n.gammaFactor=t.gammaFactor,a=!0),a&&0!==i.time&&i.object3D.traverse(function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach(function(e){e.needsUpdate=!0}):e.material.needsUpdate=!0)})}})},function(e,t,i){e.exports=i.p+"assets/images/logo-8f1dfd234d060073524bc29912a24f75.svg"},,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},a=i(84);t.default=function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setSocket=function(e){i.socket=e},this.generateCode=function(){return new Promise(function(e){var t=new Promise(function(o){!function r(){var s=Math.floor(9999*Math.random()).toString().padStart(4,"0"),l=!1,c=!1,d=i.socket.channel("link:"+s,{timeout:1e4}),u=function(){c||d.leave(),c=!0},h=function(){return u()};d.on("link_expired",function(){return o("expired")}),d.on("presence_state",function(i){l||(Object.keys(i).length>0?r():(l=!0,e({code:s,cancel:h,onFinished:t})))}),d.on("link_request",function(e){if(l){var t={path:location.pathname};i.store.state.activity.hasChangedName&&(t.profile=n({},i.store.state.profile)),(0,a.generatePublicKeyAndEncryptedObject)(e.public_key,t).then(function(t){var i=t.publicKeyString,n=t.encryptedData,a={target_session_id:e.reply_to_session_id,public_key:i,data:n};c||d.push("link_response",a),u(),o("used"),l=!1})}}),d.join().receive("error",function(e){return console.error(e)})}()})})},this.attemptLink=function(e){return new Promise(function(t,n){var o=i.socket.channel("link:"+e,{timeout:1e4}),r=!1;(0,a.generateKeys)().then(function(e){var s=e.publicKeyString,l=e.privateKey;o.on("presence_state",function(e){var t=Object.keys(e).length;1===t?(o.push("link_request",{reply_to_session_id:i.socket.params.session_id,public_key:s}),setTimeout(function(){r||(o.leave(),n(new Error("no_response")))},1e4)):0===t?(o.leave(),n(new Error("failed"))):(console.warn("link code channel already has 2 or more occupants, something fishy is going on."),o.leave(),n(new Error("in_use")))}),o.on("link_response",function(e){r=!0,o.leave(),(0,a.decryptObject)(e.public_key,l,e.data).then(t)}),o.join().receive("error",function(e){return console.error(e)})})})},this.store=t}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a,o,r,s,l,c=(n=h(function*(e,t){return crypto.subtle.deriveKey({name:"ECDH",public:t},e,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"])}),function(e,t){return n.apply(this,arguments)}),d=(a=h(function*(e){return JSON.stringify(yield crypto.subtle.exportKey("jwk",e))}),function(e){return a.apply(this,arguments)}),u=(o=h(function*(e){return yield crypto.subtle.importKey("jwk",JSON.parse(e),{name:"ECDH",namedCurve:"P-256"},!0,[])}),function(e){return o.apply(this,arguments)});t.generateKeys=(r=h(function*(){var e=yield crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]),t=yield d(e.publicKey);return{publicKeyString:t,privateKey:e.privateKey}}),function(){return r.apply(this,arguments)}),t.generatePublicKeyAndEncryptedObject=(s=h(function*(e,t){var i=new Uint8Array(16),n=yield u(e),a=yield crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]),o=yield d(a.publicKey),r=yield c(a.privateKey,n),s=btoa(p(yield crypto.subtle.encrypt({name:"AES-CBC",iv:i},r,f(JSON.stringify(t)))));return{publicKeyString:o,encryptedData:s}}),function(e,t){return s.apply(this,arguments)}),t.decryptObject=(l=h(function*(e,t,i){var n=new Uint8Array(16),a=yield u(e),o=yield c(t,a),r=f(atob(i)),s=yield crypto.subtle.decrypt({name:"AES-CBC",iv:n},o,r);return JSON.parse(p(s))}),function(e,t,i){return l.apply(this,arguments)});function h(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function f(e){for(var t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}function p(e){for(var t=new Uint8Array(e),i="",n=0;n<t.byteLength;n++)i+=String.fromCharCode(t[n]);return i}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.connectToReticulum=function(){var e=new URLSearchParams(location.search),t=e.get("phx_protocol")||("https:"===document.location.protocol?"wss:":"ws:"),i=e.get("phx_host"),a=e.get("phx_port");var o="dev.reticulum.io".split(":"),l=n(o,2),c=l[0],d=l[1];i=i||c||"",a=a||d||"443";var u=t+"//"+i+(a?":"+a:"")+"/socket";console.log("Phoenix Socket URL: "+u);var h=new s.Socket(u,{params:{session_id:(0,r.default)()}});return h.connect(),h};var a,o=i(119),r=(a=o,a&&a.__esModule?a:{default:a}),s=i(120)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableiOSZoom=function(){if("iOS"!==(0,n.detectOS)(navigator.userAgent))return;var e=0;document.addEventListener("touchmove",function(e){1!==e.scale&&e.preventDefault()}),document.addEventListener("touchend",function(t){var i=(new Date).getTime(),n=i-e<=300;e=i,n&&t.preventDefault()})};var n=i(78)},function(e,t,i){"use strict";var n,a;i(42),AFRAME.GLTFModelPlus.registerComponent("duck","duck"),AFRAME.GLTFModelPlus.registerComponent("quack","quack"),AFRAME.GLTFModelPlus.registerComponent("sound","sound"),AFRAME.GLTFModelPlus.registerComponent("collision-filter","collision-filter"),AFRAME.GLTFModelPlus.registerComponent("css-class","css-class"),AFRAME.GLTFModelPlus.registerComponent("scene-shadow","scene-shadow"),AFRAME.GLTFModelPlus.registerComponent("super-spawner","super-spawner"),AFRAME.GLTFModelPlus.registerComponent("gltf-model-plus","gltf-model-plus"),AFRAME.GLTFModelPlus.registerComponent("media-loader","media-loader"),AFRAME.GLTFModelPlus.registerComponent("body","body"),AFRAME.GLTFModelPlus.registerComponent("hide-when-quality","hide-when-quality"),AFRAME.GLTFModelPlus.registerComponent("light","light"),AFRAME.GLTFModelPlus.registerComponent("ambient-light","ambient-light"),AFRAME.GLTFModelPlus.registerComponent("directional-light","directional-light"),AFRAME.GLTFModelPlus.registerComponent("hemisphere-light","hemisphere-light"),AFRAME.GLTFModelPlus.registerComponent("point-light","point-light"),AFRAME.GLTFModelPlus.registerComponent("spot-light","spot-light"),AFRAME.GLTFModelPlus.registerComponent("skybox","skybox"),AFRAME.GLTFModelPlus.registerComponent("layers","layers"),AFRAME.GLTFModelPlus.registerComponent("shadow","shadow"),AFRAME.GLTFModelPlus.registerComponent("water","water"),AFRAME.GLTFModelPlus.registerComponent("scale-audio-feedback","scale-audio-feedback"),AFRAME.GLTFModelPlus.registerComponent("animation-mixer","animation-mixer"),AFRAME.GLTFModelPlus.registerComponent("loop-animation","loop-animation"),AFRAME.GLTFModelPlus.registerComponent("shape","shape"),AFRAME.GLTFModelPlus.registerComponent("box-collider","shape",(n=new THREE.Euler,a=new THREE.Quaternion,function(e,t,i){var o=i.scale,r=i.rotation;n.set(r.x,r.y,r.z),a.setFromEuler(n),e.setAttribute(t,{shape:"box",offset:i.position,halfExtents:{x:o.x/2,y:o.y/2,z:o.z/2},orientation:a})})),AFRAME.GLTFModelPlus.registerComponent("visible","visible"),AFRAME.GLTFModelPlus.registerComponent("spawn-point","spawn-point"),AFRAME.GLTFModelPlus.registerComponent("hoverable","hoverable"),AFRAME.GLTFModelPlus.registerComponent("sticky-zone","sticky-zone"),AFRAME.GLTFModelPlus.registerComponent("nav-mesh","nav-mesh",function(e,t,i){var n=AFRAME.scenes[0].systems.nav,a=i.zone||"character",o=!1;e.object3D.traverse(function(e){e.isMesh&&!o&&(o=!0,n.loadMesh(e,a))})})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var n,a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(20),r=(n=o,n&&n.__esModule?n:{default:n});t.App=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=null,this.quality="low",this.store=new r.default}return a(e,[{key:"setQuality",value:function(e){return this.quality!==e&&(this.quality=e,this.scene&&this.scene.dispatchEvent(new CustomEvent("quality-changed",{detail:e})),!0)}}]),e}()},,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.angleTo4Direction=function(e){return e=(e*THREE.Math.RAD2DEG+180+45)%360,e>0&&e<90?"north":e>=90&&e<180?"west":e>=180&&e<270?"south":"east"},t.angleTo8Direction=function(e){e=(e*THREE.Math.RAD2DEG+180+45)%360;var t="";(e>=0&&e<120||e>=330)&&(t+="north");e>=150&&e<300&&(t+="south");e>=60&&e<210&&(t+="west");(e>=240&&e<360||e<30)&&(t+="east");return t}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="open",a="point",o="fist",r="thumbUp",s="thumbDown",l="indexDown",c="pinch",d="mrpDown",u=t.CONTROLLER_OFFSETS={default:new THREE.Matrix4,"oculus-touch-controls":(new THREE.Matrix4).makeTranslation(0,-.015,.04),"oculus-go-controls":new THREE.Matrix4,"vive-controls":(new THREE.Matrix4).compose(new THREE.Vector3(0,-.017,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),"windows-motion-controls":(new THREE.Matrix4).compose(new THREE.Vector3(0,-.017,.13),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-40*THREE.Math.DEG2RAD,0,0)),new THREE.Vector3(1,1,1)),"daydream-controls":(new THREE.Matrix4).makeTranslation(0,0,-.04),"gearvr-controls":new THREE.Matrix4};AFRAME.registerComponent("hand-controls2",{schema:{default:"left"},init:function(){var e=this.el;this.pose=n,this.fingersDown={thumb:!1,index:!1,middle:!1,ring:!1,pinky:!1},this.onMiddleRingPinkyDown=this.updatePose.bind(this,{middle:!0,ring:!0,pinky:!0}),this.onMiddleRingPinkyUp=this.updatePose.bind(this,{middle:!1,ring:!1,pinky:!1}),this.onIndexDown=this.updatePose.bind(this,{index:!0}),this.onIndexUp=this.updatePose.bind(this,{index:!1}),this.onThumbDown=this.updatePose.bind(this,{thumb:!0}),this.onThumbUp=this.updatePose.bind(this,{thumb:!1}),this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),this.connectedController=null,e.addEventListener("controllerconnected",this.onControllerConnected),e.addEventListener("controllerdisconnected",this.onControllerDisconnected),e.setAttribute("visible",!1)},play:function(){var e=this.el;e.addEventListener("middle_ring_pinky_down",this.onMiddleRingPinkyDown),e.addEventListener("middle_ring_pinky_up",this.onMiddleRingPinkyUp),e.addEventListener("thumb_down",this.onThumbDown),e.addEventListener("thumb_up",this.onThumbUp),e.addEventListener("index_down",this.onIndexDown),e.addEventListener("index_up",this.onIndexUp)},pause:function(){var e=this.el;e.removeEventListener("middle_ring_pinky_down",this.onMiddleRingPinkyDown),e.removeEventListener("middle_ring_pinky_up",this.onMiddleRingPinkyUp),e.removeEventListener("thumb_down",this.onThumbDown),e.removeEventListener("thumb_up",this.onThumbUp),e.removeEventListener("index_down",this.onIndexDown),e.removeEventListener("index_up",this.onIndexUp)},update:function(e){var t=this.el,i=this.data,n={hand:i,model:!1,orientationOffset:{x:0,y:0,z:0}};i!==e&&(t.setAttribute("vive-controls",n),t.setAttribute("oculus-touch-controls",n),t.setAttribute("oculus-go-controls",n),t.setAttribute("windows-motion-controls",n),t.setAttribute("daydream-controls",n),t.setAttribute("gearvr-controls",n))},remove:function(){var e=this.el;e.removeEventListener("controllerconnected",this.onControllerConnected),e.removeEventListener("controllerdisconnected",this.onControllerDisconnected)},updatePose:function(e){Object.assign(this.fingersDown,e);var t=this.determinePose();if(t!==this.pose){var i=this.pose;this.pose=t,this.el.emit("hand-pose",{previous:i,current:this.pose})}},determinePose:function(){var e=this.fingersDown,t=e.thumb,i=e.index,u=e.middle,h=e.ring,f=e.pinky;return t||i||u||h||f?t&&i&&u&&h&&f?o:!t&&i&&u&&h&&f?r:!t&&!i&&u&&h&&f?d:t||!i||u||h||f?!t||i||u||h||f?!t||!i||u||h||f?t&&!i&&u&&h&&f?a:(console.warn("Did not find matching pose for ",this.fingersDown),n):c:s:l:n},onControllerConnected:function(e){this.connectedController=e.detail.name,this.el.setAttribute("visible",!0)},onControllerDisconnected:function(){this.connectedController=null,this.el.setAttribute("visible",!1)},getControllerOffset:function(){return void 0===u[this.connectedController]?u.default:u[this.connectedController]}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.Layers={reflection:3};AFRAME.registerComponent("layers",{schema:{reflection:{type:"boolean",default:!1}},init:function(){this.update=this.update.bind(this),this.el.addEventListener("model-loaded",this.update)},update:function(e){this.data.reflection!==e.reflection&&(this.data.reflection?this.el.object3D.traverse(function(e){e.layers.enable(n.reflection)}):this.el.object3D.traverse(function(e){e.layers.disable(n.reflection)}))},remove:function(){this.el.removeEventListener("model-loaded",this.update)}})},,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.AppModes=Object.freeze({DEFAULT:"default",HUD:"hud"});AFRAME.registerSystem("app-mode",{init:function(){this.setMode(n.DEFAULT)},setMode:function(e){Object.values(n).includes(e)&&e!==this.mode&&(this.mode=e,this.el.emit("app-mode-change",{mode:this.mode}))}}),AFRAME.registerComponent("app-mode-toggle-playing",{multiple:!0,schema:{mode:{type:"string"},invert:{type:"boolean",default:!1}},init:function(){var e=this,t=this.el.sceneEl.systems["app-mode"];this.el.sceneEl.addEventListener("app-mode-change",function(t){e.updateComponentState(t.detail.mode===e.data.mode)}),this.updateComponentState(t.mode===this.data.mode)},updateComponentState:function(e){var t=this.id;this.el.components[t][e!==this.data.invert?"play":"pause"]()}}),AFRAME.registerComponent("app-mode-toggle-attribute",{multiple:!0,schema:{mode:{type:"string"},invert:{type:"boolean",default:!1},property:{type:"string"}},init:function(){var e=this,t=this.el.sceneEl.systems["app-mode"];this.el.sceneEl.addEventListener("app-mode-change",function(t){e.updateComponentState(t.detail.mode===e.data.mode)}),this.updateComponentState(t.mode===this.data.mode)},updateComponentState:function(e){var t=this.id;this.el.setAttribute(t,this.data.property,e!==this.data.invert)}}),AFRAME.registerComponent("app-mode-input-mappings",{schema:{modes:{default:[]},actionSets:{default:[]}},init:function(){var e=this;this.el.sceneEl.addEventListener("app-mode-change",function(t){var i=e.data,n=i.modes,a=i.actionSets,o=n.indexOf(t.detail.mode);-1!=o&&n[o]&&a[o]&&AFRAME.inputActions[a[o]]?AFRAME.currentInputMapping=a[o]:console.error("no valid action set for "+t.detail.mode)})}}),AFRAME.registerComponent("vr-mode-toggle-visibility",{schema:{invert:{type:"boolean",default:!1}},init:function(){this.updateComponentState=this.updateComponentState.bind(this)},play:function(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause:function(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState:function(){var e=this.el.sceneEl.is("vr-mode");this.el.setAttribute("visible",e!==this.data.invert)}}),AFRAME.registerComponent("vr-mode-toggle-playing",{multiple:!0,schema:{invert:{type:"boolean",default:!1}},init:function(){this.updateComponentState=this.updateComponentState.bind(this)},play:function(){this.updateComponentState(),this.el.sceneEl.addEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.addEventListener("exit-vr",this.updateComponentState)},pause:function(){this.el.sceneEl.removeEventListener("enter-vr",this.updateComponentState),this.el.sceneEl.removeEventListener("exit-vr",this.updateComponentState)},updateComponentState:function(){var e=this.id,t=this.el.sceneEl.is("vr-mode");this.el.components[e][t!==this.data.invert?"play":"pause"]()}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBox=function(e,t){var i=new THREE.Box3;return n.copy(e.object3D.rotation),e.object3D.rotation.set(0,0,0),e.object3D.updateMatrixWorld(!0),i.setFromObject(t),e.object3D.worldToLocal(i.min),e.object3D.worldToLocal(i.max),e.object3D.rotation.copy(n),i},t.getScaleCoefficient=function(e,t){var i=t.max,n=t.min,a=Math.abs(i.x-n.x),o=Math.abs(i.y-n.y),r=Math.abs(i.z-n.z),s=Math.max(a,o,r);return e/s};var n=new THREE.Euler},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a;t.getAvailableVREntryTypes=(n=function*(){var e=navigator.userAgent,t="chrome"===s.name&&/SamsungBrowser/.test(e),i=/Oculus/.test(e),n=window.hasNativeWebVRImplementation,a=!(!n||"chrome"!==s.name||t),o=AFRAME.utils.device.isIOS(),r="firefox"===s.name,d=void 0===navigator.mediaDevices,u=o?d?l.maybe:l.yes:l.no,h=n?yield navigator.getVRDisplays():[],f=r||i,p=f?l.no:o&&d?l.maybe:l.yes,m=!n&&r,v=AFRAME.utils.device.isMobile()||m?l.no:l.maybe,g=l.no,y=l.no;(function(e){return/\WAndroid\W/.test(e)})(e)&&(y=i?l.yes:l.maybe);var b=function(e){return/\WAndroid\W/.test(e)}(e)&&!f?l.maybe:l.no;if(n){v=h.find(function(e){return e.capabilities.canPresent&&!c.find(function(t){return t.test(e.displayName)})})?l.yes:l.no,g=o||r||!h.find(function(e){return e.capabilities.canPresent&&/cardboard/i.test(e.displayName)})?l.no:l.yes;var E=h.find(function(e){return/daydream/i.test(e.displayName)});E?(b=l.yes,v=l.no):a&&(b=l.no)}return{screen:p,generic:v,gearvr:y,daydream:b,cardboard:g,isInHMD:f,safari:u}},a=function(){var e=n.apply(this,arguments);return new Promise(function(t,i){return function n(a,o){try{var r=e[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})},function(){return a.apply(this,arguments)});var o=i(78),r=o.detect,s=r(),l=t.VR_DEVICE_AVAILABILITY={yes:"yes",no:"no",maybe:"maybe"};var c=[/cardboard/i]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};i(445),i(41),i(176);var a=i(60),o=i(107),r=z(o);i(61),i(179),i(196),i(199),i(203),i(211),i(212),i(213),i(225),i(226),i(234);var s=i(235),l=z(s),c=i(236),d=z(c),u=i(237),h=z(u),f=i(238),p=z(f),m=i(239),v=i(240),g=i(65);i(241),i(242),i(243),i(66),i(244),i(245),i(246),i(247),i(249),i(111),i(250),i(251),i(252),i(253),i(254),i(256),i(112),i(257),i(258),i(259),i(260),i(67),i(68),i(261),i(42),i(262),i(263),i(264),i(265),i(266),i(267),i(268),i(269),i(270),i(271),i(272),i(273),i(274),i(277),i(278),i(279),i(280),i(285),i(286),i(287),i(288),i(289),i(290),i(76),i(292),i(293),i(294),i(295),i(296),i(297);var y=i(36),b=z(y),E=i(1),_=z(E),w=i(298),k=z(w),A=i(340),R=z(A),C=i(83),M=z(C),T=i(85),S=i(86),x=i(75);i(343),i(345),i(115),i(346),i(87);var L=i(52),D=i(88);i(347),i(387),i(392),i(402),i(403),i(404),i(406),i(407),i(408),i(409),i(410),i(411),i(412),i(413),i(414),i(421),i(422),i(425);var P=i(426),F=z(P),O=i(427),N=i(14),H=z(N),B=i(117),j=i(428),I=z(j),V=i(59),U=z(V);function z(e){return e&&e.__esModule?e:{default:e}}function G(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}console.log("Hubs version: "+({NODE_ENV:"production",JANUS_SERVER:"wss://prod-janus.reticulum.io",RETICULUM_SERVER:"dev.reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.BUILD_VERSION||"?")),(0,a.patchWebGLRenderingContext)(),window.APP=new D.App,window.APP.RENDER_ORDER={HUD_BACKGROUND:1,HUD_ICONS:2,CURSOR:3};var W=window.APP.store,q=new URLSearchParams(location.search),Y=AFRAME.utils.device.isMobile();window.APP.quality=q.get("quality")||Y?"low":"high";var Q=(0,U.default)("bot"),J=(0,U.default)("disable_telemetry"),X=(0,U.default)("debug");Q||J||(0,H.default)(),(0,S.disableiOSZoom)(),AFRAME.registerInputBehaviour("trackpad_dpad4",l.default),AFRAME.registerInputBehaviour("trackpad_scrolling",d.default),AFRAME.registerInputBehaviour("joystick_dpad4",h.default),AFRAME.registerInputBehaviour("msft_mr_axis_with_deadzone",p.default),AFRAME.registerInputActivator("pressedmove",m.PressedMove),AFRAME.registerInputActivator("reverseY",v.ReverseY),AFRAME.registerInputMappings(O.config,!0);var K=new I.default;function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(0,U.default)("allow_multi"),a=q.get("vr_entry_type"),o=(0,U.default)("enable_screen_sharing"),r=!W.state.activity.hasChangedName;b.default.render(_.default.createElement(k.default,n({scene:e,isBotMode:Q,concurrentLoadDetector:K,disableAutoExitOnConcurrentLoad:i,forcedVREntryType:a,enableScreenSharing:o,store:W,showProfileEntry:r},t)),document.getElementById("ui-root"))}function $(){r.default.enabled&&!r.default.isFullscreen&&r.default.request()}K.start(),W.init();var ee,te=(ee=G(function*(){var e=document.querySelector("a-scene"),t=new R.default(W),a=new M.default(W);document.querySelector("canvas").classList.add("blurred"),window.APP.scene=e,(0,F.default)();var o={linkChannel:a};Z(e);var r,s=function(t){o=n({},o,t),Z(e,o)},l=function(){NAF.connection.adapter&&NAF.connection.adapter.localMediaStream&&NAF.connection.adapter.localMediaStream.getTracks().forEach(function(e){return e.stop()}),t&&t.disconnect();var e=document.querySelector("a-scene");e&&(e.renderer&&e.renderer.setAnimationLoop(null),document.body.removeChild(e)),document.body.removeEventListener("touchend",$)},c=(r=G(function*(e,n,a){var o=document.querySelector("a-scene"),r=i(429);o.setAttribute("inspector",{url:r}),Q||o.classList.add("no-cursor");var c=document.querySelector("#player-rig");document.querySelector("canvas").classList.remove("blurred"),o.render(),n?o.enterVR():AFRAME.utils.device.isMobile()&&document.body.addEventListener("touchend",$),AFRAME.registerInputActions(O.inGameActions,"default"),o.setAttribute("networked-scene",{room:a,serverURL:"wss://prod-janus.reticulum.io"}),X&&o.setAttribute("networked-scene",{debug:!0}),o.setAttribute("stats-plus",!1),(Y||(0,U.default)("mobile"))&&c.setAttribute("virtual-gamepad-controls",{});var d=function(e){var t=W.state.profile.displayName;e.setAttribute("player-info",{displayName:t,avatarSrc:"#"+(W.state.profile.avatarId||"botdefault")});var i=e.querySelector("[hud-controller]");i.setAttribute("hud-controller",{showTip:!W.state.activity.hasFoundFreeze}),document.querySelector("a-scene").emit("username-changed",{username:t})}.bind(null,c);d(),W.addEventListener("statechanged",d);var u=parseInt(q.get("avatar_scale"),10);u&&c.setAttribute("scale",{x:u,y:u,z:u});var h=e?e.getVideoTracks():[],f=h.length>0,p=NAF.clientId+"-screen",m=document.getElementById(p);o.addEventListener("action_share_screen",function(){if(f=!f,f){var t=!0,i=!1,n=void 0;try{for(var a,o=h[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var r=a.value;e.addTrack(r)}}catch(e){i=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw n}}}else{var s=!0,l=!1,c=void 0;try{for(var d,u=e.getVideoTracks()[Symbol.iterator]();!(s=(d=u.next()).done);s=!0){var p=d.value;e.removeTrack(p)}}catch(e){l=!0,c=e}finally{try{!s&&u.return&&u.return()}finally{if(l)throw c}}}NAF.connection.adapter.setLocalMediaStream(e),m.setAttribute("visible",f)}),document.body.addEventListener("blocked",function(e){NAF.connection.entities.removeEntitiesOfClient(e.detail.clientId)}),document.body.addEventListener("unblocked",function(e){NAF.connection.entities.completeSync(e.detail.clientId)});var v={x:0,y:0,z:-1.5},y=function(e,t){var i=(0,x.addMedia)(e,"#interactable-media",t,!0),n=i.entity,a=i.orientation;a.then(function(e){n.setAttribute("offset-relative-to",{target:"#player-camera",offset:v,orientation:e})})};if(o.addEventListener("add_media",function(e){var t=e.detail instanceof File?g.ObjectContentOrigins.FILE:g.ObjectContentOrigins.URL;y(e.detail,t)}),o.addEventListener("object_spawned",function(e){t&&t.sendObjectSpawnedEvent(e.detail.objectType)}),document.addEventListener("paste",function(e){if("INPUT"!==e.target.nodeName){var t=e.clipboardData.getData("text"),i=e.clipboardData.files&&e.clipboardData.files;if(t)y(t,g.ObjectContentOrigins.URL);else{var n=!0,a=!1,o=void 0;try{for(var r,s=i[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;y(l,g.ObjectContentOrigins.CLIPBOARD)}}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}}}}),document.addEventListener("dragover",function(e){e.preventDefault()}),document.addEventListener("drop",function(e){e.preventDefault();var t=e.dataTransfer.getData("url"),i=e.dataTransfer.files;if(t)y(t,g.ObjectContentOrigins.URL);else{var n=!0,a=!1,o=void 0;try{for(var r,s=i[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;y(l,g.ObjectContentOrigins.FILE)}}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}}}),!(0,U.default)("offline")){if(document.body.addEventListener("connected",function(){Q||t.sendEntryEvent().then(function(){W.update({activity:{lastEnteredAt:(new Date).toISOString()}})}),s({occupantCount:NAF.connection.adapter.publisher.initialOccupants.length+1})}),document.body.addEventListener("clientConnected",function(){s({occupantCount:Object.keys(NAF.connection.adapter.occupants).length+1})}),document.body.addEventListener("clientDisconnected",function(){s({occupantCount:Object.keys(NAF.connection.adapter.occupants).length+1})}),o.components["networked-scene"].connect().catch(function(e){var t=e.error&&e.error.msg.match(/\bfull\b/i);console.error(e),s({roomUnavailableReason:t?"full":"connect_error"}),l()}),X&&(NAF.connection.adapter.session.options.verbose=!0),Q){c.setAttribute("avatar-replay",{camera:"#player-camera",leftController:"#player-left-controller",rightController:"#player-right-controller"});var b=document.createElement("audio"),E=document.querySelector("#bot-audio-input");E.onchange=function(){b.loop=!0,b.muted=!0,b.crossorigin="anonymous",b.src=URL.createObjectURL(E.files[0]),document.body.appendChild(b)};var _=document.querySelector("#bot-data-input");_.onchange=function(){var e=URL.createObjectURL(_.files[0]);c.setAttribute("avatar-replay",{recordingUrl:e})},yield new Promise(function(e){return b.addEventListener("canplay",e)}),e.addTrack(b.captureStream().getAudioTracks()[0]),b.play()}if(e)if(NAF.connection.adapter.setLocalMediaStream(e),m)m.setAttribute("visible",f);else if(f){var w=document.querySelector("a-scene");m=document.createElement("a-entity"),m.id=p,m.setAttribute("offset-relative-to",{target:"#player-camera",offset:"0 0 -2",on:"action_share_screen"}),m.setAttribute("networked",{template:"#video-template"}),w.appendChild(m)}}}),function(e,t,i){return r.apply(this,arguments)});s({enterScene:c,exitScene:l});var d="undefined"==typeof RTCDataChannelEvent?"no_data_channels":null;if(d)return s({platformUnsupportedReason:d}),void l();if(q.get("required_version")&&{NODE_ENV:"production",JANUS_SERVER:"wss://prod-janus.reticulum.io",RETICULUM_SERVER:"dev.reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.BUILD_VERSION){var u={NODE_ENV:"production",JANUS_SERVER:"wss://prod-janus.reticulum.io",RETICULUM_SERVER:"dev.reticulum.io",ASSET_BUNDLE_SERVER:"https://asset-bundles-prod.reticulum.io",EXTRA_ENVIRONMENTS:""}.BUILD_VERSION.split(" ",1)[0];if(q.get("required_version")!==u)return s({roomUnavailableReason:"version_mismatch"}),setTimeout(function(){return document.location.reload()},5e3),void l()}(0,B.getAvailableVREntryTypes)().then(function(e){e.isInHMD?s({availableVREntryTypes:e,forcedVREntryType:"vr"}):e.gearvr===B.VR_DEVICE_AVAILABILITY.yes?s({availableVREntryTypes:e,forcedVREntryType:"gearvr"}):s({availableVREntryTypes:e})});var h=document.querySelector("#environment-root"),f=document.createElement("a-entity");f.addEventListener("bundleloaded",function(){if(s({initialEnvironmentLoaded:!0}),Q){var t=function(){};e.renderer={setAnimationLoop:t,render:t}}else setTimeout(function(){return e.renderer.setAnimationLoop(null)},100)}),h.appendChild(f);var p=function(t,i){if(Q){var n=function(){return c(new MediaStream,!1,t)};e.hasLoaded?n():e.addEventListener("loaded",n)}else s({hubId:t,hubName:i})};if(q.has("room"))return p(q.get("room")||"default"),void f.setAttribute("gltf-bundle",{src:L.DEFAULT_ENVIRONMENT_URL});var m=q.get("hub_id")||document.location.pathname.substring(1).split("/")[0];console.log("Hub ID: "+m);var v,y=(0,T.connectToReticulum)(),b=y.channel("hub:"+m,{});b.join().receive("ok",(v=G(function*(e){var i=e.hubs[0],n=i.topics[0],a=n.assets.find(function(e){return"gltf_bundle"===e.asset_type}).src;if(console.log("Scene URL: "+a),/\.gltf/i.test(a)||/\.glb/i.test(a)){var o=yield(0,x.resolveMedia)(a,!1,0),r=document.createElement("a-entity");r.setAttribute("gltf-model-plus",{src:o.raw,inflate:!0}),r.addEventListener("model-loaded",function(){return f.emit("bundleloaded")}),f.appendChild(r)}else f.setAttribute("gltf-bundle","src: "+a);p(i.hub_id,i.name),t.setPhoenixChannel(b)}),function(e){return v.apply(this,arguments)})).receive("error",function(e){"closed"===e.reason&&(l(),s({roomUnavailableReason:"closed"})),console.error(e)}),a.setSocket(y)}),function(){return ee.apply(this,arguments)});document.addEventListener("DOMContentLoaded",te)},function(e,t,i){"use strict";var n=i(177),a=s(n),o=i(59),r=s(o);function s(e){return e&&e.__esModule?e:{default:e}}var l=new URLSearchParams(location.search),c=(0,r.default)("debug"),d=l.get("log_filter")||c&&"naf-janus-adapter:*";d&&a.default.enable(d)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";document.addEventListener("DOMContentLoaded",function(){var e=THREE.AudioContext.getContext();function t(){e.resume(),setTimeout(function(){"running"===e.state&&(document.body.removeEventListener("touchend",t,!1),document.body.removeEventListener("mouseup",t,!1))},0)}document.body.addEventListener("touchend",t,!1),document.body.addEventListener("mouseup",t,!1)})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(110);function a(e,t){this.outputPrefix=t,this.lastDirection="",this.previous="",this.pressed=!1,this.emitDPad4=this.emitDPad4.bind(this),this.press=this.press.bind(this),this.unpress=this.unpress.bind(this),this.hapticIntensity="low",this.centerRadius=.6,this.el=e}a.prototype={addEventListeners:function(){this.el.addEventListener("axismove",this.emitDPad4),this.el.addEventListener("trackpaddown",this.press),this.el.addEventListener("trackpadup",this.unpress)},removeEventListeners:function(){this.el.removeEventListener("axismove",this.emitDPad4),this.el.removeEventListener("trackpaddown",this.press),this.el.removeEventListener("trackpadup",this.unpress)},press:function(){this.pressed=!0},unpress:function(){this.pressed=!1},emitDPad4:function(e){var t=e.detail.axis[0],i=e.detail.axis[1],a=Math.abs(t)<this.centerRadius&&Math.abs(i)<this.centerRadius,o=a?"center":(0,n.angleTo4Direction)(Math.atan2(t,-i)),r=this.pressed?"pressed_":"",s=""+(r+o);if(0===t&&0===i)return e.target.emit(this.outputPrefix+"_dpad4_"+this.previous+"_up"),void(this.previous="");s!==this.previous&&(""!==this.previous&&e.target.emit(this.outputPrefix+"_dpad4_"+this.previous+"_up"),e.target.emit(this.outputPrefix+"_dpad4_"+s+"_down"),this.previous=s)}},t.default=a},function(e,t,i){"use strict";function n(e){this.el=e,this.start="trackpadtouchstart",this.move="axismove",this.end="trackpadtouchend",this.isScrolling=!1,this.x=-10,this.y=-10,this.axis=[0,0],this.emittedEventDetail={detail:{axis:this.axis}},this.onStart=this.onStart.bind(this),this.onMove=this.onMove.bind(this),this.onEnd=this.onEnd.bind(this)}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype={addEventListeners:function(){this.el.addEventListener(this.start,this.onStart),this.el.addEventListener(this.move,this.onMove),this.el.addEventListener(this.end,this.onEnd)},removeEventListeners:function(){this.el.removeEventListener(this.start,this.onStart),this.el.removeEventListener(this.move,this.onMove),this.el.removeEventListener(this.end,this.onEnd)},onStart:function(){this.isScrolling=!0},onMove:function(e){if(this.isScrolling){var t=e.detail.axis[0],i=e.detail.axis[1];if(-10===this.x)return this.x=t,void(this.y=i);this.axis[0]=8*(t-this.x),this.axis[1]=8*(i-this.y),this.emittedEventDetail.axis=this.axis,e.target.emit("scroll",this.emittedEventDetail),this.x=t,this.y=i}},onEnd:function(){this.isScrolling=!1,this.x=-10,this.y=-10}},t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(110);function a(e,t){this.angleToDirection=n.angleTo4Direction,this.outputPrefix=t,this.centerRadius=.6,this.previous="none",this.hapticIntensity="low",this.emitDPad4=this.emitDPad4.bind(this),this.el=e}a.prototype={addEventListeners:function(){this.el.addEventListener("axismove",this.emitDPad4)},removeEventListeners:function(){this.el.removeEventListener("axismove",this.emitDPad4)},emitDPad4:function(e){var t=e.detail.axis[0],i=e.detail.axis[1],n=Math.abs(t)<this.centerRadius&&Math.abs(i)<this.centerRadius,a=n?"center":this.angleToDirection(Math.atan2(t,-i));a!==this.previous&&(this.previous=a,e.target.emit(this.outputPrefix+"_dpad4_"+a),e.target.emit("haptic_pulse",{intensity:this.hapticIntensity}))}},t.default=a},function(e,t,i){"use strict";function n(e,t){this.el=e,this.outputPrefix=t,this.deadzone=.1,this.emitAxisMoveWithDeadzone=this.emitAxisMoveWithDeadzone.bind(this)}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype={addEventListeners:function(){this.el.addEventListener("axismove",this.emitAxisMoveWithDeadzone)},removeEventListeners:function(){this.el.removeEventListener("axismove",this.emitAxisMoveWithDeadzone)},emitAxisMoveWithDeadzone:function(e){var t=e.detail.axis;Math.abs(t[0])<this.deadzone&&Math.abs(t[1])<this.deadzone||(t[1]=-t[1],this.el.emit("axisMoveWithDeadzone",e.detail))}},t.default=n},function(e,t,i){"use strict";function n(e,t,i){this.down=t+"down",this.up=t+"up",this.pressed=!1,this.onActivate=i,this.el=e,this.onButtonDown=this.onButtonDown.bind(this),this.onButtonUp=this.onButtonUp.bind(this),this.onAxisMove=this.onAxisMove.bind(this),e.addEventListener(this.down,this.onButtonDown),e.addEventListener(this.up,this.onButtonUp),e.addEventListener("axismove",this.onAxisMove)}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype={onAxisMove:function(e){this.pressed&&this.onActivate(e)},onButtonDown:function(){this.pressed=!0},onButtonUp:function(){this.pressed=!1},removeListeners:function(){this.el.addEventListener(this.down,this.onButtonDown),this.el.addEventListener(this.up,this.onButtonUp),this.el.addEventListener("axismove",this.onAxisMove)}},t.PressedMove=n},function(e,t,i){"use strict";function n(e,t,i){this.el=e,this.emitReverseY=this.emitReverseY.bind(this),this.onActivate=i,this.button=t,this.removeListeners=this.removeListeners.bind(this),e.addEventListener(t,this.emitReverseY)}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype={emitReverseY:function(e){e.detail.axis[1]*=-1,this.onActivate(e)},removeListeners:function(){this.el.removeEventListener(this.button,this.emitReverseY)}},t.ReverseY=n},function(e,t,i){"use strict";function n(e,t,i){this.lastTime=0,this.timeOut=500,this.eventNameDown=t+"down",this.eventNameUp=t+"up",this.el=e,this.onActivate=i,this.onButtonDown=this.onButtonDown.bind(this),this.onButtonUp=this.onButtonUp.bind(this),e.addEventListener(this.eventNameDown,this.onButtonDown),e.addEventListener(this.eventNameUp,this.onButtonUp)}n.prototype={onButtonDown:function(e){var t=this;this.pressTimer=window.setTimeout(function(){t.onActivate(e)},this.timeOut)},onButtonUp:function(){clearTimeout(this.pressTimer)},removeListeners:function(){this.el.removeEventListener(this.eventNameDown,this.onButtonDown),this.el.removeEventListener(this.eventNameUp,this.onButtonUp)}},AFRAME.registerInputActivator("shortpress",n)},function(e,t,i){"use strict";AFRAME.registerComponent("wasd-to-analog2d",{schema:{analog2dOutputAction:{default:"wasd_analog2d"}},init:function(){this.output=[0,0],this.vectors={w:[0,1],a:[-1,0],s:[0,-1],d:[1,0]},this.keys={},this.onWasd=this.onWasd.bind(this),this.move=this.move.bind(this),this.onBlur=this.onBlur.bind(this)},play:function(){var e=!0,t=!1,i=void 0;try{for(var n,a=["w_down","w_up","a_down","a_up","s_down","s_up","d_down","d_up"][Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var o=n.value;this.el.sceneEl.addEventListener(o,this.onWasd)}}catch(e){t=!0,i=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw i}}this.el.sceneEl.addEventListener(this.data.analog2dOutputAction,this.move),window.addEventListener("blur",this.onBlur)},pause:function(){this.el.sceneEl.removeEventListener("wasd",this.onWasd),this.el.sceneEl.removeEventListener(this.data.analog2dOutputAction,this.move),window.removeEventListener("blur",this.onBlur),this.keys={}},onBlur:function(){this.keys={}},move:function(e){this.el.emit("move",{axis:e.detail.axis})},onWasd:function(e){var t=e.type,i=-1!==t.indexOf("down"),n=t[0].toLowerCase();this.keys[n]=i},tick:function(){for(var e in this.target=[0,0],this.keys)this.keys[e]&&this.vectors[e]&&(this.target=[this.target[0]+this.vectors[e][0],this.target[1]+this.vectors[e][1]]);var t=Math.sqrt(this.target[0]*this.target[0]+this.target[1]*this.target[1]);0!==t&&(this.target[0]=this.target[0]/t,this.target[1]=this.target[1]/t);if(!(Math.abs(this.output[0])<.01&&Math.abs(this.output[1])<.01&&0===this.target[0]&&0===this.target[1])){this.output=[this.output[0]+.25*(this.target[0]-this.output[0]),this.output[1]+.25*(this.target[1]-this.output[1])],this.output!==[0,0]&&this.el.emit(this.data.analog2dOutputAction,{axis:this.output})}}})},function(e,t,i){"use strict";var n=function(e,t,i){if(e&&e.length){var n=function(e){t.length&&t.forEach(function(t){e.addEventListener(t,i)})},a=!0,o=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;n(c)}}catch(e){o=!0,r=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw r}}}},a=function(e,t,i){if(e&&e.length){var n=function(e){t.length&&t.forEach(function(t){e.removeEventListener(t,i)})},a=!0,o=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;n(c)}}catch(e){o=!0,r=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw r}}}};AFRAME.registerComponent("mute-mic",{schema:{eventSrc:{type:"selectorAll"},toggleEvents:{type:"array"},muteEvents:{type:"array"},unmuteEvents:{type:"array"}},init:function(){this.onToggle=this.onToggle.bind(this),this.onMute=this.onMute.bind(this),this.onUnmute=this.onUnmute.bind(this)},play:function(){var e=this.data,t=e.eventSrc,i=e.toggleEvents,a=e.muteEvents,o=e.unmuteEvents;n(t,i,this.onToggle),n(t,a,this.onMute),n(t,o,this.onUnmute)},pause:function(){var e=this.data,t=e.eventSrc,i=e.toggleEvents,n=e.muteEvents,o=e.unmuteEvents;a(t,i,this.onToggle),a(t,n,this.onMute),a(t,o,this.onUnmute)},onToggle:function(){this.el.is("muted")?(NAF.connection.adapter.enableMicrophone(!0),this.el.removeState("muted")):(NAF.connection.adapter.enableMicrophone(!1),this.el.addState("muted"))},onMute:function(){this.el.is("muted")||(NAF.connection.adapter.enableMicrophone(!1),this.el.addState("muted"))},onUnmute:function(){this.el.is("muted")&&(NAF.connection.adapter.enableMicrophone(!0),this.el.removeState("muted"))}})},function(e,t,i){"use strict";AFRAME.registerComponent("bone-mute-state-indicator",{schema:{unmutedBoneName:{default:"Watch_Joint_MicON"},mutedBoneName:{default:"Watch_Joint_Muted"},onPos:{default:.81},offPos:{default:.5}},init:function(){var e=this;this.onStateToggled=this.onStateToggled.bind(this),this.el.addEventListener("model-loaded",function(){e.unmutedBone=e.el.object3D.getObjectByName(e.data.unmutedBoneName),e.mutedBone=e.el.object3D.getObjectByName(e.data.mutedBoneName),e.modelLoaded=!0,e.updateMuteState()})},play:function(){this.el.sceneEl.addEventListener("stateadded",this.onStateToggled),this.el.sceneEl.addEventListener("stateremoved",this.onStateToggled)},pause:function(){this.el.sceneEl.removeEventListener("stateadded",this.onStateToggled),this.el.sceneEl.removeEventListener("stateremoved",this.onStateToggled)},onStateToggled:function(e){"muted"!==!e.detail.state&&this.updateMuteState()},updateMuteState:function(){if(this.modelLoaded){var e=this.el.sceneEl.is("muted");this.mutedBone.position.y=e?this.data.onPos:this.data.offPos,this.unmutedBone.position.y=e?this.data.offPos:this.data.onPos}}})},function(e,t,i){"use strict";AFRAME.registerComponent("bone-visibility",{tick:function(){var e=this.el.object3D.visible;this.lastVisible!==e&&(e?this.el.object3D.scale.set(1,1,1):this.el.object3D.scale.set(1e-8,1e-8,1e-8),this.lastVisible=e)}})},function(e,t,i){"use strict";AFRAME.registerComponent("in-world-hud",{schema:{haptic:{type:"selector"},raycaster:{type:"selector"}},init:function(){var e=this;this.mic=this.el.querySelector(".mic"),this.freeze=this.el.querySelector(".freeze"),this.pen=this.el.querySelector(".pen"),this.background=this.el.querySelector(".bg");var t=window.APP.RENDER_ORDER;this.mic.object3DMap.mesh.renderOrder=t.HUD_ICONS,this.freeze.object3DMap.mesh.renderOrder=t.HUD_ICONS,this.pen.object3DMap.mesh.renderOrder=t.HUD_ICONS,this.background.object3DMap.mesh.renderORder=t.HUD_BACKGROUND,this.updateButtonStates=function(){e.mic.setAttribute("icon-button","active",e.el.sceneEl.is("muted")),e.freeze.setAttribute("icon-button","active",e.el.sceneEl.is("frozen")),e.pen.setAttribute("icon-button","active",e.el.sceneEl.is("pen"))},this.updateButtonStates(),this.onStateChange=function(t){"muted"!==t.detail&&"frozen"!==t.detail&&"pen"!==t.detail||e.updateButtonStates()},this.onMicClick=function(){e.el.emit("action_mute")},this.onFreezeClick=function(){e.el.emit("action_freeze")},this.onPenClick=function(){e.el.emit("spawn_pen")}},play:function(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange),this.mic.addEventListener("click",this.onMicClick),this.freeze.addEventListener("click",this.onFreezeClick),this.pen.addEventListener("mousedown",this.onPenClick)},pause:function(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange),this.mic.removeEventListener("click",this.onMicClick),this.freeze.removeEventListener("click",this.onFreezeClick),this.pen.removeEventListener("mousedown",this.onPenClick)}})},function(e,t,i){"use strict";var n=i(248),a=s(n),o=i(447),r=s(o);function s(e){return e&&e.__esModule?e:{default:e}}AFRAME.registerComponent("virtual-gamepad-controls",{schema:{},init:function(){this.onEnterVr=this.onEnterVr.bind(this),this.onExitVr=this.onExitVr.bind(this),this.onFirstInteraction=this.onFirstInteraction.bind(this),this.onMoveJoystickChanged=this.onMoveJoystickChanged.bind(this),this.onMoveJoystickEnd=this.onMoveJoystickEnd.bind(this),this.onLookJoystickChanged=this.onLookJoystickChanged.bind(this),this.onLookJoystickEnd=this.onLookJoystickEnd.bind(this),this.mockJoystickContainer=document.createElement("div"),this.mockJoystickContainer.classList.add(r.default.mockJoystickContainer);var e=document.createElement("div");e.classList.add(r.default.mockJoystick);var t=document.createElement("div");t.classList.add(r.default.mockJoystick,r.default.inner),e.appendChild(t),this.mockJoystickContainer.appendChild(e);var i=document.createElement("div");i.classList.add(r.default.mockJoystick);var n=document.createElement("div");n.classList.add(r.default.mockJoystick,r.default.inner),i.appendChild(n),this.mockJoystickContainer.appendChild(i),document.body.appendChild(this.mockJoystickContainer);var o=document.createElement("div");o.classList.add(r.default.touchZone,r.default.left),document.body.appendChild(o),this.leftTouchZone=o,this.leftStick=a.default.create({zone:this.leftTouchZone,color:"white",fadeTime:0}),this.leftStick.on("start",this.onFirstInteraction),this.leftStick.on("move",this.onMoveJoystickChanged),this.leftStick.on("end",this.onMoveJoystickEnd);var s=document.createElement("div");s.classList.add(r.default.touchZone,r.default.right),document.body.appendChild(s),this.rightTouchZone=s,this.rightStick=a.default.create({zone:this.rightTouchZone,color:"white",fadeTime:0}),this.rightStick.on("start",this.onFirstInteraction),this.rightStick.on("move",this.onLookJoystickChanged),this.rightStick.on("end",this.onLookJoystickEnd),this.inVr=!1,this.moving=!1,this.rotating=!1,this.moveEvent={axis:[0,0]},this.rotateYEvent={value:0},this.rotateXEvent={value:0},this.el.sceneEl.addEventListener("enter-vr",this.onEnterVr),this.el.sceneEl.addEventListener("exit-vr",this.onExitVr)},onFirstInteraction:function(){this.leftStick.off("start",this.onFirstInteraction),this.rightStick.off("start",this.onFirstInteraction),document.body.removeChild(this.mockJoystickContainer)},onMoveJoystickChanged:function(e,t){var i=t.angle.radian,n=t.force<1?t.force:1,a=Math.cos(i)*n*.85,o=Math.sin(i)*n*.85;this.moving=!0,this.moveEvent.axis[0]=a,this.moveEvent.axis[1]=o},onMoveJoystickEnd:function(){this.moving=!1,this.moveEvent.axis[0]=0,this.moveEvent.axis[1]=0,this.el.sceneEl.emit("move",this.moveEvent)},onLookJoystickChanged:function(e,t){var i=t.angle.radian,n=t.force<1?t.force:1;this.rotating=!0,this.rotateYEvent.value=Math.cos(i)*n*.5,this.rotateXEvent.value=Math.sin(i)*n*.5},onLookJoystickEnd:function(){this.rotating=!1,this.rotateYEvent.value=0,this.rotateXEvent.value=0,this.el.sceneEl.emit("rotateY",this.rotateYEvent),this.el.sceneEl.emit("rotateX",this.rotateXEvent)},tick:function(){this.inVr||(this.moving&&this.el.sceneEl.emit("move",this.moveEvent),this.rotating&&(this.el.sceneEl.emit("rotateY",this.rotateYEvent),this.el.sceneEl.emit("rotateX",this.rotateXEvent)))},onEnterVr:function(){this.inVr=!0,this.leftTouchZone.style.display="none",this.rightTouchZone.style.display="none"},onExitVr:function(){this.inVr=!1,this.leftTouchZone.style.display="block",this.rightTouchZone.style.display="block"},remove:function(){this.el.sceneEl.removeEventListener("entervr",this.onEnterVr),this.el.sceneEl.removeEventListener("exitvr",this.onExitVr),document.body.removeChild(this.mockJoystickContainer),document.body.removeChild(this.leftTouchZone),document.body.removeChild(this.rightTouchZone)}})},,function(e,t,i){"use strict";var n=THREE,a=n.Vector3,o=n.Quaternion,r=n.Matrix4,s=n.Euler;AFRAME.registerComponent("ik-root",{schema:{camera:{type:"string",default:".camera"},leftController:{type:"string",default:".left-controller"},rightController:{type:"string",default:".right-controller"}},update:function(e){this.data.camera!==e.camera&&(this.camera=this.el.querySelector(this.data.camera)),this.data.leftController!==e.leftController&&(this.leftController=this.el.querySelector(this.data.leftController)),this.data.rightController!==e.rightController&&(this.rightController=this.el.querySelector(this.data.rightController))}}),AFRAME.registerComponent("ik-controller",{schema:{leftEye:{type:"string",default:"LeftEye"},rightEye:{type:"string",default:"RightEye"},head:{type:"string",default:"Head"},neck:{type:"string",default:"Neck"},leftHand:{type:"string",default:"LeftHand"},rightHand:{type:"string",default:"RightHand"},chest:{type:"string",default:"Chest"},hips:{type:"string",default:"Hips"},rotationSpeed:{default:5}},init:function(){this.flipY=(new r).makeRotationY(Math.PI),this.cameraForward=new r,this.headTransform=new r,this.hipsPosition=new a,this.invHipsToHeadVector=new a,this.middleEyeMatrix=new r,this.middleEyePosition=new a,this.invMiddleEyeToHead=new r,this.cameraYRotation=new s,this.cameraYQuaternion=new o,this.invHipsQuaternion=new o,this.headQuaternion=new o,this.rootToChest=new r,this.invRootToChest=new r,this.ikRoot=function(e){for(;e&&(!e.components||!e.components["ik-root"]);)e=e.parentNode;return e&&e.components["ik-root"]}(this.el),this.hands={left:{rotation:(new r).makeRotationFromEuler(new s(-Math.PI/2,Math.PI/2,0))},right:{rotation:(new r).makeRotationFromEuler(new s(Math.PI/2,Math.PI/2,0))}}},update:function(e){this.data.leftEye!==e.leftEye&&(this.leftEye=this.el.object3D.getObjectByName(this.data.leftEye)),this.data.rightEye!==e.rightEye&&(this.rightEye=this.el.object3D.getObjectByName(this.data.rightEye)),this.data.head!==e.head&&(this.head=this.el.object3D.getObjectByName(this.data.head)),this.data.neck!==e.neck&&(this.neck=this.el.object3D.getObjectByName(this.data.neck)),this.data.leftHand!==e.leftHand&&(this.leftHand=this.el.object3D.getObjectByName(this.data.leftHand)),this.data.rightHand!==e.rightHand&&(this.rightHand=this.el.object3D.getObjectByName(this.data.rightHand)),this.data.chest!==e.chest&&(this.chest=this.el.object3D.getObjectByName(this.data.chest)),this.data.hips!==e.hips&&(this.hips=this.el.object3D.getObjectByName(this.data.hips)),this.middleEyePosition.addVectors(this.leftEye.position,this.rightEye.position),this.middleEyePosition.divideScalar(2),this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x,this.middleEyePosition.y,this.middleEyePosition.z),this.invMiddleEyeToHead=this.middleEyeMatrix.getInverse(this.middleEyeMatrix),this.invHipsToHeadVector.addVectors(this.chest.position,this.neck.position).add(this.head.position).negate()},tick:function(e,t){if(this.ikRoot){var i=this.ikRoot,n=i.camera,a=i.leftController,r=i.rightController,s=this.hips,l=this.head,c=this.chest,d=this.cameraForward,u=this.headTransform,h=this.invMiddleEyeToHead,f=this.invHipsToHeadVector,p=this.flipY,m=this.cameraYRotation,v=this.cameraYQuaternion,g=this.invHipsQuaternion,y=this.leftHand,b=this.rightHand,E=this.rootToChest,_=this.invRootToChest;n.object3D.updateMatrix(),d.multiplyMatrices(n.object3D.matrix,p),u.multiplyMatrices(d,h),s.position.setFromMatrixPosition(u).add(f),m.setFromRotationMatrix(d,"YXZ"),m.x=0,m.z=0,v.setFromEuler(m),o.slerp(s.quaternion,v,s.quaternion,this.data.rotationSpeed*t/1e3),g.copy(s.quaternion).inverse(),l.quaternion.setFromRotationMatrix(u).premultiply(g),s.updateMatrix(),E.multiplyMatrices(s.matrix,c.matrix),_.getInverse(E),this.updateHand(this.hands.left,y,a),this.updateHand(this.hands.right,b,r)}},updateHand:function(e,t,i){var n=t.el,a=t.matrix,o=i.object3D,r=n.components["personal-space-invader"],s=r&&r.invading;if(t.visible=!s&&o.visible,o.visible){a.multiplyMatrices(this.invRootToChest,o.matrix);var l=i.components["hand-controls2"];l&&a.multiply(l.getControllerOffset()),a.multiply(e.rotation),t.position.setFromMatrixPosition(a),t.rotation.setFromRotationMatrix(a)}}})},function(e,t,i){"use strict";var n,a,o,r,s,l,c,d,u,h,f,p;AFRAME.registerComponent("character-controller",{schema:{groundAcc:{default:5.5},easing:{default:10},pivot:{type:"selector"},snapRotationDegrees:{default:45*THREE.Math.DEG2RAD},rotationSpeed:{default:-3}},init:function(){this.navZone="character",this.navGroup=null,this.navNode=null,this.velocity=new THREE.Vector3(0,0,0),this.accelerationInput=new THREE.Vector3(0,0,0),this.pendingSnapRotationMatrix=new THREE.Matrix4,this.angularVelocity=0,this.setAccelerationInput=this.setAccelerationInput.bind(this),this.snapRotateLeft=this.snapRotateLeft.bind(this),this.snapRotateRight=this.snapRotateRight.bind(this),this.setAngularVelocity=this.setAngularVelocity.bind(this),this.handleTeleport=this.handleTeleport.bind(this)},update:function(){this.leftRotationMatrix=(new THREE.Matrix4).makeRotationY(this.data.snapRotationDegrees),this.rightRotationMatrix=(new THREE.Matrix4).makeRotationY(-this.data.snapRotationDegrees)},play:function(){var e=this.el.sceneEl;e.addEventListener("move",this.setAccelerationInput),e.addEventListener("rotateY",this.setAngularVelocity),e.addEventListener("snap_rotate_left",this.snapRotateLeft),e.addEventListener("snap_rotate_right",this.snapRotateRight),e.addEventListener("teleported",this.handleTeleport)},pause:function(){var e=this.el.sceneEl;e.removeEventListener("move",this.setAccelerationInput),e.removeEventListener("rotateY",this.setAngularVelocity),e.removeEventListener("snap_rotate_left",this.snapRotateLeft),e.removeEventListener("snap_rotate_right",this.snapRotateRight),e.removeEventListener("teleported",this.handleTeleport),this.reset()},reset:function(){this.accelerationInput.set(0,0,0),this.velocity.set(0,0,0),this.angularVelocity=0,this.pendingSnapRotationMatrix.identity()},setAccelerationInput:function(e){var t=e.detail.axis;this.accelerationInput.set(t[0],0,t[1])},setAngularVelocity:function(e){this.angularVelocity=e.detail.value},snapRotateLeft:function(){this.pendingSnapRotationMatrix.copy(this.leftRotationMatrix)},snapRotateRight:function(){this.pendingSnapRotationMatrix.copy(this.rightRotationMatrix)},handleTeleport:function(e){var t=e.detail.newPosition,i=e.detail.hitPoint;this.resetPositionOnNavMesh(t,i,this.el.object3D)},tick:(n=new THREE.Matrix4,a=new THREE.Matrix4,o=new THREE.Matrix4,r=new THREE.Vector3,s=new THREE.Vector3(0,1,0),l=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Matrix4,u=new THREE.Matrix4,h=new THREE.Matrix4,f=new THREE.Vector3,p=new THREE.Vector3,function(e,t){var i=t/1e3,m=this.el.object3D,v=this.data.pivot.object3D,g=this.data.groundAcc*i,y=this.data.rotationSpeed*this.angularVelocity*i;p.copy(m.scale),f.copy(m.position),m.updateMatrix(),r.copy(v.position),r.applyMatrix4(m.matrix),a.setPosition(r),o.makeTranslation(-r.x,-r.y,-r.z),c.makeRotationAxis(s,m.rotation.y),d.makeRotationAxis(s,-m.rotation.y),u.makeRotationAxis(s,v.rotation.y),h.makeRotationAxis(s,-v.rotation.y),this.updateVelocity(i),n.makeTranslation(this.velocity.x*g,this.velocity.y*g,this.velocity.z*g),l.makeRotationAxis(s,y),m.matrix.premultiply(o),m.matrix.premultiply(d),m.matrix.premultiply(h),m.matrix.premultiply(n),m.matrix.premultiply(l),m.matrix.premultiply(this.pendingSnapRotationMatrix),m.matrix.premultiply(u),m.matrix.premultiply(c),m.matrix.premultiply(a),m.matrix.decompose(m.position,m.quaternion,m.scale),m.scale.copy(p),this.pendingSnapRotationMatrix.identity(),this.velocity.lengthSq()>1e-5&&this.setPositionOnNavMesh(f,m.position,m)}),setPositionOnNavMesh:function(e,t,i){var n=this.el.sceneEl.systems.nav.pathfinder,a=this.navZone;a in n.zones&&(null==this.navGroup&&(this.navGroup=n.getGroup(a,t)),this.navNode=this.navNode||n.getClosestNode(t,a,this.navGroup,!0),this.navNode=n.clampStep(e,t,this.navNode,a,this.navGroup,i.position))},resetPositionOnNavMesh:function(e,t,i){var n=this.el.sceneEl.systems.nav.pathfinder,a=this.navZone;a in n.zones&&(this.navGroup=n.getGroup(a,e),this.navNode=n.getClosestNode(t,a,this.navGroup,!0)||this.navNode,this.navNode=n.clampStep(e,e,this.navNode,a,this.navGroup,i.position))},updateVelocity:function(e){var t=this.data,i=this.velocity;if(e>.2)return i.x=0,void(i.z=0);0!==i.x&&(i.x-=i.x*t.easing*e),0!==i.z&&(i.z-=i.z*t.easing*e),0!==i.y&&(i.y-=i.y*t.easing*e);var n=t.groundAcc*e*this.accelerationInput.x,a=t.groundAcc*e*-this.accelerationInput.z;i.x+=n,i.z+=a;this.accelerationInput.x=.7*this.accelerationInput.x,this.accelerationInput.z=.7*this.accelerationInput.z,Math.abs(i.x)<.01&&(i.x=0),Math.abs(i.y)<.01&&(i.y=0),Math.abs(i.z)<.01&&(i.z=0)}})},function(e,t,i){"use strict";var n={low:.07,medium:.2,high:1};AFRAME.registerComponent("haptic-feedback",{schema:{hapticEventName:{default:"haptic_pulse"}},init:function(){var e=this;this.handlePulse=this.handlePulse.bind(this),this.getActuator=this.getActuator.bind(this),this.getActuator().then(function(t){e.actuator=t})},getActuator:function(){var e=this;return new Promise(function(t){setTimeout(function i(){var n=e.el.components["tracked-controls"];n&&n.controller&&n.controller.hapticActuators&&n.controller.hapticActuators.length?t(n.controller.hapticActuators[0]):setTimeout(i,1e3)},1e3)})},play:function(){this.el.addEventListener(this.data.hapticEventName,this.handlePulse)},pause:function(){this.el.removeEventListener(this.data.hapticEventName,this.handlePulse)},handlePulse:function(e){var t=e.detail.intensity;n[t]?this.pulse(n[t]):Number(t)===t?this.pulse(t):console.warn("Invalid intensity : "+t)},pulse:function(e){this.actuator&&this.actuator.pulse(e,15)}})},function(e,t,i){"use strict";var n,a=i(449),o=(n=a,n&&n.__esModule?n:{default:n});AFRAME.registerComponent("networked-video-player",{schema:{},init:function(){var e,t=(e=function*(){var e=this;yield new Promise(function(e){NAF.clientId?e():document.body.addEventListener("connected",e)});var t=yield NAF.utils.getNetworkedEntity(this.el);if(!t)throw new Error("Video player must be added on a node, or a child of a node, with the `networked` component.");var i=t.components.networked.data.owner,n=new URLSearchParams(location.search),a=!n.has("accept_screen_shares");if(i!==NAF.clientId&&a)this.el.setAttribute("material",{visible:!1});else{var r=document.getElementById("nvp-debug-container");r||(r=document.createElement("div"),r.id="nvp-debug-container",r.classList.add(o.default.container),document.body.appendChild(r));var s=yield NAF.connection.adapter.getMediaStream(i,"video");if(s){var l=document.createElement("video");l.id="nvp-video-"+i,l.muted=!0,l.autoplay=!0,l.playsInline=!0,l.classList.add(o.default.video),l.srcObject=new MediaStream(s.getVideoTracks()),r.appendChild(l),l.play(),this.videoEl=l,l.onloadedmetadata=function(){var t=l.videoWidth/l.videoHeight;e.el.setAttribute("geometry",{width:1*t,height:1}),e.el.setAttribute("material","src",l)}}}},function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})});return function(){return t.apply(this,arguments)}}(),remove:function(){this.videoEl&&this.videoEl.parentNode.removeChild(this.videoEl)}})},function(e,t,i){"use strict";var n,a,o,r;AFRAME.registerComponent("offset-relative-to",{schema:{target:{type:"selector"},offset:{type:"vec3"},on:{type:"string"},orientation:{default:1},selfDestruct:{default:!1}},init:function(){this.updateOffset=this.updateOffset.bind(this),this.data.on?this.el.sceneEl.addEventListener(this.data.on,this.updateOffset):this.updateOffset()},updateOffset:(n=new THREE.Vector3(0,1,0),a=new THREE.Vector3(0,0,-1),o=Math.PI/2,r=new THREE.Vector3,function(){var e=this.el.object3D,t=this.data.target.object3D;switch(r.copy(this.data.offset),t.localToWorld(r),e.parent&&e.parent.worldToLocal(r),e.position.copy(r),this.el.body&&this.el.body.position.copy(e.position),t.getWorldQuaternion(e.quaternion),this.el.body&&this.el.body.quaternion.copy(e.quaternion),this.data.orientation){case 8:e.rotateOnAxis(a,3*o);break;case 7:e.rotateOnAxis(a,3*o),e.rotateOnAxis(n,2*o);break;case 6:e.rotateOnAxis(a,o);break;case 5:e.rotateOnAxis(a,o),e.rotateOnAxis(n,2*o);break;case 4:e.rotateOnAxis(a,2*o),e.rotateOnAxis(n,2*o);break;case 3:e.rotateOnAxis(a,2*o);break;case 2:e.rotateOnAxis(n,2*o)}this.data.selfDestruct&&(this.data.on&&this.el.sceneEl.removeEventListener(this.data.on,this.updateOffset),this.el.removeAttribute("offset-relative-to"))})})},function(e,t,i){"use strict";var n=i(112);function a(e,t){THREE.Mesh.call(this,e);t=t||{};var i=void 0!==t.time?t.time:0,n=void 0!==t.waterNormals?t.waterNormals:null,a=void 0!==t.sunDirection?t.sunDirection:new THREE.Vector3(.70707,.70707,0),o=new THREE.Color(void 0!==t.sunColor?t.sunColor:16777215),r=new THREE.Color(void 0!==t.waterColor?t.waterColor:8355711),s=void 0!==t.eye?t.eye:new THREE.Vector3(0,0,0),l=void 0!==t.distortionScale?t.distortionScale:20,c=void 0!==t.side?t.side:THREE.FrontSide,d=void 0!==t.fog&&t.fog,u={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.lights,{normalSampler:{value:null},time:{value:0},size:{value:1},distortionScale:{value:20},sunColor:{value:new THREE.Color(8355711)},sunDirection:{value:new THREE.Vector3(.70707,.70707,0)},eye:{value:new THREE.Vector3},waterColor:{value:new THREE.Color(5592405)}}]),vertexShader:"\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    ",fragmentShader:"\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      "+THREE.ShaderChunk.common+"\n      "+THREE.ShaderChunk.packing+"\n      "+THREE.ShaderChunk.bsdfs+"\n      "+THREE.ShaderChunk.lights_pars_begin+"\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    "},h=new THREE.ShaderMaterial({fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:THREE.UniformsUtils.clone(u.uniforms),transparent:!1,lights:!0,side:c,fog:d});h.uniforms.time.value=i,h.uniforms.normalSampler.value=n,h.uniforms.sunColor.value=o,h.uniforms.waterColor.value=r,h.uniforms.sunDirection.value=a,h.uniforms.distortionScale.value=l,h.uniforms.eye.value=s,this.material=h}i(255),a.prototype=Object.create(THREE.Mesh.prototype),a.prototype.constructor=THREE.Water,AFRAME.registerComponent("water",{schema:{waterColor:{type:"color",default:"#001e0f"},distortionScale:{type:"number",default:3.7},sunColor:{type:"color",default:"#ffffff"},inclination:{type:"number",default:0},azimuth:{type:"number",default:0},distance:{type:"number",default:1},speed:{type:"number",default:.1},forceMobile:{type:"boolean",default:!1},normalMap:{type:"asset",default:"#water-normal-map"}},init:function(){var e=this.el.getObject3D("mesh"),t=e.geometry;e.visible=!1;var i=new THREE.Texture(this.data.normalMap);i.wrapS=i.wrapT=THREE.RepeatWrapping,i.needsUpdate=!0;var o={textureWidth:512,textureHeight:512,waterNormals:i,sunDirection:this.data.sunDirection,sunColor:new THREE.Color(this.data.sunColor),waterColor:new THREE.Color(this.data.waterColor),distortionScale:this.data.distortionScale,fog:!1};AFRAME.utils.device.isMobile()||this.data.forceMobile?this.water=new a(t,o):(this.water=new THREE.Water(t,o),this.water.mirrorCamera.layers.set(n.Layers.reflection)),this.el.setObject3D("water",this.water)},update:function(e){var t=this.water.material.uniforms;if(this.data.forceMobile!==e.forceMobile)return this.el.removeObject3D("water"),void this.init();if(this.data.waterColor!==e.waterColor&&t.waterColor.value.setStyle(this.data.waterColor),this.data.distortionScale!==e.distortionScale&&(t.distortionScale.value=this.data.distortionScale),this.data.sunColor!==e.sunColor&&t.sunColor.value.setStyle(this.data.sunColor),this.data.inclination!==e.inclination||this.data.azimuth!==e.azimuth||this.data.distance!==e.distance){var i=Math.PI*(this.data.inclination-.5),n=2*Math.PI*(this.data.azimuth-.5),a=this.data.distance,o=a*Math.cos(n),r=a*Math.sin(n)*Math.sin(i),s=a*Math.sin(n)*Math.cos(i);t.sunDirection.value.set(o,r,s)}},tick:function(e){this.water.material.uniforms.time.value=e/1e3*this.data.speed},remove:function(){this.el.removeObject3D("water");var e=this.el.getObject3D("mesh");e.visible=!0}})},,function(e,t,i){"use strict";THREE.Sky=function(){var e=THREE.Sky.SkyShader,t=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:THREE.UniformsUtils.clone(e.uniforms),side:THREE.BackSide});THREE.Mesh.call(this,new THREE.BoxBufferGeometry(1,1,1),t)},THREE.Sky.prototype=Object.create(THREE.Mesh.prototype),THREE.Sky.prototype.constructor=THREE.Sky,THREE.Sky.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new THREE.Vector3}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")},AFRAME.registerComponent("skybox",{schema:{turbidity:{type:"number",default:10},rayleigh:{type:"number",default:2},luminance:{type:"number",default:1},mieCoefficient:{type:"number",default:.005},mieDirectionalG:{type:"number",default:.8},inclination:{type:"number",default:0},azimuth:{type:"number",default:0},distance:{type:"number",default:8e3}},init:function(){this.sky=new THREE.Sky,this.el.setObject3D("mesh",this.sky)},update:function(e){var t=this.sky.material.uniforms;if(this.data.turbidity!==e.turbidity&&(t.turbidity.value=this.data.turbidity),this.data.rayleigh!==e.rayleigh&&(t.rayleigh.value=this.data.rayleigh),this.data.luminance!==e.luminance&&(t.luminance.value=this.data.luminance),this.data.mieCoefficient!==e.mieCoefficient&&(t.mieCoefficient.value=this.data.mieCoefficient),this.data.mieDirectionalG!==e.mieDirectionalG&&(t.mieDirectionalG.value=this.data.mieDirectionalG),this.data.inclination!==e.inclination||this.data.azimuth!==e.azimuth||this.data.distance!==e.distance){var i=Math.PI*(this.data.inclination-.5),n=2*Math.PI*(this.data.azimuth-.5),a=this.data.distance,o=a*Math.cos(n),r=a*Math.sin(n)*Math.sin(i),s=a*Math.sin(n)*Math.cos(i);t.sunPosition.value.set(o,r,s).normalize()}},remove:function(){this.el.removeObject3D("mesh")}})},function(e,t,i){"use strict";AFRAME.registerComponent("spawn-controller",{schema:{target:{type:"selector"},loadedEvent:{type:"string"}},init:function(){this.onLoad=this.onLoad.bind(this),this.data.target.addEventListener(this.data.loadedEvent,this.onLoad)},onLoad:function(){var e=document.querySelectorAll("[spawn-point]");if(0!==e.length){var t=Math.round((e.length-1)*Math.random()),i=e[t];i.object3D.getWorldPosition(this.el.object3D.position),this.el.object3D.rotation.copy(i.object3D.rotation)}}}),AFRAME.registerComponent("spawn-point",{})},function(e,t,i){"use strict";AFRAME.registerComponent("hide-when-quality",{schema:{type:"string",default:"low"},init:function(){this.onQualityChanged=this.onQualityChanged.bind(this),this.el.sceneEl.addEventListener("quality-changed",this.onQualityChanged)},onQualityChanged:function(e){this.updateComponentState(e.detail)},update:function(e){this.data!==e&&this.updateComponentState(window.APP.quality)},updateComponentState:function(e){this.el.setAttribute("visible",e!==this.data)}})},function(e,t,i){"use strict";AFRAME.registerComponent("player-info",{schema:{displayName:{type:"string"},avatarSrc:{type:"string"}},init:function(){this.applyProperties=this.applyProperties.bind(this)},play:function(){this.el.addEventListener("model-loaded",this.applyProperties)},pause:function(){this.el.removeEventListener("model-loaded",this.applyProperties)},update:function(){this.applyProperties()},applyProperties:function(){var e=this.el.querySelector(".nametag");this.data.displayName&&e&&e.setAttribute("text",{value:this.data.displayName});var t=this.el.querySelector(".model");this.data.avatarSrc&&t&&t.setAttribute("gltf-model-plus","src",this.data.avatarSrc)}})},function(e,t,i){"use strict";AFRAME.registerComponent("lifecycle-checker",{schema:{name:{type:"string"},tick:{default:!1}},init:function(){this.log("init")},update:function(){this.log("update")},tick:function(){this.data.tick&&this.log("tick")},remove:function(){this.log("remove")},pause:function(){this.log("pause")},play:function(){this.log("play")},log:function(e){console.info("lifecycle-checker:"+this.data.name+" "+e)}})},function(e,t,i){"use strict";var n={open:"allOpen",thumbDown:"thumbDown",indexDown:"indexDown",mrpDown:"mrpDown",thumbUp:"thumbsUp",point:"point",fist:"allGrip",pinch:"pinch"},a=["allOpen","thumbDown","indexDown","mrpDown","thumbsUp","point","allGrip","pinch"];AFRAME.registerComponent("hand-pose",{multiple:!0,init:function(){this.pose=0,this.animatePose=this.animatePose.bind(this),this.mixer=this.el.components["animation-mixer"];var e=this.mixer.el.object3DMap,t=e.mesh||e.scene;this.clipActionObject=t.parent;var i="left"==this.id?"_L":"_R";this.from=this.to=this.mixer.mixer.clipAction(n.open+i,this.clipActionObject),this.from.play();this.networkedAvatar=function e(t){var i=t.components["networked-avatar"];return i||e(t.parentEl)}(this.el)},tick:function(){this.networkedAvatar&&this.networkedAvatar.data&&this.networkedAvatar.data[this.id+"_hand_pose"]!==this.pose&&(this.animatePose(a[this.pose],a[this.networkedAvatar.data[this.id+"_hand_pose"]]),this.pose=this.networkedAvatar.data[this.id+"_hand_pose"])},animatePose:function(e,t){this.from.stop(),this.to.stop();var i="left"==this.id?"_L":"_R";this.from=this.mixer.mixer.clipAction(e+i,this.clipActionObject),this.to=this.mixer.mixer.clipAction(t+i,this.clipActionObject),this.from.fadeOut(.065),this.to.fadeIn(.065),this.to.play(),this.from.play(),this.mixer.mixer.update(.001)}}),AFRAME.registerComponent("hand-pose-controller",{multiple:!0,schema:{eventSrc:{type:"selector"},networkedAvatar:{type:"selector"}},init:function(){this.setHandPose=this.setHandPose.bind(this)},play:function(){this.data.eventSrc.addEventListener("hand-pose",this.setHandPose)},pause:function(){this.data.eventSrc.removeEventListener("hand-pose",this.setHandPose)},setHandPose:function(e){this.data.networkedAvatar.setAttribute("networked-avatar",this.id+"_hand_pose",a.indexOf(n[e.detail.current]))}})},function(e,t,i){"use strict";AFRAME.registerComponent("gltf-bundle",{schema:{src:{default:""}},init:function(){var e,t=(e=function*(){this._addGltfEntitiesForBundleJson=this._addGltfEntitiesForBundleJson.bind(this),this.baseURL=new URL(THREE.LoaderUtils.extractUrlBase(this.data.src),window.location.href);var e=yield fetch(this.data.src),t=yield e.json();this._addGltfEntitiesForBundleJson(t)},function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})});return function(){return t.apply(this,arguments)}}(),_addGltfEntitiesForBundleJson:function(e){for(var t=this,i=[],n=function(n){var a=e.assets[n];if("resource"===a.type)return"continue";var o=new URL(a.src,t.baseURL).href,r=document.createElement("a-entity");r.setAttribute("gltf-model-plus",{src:o,inflate:!0}),i.push(new Promise(function(e){return r.addEventListener("model-loaded",e)})),t.el.appendChild(r)},a=0;a<e.assets.length;a++)n(a);Promise.all(i).then(function(){return t.el.emit("bundleloaded")})}})},function(e,t,i){"use strict";var n=i(115),a=2*Math.PI;AFRAME.registerComponent("hud-controller",{schema:{head:{type:"selector"},offset:{default:.7},lookCutoff:{default:20},animRange:{default:30},yawCutoff:{default:50},showTip:{type:"bool"}},init:function(){this.isYLocked=!1,this.lockedHeadPositionY=0,this.lookDir=new THREE.Vector3,this.lookEuler=new THREE.Euler},pause:function(){var e=this.el.sceneEl.systems["app-mode"];e.setMode(n.AppModes.DEFAULT)},tick:function(){var e,t,i,o=this.el.object3D,r=this.data.head.object3D,s=this.el.sceneEl,l=this.data,c=l.offset,d=l.lookCutoff,u=l.animRange,h=l.yawCutoff,f=l.showTip,p=r.rotation.x*THREE.Math.RAD2DEG,m=(e=r.rotation.y,t=o.rotation.y,i=Math.abs(t-e)%a,(i>Math.PI?a-i:i)*THREE.Math.RAD2DEG),v=1-THREE.Math.clamp(d-p,0,u)/u;f&&(v=1),1===v?(this.lockedHeadPositionY=r.position.y,this.hudLocked=!0):this.hudLocked&&p<d-u/2&&(this.hudLocked=!1),this.hudLocked&&(v=1),(m>=h||p<d-u/2)&&(this.lookDir.set(0,0,-1),this.lookDir.applyQuaternion(r.quaternion),this.lookDir.add(r.position),o.position.x=this.lookDir.x,o.position.z=this.lookDir.z,o.rotation.copy(r.rotation),o.rotation.x=0,o.rotation.z=0),o.position.y=(this.isYLocked?this.lockedHeadPositionY:r.position.y)+c+(1-v)*c,o.rotation.x=(1-v)*THREE.Math.DEG2RAD*90;var g=s.systems["app-mode"];p>d&&g.mode!==n.AppModes.HUD?g.setMode(n.AppModes.HUD):p<d&&g.mode===n.AppModes.HUD&&g.setMode(n.AppModes.DEFAULT)}})},function(e,t,i){"use strict";AFRAME.registerComponent("freeze-controller",{schema:{toggleEvent:{type:"string"}},init:function(){this.onToggle=this.onToggle.bind(this)},play:function(){this.el.addEventListener(this.data.toggleEvent,this.onToggle)},pause:function(){this.el.removeEventListener(this.data.toggleEvent,this.onToggle)},onToggle:function(){window.APP.store.update({activity:{hasFoundFreeze:!0}}),NAF.connection.adapter.toggleFreeze(),NAF.connection.adapter.frozen?this.el.addState("frozen"):this.el.removeState("frozen")}})},function(e,t,i){"use strict";AFRAME.registerComponent("icon-button",{schema:{image:{type:"string"},hoverImage:{type:"string"},activeImage:{type:"string"},activeHoverImage:{type:"string"},active:{type:"boolean"},haptic:{type:"selector"},tooltip:{type:"selector"},tooltipText:{type:"string"},activeTooltipText:{type:"string"}},init:function(){var e=this;this.onHover=function(){e.hovering=!0,e.updateButtonState(),e.emitHapticPulse()},this.onHoverOut=function(){e.hovering=!1,e.updateButtonState()},this.onClick=function(){e.emitHapticPulse()}},emitHapticPulse:function(){this.data.haptic&&this.data.haptic.emit("haptic_pulse",{intensity:"low"})},play:function(){this.updateButtonState(),this.el.addEventListener("mouseover",this.onHover),this.el.addEventListener("mouseout",this.onHoverOut),this.el.addEventListener("click",this.onClick)},pause:function(){this.el.removeEventListener("mouseover",this.onHover),this.el.removeEventListener("mouseout",this.onHoverOut),this.el.removeEventListener("click",this.onClick)},update:function(){this.updateButtonState()},updateButtonState:function(){var e=this.hovering,t=this.data.active,i=t?e?"activeHoverImage":"activeImage":e?"hoverImage":"image";this.el.setAttribute("src",this.data[i]),this.data.tooltip&&(this.data.tooltip.setAttribute("visible",this.hovering),this.data.tooltip.querySelector("[text]").setAttribute("text","value",this.data.active?this.data.activeTooltipText:this.data.tooltipText))}})},function(e,t,i){"use strict";AFRAME.registerComponent("text-button",{schema:{haptic:{type:"selector"},textHoverColor:{type:"string"},textColor:{type:"string"},backgroundHoverColor:{type:"string"},backgroundColor:{type:"string"}},init:function(){var e=this;this.onHover=function(){e.hovering=!0,e.updateButtonState(),e.emitHapticPulse()},this.onHoverOut=function(){e.hovering=!1,e.updateButtonState()},this.onClick=function(){e.emitHapticPulse()},this.textEl=this.el.parentEl.querySelector("[text]")},emitHapticPulse:function(){this.data.haptic&&this.data.haptic.emit("haptic_pulse",{intensity:"low"})},play:function(){this.updateButtonState(),this.el.addEventListener("mouseover",this.onHover),this.el.addEventListener("mouseout",this.onHoverOut),this.el.addEventListener("click",this.onClick)},pause:function(){this.el.removeEventListener("mouseover",this.onHover),this.el.removeEventListener("mouseout",this.onHoverOut),this.el.removeEventListener("click",this.onClick)},update:function(){this.updateButtonState()},updateButtonState:function(){var e=this.hovering;this.el.setAttribute("slice9","color",e?this.data.backgroundHoverColor:this.data.backgroundColor),this.textEl.setAttribute("text","color",e?this.data.textHoverColor:this.data.textColor)}});var n=function(){};AFRAME.registerComponent("text-raycast-hack",{dependencies:["text"],init:function(){this.el.getObject3D("text").raycast=n}})},function(e,t,i){"use strict";AFRAME.registerComponent("block-button",{init:function(){var e=this;this.onClick=function(){e.block(e.owner)},NAF.utils.getNetworkedEntity(this.el).then(function(t){e.owner=t.components.networked.data.owner})},play:function(){this.el.addEventListener("click",this.onClick)},pause:function(){this.el.removeEventListener("click",this.onClick)},block:function(e){NAF.connection.adapter.block(e)},unblock:function(e){NAF.connection.adapter.unblock(e),NAF.connection.entities.completeSync(e)}})},function(e,t,i){"use strict";AFRAME.registerComponent("visible-while-frozen",{init:function(){var e=this;this.onStateChange=function(t){"frozen"!==!t.detail&&e.el.setAttribute("visible",e.el.sceneEl.is("frozen"))},this.el.setAttribute("visible",this.el.sceneEl.is("frozen"))},play:function(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange)},pause:function(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange)}}),AFRAME.registerComponent("ui-class-while-frozen",{init:function(){var e=this;this.onStateChange=function(t){"frozen"!==!t.detail&&e.el.classList.toggle("ui",e.el.sceneEl.is("frozen"))},this.el.classList.toggle("ui",this.el.sceneEl.is("frozen"))},play:function(){this.el.sceneEl.addEventListener("stateadded",this.onStateChange),this.el.sceneEl.addEventListener("stateremoved",this.onStateChange)},pause:function(){this.el.sceneEl.removeEventListener("stateadded",this.onStateChange),this.el.sceneEl.removeEventListener("stateremoved",this.onStateChange)}})},function(e,t,i){"use strict";i(451);AFRAME.registerComponent("stats-plus",{schema:{default:!1},init:function(){this.onExpand=this.onExpand.bind(this),this.onCollapse=this.onCollapse.bind(this),this.onEnterVr=this.onEnterVr.bind(this),this.onExitVr=this.onExitVr.bind(this);var e=this.el.sceneEl;this.stats=function(e){var t=new window.threeStats(e.renderer),i=new window.aframeStats(e),n=e.isMobile?[]:[t,i];return new window.rStats({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:n})}(e),this.statsEl=document.querySelector(".rs-base");var t=document.createElement("div");t.classList.add("rs-header");var i=document.createElement("h1");i.innerHTML="Stats",t.appendChild(i);var n=document.createElement("div");n.classList.add("rs-collapse-btn"),n.innerHTML="X",n.addEventListener("click",this.onCollapse),t.appendChild(n),this.statsEl.insertBefore(t,this.statsEl.firstChild),this.fpsEl=document.createElement("div"),this.fpsEl.addEventListener("click",this.onExpand),this.fpsEl.classList.add("rs-fps-counter"),document.body.appendChild(this.fpsEl),this.lastFpsUpdate=performance.now(),this.lastFps=0,this.frameCount=0,e.isMobile&&(this.statsEl.classList.add("rs-mobile"),this.fpsEl.classList.add("rs-mobile")),e.addEventListener("enter-vr",this.onEnterVr),e.addEventListener("exit-vr",this.onExitVr)},update:function(e){e!==this.data&&(this.data?(this.statsEl.classList.remove("a-hidden"),this.fpsEl.classList.add("a-hidden")):(this.statsEl.classList.add("a-hidden"),this.fpsEl.classList.remove("a-hidden")))},tick:function(){if(this.data){var e=this.stats;e("rAF").tick(),e("FPS").frame(),e().update()}else{var t=performance.now();if(this.frameCount++,t>=this.lastFpsUpdate+1e3){var i=Math.round(this.frameCount/((t-this.lastFpsUpdate)/1e3));i!==this.lastFps&&(this.fpsEl.innerHTML=Math.round(i)+" FPS",this.lastFps=i),this.lastFpsUpdate=t,this.frameCount=0}}},onEnterVr:function(){this.el.sceneEl.isMobile&&(this.statsEl.classList.add("a-hidden"),this.fpsEl.classList.add("a-hidden"))},onExitVr:function(){this.el.sceneEl.isMobile&&(this.data?this.statsEl.classList.remove("a-hidden"):this.fpsEl.classList.remove("a-hidden"))},onExpand:function(){this.el.setAttribute(this.name,!0)},onCollapse:function(){this.el.setAttribute(this.name,!1)},remove:function(){this.el.sceneEl.removeEventListener("enter-vr",this.hide),this.el.sceneEl.removeEventListener("exit-vr",this.show),this.statsEl&&(this.statsEl.parentNode.removeChild(this.statsEl),this.fpsEl.parentNode.removeChild(this.fpsEl))}})},function(e,t,i){"use strict";AFRAME.registerComponent("networked-avatar",{schema:{left_hand_pose:{default:0},right_hand_pose:{default:0}}})},function(e,t,i){"use strict";AFRAME.registerComponent("css-class",{schema:{type:"string"},multiple:!0,init:function(){this.el.classList.add(this.data)},update:function(e){this.data!==e&&(this.el.classList.remove(e),this.el.classList.add(this.data))},remove:function(){this.el.classList.remove(this.data)}})},function(e,t,i){"use strict";AFRAME.registerComponent("scene-shadow",{schema:{type:{type:"string",default:"pcf"}},init:function(){this.originalShadowProperties=this.el.sceneEl.getAttribute("shadow")},update:function(){this.el.sceneEl.setAttribute("shadow",this.data)},remove:function(){this.el.sceneEl.setAttribute("shadow",this.originalShadowProperties)}})},function(e,t,i){"use strict";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=["tracked-controls","hand-controls2","vive-controls","oculus-touch-controls","windows-motion-controls","daydream-controls","gearvr-controls"];AFRAME.registerComponent("avatar-replay",{schema:{camera:{type:"selector"},leftController:{type:"selector"},rightController:{type:"selector"},recordingUrl:{type:"string"}},init:function(){var e=this;this.modelLoaded=new Promise(function(t){return e.el.addEventListener("model-loaded",t)})},update:function(){var e=this.data,t=e.camera,i=e.leftController,a=e.rightController,o=e.recordingUrl;if(o){var r=fetch(o).then(function(e){return e.json()});t.setAttribute("motion-capture-replayer",{loop:!0}),this._setupController(i),this._setupController(a),this.dataLoaded=Promise.all([r,this.modelLoaded]).then(function(e){var o=n(e,1),r=o[0],s=t.components["motion-capture-replayer"];s.startReplaying(r.camera);var l=i.components["motion-capture-replayer"];l.startReplaying(r.left);var c=a.components["motion-capture-replayer"];c.startReplaying(r.right)})}},_setupController:function(e){a.forEach(function(t){return e.removeAttribute(t)}),e.setAttribute("visible",!0),e.setAttribute("motion-capture-replayer",{loop:!0})}})},function(e,t,i){"use strict";var n,a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,a=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=(n=h(function*(e){return new Promise(function(t,i){var n=new l.default;n.onmessage=function(n){var o=a(n.data,4),r=o[0],s=o[1],l=o[2],c=o[3];if(r)for(var d=0,u=function(i){var n=new Image;n.onload=function(n){if(d++,s[i]=n.target,d===s.length){var a=new p(s,l,c);a.image.src=e,a.encoding=THREE.sRGBEncoding,a.minFilter=THREE.LinearFilter,t(a)}},n.src=s[i]},h=0;h<s.length;h++)u(h);else i("error loading gif: "+n.data[1])},fetch(e,{mode:"cors"}).then(function(e){return e.arrayBuffer()}).then(function(e){n.postMessage(e,[e])}).catch(i)})}),function(e){return n.apply(this,arguments)}),s=i(275),l=u(s),c=i(276),d=u(c);function u(e){return e&&e.__esModule?e:{default:e}}function h(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var p=function(e){function t(e,i,n){f(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,document.createElement("canvas")));return a.image.width=e[0].width,a.image.height=e[0].height,a._ctx=a.image.getContext("2d"),a.generateMipmaps=!1,a.isVideoTexture=!0,a.minFilter=THREE.NearestFilter,a.frames=e,a.delays=i,a.disposals=n,a.frame=0,a.frameStartTime=Date.now(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"update",value:function(){if(this.frames&&this.delays&&this.disposals){var e=Date.now();e-this.frameStartTime>this.delays[this.frame]&&(2===this.disposals[this.frame]&&this._ctx.clearRect(0,0,this.image.width,this.image.width),this.frame=(this.frame+1)%this.frames.length,this.frameStartTime=e,this._ctx.drawImage(this.frames[this.frame],0,0,this.image.width,this.image.height),this.needsUpdate=!0)}}}]),t}(THREE.Texture);function m(e){return new Promise(function(t,i){var n=function(e){var t=document.createElement("video");return t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline",""),t.loop=!0,t.preload="auto",t.crossOrigin="anonymous",t.src=e,t}(e),a=new THREE.VideoTexture(n);a.minFilter=THREE.LinearFilter,a.encoding=THREE.sRGBEncoding,n.addEventListener("loadedmetadata",function(){return t(a)},{once:!0}),n.onerror=i,AFRAME.utils.device.isIOS()&&AFRAME.utils.material.isHLS(n.src||n.getAttribute("src"),n.type||n.getAttribute("type"))&&(a.format=THREE.RGBAFormat,a.needsCorrectionBGRA=!0,a.flipY=!1,a.needsCorrectionFlipY=!0)})}function v(e){var t=new THREE.MeshBasicMaterial;t.side=THREE.DoubleSide,t.transparent=!0,t.map=e,t.needsUpdate=!0;var i=new THREE.PlaneGeometry;return new THREE.Mesh(i,t)}function g(e,t){var i=(t.image.videoHeight||t.image.height||1)/(t.image.videoWidth||t.image.width||1),n=Math.min(1,1/i),a=Math.min(1,i);e.object3DMap.mesh.scale.set(n,a,1),e.setAttribute("shape",{shape:"box",halfExtents:{x:n/2,y:a/2,z:.05}})}var y=new THREE.TextureLoader;function b(e){if(e.image instanceof HTMLVideoElement){var t=e.image;t.pause(),t.src="",t.load()}e.dispose()}y.setCrossOrigin("anonymous");var E=function(){function e(){f(this,e),this.cache=new Map}return o(e,[{key:"set",value:function(e,t){this.cache.set(e,{texture:t,count:0}),this.retain(e)}},{key:"has",value:function(e){return this.cache.has(e)}},{key:"get",value:function(e){return this.cache.get(e).texture}},{key:"retain",value:function(e){var t=this.cache.get(e);return t.count++,t.texture}},{key:"release",value:function(e){var t=this.cache.get(e);t.count--,t.count<=0&&(b(t.texture),this.cache.delete(e))}}]),e}(),_=new E,w=new Image;w.src=d.default;var k=new THREE.Texture(w);k.magFilter=THREE.NearestFilter,w.onload=function(){k.needsUpdate=!0},AFRAME.registerComponent("media-video",{schema:{src:{type:"string"},time:{type:"number"},videoPaused:{type:"boolean"},tickRate:{default:1e3},syncTolerance:{default:2}},init:function(){var e=this;this.onPauseStateChange=this.onPauseStateChange.bind(this),this.togglePlayingIfOwner=this.togglePlayingIfOwner.bind(this),this.lastUpdate=0,NAF.utils.getNetworkedEntity(this.el).then(function(t){e.networkedEl=t,e.updatePlaybackState()});var t=this.el.sceneEl;t.audioListener=t.audioListener||new THREE.AudioListener,t.camera&&t.camera.add(t.audioListener),t.addEventListener("camera-set-active",function(e){e.detail.cameraEl.getObject3D("camera").add(t.audioListener)})},play:function(){this.el.addEventListener("click",this.togglePlayingIfOwner)},pause:function(){this.el.removeEventListener("click",this.togglePlayingIfOwner)},togglePlayingIfOwner:function(){this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this.video&&(this.data.videoPaused?this.video.play():this.video.pause())},remove:function(){this.mesh&&this.mesh.material&&b(this.mesh.material.map),this.video&&(this.video.removeEventListener("pause",this.onPauseStateChange),this.video.removeEventListener("play",this.onPauseStateChange))},onPauseStateChange:function(){this.el.setAttribute("media-video","videoPaused",this.video.paused)},updateTexture:function(){var e=h(function*(e){var t=void 0;try{if(t=yield m(e),this.data.src!==e)return void b(t);t.audioSource=this.el.sceneEl.audioListener.context.createMediaElementSource(t.image),this.video=t.image,this.video.addEventListener("pause",this.onPauseStateChange),this.video.addEventListener("play",this.onPauseStateChange);var i=new THREE.PositionalAudio(this.el.sceneEl.audioListener);i.setNodeSource(t.audioSource),this.el.setObject3D("sound",i)}catch(e){console.error("Error loading video",this.data.src,e),t=k}if(this.mesh){var n=this.mesh.material;n.map=t,n.needsUpdate=!0,this.mesh.needsUpdate=!0}else this.mesh=v(t),this.el.setObject3D("mesh",this.mesh);g(this.el,t),this.updatePlaybackState(!0),this.el.emit("video-loaded")});return function(t){return e.apply(this,arguments)}}(),updatePlaybackState:function(e){(e||this.networkedEl&&!NAF.utils.isMine(this.networkedEl)&&this.video)&&(Math.abs(this.data.time-this.video.currentTime)>this.data.syncTolerance&&(this.video.currentTime=this.data.time),this.data.videoPaused?this.video.pause():this.video.play())},update:function(e){var t=this.data.src;this.updatePlaybackState(),t&&t!==e.src&&(this.remove(),this.mesh&&this.mesh.material&&(this.mesh.material.map=null,this.mesh.material.needsUpdate=!0),this.updateTexture(t))},tick:function(){if(!this.data.videoPaused&&this.video&&this.networkedEl&&NAF.utils.isMine(this.networkedEl)){var e=performance.now();e-this.lastUpdate>this.data.tickRate&&(this.el.setAttribute("media-video","time",this.video.currentTime),this.lastUpdate=e)}}}),AFRAME.registerComponent("media-image",{schema:{src:{type:"string"},contentType:{type:"string"}},remove:function(){_.release(this.data.src)},update:function(){var e=h(function*(e){var t,i=void 0;try{var n=this.data,a=n.src,o=n.contentType;if(!a)return;if(this.mesh&&this.mesh.map&&(this.mesh.material.map=null,this.mesh.material.needsUpdate=!0,this.mesh.map!==k&&_.release(e.src)),_.has(a))i=_.retain(a);else{if("error"===a)i=k;else if(o.includes("image/gif"))i=yield r(a);else{if(!o.startsWith("image/"))throw new Error("Unknown image content type: "+o);i=yield(t=a,new Promise(function(e,i){y.load(t,function(t){t.encoding=THREE.sRGBEncoding,t.minFilter=THREE.LinearFilter,e(t)},null,function(e){i("'"+t+"' could not be fetched (Error code: "+e.status+"; Response: "+e.statusText+")")})}))}if(_.set(a,i),this.data.src!==a)return void _.release(a)}}catch(e){console.error("Error loading image",this.data.src,e),i=k}if(this.mesh){var s=this.mesh.material;s.map=i,s.needsUpdate=!0,this.mesh.needsUpdate=!0}else this.mesh=v(i),this.el.setObject3D("mesh",this.mesh);g(this.el,i),this.el.emit("image-loaded")});return function(t){return e.apply(this,arguments)}}()})},,function(e,t){e.exports="data:image/gif;base64,R0lGODlhEAAQAIQaAAAAAAEBAQABBQEBAgEBBQMDAwAykwBk+wFk+/85Af47AwCIHgCJHgGJHgCKHgOJIPc63vc64Pc64YeHhwDySLu7wru8wru8w7y8wwD6/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAB8ALAAAAAAQABAAAAVl4AeMZDl9KAqkLDqd6YrN9HzC4jdbTUPDMBnGQWEAKphBYKTSYR6LRQE5y+VmlUAAc+lWrMIa4nBYxXQJcabMkkUUtLGhJZNA4BiC4HyVSCJpKRhgOktmgoRVLDSELY5mTHQlKyEAOw=="},function(e,t,i){"use strict";AFRAME.registerComponent("pinch-to-move",{schema:{speed:{default:.25}},init:function(){this.onPinch=this.onPinch.bind(this),this.axis=[0,0],this.pinch=0,this.prevPinch=0,this.needsMove=!1},play:function(){this.el.addEventListener("pinch",this.onPinch)},pause:function(){this.el.removeEventListener("pinch",this.onPinch)},tick:function(){if(this.needsMove){var e=this.pinch-this.prevPinch;this.axis[1]=e*this.data.speed,this.el.emit("move",{axis:this.axis}),this.prevPinch=this.pinch}this.needsMove=!1},onPinch:function(e){var t=e.detail,i=t.isNewPinch,n=t.distance;i?this.prevPinch=n:(this.pinch=n,this.needsMove=!0)}})},function(e,t,i){"use strict";var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=2*Math.PI,o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.items=new Array(t).fill(0),this.writePtr=0}return n(e,[{key:"push",value:function(e){this.items[this.writePtr]=e,this.writePtr=(this.writePtr+1)%this.items.length}}]),e}(),r=Math.abs,s=function(e,t){var i=e-t,n=e+a-t,o=e-(t+a);return r(i)<r(n)&&r(i)<r(o)?i:r(n)<r(o)?n:o},l=function(e){for(var t=0,i=0;i<e.length;i++){var n=e[i];t+=n}return t/e.length};AFRAME.registerComponent("look-on-mobile",{schema:{horizontalLookSpeedRatio:{default:1},verticalLookSpeedRatio:{default:1},camera:{type:"selector"}},init:function(){this.hmdEuler=new THREE.Euler,this.hmdQuaternion=new THREE.Quaternion,this.prevX=this.hmdEuler.x,this.prevY=this.hmdEuler.y,this.pendingLookX=0,this.onRotateX=this.onRotateX.bind(this),this.dXBuffer=new o(6),this.dYBuffer=new o(6),this.vrDisplay=window.webvrpolyfill.getPolyfillDisplays()[0],this.frameData=new window.webvrpolyfill.constructor.VRFrameData},play:function(){this.el.addEventListener("rotateX",this.onRotateX)},pause:function(){this.el.removeEventListener("rotateX",this.onRotateX)},update:function(){this.cameraController=this.data.camera.components["pitch-yaw-rotator"]},onRotateX:function(e){this.pendingLookX=e.detail.value},tick:function(){var e=this.hmdEuler,t=this.data,i=t.horizontalLookSpeedRatio,n=t.verticalLookSpeedRatio;this.vrDisplay.getFrameData(this.frameData),null!==this.frameData.pose.orientation&&(this.hmdQuaternion.fromArray(this.frameData.pose.orientation),e.setFromQuaternion(this.hmdQuaternion,"YXZ"));var a=THREE.Math.RAD2DEG*s(e.x,this.prevX),o=THREE.Math.RAD2DEG*s(e.y,this.prevY);this.dXBuffer.push(Math.abs(a)<.001?0:a),this.dYBuffer.push(Math.abs(o)<.001?0:o);var r=l(this.dYBuffer.items)*i,c=l(this.dXBuffer.items)*n+this.pendingLookX;this.cameraController.look(c,r),this.prevX=e.x,this.prevY=e.y,this.pendingLookX=0}})},function(e,t,i){"use strict";var n=THREE.Math.degToRad;AFRAME.registerComponent("pitch-yaw-rotator",{schema:{minPitch:{default:-50},maxPitch:{default:50}},init:function(){this.pitch=0,this.yaw=0},look:function(e,t){var i=this.data,n=i.minPitch,a=i.maxPitch;this.pitch+=e,this.pitch=Math.max(n,Math.min(a,this.pitch)),this.yaw+=t},tick:function(){this.el.object3D.rotation.set(n(this.pitch),n(this.yaw),0),this.el.object3D.rotation.order="YXZ"}})},function(e,t,i){"use strict";var n=i(281),a=u(n),o=i(282),r=u(o),s=i(283),l=u(s),c=i(284),d=u(c);function u(e){return e&&e.__esModule?e:{default:e}}AFRAME.registerComponent("input-configurator",{schema:{cursorController:{type:"selector"},gazeTeleporter:{type:"selector"},camera:{type:"selector"},playerRig:{type:"selector"},leftController:{type:"selector"},rightController:{type:"selector"},leftControllerRayObject:{type:"string"},rightControllerRayObject:{type:"string"},gazeCursorRayObject:{type:"string"}},init:function(){this.inVR=this.el.sceneEl.is("vr-mode"),this.isMobile=AFRAME.utils.device.isMobile(),this.eventHandlers=[],this.controllerQueue=[],this.hasPointingDevice=!1,this.cursor=this.data.cursorController.components["cursor-controller"],this.gazeTeleporter=this.data.gazeTeleporter.components["teleport-controls"],this.cameraController=this.data.camera.components["pitch-yaw-rotator"],this.playerRig=this.data.playerRig,this.handedness="right",this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this),this.handleControllerConnected=this.handleControllerConnected.bind(this),this.handleControllerDisconnected=this.handleControllerDisconnected.bind(this),this.configureInput()},play:function(){this.el.sceneEl.addEventListener("controllerconnected",this.handleControllerConnected),this.el.sceneEl.addEventListener("controllerdisconnected",this.handleControllerDisconnected),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},pause:function(){this.el.sceneEl.removeEventListener("controllerconnected",this.handleControllerConnected),this.el.sceneEl.removeEventListener("controllerdisconnected",this.handleControllerDisconnected),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.removeEventListener("exit-vr",this.onExitVR)},onEnterVR:function(){this.inVR=!0,this.tearDown(),this.configureInput(),this.updateController()},onExitVR:function(){this.inVR=!1,this.tearDown(),this.configureInput(),this.updateController()},tearDown:function(){this.eventHandlers.forEach(function(e){return e.tearDown()}),this.eventHandlers=[],this.actionEventHandler=null,this.lookOnMobile&&(this.lookOnMobile.el.removeAttribute("look-on-mobile"),this.lookOnMobile=null),this.cursorRequiresManagement=!1},addLookOnMobile:function(){var e=this;this.el.sceneEl.addEventListener("componentinitialized",function(t){"look-on-mobile"===t.detail.name&&(e.lookOnMobile=e.el.sceneEl.components["look-on-mobile"])}),this.el.sceneEl.setAttribute("look-on-mobile","camera",this.data.camera)},configureInput:function(){this.actionEventHandler=new d.default(this.el.sceneEl,this.cursor),this.eventHandlers.push(this.actionEventHandler),this.cursor.el.setAttribute("cursor-controller","useMousePos",!this.inVR),this.inVR?(this.cameraController.pause(),this.cursorRequiresManagement=!0,this.cursor.el.setAttribute("cursor-controller","minDistance",0),this.isMobile?this.eventHandlers.push(new l.default(this.cursor,this.gazeTeleporter)):this.eventHandlers.push(new r.default(this.cursor,this.cameraController))):(this.cameraController.play(),this.isMobile?(this.cursor.setCursorVisibility(!1),this.eventHandlers.push(new a.default(this.cursor,this.cameraController,this.cursor.el)),this.addLookOnMobile()):(this.eventHandlers.push(new r.default(this.cursor,this.cameraController)),this.cursor.el.setAttribute("cursor-controller","minDistance",.3)))},tick:function(){this.cursorRequiresManagement&&this.controller&&this.actionEventHandler.manageCursorEnabled()},handleControllerConnected:function(e){var t={controller:e.target,handedness:e.detail.component.data.hand};t.handedness===this.handedness?this.controllerQueue.unshift(t):this.controllerQueue.push(t),this.updateController()},handleControllerDisconnected:function(e){for(var t=0;t<this.controllerQueue.length;t++)if(e.target===this.controllerQueue[t].controller)return this.controllerQueue.splice(t,1),void this.updateController()},updateController:function(){if(this.hasPointingDevice=this.controllerQueue.length>0&&this.inVR,this.cursor.el.setAttribute("cursor-controller","drawLine",this.hasPointingDevice),this.cursor.setCursorVisibility(!0),this.hasPointingDevice){var e=this.controllerQueue[0],t=e.handedness;this.controller=e.controller,this.cursor.el.setAttribute("cursor-controller",{rayObject:"left"===t?this.data.leftControllerRayObject:this.data.rightControllerRayObject})}else this.controller=null,this.cursor.el.setAttribute("cursor-controller",{rayObject:this.data.gazeCursorRayObject});this.actionEventHandler&&this.controller&&this.actionEventHandler.setHandThatAlsoDrivesCursor(this.controller)}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cursor=t,this.cameraController=i,this.pinchEmitter=n,this.touches=[],this.touchReservedForCursor=null,this.touchesReservedForPinch=[],this.touchReservedForLookControls=null,this.needsPinch=!1,this.pinchTouchId1=-1,this.pinchTouchId2=-1,this.handleTouchStart=this.handleTouchStart.bind(this),this.singleTouchStart=this.singleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.singleTouchMove=this.singleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.singleTouchEnd=this.singleTouchEnd.bind(this),this.addEventListeners()}return n(e,[{key:"addEventListeners",value:function(){document.addEventListener("touchstart",this.handleTouchStart),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("touchend",this.handleTouchEnd),document.addEventListener("touchcancel",this.handleTouchEnd)}},{key:"tearDown",value:function(){document.removeEventListener("touchstart",this.handleTouchStart),document.removeEventListener("touchmove",this.handleTouchMove),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("touchcancel",this.handleTouchEnd)}},{key:"handleTouchStart",value:function(e){for(var t=0;t<e.changedTouches.length;t++)this.singleTouchStart(e.changedTouches[t])}},{key:"singleTouchStart",value:function(e){if(!(e.clientY/window.innerHeight>=.8)){if(!this.touchReservedForCursor){var t=e.clientX/window.innerWidth*2-1,i=-e.clientY/window.innerHeight*2+1;this.cursor.moveCursor(t,i),this.cursor.forceCursorUpdate(),this.cursor.startInteraction()&&(this.touchReservedForCursor=e)}this.touches.push(e)}}},{key:"handleTouchMove",value:function(e){for(var t=0;t<e.touches.length;t++)this.singleTouchMove(e.touches[t]);this.needsPinch&&(this.pinch(),this.needsPinch=!1)}},{key:"singleTouchMove",value:function(e){if(this.touchReservedForCursor&&e.identifier===this.touchReservedForCursor.identifier){var t=e.clientX/window.innerWidth*2-1,i=-e.clientY/window.innerHeight*2+1;this.cursor.moveCursor(t,i)}else if(!(e.clientY/window.innerHeight>=.8)&&this.touches.some(function(t){return e.identifier===t.identifier})){var n=this.touchesReservedForPinch.findIndex(function(t){return e.identifier===t.identifier});return-1!==n?this.touchesReservedForPinch[n]=e:this.touchesReservedForPinch.length<2&&(this.touchesReservedForPinch.push(e),n=this.touchesReservedForPinch.length-1),2==this.touchesReservedForPinch.length&&-1!==n?(this.touchReservedForLookControls&&e.identifier===this.touchReservedForLookControls.identifier&&(this.touchReservedForLookControls=null),void(this.needsPinch=!0)):(this.touchReservedForLookControls||(this.touchReservedForLookControls=e),e.identifier===this.touchReservedForLookControls.identifier?(this.touchReservedForCursor||this.cursor.moveCursor(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1),this.look(this.touchReservedForLookControls,e),void(this.touchReservedForLookControls=e)):void 0)}}},{key:"pinch",value:function(){var t=this.touchesReservedForPinch[0],i=this.touchesReservedForPinch[1],n=t.identifier!==this.pinchTouchId1||i.identifier!==this.pinchTouchId2,a=e.distance(t.clientX,t.clientY,i.clientX,i.clientY);this.pinchEmitter.emit("pinch",{isNewPinch:n,distance:a}),this.pinchTouchId1=t.identifier,this.pinchTouchId2=i.identifier}},{key:"look",value:function(e,t){var i=.18*(t.clientY-e.clientY),n=.35*(t.clientX-e.clientX);this.cameraController.look(i,n)}},{key:"handleTouchEnd",value:function(e){for(var t=0;t<e.changedTouches.length;t++)this.singleTouchEnd(e.changedTouches[t])}},{key:"singleTouchEnd",value:function(e){var t=this.touches.findIndex(function(t){return e.identifier===t.identifier});if(-1!==t){if(this.touches.splice(t,1),this.touchReservedForCursor&&e.identifier===this.touchReservedForCursor.identifier)return this.cursor.endInteraction(e),void(this.touchReservedForCursor=null);var i=this.touchesReservedForPinch.findIndex(function(t){return e.identifier===t.identifier});-1!==i&&(this.touchesReservedForPinch.splice(i,1),this.pinchTouchId1=-1,this.pinchTouchId2=-1),this.touchReservedForLookControls&&e.identifier===this.touchReservedForLookControls.identifier&&(this.touchReservedForLookControls=null)}}}]),e}();a.distance=function(e,t,i,n){var a=e-i,o=t-n;return Math.sqrt(a*a+o*o)},t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cursor=t;var n=this.cursor.el.getAttribute("cursor-controller");this.superHand=n.cursor.components["super-hands"],this.cameraController=i,this.isLeftButtonDown=!1,this.isLeftButtonHandledByCursor=!1,this.isPointerLocked=!1,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseWheel=this.onMouseWheel.bind(this),this.addEventListeners(),this.lastVerticalScrollTime=0,this.lastHorizontalScrollTime=0}return n(e,[{key:"tearDown",value:function(){document.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("wheel",this.onMouseWheel),document.removeEventListener("contextmenu",this.onContextMenu)}},{key:"setInverseMouseLook",value:function(e){this.invertMouseLook=e}},{key:"addEventListeners",value:function(){document.addEventListener("mousedown",this.onMouseDown),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("wheel",this.onMouseWheel),document.addEventListener("contextmenu",this.onContextMenu)}},{key:"onContextMenu",value:function(e){e.preventDefault()}},{key:"onMouseDown",value:function(e){switch(e.button){case 0:this.onLeftButtonDown();break;case 1:break;case 2:this.onRightButtonDown()}}},{key:"onLeftButtonDown",value:function(){this.isLeftButtonDown=!0,this.isToggle(this.superHand.state.get("grab-start"))&&this.superHand.el.emit("secondary-cursor-grab"),this.isLeftButtonHandledByCursor=this.cursor.startInteraction()}},{key:"onRightButtonDown",value:function(){this.isLeftButtonHandledByCursor=this.cursor.isInteracting(),this.isLeftButtonHandledByCursor||(this.isPointerLocked?(document.exitPointerLock(),this.isPointerLocked=!1):(document.body.requestPointerLock(),this.isPointerLocked=!0))}},{key:"onMouseWheel",value:function(e){var t=!0;e.altKey||e.shiftKey||(t=this.cursor.changeDistanceMod(this.getScrollMod(e.deltaY,e.deltaMode))),t&&!e.shiftKey||!(0===this.lastVerticalScrollTime||this.lastVerticalScrollTime+50<Date.now())||(this.superHand.el.emit(e.deltaY>0?"scroll_up":"scroll_down"),this.superHand.el.emit("vertical_scroll_release"),this.lastVerticalScrollTime=Date.now());var i=e.altKey?e.deltaY:e.deltaX;Math.abs(i)>0&&(0===this.lastHorizontalScrollTime||this.lastHorizontalScrollTime+50<Date.now())&&(this.superHand.el.emit(i<0?"scroll_left":"scroll_right"),this.superHand.el.emit("horizontal_scroll_release"),this.lastHorizontalScrollTime=Date.now()),e.altKey&&e.preventDefault()}},{key:"getScrollMod",value:function(e,t){switch(t){case WheelEvent.DOM_DELTA_PIXEL:return e/500;case WheelEvent.DOM_DELTA_LINE:return e/10;case WheelEvent.DOM_DELTA_PAGE:return e/2}}},{key:"onMouseMove",value:function(e){var t=this.isPointerLocked||!this.superHand.state.get("grab-start")&&this.isLeftButtonDown&&!this.isLeftButtonHandledByCursor;t&&this.look(e),this.cursor.moveCursor(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1)}},{key:"onMouseUp",value:function(e){switch(e.button){case 0:this.isToggle(this.superHand.state.get("grab-start"))?this.superHand.el.emit("secondary-cursor-release"):this.endInteraction(),this.isLeftButtonDown=!1;break;case 1:break;case 2:this.endInteraction()}}},{key:"endInteraction",value:function(){this.cursor.endInteraction(),this.isLeftButtonHandledByCursor=!1}},{key:"isToggle",value:function(e){return e&&e.matches(".toggle, .toggle *")}},{key:"look",value:function(e){var t=this.invertMouseLook?1:-1,i=.06*e.movementY*t,n=.1*e.movementX*t;this.cameraController.look(i,n)}}]),e}();t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cursor=t,this.gazeTeleporter=i,this.isMouseDownHandledByCursor=!1,this.isMouseDownHandledByGazeTeleporter=!1,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.addEventListeners()}return n(e,[{key:"addEventListeners",value:function(){document.addEventListener("mousedown",this.onMouseDown),document.addEventListener("mouseup",this.onMouseUp)}},{key:"tearDown",value:function(){document.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"onMouseDown",value:function(){if(this.isMouseDownHandledByCursor=this.cursor.startInteraction(),!this.isMouseDownHandledByCursor){this.cursor.setCursorVisibility(!1);var e=this.gazeTeleporter.data.button;this.gazeTeleporter.el.emit(e+"down"),this.isMouseDownHandledByGazeTeleporter=!0}}},{key:"onMouseUp",value:function(){if(this.isMouseDownHandledByCursor&&(this.cursor.endInteraction(),this.isMouseDownHandledByCursor=!1),this.cursor.setCursorVisibility(!0),this.isMouseDownHandledByGazeTeleporter){var e=this.gazeTeleporter.data.button;this.gazeTeleporter.el.emit(e+"up"),this.isMouseDownHandledByGazeTeleporter=!1}}}]),e}();t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this.cursor=i,this.cursorHand=this.cursor.data.cursor.components["super-hands"],this.isCursorInteracting=!1,this.isTeleporting=!1,this.handThatAlsoDrivesCursor=null,this.hovered=!1,this.gotPrimaryDown=!1,this.onPrimaryDown=this.onPrimaryDown.bind(this),this.onPrimaryUp=this.onPrimaryUp.bind(this),this.onSecondaryDown=this.onSecondaryDown.bind(this),this.onSecondaryUp=this.onSecondaryUp.bind(this),this.onPrimaryGrab=this.onPrimaryGrab.bind(this),this.onPrimaryRelease=this.onPrimaryRelease.bind(this),this.onSecondaryGrab=this.onSecondaryGrab.bind(this),this.onSecondaryRelease=this.onSecondaryRelease.bind(this),this.onCardboardButtonDown=this.onCardboardButtonDown.bind(this),this.onCardboardButtonUp=this.onCardboardButtonUp.bind(this),this.onScrollMove=this.onScrollMove.bind(this),this.addEventListeners(),this.lastVerticalScrollTime=0,this.lastHorizontalScrollTime=0}return n(e,[{key:"addEventListeners",value:function(){this.scene.addEventListener("action_primary_down",this.onPrimaryDown),this.scene.addEventListener("action_primary_up",this.onPrimaryUp),this.scene.addEventListener("action_secondary_down",this.onSecondaryDown),this.scene.addEventListener("action_secondary_up",this.onSecondaryUp),this.scene.addEventListener("primary_action_grab",this.onPrimaryGrab),this.scene.addEventListener("primary_action_release",this.onPrimaryRelease),this.scene.addEventListener("secondary_action_grab",this.onSecondaryGrab),this.scene.addEventListener("secondary_action_release",this.onSecondaryRelease),this.scene.addEventListener("scroll_move",this.onScrollMove),this.scene.addEventListener("cardboardbuttondown",this.onCardboardButtonDown),this.scene.addEventListener("cardboardbuttonup",this.onCardboardButtonUp)}},{key:"tearDown",value:function(){this.scene.removeEventListener("action_primary_down",this.onPrimaryDown),this.scene.removeEventListener("action_primary_up",this.onPrimaryUp),this.scene.removeEventListener("action_secondary_down",this.onSecondaryDown),this.scene.removeEventListener("action_secondary_up",this.onSecondaryUp),this.scene.removeEventListener("primary_action_grab",this.onPrimaryGrab),this.scene.removeEventListener("primary_action_release",this.onPrimaryRelease),this.scene.removeEventListener("secondary_action_grab",this.onSecondaryGrab),this.scene.removeEventListener("secondary_action_release",this.onSecondaryRelease),this.scene.removeEventListener("scroll_move",this.onScrollMove),this.scene.removeEventListener("cardboardbuttondown",this.onCardboardButtonDown),this.scene.removeEventListener("cardboardbuttonup",this.onCardboardButtonUp)}},{key:"onScrollMove",value:function(e){var t=.1*e.detail.axis[1];t=Math.abs(t)>.05?t:0;var i=this.cursor.changeDistanceMod(-t),n=.1*e.detail.axis[0];n=Math.abs(n)>.05?n:0,this.isCursorInteracting=this.cursor.isInteracting(),Math.abs(t)>0&&(0===this.lastVerticalScrollTime||this.lastVerticalScrollTime+150<Date.now())&&(!i&&this.isCursorInteracting&&this.isHandThatAlsoDrivesCursor(e.target)?(this.cursorHand.el.emit(t<0?"scroll_up":"scroll_down"),this.cursorHand.el.emit("vertical_scroll_release")):(e.target.emit(t<0?"scroll_up":"scroll_down"),e.target.emit("vertical_scroll_release")),this.lastVerticalScrollTime=Date.now()),Math.abs(n)>0&&(0===this.lastHorizontalScrollTime||this.lastHorizontalScrollTime+150<Date.now())&&(this.isCursorInteracting&&this.isHandThatAlsoDrivesCursor(e.target)?(this.cursorHand.el.emit(n<0?"scroll_left":"scroll_right"),this.cursorHand.el.emit("horizontal_scroll_release")):(e.target.emit(n<0?"scroll_left":"scroll_right"),e.target.emit("horizontal_scroll_release")),this.lastHorizontalScrollTime=Date.now())}},{key:"setHandThatAlsoDrivesCursor",value:function(e){this.handThatAlsoDrivesCursor=e}},{key:"isToggle",value:function(e){return e&&e.matches(".toggle, .toggle *")}},{key:"isHandThatAlsoDrivesCursor",value:function(e){return this.handThatAlsoDrivesCursor===e}},{key:"onGrab",value:function(e,t){t=t||e.type;var i=e.target.components["super-hands"],n=this.isHandThatAlsoDrivesCursor(e.target);this.isCursorInteracting=this.cursor.isInteracting(),n&&!this.isCursorInteracting?i.state.has("hover-start")||i.state.get("grab-start")?e.target.emit(t):this.isCursorInteracting=this.cursor.startInteraction():n&&this.isCursorInteracting?this.cursorHand.el.emit(t):e.target.emit(t)}},{key:"onRelease",value:function(e,t){t=t||e.type;var i=this.isHandThatAlsoDrivesCursor(e.target);this.isCursorInteracting&&i?this.isToggle(this.cursorHand.state.get("grab-start")||this.cursorHand.state.get("hover-start"))?(this.cursorHand.el.emit(t),this.isCursorInteracting=this.cursor.isInteracting()):(this.isCursorInteracting=!1,this.cursor.endInteraction()):e.target.emit(t)}},{key:"onPrimaryGrab",value:function(e){this.onGrab(e,"primary_hand_grab")}},{key:"onPrimaryRelease",value:function(e){this.onRelease(e,"primary_hand_release")}},{key:"onSecondaryGrab",value:function(e){this.onGrab(e,"secondary_hand_grab")}},{key:"onSecondaryRelease",value:function(e){this.onRelease(e,"secondary_hand_release")}},{key:"onDown",value:function(e,t){if(this.onGrab(e,t),this.isHandThatAlsoDrivesCursor(e.target)&&!this.isCursorInteracting&&!this.cursorHand.state.get("grab-start")){this.cursor.setCursorVisibility(!1);var i=e.target.components["teleport-controls"].data.button;e.target.emit(i+"down"),this.isTeleporting=!0}}},{key:"onUp",value:function(e,t){if(this.isTeleporting&&this.isHandThatAlsoDrivesCursor(e.target)){var i=e.target.components["super-hands"];this.cursor.setCursorVisibility(!i.state.has("hover-start"));var n=e.target.components["teleport-controls"].data.button;e.target.emit(n+"up"),this.isTeleporting=!1}else this.onRelease(e,t)}},{key:"onPrimaryDown",value:function(e){this.gotPrimaryDown||(this.onDown(e,"primary_hand_grab"),this.gotPrimaryDown=!0)}},{key:"onPrimaryUp",value:function(e){this.gotPrimaryDown?this.onUp(e,"primary_hand_release"):this.isToggle(this.cursorHand.state.get("grab-start")||this.cursorHand.state.get("hover-start"))&&this.onUp(e,"secondary_hand_release"),this.gotPrimaryDown=!1}},{key:"onSecondaryDown",value:function(e){this.onDown(e,"secondary_hand_grab")}},{key:"onSecondaryUp",value:function(e){this.onUp(e,"secondary_hand_release")}},{key:"onCardboardButtonDown",value:function(e){if(this.isCursorInteracting=this.cursor.startInteraction(),!this.isCursorInteracting){this.cursor.setCursorVisibility(!1);var t=e.target.querySelector("#gaze-teleport"),i=t.components["teleport-controls"].data.button;t.emit(i+"down"),this.isTeleporting=!0}}},{key:"onCardboardButtonUp",value:function(e){if(this.isCursorInteracting)return this.isCursorInteracting=!1,void this.cursor.endInteraction();this.cursor.setCursorVisibility(!0);var t=e.target.querySelector("#gaze-teleport"),i=t.components["teleport-controls"].data.button;t.emit(i+"up"),this.isTeleporting=!1}},{key:"manageCursorEnabled",value:function(){var e=this.handThatAlsoDrivesCursor.components["super-hands"].state,t=!this.hovered&&e.has("hover-start")&&!this.isCursorInteracting,i=!0===this.hovered&&!e.has("hover-start")&&!e.has("grab-start");t?(this.hovered=!0,this.cursor.disable()):i&&(this.hovered=!1,this.cursor.enable(),this.cursor.setCursorVisibility(!this.isTeleporting))}}]),e}();t.default=a},function(e,t,i){"use strict";AFRAME.registerComponent("sticky-object",{dependencies:["body"],schema:{autoLockOnLoad:{default:!1},autoLockOnRelease:{default:!1},autoLockSpeedLimit:{default:.25}},init:function(){this._onGrab=this._onGrab.bind(this),this._onRelease=this._onRelease.bind(this),this._onBodyLoaded=this._onBodyLoaded.bind(this)},play:function(){this.el.addEventListener("grab-start",this._onGrab),this.el.addEventListener("grab-end",this._onRelease),this.hasSetupBodyLoaded||(this.hasSetupBodyLoaded=!0,this.el.body?this._onBodyLoaded():this.el.addEventListener("body-loaded",this._onBodyLoaded,{once:!0}))},pause:function(){this.el.removeEventListener("grab-start",this._onGrab),this.el.removeEventListener("grab-end",this._onRelease)},setLocked:function(e){this.el.components.networked&&!NAF.utils.isMine(this.el)||(this.locked=e,this.el.setAttribute("body",{type:e?"static":"dynamic"}))},_onBodyLoaded:function(){this.data.autoLockOnLoad&&this.setLocked(!0)},_onRelease:function(){!this.el.is("grabbed")&&this.data.autoLockOnRelease&&this.el.body.velocity.lengthSquared()<this.data.autoLockSpeedLimit*this.data.autoLockSpeedLimit&&this.setLocked(!0)},_onGrab:function(){this.setLocked(!1)},remove:function(){if(this.el.removeEventListener("body-loaded",this._onBodyLoaded),this.stuckTo){var e=this.stuckTo;delete this.stuckTo,e._unstickObject()}}}),AFRAME.registerComponent("sticky-object-zone",{dependencies:["physics"],init:function(){this.worldQuaternion=new THREE.Quaternion,this.worldPosition=new THREE.Vector3,this.el.object3D.getWorldQuaternion(this.worldQuaternion),this.el.object3D.getWorldPosition(this.worldPosition);var e=new THREE.Vector3(0,0,5).applyQuaternion(this.el.object3D.quaternion);this.bootImpulsePosition=new CANNON.Vec3(0,0,0),this.bootImpulse=new CANNON.Vec3,this.bootImpulse.copy(e),this._onCollisions=this._onCollisions.bind(this),this.el.addEventListener("collisions",this._onCollisions)},remove:function(){this.el.removeEventListener("collisions",this._onCollisions)},_onCollisions:function(e){var t=this;e.detail.els.forEach(function(e){var i=e.components["sticky-object"];i&&t._setStuckObject(i)}),this.stuckObject&&e.detail.clearedEls.forEach(function(e){t.stuckObject&&t.stuckObject.el===e&&t._unstickObject()})},_setStuckObject:function(e){if(e.setLocked(!0),e.el.object3D.position.copy(this.worldPosition),e.el.object3D.quaternion.copy(this.worldQuaternion),e.el.body.collisionResponse=!1,e.stuckTo=this,this.stuckObject&&NAF.utils.isMine(this.stuckObject.el)){var t=this.stuckObject.el;this._unstickObject(),t.body.applyImpulse(this.bootImpulse,this.bootImpulsePosition)}this.stuckObject=e},_unstickObject:function(){this.stuckObject.stuckTo===this&&(this.stuckObject.setLocked(!1),this.stuckObject.el.body.collisionResponse=!0,delete this.stuckObject.stuckTo),delete this.stuckObject}})},function(e,t,i){"use strict";AFRAME.registerComponent("auto-scale-cannon-physics-body",{dependencies:["body"],schema:{equalityEpsilon:{default:.001},debounceDelay:{default:100}},init:function(){this.body=this.el.components.body,this.prevScale=this.el.object3D.scale.clone(),this.nextUpdateTime=-1},tick:function(e){var t,i,n,a=this.el.object3D.scale;t=this.data.equalityEpsilon,i=a,n=this.prevScale,Math.abs(i.x-n.x)<t&&Math.abs(i.y-n.y)<t&&Math.abs(i.z-n.z)<t||(this.prevScale.copy(a),this.nextUpdateTime=e+this.data.debounceDelay),this.nextUpdateTime>0&&e>this.nextUpdateTime&&(this.nextUpdateTime=-1,this.body.updateCannonScale())}})},function(e,t,i){"use strict";var n,a,o,r=i(116),s=Math.PI,l=s/2,c=3*l,d=new THREE.Vector3(1,0,0),u=new THREE.Vector3(0,0,1),h=new THREE.Vector3(-1,0,0),f=new THREE.Vector3(0,0,-1),p={left:{dir:h,rotation:c,halfExtent:"x"},right:{dir:d,rotation:l,halfExtent:"x"},forward:{dir:u,rotation:0,halfExtent:"z"},back:{dir:f,rotation:s,halfExtent:"z"}},m={x:"z",z:"x"};AFRAME.registerComponent("position-at-box-shape-border",{schema:{target:{type:"string"},dirs:{default:["left","right","forward","back"]}},init:function(){this.cam=this.el.sceneEl.camera.el.object3D,this.halfExtents=new THREE.Vector3},update:function(){this.dirs=this.data.dirs.map(function(e){return p[e]})},tick:(n=new THREE.Vector3,a=new THREE.Vector3,o=new THREE.Vector3,function(){if((this.target||(this.target=this.el.querySelector(this.data.target).object3D,this.target))&&this.el.getObject3D("mesh")){if(!this.halfExtents||this.mesh!==this.el.getObject3D("mesh")||this.shape!==this.el.components.shape)if(this.mesh=this.el.getObject3D("mesh"),this.el.components.shape)this.shape=this.el.components.shape,this.halfExtents.copy(this.shape.data.halfExtents);else{var e=(0,r.getBox)(this.el,this.mesh);this.halfExtents=e.min.clone().negate().add(e.max).multiplyScalar(.51/this.el.object3D.scale.x)}this.cam.getWorldPosition(n);for(var t=1/0,i=this.dirs[0].dir,s=this.dirs[0].halfExtent,l=this.halfExtents[s],c=this.dirs[0].rotation,d=0;d<this.dirs.length;d++){var u=this.dirs[d].dir,h=this.dirs[d].halfExtent,f=this.halfExtents[h];o.copy(u).multiplyScalar(f),this.el.object3D.localToWorld(o);var p=o.distanceToSquared(n);p<t&&(t=p,i=u,l=f,c=this.dirs[d].rotation,s=h)}this.target.position.copy(a.copy(i).multiplyScalar(l)),this.target.rotation.set(0,c,0),this.target.scale.setScalar(4*this.halfExtents[m[s]])}})})},function(e,t,i){"use strict";AFRAME.registerComponent("remove-networked-object-button",{init:function(){var e=this;this.onClick=function(){e.targetEl.parentNode.removeChild(e.targetEl)},NAF.utils.getNetworkedEntity(this.el).then(function(t){e.targetEl=t})},play:function(){this.el.addEventListener("click",this.onClick)},pause:function(){this.el.removeEventListener("click",this.onClick)}})},function(e,t,i){"use strict";var n;AFRAME.registerComponent("destroy-at-extreme-distances",{schema:{xMin:{default:-1e3},xMax:{default:1e3},yMin:{default:-1e3},yMax:{default:1e3},zMin:{default:-1e3},zMax:{default:1e3}},tick:(n=new THREE.Vector3,function(){var e=this.data,t=e.xMin,i=e.xMax,a=e.yMin,o=e.yMax,r=e.zMin,s=e.zMax;this.el.object3D.getWorldPosition(n),this.el.parentNode===this.el.sceneEl?n.copy(this.el.object3D.position):this.el.object3D.getWorldPosition(n),(n.x<t||n.x>i||n.y<a||n.y>o||n.z<r||n.z>s)&&this.el.parentNode.removeChild(this.el)})})},function(e,t,i){"use strict";var n=i(116),a=i(75);i(61);var o,r=i(291),s=(o=r,o&&o.__esModule?o:{default:o});function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var c=new THREE.GLTFLoader,d=void 0;c.load(s.default,function(e){d=e}),AFRAME.registerComponent("media-loader",{schema:{src:{type:"string"},index:{type:"number"},resize:{default:!1}},init:function(){this.onError=this.onError.bind(this),this.showLoader=this.showLoader.bind(this),this.clearLoadingTimeout=this.clearLoadingTimeout.bind(this),this.shapeAdded=!1,this.hasBakedShapes=!1},setShapeAndScale:function(e){var t=this.el.getObject3D("mesh"),i=(0,n.getBox)(this.el,t),a=e?(0,n.getScaleCoefficient)(.5,i):1;if(this.el.object3DMap.mesh.scale.multiplyScalar(a),this.el.body&&this.shapeAdded&&this.el.body.shapes.length>1)this.el.removeAttribute("shape"),this.shapeAdded=!1;else if(!this.hasBakedShapes){var o=new THREE.Vector3,r=i.min,s=i.max,l={x:Math.abs(r.x-s.x)/2*a,y:Math.abs(r.y-s.y)/2*a,z:Math.abs(r.z-s.z)/2*a};o.addVectors(r,s).multiplyScalar(.5*a),t.position.sub(o),this.el.setAttribute("shape",{shape:"box",halfExtents:l}),this.shapeAdded=!0}},tick:function(e,t){this.loaderMixer&&this.loaderMixer.update(t/1e3)},onError:function(){this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-pager"),this.el.removeAttribute("media-video"),this.el.setAttribute("media-image",{src:"error"}),clearTimeout(this.showLoaderTimeout),delete this.showLoaderTimeout},showLoader:function(){var e=!!d,t=e?d.scene.clone():new THREE.Mesh(new THREE.BoxGeometry,new THREE.MeshBasicMaterial);e&&(this.loaderMixer=new THREE.AnimationMixer(t),this.loadingClip=this.loaderMixer.clipAction(d.animations[0]),this.loadingClip.play()),this.el.setObject3D("mesh",t),this.hasBakedShapes=!!(this.el.body&&this.el.body.shapes.length>0),this.setShapeAndScale(!0),delete this.showLoaderTimeout},clearLoadingTimeout:function(){clearTimeout(this.showLoaderTimeout),this.loaderMixer&&(this.loadingClip.stop(),delete this.loaderMixer),delete this.showLoaderTimeout},update:function(){var e=l(function*(e){var t=this;try{var i=this.data,n=i.src,o=i.index;if(n===e.src||this.showLoaderTimeout||(this.showLoaderTimeout=setTimeout(this.showLoader,100)),!n)return;var r=yield(0,a.resolveMedia)(n,!1,o),s=r.raw,c=r.origin,d=r.images,u=r.contentType;n!==e.src&&this.el.emit("media_resolved",{src:n,raw:s,origin:c,contentType:u});var h=u.startsWith("application/pdf");if(u.startsWith("video/")||u.startsWith("audio/"))this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-image"),this.el.addEventListener("video-loaded",this.clearLoadingTimeout,{once:!0}),this.el.setAttribute("media-video",{src:s}),this.el.setAttribute("position-at-box-shape-border",{dirs:["forward","back"]});else if(u.startsWith("image/")||h){this.el.removeAttribute("gltf-model-plus"),this.el.removeAttribute("media-video"),this.el.addEventListener("image-loaded",l(function*(){if(t.clearLoadingTimeout(),h){var e=yield(0,a.fetchMaxContentIndex)(n,d.png);t.el.setAttribute("media-pager",{index:o,maxIndex:e})}}),{once:!0});var f=h?d.png:s,p=h?"image/png":u;h||this.el.removeAttribute("media-pager"),this.el.setAttribute("media-image",{src:f,contentType:p}),this.el.setAttribute("position-at-box-shape-border",{dirs:["forward","back"]})}else{if(!(u.includes("application/octet-stream")||u.includes("x-zip-compressed")||u.startsWith("model/gltf")||n.endsWith(".gltf")||n.endsWith(".glb")))throw new Error("Unsupported content type: "+u);this.el.removeAttribute("media-image"),this.el.removeAttribute("media-video"),this.el.removeAttribute("media-pager"),this.el.addEventListener("model-loaded",function(){t.clearLoadingTimeout(),t.hasBakedShapes=!!(t.el.body&&t.el.body.shapes.length>(t.shapeAdded?1:0)),t.setShapeAndScale(t.data.resize)},{once:!0}),this.el.addEventListener("model-error",this.onError,{once:!0}),this.el.setAttribute("gltf-model-plus",{src:s,contentType:u,inflate:!0})}}catch(e){console.error("Error adding media",e),this.onError()}});return function(t){return e.apply(this,arguments)}}()}),AFRAME.registerComponent("media-pager",{schema:{index:{type:"string"},maxIndex:{type:"string"}},init:function(){var e=this;this.onNext=this.onNext.bind(this),this.onPrev=this.onPrev.bind(this);var t=document.getElementById("paging-toolbar");this.el.appendChild(document.importNode(t.content,!0)),this.toolbar=this.el.querySelector(".paging-toolbar"),setTimeout(function(){e.nextButton=e.el.querySelector(".next-button [text-button]"),e.prevButton=e.el.querySelector(".prev-button [text-button]"),e.pageLabel=e.el.querySelector(".page-label"),e.nextButton.addEventListener("click",e.onNext),e.prevButton.addEventListener("click",e.onPrev),e.update()},0)},update:function(){this.pageLabel&&(this.pageLabel.setAttribute("text","value",this.data.index+1+"/"+(this.data.maxIndex+1)),this.repositionToolbar())},remove:function(){this.nextButton.removeEventListener("click",this.onNext),this.prevButton.removeEventListener("click",this.onPrev),this.el.removeChild(this.toolbar)},onNext:function(){this.el.setAttribute("media-loader","index",Math.min(this.data.index+1,this.data.maxIndex))},onPrev:function(){this.el.setAttribute("media-loader","index",Math.max(this.data.index-1,0))},repositionToolbar:function(){this.toolbar.object3D.position.y=-this.el.getAttribute("shape").halfExtents.y-.2}})},function(e,t,i){e.exports=i.p+"assets/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb"},function(e,t,i){"use strict";AFRAME.registerComponent("ambient-light",{schema:{color:{type:"color"},intensity:{default:1}},init:function(){var e=this.el;this.light=new THREE.AmbientLight,this.el.setObject3D("ambient-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update:function(e){this.data.color!==e.color&&this.light.color.set(this.data.color),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity)},remove:function(){this.el.removeObject3D("ambient-light")}})},function(e,t,i){"use strict";AFRAME.registerComponent("directional-light",{schema:{color:{type:"color"},intensity:{default:1},castShadow:{default:!0}},init:function(){var e=this.el;this.light=new THREE.DirectionalLight,this.light.position.set(0,0,0),this.light.target.position.set(0,0,1),this.light.add(this.light.target),this.el.setObject3D("directional-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update:function(e){this.data.color!==e.color&&this.light.color.set(this.data.color),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity),this.data.castShadow!==e.castShadow&&(this.light.castShadow=this.data.castShadow)},remove:function(){this.el.removeObject3D("directional-light")}})},function(e,t,i){"use strict";AFRAME.registerComponent("hemisphere-light",{schema:{skyColor:{type:"color"},groundColor:{type:"color"},intensity:{default:1}},init:function(){var e=this.el;this.light=new THREE.HemisphereLight,this.light.position.set(0,0,0),this.el.setObject3D("hemisphere-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update:function(e){this.data.skyColor!==e.skyColor&&this.light.color.set(this.data.skyColor),this.data.groundColor!==e.groundColor&&this.light.groundColor.set(this.data.groundColor),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity)},remove:function(){this.el.removeObject3D("hemisphere-light")}})},function(e,t,i){"use strict";AFRAME.registerComponent("point-light",{schema:{color:{type:"color"},intensity:{default:1},range:{default:0},castShadow:{default:!0}},init:function(){var e=this.el;this.light=new THREE.PointLight,this.light.decay=2,this.el.setObject3D("point-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update:function(e){this.data.color!==e.color&&this.light.color.set(this.data.color),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity),this.data.range!==e.range&&(this.light.distance=this.data.range),this.data.castShadow!==e.castShadow&&(this.light.castShadow=this.data.castShadow)},remove:function(){this.el.removeObject3D("point-light")}})},function(e,t,i){"use strict";AFRAME.registerComponent("spot-light",{schema:{color:{type:"color"},intensity:{default:1},range:{default:0},innerConeAngle:{default:0},outerConeAngle:{default:Math.PI/4},castShadow:{default:!0}},init:function(){var e=this.el;this.light=new THREE.SpotLight,this.light.target.position.set(0,0,1),this.light.add(this.light.target),this.light.decay=2,this.el.setObject3D("spot-light",this.light),this.el.sceneEl.systems.light.registerLight(e)},update:function(e){this.data.color!==e.color&&this.light.color.set(this.data.color),this.data.intensity!==e.intensity&&(this.light.intensity=this.data.intensity),this.data.range!==e.range&&(this.light.distance=this.data.range),this.data.innerConeAngle===e.innerConeAngle&&this.data.outerConeAngle===e.outerConeAngle||(this.light.angle=this.data.outerConeAngle,this.light.penumbra=1-this.data.innerConeAngle/this.data.outerConeAngle),this.data.castShadow!==e.castShadow&&(this.light.castShadow=this.data.castShadow)},remove:function(){this.el.removeObject3D("spot-light")}})},function(e,t,i){"use strict";AFRAME.registerComponent("visible-to-owner",{init:function(){var e=this;this.onStateChange=function(t){e.el.setAttribute("visible",t.detail.newOwner===NAF.clientId)},NAF.utils.getNetworkedEntity(this.el).then(function(t){t.addEventListener("ownership-changed",e.onStateChange),e.el.setAttribute("visible",NAF.utils.isMine(t))})}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=(n=Ae(function*(){var e=yield navigator.mediaDevices.enumerateDevices();return e.filter(function(e){return e.label&&"audioinput"===e.kind}).map(function(e){return e.label})}),function(){return n.apply(this,arguments)}),r=i(77),s=ke(r),l=i(299),c=ke(l),d=i(300),u=ke(d),h=i(301),f=ke(h),p=i(302),m=ke(p),v=i(303),g=ke(v),y=i(304),b=ke(y),E=i(305),_=ke(E),w=i(306),k=ke(w),A=i(307),R=ke(A),C=i(308),M=ke(C),T=i(309),S=ke(T),x=i(310),L=ke(x),D=i(311),P=ke(D),F=i(312),O=ke(F),N=i(313),H=ke(N),B=i(314),j=ke(B),I=i(315),V=ke(I),U=i(316),z=ke(U),G=i(1),W=we(G),q=i(0),Y=we(q),Q=i(9),J=we(Q),X=i(117),K=i(5),Z=i(40),$=we(Z),ee=i(318),te=we(ee),ie=i(107),ne=we(ie),ae=i(453),oe=we(ae),re=i(455),se=we(re),le=i(15),ce=i(319),de=we(ce),ue=i(320),he=i(327),fe=i(329),pe=we(fe),me=i(29),ve=we(me),ge=i(338),ye=we(ge),be=i(339),Ee=i(19),_e=i(118);function we(e){return e&&e.__esModule?e:{default:e}}function ke(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function Ae(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}(0,K.addLocaleData)([].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}($.default)));var Re={start:"start",mic_grant:"mic_grant",mic_granted:"mic_granted",audio_setup:"audio_setup",finished:"finished"},Ce=[/\Wvive\W/i,/\Wrift\W/i],Me=10,Te=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i,n,a,r,s,l=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return l.state={entryStep:Re.start,enterInVR:!1,infoDialogType:null,linkCode:null,linkCodeCancel:null,shareScreen:!1,requestedScreen:!1,mediaStream:null,videoTrack:null,audioTrack:null,toneInterval:null,tonePlaying:!1,micLevel:0,micDevices:[],micUpdateInterval:null,profileNamePending:"Hello",autoExitTimerStartedAt:null,autoExitTimerInterval:null,secondsRemainingBeforeAutoExit:1/0,muted:!1,frozen:!1,spacebubble:!0,exited:!1,showProfileEntry:!1},l.onSceneLoaded=function(){l.setState({sceneLoaded:!0})},l.onAframeStateChanged=function(e){var t,i,n;"muted"!==e.detail&&"frozen"!==e.detail&&"spacebubble"!==e.detail||l.setState((t={},i=e.detail,n=l.props.scene.is(e.detail),i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t))},l.toggleMute=function(){l.props.scene.emit("action_mute")},l.toggleFreeze=function(){l.props.scene.emit("action_freeze")},l.toggleSpaceBubble=function(){l.props.scene.emit("action_space_bubble")},l.spawnPen=function(){l.props.scene.emit("spawn_pen")},l.handleForcedVREntryType=function(){l.props.forcedVREntryType&&(l.props.forcedVREntryType.startsWith("daydream")?l.enterDaydream():l.props.forcedVREntryType.startsWith("vr")?l.enterVR():l.props.forcedVREntryType.startsWith("2d")&&l.enter2D())},l.playTestTone=function(){var e=document.querySelector("#test-tone");e.currentTime=0,e.play(),clearTimeout(l.testToneTimeout),l.setState({tonePlaying:!0});l.testToneTimeout=setTimeout(function(){l.setState({tonePlaying:!1})},1393)},l.stopTestTone=function(){var e=document.querySelector("#test-tone");e.pause(),e.currentTime=0,l.setState({tonePlaying:!1})},l.onConcurrentLoad=function(){if(!l.props.disableAutoExitOnConcurrentLoad){var e=setInterval(function(){var e=1/0;if(l.state.autoExitTimerStartedAt){var t=(new Date-l.state.autoExitTimerStartedAt)/1e3;e=Math.max(0,Math.floor(Me-t))}l.setState({secondsRemainingBeforeAutoExit:e}),l.checkForAutoExit()},500);l.setState({autoExitTimerStartedAt:new Date,autoExitTimerInterval:e})}},l.checkForAutoExit=function(){0===l.state.secondsRemainingBeforeAutoExit&&(l.endAutoExitTimer(),l.exit())},l.exit=function(){l.props.exitScene(),l.setState({exited:!0})},l.isWaitingForAutoExit=function(){return l.state.secondsRemainingBeforeAutoExit<=Me},l.endAutoExitTimer=function(){clearInterval(l.state.autoExitTimerInterval),l.setState({autoExitTimerStartedAt:null,autoExitTimerInterval:null,secondsRemainingBeforeAutoExit:1/0})},l.hasGrantedMicPermissions=Ae(function*(){return!l.state.requestedScreen&&(yield o()).length>0}),l.performDirectEntryFlow=(i=Ae(function*(e){l.setState({enterInVR:e});var t=yield l.hasGrantedMicPermissions();t?(yield l.setMediaStreamToDefault(),l.beginOrSkipAudioSetup()):l.setState({entryStep:Re.mic_grant})}),function(e){return i.apply(this,arguments)}),l.enter2D=Ae(function*(){yield l.performDirectEntryFlow(!1)}),l.linkSafari=Ae(function*(){l.setState({infoDialogType:ve.default.dialogTypes.safari})}),l.enterVR=Ae(function*(){l.props.availableVREntryTypes.generic!==X.VR_DEVICE_AVAILABILITY.maybe?yield l.performDirectEntryFlow(!0):l.setState({infoDialogType:ve.default.dialogTypes.webvr_recommend})}),l.enterDaydream=Ae(function*(){if(l.props.availableVREntryTypes.daydream==X.VR_DEVICE_AVAILABILITY.maybe){l.exit();var e=window.location,t=new URLSearchParams(e.search);t.set("vr_entry_type","daydream");var i="intent://"+e.host+e.pathname+"?"+t+"#Intent;scheme="+e.protocol.replace(":","")+";action=android.intent.action.VIEW;package=com.android.chrome;end;";window.location=i}else yield l.performDirectEntryFlow(!0)}),l.micDeviceChanged=(n=Ae(function*(e){var t={audio:{deviceId:{exact:[e.target.value]}}};yield l.fetchAudioTrack(t),yield l.setupNewMediaStream()}),function(e){return n.apply(this,arguments)}),l.setMediaStreamToDefault=Ae(function*(){var e=!1,t=l.props.store.state.settings.lastUsedMicDeviceId;return e=t?yield l.fetchAudioTrack({audio:{deviceId:{ideal:t}}}):yield l.fetchAudioTrack({audio:!0}),yield l.setupNewMediaStream(),{hasAudio:e}}),l.setStateAndRequestScreen=(a=Ae(function*(e){var t=e.target.checked;yield l.setState({requestedScreen:!0,shareScreen:t}),t?l.fetchVideoTrack({video:{mediaSource:"screen",width:screen.width/screen.height*720,height:720,frameRate:30}}):l.setState({videoTrack:null})}),function(e){return a.apply(this,arguments)}),l.fetchVideoTrack=(r=Ae(function*(e){var t=yield navigator.mediaDevices.getUserMedia(e);l.setState({videoTrack:t.getVideoTracks()[0]})}),function(e){return r.apply(this,arguments)}),l.fetchAudioTrack=(s=Ae(function*(e){l.state.audioTrack&&l.state.audioTrack.stop();try{var t=yield navigator.mediaDevices.getUserMedia(e);return l.setState({audioTrack:t.getAudioTracks()[0]}),!0}catch(e){return l.setState({audioTrack:null}),!1}}),function(e){return s.apply(this,arguments)}),l.setupNewMediaStream=Ae(function*(){var e=new MediaStream;if(yield l.fetchMicDevices(),l.state.videoTrack&&e.addTrack(l.state.videoTrack),l.state.audioTrack){e.addTrack(l.state.audioTrack);var t=window.AudioContext||window.webkitAudioContext,i=new t,n=i.createMediaStreamSource(e),a=i.createAnalyser();a.fftSize=32;var o=new Uint8Array(a.frequencyBinCount);n.connect(a);var r=setInterval(function(){a.getByteTimeDomainData(o);for(var e=0,t=0;t<o.length;t++)e=Math.max(o[t]-128,e);var i=e/128;l.micLevelMovingAverage.push(Date.now(),6*i);var n=l.micLevelMovingAverage.movingAverage();l.setState(function(e){if(Math.abs(n-e.micLevel)>1e-4)return{micLevel:n}})},50),s=l.micDeviceIdForMicLabel(l.micLabelForMediaStream(e));s&&l.props.store.update({settings:{lastUsedMicDeviceId:s}}),l.setState({micLevelAudioContext:i,micUpdateInterval:r})}l.setState({mediaStream:e})}),l.onMicGrantButton=Ae(function*(){if(l.state.entryStep==Re.mic_grant){var e=yield l.setMediaStreamToDefault(),t=e.hasAudio;t?l.setState({entryStep:Re.mic_granted}):l.beginOrSkipAudioSetup()}else l.beginOrSkipAudioSetup()}),l.onProfileFinished=function(){l.setState({showProfileEntry:!1})},l.beginOrSkipAudioSetup=function(){l.props.forcedVREntryType&&l.props.forcedVREntryType.endsWith("_now")?setTimeout(l.onAudioReadyButton,3e3):l.setState({entryStep:Re.audio_setup})},l.fetchMicDevices=function(){return new Promise(function(e){navigator.mediaDevices.enumerateDevices().then(function(t){l.setState({micDevices:t.filter(function(e){return"audioinput"===e.kind}).map(function(e){return{deviceId:e.deviceId,label:e.label}})},e)})})},l.shouldShowHmdMicWarning=function(){return!AFRAME.utils.device.isMobile()&&(!!l.state.enterInVR&&(!!l.hasHmdMicrophone()&&!Ce.find(function(e){return l.selectedMicLabel().match(e)})))},l.hasHmdMicrophone=function(){return!!l.state.micDevices.find(function(e){return Ce.find(function(t){return e.label.match(t)})})},l.micLabelForMediaStream=function(e){return e&&e.getAudioTracks().length>0&&e.getAudioTracks()[0].label||""},l.selectedMicLabel=function(){return l.micLabelForMediaStream(l.state.mediaStream)},l.micDeviceIdForMicLabel=function(e){return l.state.micDevices.filter(function(t){return t.label===e}).map(function(e){return e.deviceId})[0]},l.selectedMicDeviceId=function(){return l.micDeviceIdForMicLabel(l.selectedMicLabel())},l.onAudioReadyButton=function(){AFRAME.utils.device.isMobile()&&!l.state.enterInVR&&ne.default.enabled&&ne.default.request(),l.props.enterScene(l.state.mediaStream,l.state.enterInVR,l.props.hubId);var e=l.state.mediaStream;e&&(e.getAudioTracks().length>0&&console.log("Using microphone: "+e.getAudioTracks()[0].label),e.getVideoTracks().length>0&&console.log("Screen sharing enabled.")),l.stopTestTone(),clearTimeout(l.testToneTimeout),l.state.micLevelAudioContext&&(l.state.micLevelAudioContext.close(),clearInterval(l.state.micUpdateInterval)),l.setState({entryStep:Re.finished})},l.attemptLink=Ae(function*(){l.setState({infoDialogType:ve.default.dialogTypes.link});var e=yield l.props.linkChannel.generateCode(),t=e.code,i=e.cancel,n=e.onFinished;l.setState({linkCode:t,linkCodeCancel:i}),n.then(l.handleCloseDialog)}),l.handleCloseDialog=Ae(function*(){l.state.linkCodeCancel&&l.state.linkCodeCancel(),l.setState({infoDialogType:null,linkCode:null,linkCodeCancel:null})}),l.handleCreateObject=function(e){l.props.scene.emit("add_media",e)},l.state.showProfileEntry=l.props.showProfileEntry,l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.props.concurrentLoadDetector.addEventListener("concurrentload",this.onConcurrentLoad),this.micLevelMovingAverage=(0,te.default)(100),this.props.scene.addEventListener("loaded",this.onSceneLoaded),this.props.scene.addEventListener("stateadded",this.onAframeStateChanged),this.props.scene.addEventListener("stateremoved",this.onAframeStateChanged),this.props.scene.addEventListener("exit",this.exit)}},{key:"componentWillUnmount",value:function(){this.props.scene.removeEventListener("loaded",this.onSceneLoaded),this.props.scene.removeEventListener("exit",this.exit)}},{key:"componentDidUpdate",value:function(e){this.props.availableVREntryTypes&&e.availableVREntryTypes!==this.props.availableVREntryTypes&&this.handleForcedVREntryType()}},{key:"render",value:function(){var e=this;if(this.state.exited||this.props.roomUnavailableReason||this.props.platformUnsupportedReason){var t=null;if("closed"===this.props.roomUnavailableReason)t=W.default.createElement("div",null,"Sorry, this room is no longer available.",W.default.createElement("p",null),"A room may be closed if we receive reports that it violates our"," ",W.default.createElement("a",{target:"_blank",rel:"noreferrer noopener",href:"https://github.com/mozilla/hubs/blob/master/TERMS.md"},"Terms of Use"),".",W.default.createElement("br",null),"If you have questions, contact us at ",W.default.createElement("a",{href:"mailto:hubs@mozilla.com"},"hubs@mozilla.com"),".",W.default.createElement("p",null),"If you'd like to run your own server, hubs's source code is available on"," ",W.default.createElement("a",{href:"https://github.com/mozilla/hubs"},"GitHub"),".");else if("no_data_channels"===this.props.platformUnsupportedReason)t=W.default.createElement("div",null,"Your browser does not support"," ",W.default.createElement("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createDataChannel#Browser_compatibility",rel:"noreferrer noopener"},"WebRTC Data Channels"),", which is required to use Hubs.",W.default.createElement("br",null),'If you"d like to use Hubs with Oculus or SteamVR, you can'," ",W.default.createElement("a",{href:"https://www.mozilla.org/firefox",rel:"noreferrer noopener"},"Download Firefox"),".");else{var i=this.props.roomUnavailableReason||this.props.platformUnsupportedReason,n="exit.subtitle."+(this.state.exited?"exited":i);t=W.default.createElement("div",null,W.default.createElement(K.FormattedMessage,{id:n}),W.default.createElement("p",null),this.props.roomUnavailableReason&&W.default.createElement("div",null,"You can also ",W.default.createElement("a",{href:"/"},"create a new room"),"."))}return W.default.createElement(K.IntlProvider,{locale:le.lang,messages:le.messages},W.default.createElement("div",{className:"exited-panel"},W.default.createElement("img",{className:"exited-panel__logo",src:s.default}),W.default.createElement("div",{className:"exited-panel__subtitle"},t)))}if(this.props.isBotMode)return W.default.createElement("div",{className:"loading-panel"},W.default.createElement("img",{className:"loading-panel__logo",src:s.default}),W.default.createElement("input",{type:"file",id:"bot-audio-input",accept:"audio/*"}),W.default.createElement("input",{type:"file",id:"bot-data-input",accept:"application/json"}));if(!this.props.initialEnvironmentLoaded||!this.props.availableVREntryTypes||!this.props.hubId)return W.default.createElement(K.IntlProvider,{locale:le.lang,messages:le.messages},W.default.createElement("div",{className:"loading-panel"},W.default.createElement("div",{className:"loader-wrap"},W.default.createElement("div",{className:"loader"},W.default.createElement("div",{className:"loader-center"}))),W.default.createElement("img",{className:"loading-panel__logo",src:s.default})));var a=this.props.enableScreenSharing&&!AFRAME.utils.device.isMobile()&&/firefox/i.test(navigator.userAgent)&&W.default.createElement("label",{className:se.default.screenSharing},W.default.createElement("input",{className:se.default.checkbox,type:"checkbox",value:this.state.shareScreen,onChange:this.setStateAndRequestScreen}),W.default.createElement(K.FormattedMessage,{id:"entry.enable-screen-sharing"})),o=this.state.entryStep===Re.start?W.default.createElement("div",{className:se.default.entryPanel},W.default.createElement("div",{className:se.default.buttonContainer},!1,this.props.availableVREntryTypes.screen===X.VR_DEVICE_AVAILABILITY.yes&&W.default.createElement(ue.TwoDEntryButton,{onClick:this.enter2D}),this.props.availableVREntryTypes.safari===X.VR_DEVICE_AVAILABILITY.maybe&&W.default.createElement(ue.SafariEntryButton,{onClick:this.linkSafari}),this.props.availableVREntryTypes.generic!==X.VR_DEVICE_AVAILABILITY.no&&W.default.createElement(ue.GenericEntryButton,{onClick:this.enterVR}),this.props.availableVREntryTypes.daydream!==X.VR_DEVICE_AVAILABILITY.no&&W.default.createElement(ue.DaydreamEntryButton,{onClick:this.enterDaydream,subtitle:this.props.availableVREntryTypes.daydream==X.VR_DEVICE_AVAILABILITY.maybe?"entry.daydream-via-chrome":null}),W.default.createElement(ue.DeviceEntryButton,{onClick:this.attemptLink,isInHMD:this.props.availableVREntryTypes.isInHMD}),this.props.availableVREntryTypes.cardboard!==X.VR_DEVICE_AVAILABILITY.no&&W.default.createElement("div",{className:se.default.secondary,onClick:this.enterVR},W.default.createElement(K.FormattedMessage,{id:"entry.cardboard"})),a,W.default.createElement("button",{className:se.default.inviteButton,onClick:function(){return e.setState({infoDialogType:ve.default.dialogTypes.invite})}},W.default.createElement(K.FormattedMessage,{id:"entry.invite-others"})))):null,r=this.state.entryStep===Re.mic_grant||this.state.entryStep===Re.mic_granted?W.default.createElement("div",{className:"mic-grant-panel"},W.default.createElement("div",{className:"mic-grant-panel__grant-container"},W.default.createElement("div",{className:"mic-grant-panel__title"},W.default.createElement(K.FormattedMessage,{id:this.state.entryStep==Re.mic_grant?"audio.grant-title":"audio.granted-title"})),W.default.createElement("div",{className:"mic-grant-panel__subtitle"},W.default.createElement(K.FormattedMessage,{id:this.state.entryStep==Re.mic_grant?"audio.grant-subtitle":"audio.granted-subtitle"})),W.default.createElement("div",{className:"mic-grant-panel__button-container"},this.state.entryStep==Re.mic_grant?W.default.createElement("button",{className:"mic-grant-panel__button",onClick:this.onMicGrantButton},W.default.createElement("img",{src:c.default,srcSet:u.default+" 2x"})):W.default.createElement("button",{className:"mic-grant-panel__button",onClick:this.onMicGrantButton},W.default.createElement("img",{src:f.default,srcSet:m.default+" 2x"})))),W.default.createElement("div",{className:"mic-grant-panel__next-container"},W.default.createElement("button",{className:(0,J.default)("mic-grant-panel__next"),onClick:this.onMicGrantButton},W.default.createElement(K.FormattedMessage,{id:"audio.granted-next"})))):null,l={clip:"rect("+(111-Math.floor(111*this.state.micLevel))+"px, 111px, 111px, 0px)"},d={clip:"rect("+(this.state.tonePlaying?0:111)+"px, 111px, 111px, 0px)"},h=AFRAME.utils.device.isMobile()?"audio.subtitle-mobile":"audio.subtitle-desktop",p=this.state.entryStep===Re.audio_setup?W.default.createElement("div",{className:"audio-setup-panel"},W.default.createElement("div",null,W.default.createElement("div",{className:"audio-setup-panel__title"},W.default.createElement(K.FormattedMessage,{id:"audio.title"})),W.default.createElement("div",{className:"audio-setup-panel__subtitle"},(AFRAME.utils.device.isMobile()||this.state.enterInVR)&&W.default.createElement(K.FormattedMessage,{id:h})),W.default.createElement("div",{className:"audio-setup-panel__levels"},W.default.createElement("div",{className:"audio-setup-panel__levels__icon"},W.default.createElement("img",{src:g.default,srcSet:b.default+" 2x",className:"audio-setup-panel__levels__icon-part"}),W.default.createElement("img",{src:_.default,srcSet:k.default+" 2x",className:"audio-setup-panel__levels__icon-part",style:l}),this.state.audioTrack?W.default.createElement("img",{src:R.default,srcSet:M.default+" 2x",className:"audio-setup-panel__levels__icon-part"}):W.default.createElement("img",{src:c.default,srcSet:u.default+" 2x",className:"audio-setup-panel__levels__icon-part"})),W.default.createElement("div",{className:"audio-setup-panel__levels__icon",onClick:this.playTestTone},W.default.createElement("img",{src:g.default,srcSet:b.default+" 2x",className:"audio-setup-panel__levels__icon-part"}),W.default.createElement("img",{src:_.default,srcSet:k.default+" 2x",className:"audio-setup-panel__levels__icon-part",style:d}),W.default.createElement("img",{src:S.default,srcSet:L.default+" 2x",className:"audio-setup-panel__levels__icon-part"}))),this.state.audioTrack&&W.default.createElement("div",{className:"audio-setup-panel__device-chooser"},W.default.createElement("select",{className:"audio-setup-panel__device-chooser__dropdown",value:this.selectedMicDeviceId(),onChange:this.micDeviceChanged},this.state.micDevices.map(function(e){return W.default.createElement("option",{key:e.deviceId,value:e.deviceId},"Â Â Â Â Â ",e.label)})),W.default.createElement("img",{className:"audio-setup-panel__device-chooser__mic-icon",src:P.default,srcSet:O.default+" 2x"}),W.default.createElement("img",{className:"audio-setup-panel__device-chooser__dropdown-arrow",src:H.default,srcSet:j.default+" 2x"})),this.shouldShowHmdMicWarning()&&W.default.createElement("div",{className:"audio-setup-panel__hmd-mic-warning"},W.default.createElement("img",{src:V.default,srcSet:z.default+" 2x",className:"audio-setup-panel__hmd-mic-warning__icon"}),W.default.createElement("span",{className:"audio-setup-panel__hmd-mic-warning__label"},W.default.createElement(K.FormattedMessage,{id:"audio.hmd-mic-warning"})))),W.default.createElement("div",{className:"audio-setup-panel__enter-button-container"},W.default.createElement("button",{className:"audio-setup-panel__enter-button",onClick:this.onAudioReadyButton},W.default.createElement(K.FormattedMessage,{id:"audio.enter-now"})))):null,v=this.isWaitingForAutoExit()?W.default.createElement(de.default,{secondsRemaining:this.state.secondsRemainingBeforeAutoExit,onCancel:this.endAutoExitTimer}):W.default.createElement("div",{className:se.default.entryDialog},W.default.createElement(he.ProfileInfoHeader,{name:this.props.store.state.profile.displayName,onClickName:function(){return e.setState({showProfileEntry:!0})},onClickHelp:function(){return e.setState({infoDialogType:ve.default.dialogTypes.help})}}),o,r,p),y=(0,J.default)({"ui-interactive":!this.state.infoDialogType,"ui-dialog-box":!0}),E=(0,J.default)({"ui-dialog-box-contents":!0,"ui-dialog-box-contents--backgrounded":this.state.showProfileEntry});return W.default.createElement(K.IntlProvider,{locale:le.lang,messages:le.messages},W.default.createElement("div",{className:"ui"},W.default.createElement(ve.default,{dialogType:this.state.infoDialogType,linkCode:this.state.linkCode,onSubmittedEmail:function(){return e.setState({infoDialogType:ve.default.dialogTypes.email_submitted})},onCloseDialog:this.handleCloseDialog,onCreateObject:this.handleCreateObject}),this.state.entryStep===Re.finished&&W.default.createElement("button",{onClick:function(){return e.setState({infoDialogType:ve.default.dialogTypes.help})},className:"ui__help-icon"},W.default.createElement("i",{className:"ui__help-icon__icon"},W.default.createElement(Ee.FontAwesomeIcon,{icon:_e.faQuestion}))),this.state.entryStep===Re.finished&&W.default.createElement("div",{className:oe.default.presenceInfo},W.default.createElement(Ee.FontAwesomeIcon,{icon:be.faUsers}),W.default.createElement("span",{className:oe.default.occupantCount},this.props.occupantCount||"-")),W.default.createElement("div",{className:"ui-dialog"},(this.state.entryStep!==Re.finished||this.isWaitingForAutoExit())&&W.default.createElement("div",{className:y},W.default.createElement("div",{className:E},v),this.state.showProfileEntry&&W.default.createElement(pe.default,{finished:this.onProfileFinished,store:this.props.store}))),this.state.entryStep===Re.finished?W.default.createElement("div",null,W.default.createElement(ye.default.TopHUD,{muted:this.state.muted,frozen:this.state.frozen,spacebubble:this.state.spacebubble,onToggleMute:this.toggleMute,onToggleFreeze:this.toggleFreeze,onToggleSpaceBubble:this.toggleSpaceBubble,onSpawnPen:this.spawnPen}),!this.props.availableVREntryTypes.isInHMD&&this.props.occupantCount<=1&&W.default.createElement("div",{className:oe.default.nagButton},W.default.createElement("button",{onClick:function(){return e.setState({infoDialogType:ve.default.dialogTypes.invite})}},W.default.createElement(K.FormattedMessage,{id:"entry.invite-others-nag"}))),this.props.availableVREntryTypes.isInHMD&&W.default.createElement("div",{className:oe.default.nagButton},W.default.createElement("button",{onClick:function(){return e.props.scene.enterVR()}},W.default.createElement(K.FormattedMessage,{id:"entry.return-to-vr"}))),W.default.createElement(ye.default.BottomHUD,{onCreateObject:function(){return e.setState({infoDialogType:ve.default.dialogTypes.create_object})},showPhotoPicker:AFRAME.utils.device.isMobile(),onMediaPicked:this.handleCreateObject})):null))}}]),t}(G.Component);Te.propTypes={enterScene:Y.default.func,exitScene:Y.default.func,concurrentLoadDetector:Y.default.object,disableAutoExitOnConcurrentLoad:Y.default.bool,forcedVREntryType:Y.default.string,enableScreenSharing:Y.default.bool,isBotMode:Y.default.bool,store:Y.default.object,scene:Y.default.object,linkChannel:Y.default.object,showProfileEntry:Y.default.bool,availableVREntryTypes:Y.default.object,initialEnvironmentLoaded:Y.default.bool,roomUnavailableReason:Y.default.string,platformUnsupportedReason:Y.default.string,hubId:Y.default.string,hubName:Y.default.string,occupantCount:Y.default.number},t.default=Te},function(e,t,i){e.exports=i.p+"assets/images/mic_denied-6f265ac615c120127ea96a42e622cabc.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_denied@2x-7b31e5ffc307062fc2c609a33d918b9d.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_granted-6a5d269f341348577b687a24aeea12f2.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_granted@2x-1a2a0c515fdcfdd6ce5ee6be6f17d64f.png"},function(e,t,i){e.exports=i.p+"assets/images/level_background-009d04c7e0ca03ce73c117b3e469ac49.png"},function(e,t,i){e.exports=i.p+"assets/images/level_background@2x-8f7d48a15bfad5d8f61a146eb7ad5945.png"},function(e,t,i){e.exports=i.p+"assets/images/level_fill-338fe47928b89e96b82cc651023d0dfd.png"},function(e,t,i){e.exports=i.p+"assets/images/level_fill@2x-dc5ec005319ba99f27e4011db035292e.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_level-65069cdb2a680e44a7888ee019abee23.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_level@2x-921d16c1ae1419c3df154ffb44166839.png"},function(e,t,i){e.exports=i.p+"assets/images/speaker_level-c9f33814b00c63cd9d8b7676f262ac6d.png"},function(e,t,i){e.exports=i.p+"assets/images/speaker_level@2x-bf22116041d89f49b1b3bcf7ade958da.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_small-48ba900577e5d1e9dacab139ef787103.png"},function(e,t,i){e.exports=i.p+"assets/images/mic_small@2x-48ba900577e5d1e9dacab139ef787103.png"},function(e,t,i){e.exports=i.p+"assets/images/dropdown_arrow-427fb8d451998f4eec0ad543165f2a91.png"},function(e,t,i){e.exports=i.p+"assets/images/dropdown_arrow@2x-c16ca622a5bd77aec0faa2761ab8dcd6.png"},function(e,t,i){e.exports=i.p+"assets/images/warning_icon-6763c155fea2391899e9e5faa44d5f4d.png"},function(e,t,i){e.exports=i.p+"assets/images/warning_icon@2x-a585508ac0c8b1fbfed0bc762c628830.png"},,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),a=l(n),o=i(5),r=i(0),s=l(r);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){return a.default.createElement("div",{className:"autoexit-panel"},a.default.createElement("div",{className:"autoexit-panel__title"},a.default.createElement(o.FormattedMessage,{id:"autoexit.title"}),a.default.createElement("span",null,e.secondsRemaining),a.default.createElement(o.FormattedMessage,{id:"autoexit.title_units"})),a.default.createElement("div",{className:"autoexit-panel__subtitle"},a.default.createElement(o.FormattedMessage,{id:"autoexit.subtitle"})),a.default.createElement("div",{className:"autoexit-panel__cancel-button",onClick:e.onCancel},a.default.createElement(o.FormattedMessage,{id:"autoexit.cancel"})))};c.propTypes={secondsRemaining:s.default.number,onCancel:s.default.func},t.default=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceEntryButton=t.SafariEntryButton=t.DaydreamEntryButton=t.GearVREntryButton=t.GenericEntryButton=t.TwoDEntryButton=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},a=i(1),o=k(a),r=i(5),s=i(0),l=k(s),c=i(321),d=k(c),u=i(322),h=k(u),f=i(323),p=k(f),m=i(324),v=k(m),g=i(325),y=k(g),b=i(326),E=k(b),_=i(455),w=k(_);function k(e){return e&&e.__esModule?e:{default:e}}var A=function(e){return o.default.createElement("button",{className:w.default.entryButton,onClick:e.onClick},o.default.createElement("img",{src:e.iconSrc,className:w.default.icon}),o.default.createElement("div",{className:w.default.label},o.default.createElement("div",{className:w.default.contents},o.default.createElement("span",null,o.default.createElement(r.FormattedMessage,{id:e.prefixMessageId})),o.default.createElement("span",{className:w.default.bolded},o.default.createElement(r.FormattedMessage,{id:e.mediumMessageId})),e.subtitle&&o.default.createElement("div",{className:w.default.subtitle},o.default.createElement(r.FormattedMessage,{id:e.subtitle})))))};A.propTypes={onClick:l.default.func,iconSrc:l.default.string,prefixMessageId:l.default.string,mediumMessageId:l.default.string,subtitle:l.default.string,isInHMD:l.default.bool};t.TwoDEntryButton=function(e){var t=n({},e,{iconSrc:AFRAME.utils.device.isMobile()?d.default:h.default,prefixMessageId:"entry.screen-prefix",mediumMessageId:AFRAME.utils.device.isMobile()?"entry.mobile-screen":"entry.desktop-screen"});return o.default.createElement(A,t)},t.GenericEntryButton=function(e){var t=n({},e,{iconSrc:p.default,prefixMessageId:"entry.generic-prefix",mediumMessageId:"entry.generic-medium",subtitle:AFRAME.utils.device.isMobile()?null:"entry.generic-subtitle-desktop"});return o.default.createElement(A,t)},t.GearVREntryButton=function(e){var t=n({},e,{iconSrc:v.default,prefixMessageId:"entry.gearvr-prefix",mediumMessageId:"entry.gearvr-medium"});return o.default.createElement(A,t)},t.DaydreamEntryButton=function(e){var t=n({},e,{iconSrc:y.default,prefixMessageId:"entry.daydream-prefix",mediumMessageId:"entry.daydream-medium"});return o.default.createElement(A,t)},t.SafariEntryButton=function(e){var t=n({},e,{iconSrc:d.default,prefixMessageId:"entry.screen-prefix",mediumMessageId:"entry.mobile-safari"});return o.default.createElement(A,t)},t.DeviceEntryButton=function(e){var t=n({},e,{iconSrc:E.default,prefixMessageId:AFRAME.utils.device.isMobile()?"entry.device-prefix-mobile":"entry.device-prefix-desktop",mediumMessageId:"entry.device-medium"});return t.subtitle=t.isInHMD?"entry.device-subtitle-vr":AFRAME.utils.device.isMobile()?"entry.device-subtitle-mobile":"entry.device-subtitle-desktop",o.default.createElement(A,t)}},function(e,t,i){e.exports=i.p+"assets/images/mobile_screen_entry-56571ad6d8e70df95a684842b96621ff.svg"},function(e,t,i){e.exports=i.p+"assets/images/desktop_screen_entry-6e77d74d066138048b1151fd64e14e32.svg"},function(e,t,i){e.exports=i.p+"assets/images/generic_vr_entry-69dd6f2bbef1834ed4e3ff46bd6422df.svg"},function(e,t,i){e.exports=i.p+"assets/images/gearvr_entry-dcea59d35d7fae4c8b9c4985c1743851.svg"},function(e,t,i){e.exports=i.p+"assets/images/daydream_entry-4fe9ced9f15163d2095c43bf64edad7b.svg"},function(e,t,i){e.exports=i.p+"assets/images/device_entry-d3f3d960fab9d2ba5f868c6b671653ca.svg"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProfileInfoHeader=void 0;var n=i(328),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(n),o=i(1),r=u(o),s=i(0),l=u(s),c=i(19),d=i(118);function u(e){return e&&e.__esModule?e:{default:e}}var h=t.ProfileInfoHeader=function(e){return r.default.createElement("div",{className:"profile-info-header"},r.default.createElement("div",{className:"profile-info-header__menu-buttons"},r.default.createElement("button",{className:"profile-info-header__menu-buttons__menu-button",onClick:e.onClickHelp},r.default.createElement("i",{className:"profile-info-header__menu-buttons__menu-button__icon"},r.default.createElement(c.FontAwesomeIcon,{icon:d.faQuestion})))),r.default.createElement("div",{className:"profile-info-header__profile_display_name"},r.default.createElement("img",{src:a.default,onClick:e.onClickName,className:"profile-info-header__icon"}),r.default.createElement("div",{onClick:e.onClickName,title:e.name},e.name)))};h.propTypes={onClickName:l.default.func,onClickHelp:l.default.func,name:l.default.string}},function(e,t,i){e.exports=i.p+"assets/images/account-b19d3eb256285a254dc8756d5c38235e.svg"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(1),r=u(o),s=i(0),l=u(s),c=i(5),d=i(20);function u(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));f.call(i);var n=i.props.store.state.profile,a=n.displayName,o=n.avatarId;return i.state={displayName:a,avatarId:o},i.props.store.addEventListener("statechanged",i.storeUpdated),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentDidMount",value:function(){this.nameInput.addEventListener("keydown",this.stopPropagation),this.nameInput.addEventListener("keypress",this.stopPropagation),this.nameInput.addEventListener("keyup",this.stopPropagation),window.addEventListener("message",this.setAvatarStateFromIframeMessage)}},{key:"componentWillUnmount",value:function(){this.props.store.removeEventListener("statechanged",this.storeUpdated),this.nameInput.removeEventListener("keydown",this.stopPropagation),this.nameInput.removeEventListener("keypress",this.stopPropagation),this.nameInput.removeEventListener("keyup",this.stopPropagation),window.removeEventListener("message",this.setAvatarStateFromIframeMessage)}},{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage;return r.default.createElement("div",{className:"profile-entry"},r.default.createElement("form",{onSubmit:this.saveStateAndFinish,className:"profile-entry__form"},r.default.createElement("div",{className:"profile-entry__box profile-entry__box--darkened"},r.default.createElement("label",{htmlFor:"#profile-entry-display-name",className:"profile-entry__subtitle"},r.default.createElement(c.FormattedMessage,{id:"profile.header"})),r.default.createElement("label",null,r.default.createElement("input",{id:"profile-entry-display-name",className:"profile-entry__form-field-text",value:this.state.displayName,onFocus:function(e){return e.target.select()},onChange:function(t){return e.setState({displayName:t.target.value})},required:!0,spellCheck:"false",pattern:d.SCHEMA.definitions.profile.properties.displayName.pattern,title:t({id:"profile.display_name.validation_warning"}),ref:function(t){return e.nameInput=t}})),r.default.createElement("div",{className:"profile-entry__avatar-selector-container"},r.default.createElement("div",{className:"loading-panel"},r.default.createElement("div",{className:"loader-wrap"},r.default.createElement("div",{className:"loader"},r.default.createElement("div",{className:"loader-center"})))),r.default.createElement("iframe",{className:"profile-entry__avatar-selector",src:"/avatar-selector.html#avatar_id="+this.state.avatarId,ref:function(t){return e.avatarSelector=t}})),r.default.createElement("input",{className:"profile-entry__form-submit",type:"submit",value:t({id:"profile.save"})}),r.default.createElement("div",{className:"profile-entry__box__links"},r.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/blob/master/TERMS.md"},r.default.createElement(c.FormattedMessage,{id:"profile.terms_of_use"})),r.default.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/mozilla/hubs/blob/master/PRIVACY.md"},r.default.createElement(c.FormattedMessage,{id:"profile.privacy_notice"}))))))}}]),t}(o.Component);h.propTypes={store:l.default.object,messages:l.default.object,finished:l.default.func,intl:l.default.object};var f=function(){var e=this;this.storeUpdated=function(){var t=e.props.store.state.profile,i=t.avatarId,n=t.displayName;e.setState({avatarId:i,displayName:n})},this.saveStateAndFinish=function(t){t.preventDefault();var i=e.props.store.state.profile.displayName,a=e.props.store.state.activity.hasChangedName,o=a||e.state.displayName!==i;e.props.store.update({activity:{hasChangedName:o},profile:n({},e.state)}),e.props.finished()},this.stopPropagation=function(e){e.stopPropagation()},this.setAvatarStateFromIframeMessage=function(t){t.source===e.avatarSelector.contentWindow&&e.setState({avatarId:t.data.avatarId})}};t.default=(0,c.injectIntl)(h)},,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),a=u(n),o=i(0),r=u(o),s=i(9),l=u(s),c=i(457),d=u(c);function u(e){return e&&e.__esModule?e:{default:e}}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var f=function(e){var t=e.muted,i=e.frozen,n=e.onToggleMute,o=e.onToggleFreeze,r=e.onSpawnPen;return a.default.createElement("div",{className:(0,l.default)(d.default.container,d.default.top,d.default.unselectable)},a.default.createElement("div",{className:(0,l.default)("ui-interactive",d.default.panel,d.default.left)},a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default.mute,h({},d.default.active,t)),title:t?"Unmute Mic":"Mute Mic",onClick:n})),a.default.createElement("div",{className:(0,l.default)("ui-interactive",d.default.iconButton,d.default.large,d.default.freeze,h({},d.default.active,i)),title:i?"Resume":"Pause",onClick:o}),a.default.createElement("div",{className:(0,l.default)("ui-interactive",d.default.panel,d.default.right)},a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default.spawn_pen),title:"Drawing Pen",onClick:r})))};f.propTypes={muted:r.default.bool,frozen:r.default.bool,onToggleMute:r.default.func,onToggleFreeze:r.default.func,onSpawnPen:r.default.func};var p=function(e){var t=e.onCreateObject,i=e.showPhotoPicker,n=e.onMediaPicked;return a.default.createElement("div",{className:(0,l.default)(d.default.container,d.default.column,d.default.bottom,d.default.unselectable)},i?a.default.createElement("div",{className:(0,l.default)("ui-interactive",d.default.panel,d.default.up)},a.default.createElement("input",{id:"media-picker-input",className:(0,l.default)(d.default.hide),type:"file",accept:"image/*",multiple:!0,onChange:function(e){var t=!0,i=!1,a=void 0;try{for(var o,r=e.target.files[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var s=o.value;n(s)}}catch(e){i=!0,a=e}finally{try{!t&&r.return&&r.return()}finally{if(i)throw a}}}}),a.default.createElement("label",{htmlFor:"media-picker-input"},a.default.createElement("div",{className:(0,l.default)(d.default.iconButton,d.default.mobileMediaPicker),title:"Pick Media"}))):a.default.createElement("div",null),a.default.createElement("div",null,a.default.createElement("div",{className:(0,l.default)("ui-interactive",d.default.iconButton,d.default.large,d.default.createObject),title:"Create Object",onClick:t})))};p.propTypes={onCreateObject:r.default.func,showPhotoPicker:r.default.bool,onMediaPicked:r.default.func},t.default={TopHUD:f,BottomHUD:p}},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};function a(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()}t.default=function e(t){var i,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setPhoenixChannel=function(e){o.channel=e},this.sendEntryEvent=(i=function*(){if(o.channel){var e="Screen";if(navigator.getVRDisplays){var t=(yield navigator.getVRDisplays()).find(function(e){return e.isPresenting});t&&(e=t.displayName)}var i=0;NAF.connection.adapter&&NAF.connection.adapter.publisher&&(i=NAF.connection.adapter.publisher.initialOccupants.length);var a=o.getEntryTimingFlags(),r=n({},a,{initialOccupantCount:i,entryDisplayType:e,userAgent:navigator.userAgent});o.channel.push("events:entered",r)}else console.warn("No phoenix channel initialized before room entry.")},function(){var e=i.apply(this,arguments);return new Promise(function(t,i){return function n(a,o){try{var r=e[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});t(s)}("next")})}),this.getEntryTimingFlags=function(){var e={isNewDaily:!0,isNewMonthly:!0,isNewDayWindow:!0,isNewMonthWindow:!0},t=o.store.state.activity.lastEnteredAt;if(!t)return e;var i,n,r=new Date,s=new Date(t),l=r-s;return e.isNewDaily=(i=r,n=s,!(a(i,n)&&i.getDate()==n.getDate())),e.isNewMonthly=!a(r,s),e.isNewDayWindow=l>864e5,e.isNewMonthWindow=l>2592e6,e},this.sendObjectSpawnedEvent=function(e){if(o.channel){var t={object_type:e};o.channel.push("events:object_spawned",t)}else console.warn("No phoenix channel initialized before object spawn.")},this.disconnect=function(){o.channel&&o.channel.socket.disconnect()},this.store=t}},,,function(e,t,i){"use strict";var n=i(344),a=n.Pathfinding;AFRAME.registerSystem("nav",{init:function(){this.pathfinder=new a},loadMesh:function(e,t){this.el.object3D.updateMatrixWorld();var i=(new THREE.Geometry).fromBufferGeometry(e.geometry);i.applyMatrix(e.matrixWorld),this.pathfinder.setZoneData(t,a.createZone(i))}})},,function(e,t,i){"use strict";var n=new AFRAME.THREE.Vector3,a=new AFRAME.THREE.Vector3;function o(e){var t=new THREE.SphereBufferGeometry(e,10,10),i=new THREE.WireframeGeometry(t),n=new THREE.LineSegments(i);return n.material.opacity=.5,n.material.transparent=!0,n}AFRAME.registerSystem("personal-space-bubble",{schema:{debug:{default:!1},enabled:{default:!0}},init:function(){var e=this;this.invaders=[],this.bubbles=[],this.el.addEventListener("action_space_bubble",function(){e.el.setAttribute("personal-space-bubble",{enabled:!e.data.enabled})})},registerBubble:function(e){this.bubbles.push(e)},unregisterBubble:function(e){var t=this.bubbles.indexOf(e);-1!==t&&this.bubbles.splice(t,1)},registerInvader:function(e){var t=this;NAF.utils.getNetworkedEntity(e.el).then(function(i){var n=NAF.utils.getNetworkOwner(i);n!==NAF.clientId&&t.invaders.push(e)})},unregisterInvader:function(e){var t=this.invaders.indexOf(e);-1!==t&&this.invaders.splice(t,1)},update:function(){for(var e=0;e<this.bubbles.length;e++)this.bubbles[e].updateDebug();for(var t=0;t<this.invaders.length;t++)this.invaders[t].updateDebug(),this.data.enabled||this.invaders[t].setInvading(!1);this.data.enabled?this.el.addState("spacebubble"):this.el.removeState("spacebubble")},tick:function(){if(this.data.enabled){for(var e=0;e<this.invaders.length;e++)this.invaders[e].setInvading(!1);for(var t=0;t<this.bubbles.length;t++){var i=this.bubbles[t];a.setFromMatrixPosition(i.el.object3D.matrixWorld);for(var o=0;o<this.invaders.length;o++){var r=this.invaders[o];n.setFromMatrixPosition(r.el.object3D.matrixWorld);var s=a.distanceToSquared(n),l=i.data.radius+r.data.radius;s<l*l&&r.setInvading(!0)}}}}}),AFRAME.registerComponent("space-invader-mesh",{schema:{meshName:{type:"string"}},update:function(){this.targetMesh=this.el.object3D.getObjectByName(this.data.meshName)}});AFRAME.registerComponent("personal-space-invader",{schema:{radius:{type:"number",default:.1},useMaterial:{default:!1},debug:{default:!1},invadingOpacity:{default:.3}},init:function(){var e=this.el.sceneEl.systems["personal-space-bubble"];if(e.registerInvader(this),this.data.useMaterial){var t=function(e){for(;e&&(!e.components||!e.components["space-invader-mesh"]);)e=e.parentNode;return e&&e.components["space-invader-mesh"].targetMesh}(this.el);t&&(this.targetMaterial=t.material)}this.invading=!1},update:function(){this.radiusSquared=this.data.radius*this.data.radius,this.updateDebug()},updateDebug:function(){var e=this.el.sceneEl.systems["personal-space-bubble"];e.data.debug||this.data.debug?!this.el.object3DMap["psb-debug"]&&this.el.setObject3D("psb-debug",o(this.data.radius)):this.el.object3DMap["psb-debug"]&&this.el.removeObject3D("psb-debug")},remove:function(){this.el.sceneEl.systems["personal-space-bubble"].unregisterInvader(this)},setInvading:function(e){this.targetMaterial?(this.targetMaterial.opacity=e?this.data.invadingOpacity:1,this.targetMaterial.transparent=e):this.el.object3D.visible=!e,this.invading=e}}),AFRAME.registerComponent("personal-space-bubble",{schema:{radius:{type:"number",default:.8},debug:{default:!1}},init:function(){this.system.registerBubble(this)},update:function(){this.radiusSquared=this.data.radius*this.data.radius,this.updateDebug()},updateDebug:function(){this.system.data.debug||this.data.debug?!this.el.object3DMap["psb-debug"]&&this.el.setObject3D("psb-debug",o(this.data.radius)):this.el.object3DMap["psb-debug"]&&this.el.removeObject3D("psb-debug")},remove:function(){this.system.unregisterBubble(this)}})},function(e,t,i){"use strict";AFRAME.registerSystem("exit-on-blur",{init:function(){this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this),this.onTimeout=this.onTimeout.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.isOculusBrowser=navigator.userAgent.match(/Oculus/),this.enteredVR=!1,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),this.el.addEventListener("enter-vr",this.onEnterVR),this.exitTimeout=null},tick:function(){this.isOculusBrowser&&this.enteredVR&&(clearTimeout(this.exitTimeout),this.exitTimeout=setTimeout(this.onTimeout,15e3))},onEnterVR:function(){this.enteredVR=!0},onBlur:function(){this.el.isMobile&&(clearTimeout(this.exitTimeout),this.exitTimeout=setTimeout(this.onTimeout,3e4))},onFocus:function(){this.el.isMobile&&clearTimeout(this.exitTimeout)},onTimeout:function(){this.el.dispatchEvent(new CustomEvent("exit"))},remove:function(){clearTimeout(this.exitTimeout),window.removeEventListener("blur",this.onBlur)}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";AFRAME.registerComponent("super-networked-interactable",{schema:{hapticsMassVelocityFactor:{default:.1},counter:{type:"selector"},scrollScaleDelta:{default:.1},minScale:{default:.1},maxScale:{default:100}},init:function(){var e=this;this.system=this.el.sceneEl.systems.physics,this.counter=this.data.counter.components["networked-counter"],this.hand=null,this.currentScale=new THREE.Vector3,this.currentScale.copy(this.el.getAttribute("scale")),NAF.utils.getNetworkedEntity(this.el).then(function(t){e.networkedEl=t,NAF.utils.isMine(t)?e.counter.register(t):e.el.setAttribute("body",{type:"static"})}),this._stateAdded=this._stateAdded.bind(this),this._onGrabStart=this._onGrabStart.bind(this),this._onGrabEnd=this._onGrabEnd.bind(this),this._onOwnershipLost=this._onOwnershipLost.bind(this),this.el.addEventListener("grab-start",this._onGrabStart),this.el.addEventListener("grab-end",this._onGrabEnd),this.el.addEventListener("ownership-lost",this._onOwnershipLost),this.el.addEventListener("stateadded",this._stateAdded),this.system.addComponent(this)},remove:function(){this.counter.deregister(this.el),this.el.removeEventListener("grab-start",this._onGrabStart),this.el.removeEventListener("grab-end",this._onGrabEnd),this.el.removeEventListener("ownership-lost",this._onOwnershipLost),this.el.removeEventListener("stateadded",this._stateAdded),this.system.removeComponent(this)},_onGrabStart:function(e){this.hand=e.detail.hand,this.hand.emit("haptic_pulse",{intensity:"high"}),this.networkedEl&&!NAF.utils.isMine(this.networkedEl)&&(NAF.utils.takeOwnership(this.networkedEl)?(this.el.setAttribute("body",{type:"dynamic"}),this.counter.register(this.networkedEl)):(this.el.emit("grab-end",{hand:this.hand}),this.hand=null)),this.currentScale.copy(this.el.getAttribute("scale"))},_onGrabEnd:function(e){e.detail.hand&&e.detail.hand.emit("haptic_pulse",{intensity:"high"})},_onOwnershipLost:function(){this.el.setAttribute("body",{type:"static"}),this.el.emit("grab-end",{hand:this.hand}),this.hand=null,this.counter.deregister(this.el)},_changeScale:function(e){this.el.is("grabbed")&&this.el.components.hasOwnProperty("stretchable")&&(this.currentScale.addScalar(e).clampScalar(this.data.minScale,this.data.maxScale),this.el.setAttribute("scale",this.currentScale),this.el.components.stretchable.stretchBody(this.el,this.currentScale))},_stateAdded:function(e){switch(e.detail){case"scaleUp":this._changeScale(-this.data.scrollScaleDelta);break;case"scaleDown":this._changeScale(this.data.scrollScaleDelta)}}})},function(e,t,i){"use strict";AFRAME.registerComponent("networked-counter",{schema:{max:{default:3},ttl:{default:0},grab_event:{type:"string",default:"grab-start"},release_event:{type:"string",default:"grab-end"}},init:function(){this.registeredEls=new Map},remove:function(){var e=this;this.registeredEls.forEach(function(t,i){var n=t.onGrabHandler,a=t.onReleaseHandler,o=t.timeout;i.removeEventListener(e.data.grab_event,n),i.removeEventListener(e.data.release_event,a),clearTimeout(o)}),this.registeredEls.clear()},register:function(e){if(!(this.data.max<=0||this.registeredEls.has(e))){var t=this._onGrabbed.bind(this,e),i=this._onReleased.bind(this,e);this.registeredEls.set(e,{ts:Date.now(),onGrabHandler:t,onReleaseHandler:i}),e.addEventListener(this.data.grab_event,t),e.addEventListener(this.data.release_event,i),e.is("grabbed")||this._startTimer(e),this._destroyOldest()}},deregister:function(e){if(this.registeredEls.has(e)){var t=this.registeredEls.get(e),i=t.onGrabHandler,n=t.onReleaseHandler,a=t.timeout;e.removeEventListener(this.data.grab_event,i),e.removeEventListener(this.data.release_event,n),clearTimeout(a),this.registeredEls.delete(e)}},_onGrabbed:function(e){clearTimeout(this.registeredEls.get(e).timeout)},_onReleased:function(e){this._startTimer(e),this.registeredEls.get(e).ts=Date.now()},_destroyOldest:function(){if(this.registeredEls.size>this.data.max){var e=null,t=Number.MAX_VALUE;this.registeredEls.forEach(function(i,n){var a=i.ts;a<t&&!n.is("grabbed")&&(e=n,t=a)}),this._destroy(e)}},_startTimer:function(e){var t=this;this.data.ttl&&(clearTimeout(this.registeredEls.get(e).timeout),this.registeredEls.get(e).timeout=setTimeout(function(){t._destroy(e)},1e3*this.data.ttl))},_destroy:function(e){this.deregister(e),e.parentNode.removeChild(e)}})},function(e,t,i){"use strict";var n=i(75),a=i(405),o=i(65);function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,o){try{var r=t[a](o),s=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)});e(s)}("next")})}}var s=0;AFRAME.registerComponent("super-spawner",{schema:{src:{default:""},template:{default:""},useCustomSpawnPosition:{default:!1},spawnPosition:{type:"vec3"},useCustomSpawnRotation:{default:!1},spawnRotation:{type:"vec4"},useCustomSpawnScale:{default:!1},spawnScale:{type:"vec3"},grabEvents:{default:["cursor-grab","primary_hand_grab"]},releaseEvents:{default:["cursor-release","primary_hand_release"]},spawnCooldown:{default:1},centerSpawnedObject:{default:!1},spawnEvent:{type:"string"},superHand:{type:"selector"},cursorSuperHand:{type:"selector"}},init:function(){this.heldEntities=new Map,this.cooldownTimeout=null,this.onGrabStart=this.onGrabStart.bind(this),this.onGrabEnd=this.onGrabEnd.bind(this),this.onSpawnEvent=this.onSpawnEvent.bind(this),this.sceneEl=document.querySelector("a-scene")},play:function(){this.el.addEventListener("grab-start",this.onGrabStart),this.el.addEventListener("grab-end",this.onGrabEnd),this.data.spawnEvent&&this.sceneEl.addEventListener(this.data.spawnEvent,this.onSpawnEvent)},pause:function(){this.el.removeEventListener("grab-start",this.onGrabStart),this.el.removeEventListener("grab-end",this.onGrabEnd),this.data.spawnEvent&&this.sceneEl.removeEventListener(this.data.spawnEvent,this.onSpawnEvent),this.cooldownTimeout&&(clearTimeout(this.cooldownTimeout),this.cooldownTimeout=null,this.el.setAttribute("visible",!0),this.el.classList.add("interactable"))},remove:function(){this.heldEntities.clear()},onSpawnEvent:function(){var e=r(function*(){var e=this.el.sceneEl.components["input-configurator"].controllerQueue.length,t=e>1&&this.el.sceneEl.is("vr-mode"),i=t?this.data.superHand:this.data.cursorSuperHand;if(!this.cooldownTimeout&&i){var r=(0,n.addMedia)(this.data.src,this.data.template,o.ObjectContentOrigins.SPAWNER).entity;if(i.object3D.getWorldPosition(r.object3D.position),i.object3D.getWorldQuaternion(r.object3D.quaternion),this.data.useCustomSpawnScale&&r.object3D.scale.copy(this.data.spawnScale),this.activateCooldown(),yield(0,a.waitForEvent)("body-loaded",r),i.object3D.getWorldPosition(r.object3D.position),!t)for(var s=0;s<this.data.grabEvents.length;s++)i.emit(this.data.grabEvents[s],{targetEntity:r})}});return function(){return e.apply(this,arguments)}}(),onGrabStart:function(){var e=r(function*(e){if(!this.cooldownTimeout){e.preventDefault();var t=e.detail.hand,i=s++;this.heldEntities.set(t,i);var r=(0,n.addMedia)(this.data.src,this.data.template,o.ObjectContentOrigins.SPAWNER).entity;if(r.object3D.position.copy(this.data.useCustomSpawnPosition?this.data.spawnPosition:this.el.object3D.position),r.object3D.rotation.copy(this.data.useCustomSpawnRotation?this.data.spawnRotation:this.el.object3D.rotation),r.object3D.scale.copy(this.data.useCustomSpawnScale?this.data.spawnScale:this.el.object3D.scale),this.activateCooldown(),yield(0,a.waitForEvent)("body-loaded",r),this.heldEntities.get(t)===i){this.data.centerSpawnedObject&&r.body.position.copy(t.object3D.position);for(var l=0;l<this.data.grabEvents.length;l++)t.emit(this.data.releaseEvents[l]),t.emit(this.data.grabEvents[l],{targetEntity:r})}}});return function(t){return e.apply(this,arguments)}}(),onGrabEnd:function(e){this.heldEntities.delete(e.detail.hand),e.preventDefault()},activateCooldown:function(){var e=this;this.data.spawnCooldown>0&&(this.el.setAttribute("visible",!1),this.el.classList.remove("interactable"),this.cooldownTimeout=setTimeout(function(){e.el.setAttribute("visible",!0),e.el.classList.add("interactable"),e.cooldownTimeout=null},1e3*this.data.spawnCooldown))}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.waitForEvent=function(e,t){return new Promise(function(i){t.addEventListener(e,i,{once:!0})})}},function(e,t,i){"use strict";AFRAME.registerComponent("event-repeater",{schema:{eventSource:{type:"selector"},events:{type:"array"}},play:function(){this.data.eventListeners=[];for(var e=this.data.events,t=0;t<e.length;t++){var i=e[t];this.data.eventListeners[i]=this._handleEvent.bind(this,i),this.data.eventSource.addEventListener(i,this.data.eventListeners[i])}},pause:function(){for(var e=this.data.events,t=0;t<e.length;t++){var i=e[t];this.data.eventSource.removeEventListener(i,this.data.eventListeners[i])}this.data.eventListeners=[]},_handleEvent:function(e,t){this.el.emit(e,t.detail)}})},function(e,t,i){"use strict";var n=i(111);AFRAME.registerComponent("controls-shape-offset",{schema:{additionalOffset:{type:"vec3",default:{x:0,y:-.03,z:-.04}}},init:function(){this.controller=null,this.shapeAdded=!1,this._handleControllerConnected=this._handleControllerConnected.bind(this),this.el.addEventListener("controllerconnected",this._handleControllerConnected)},remove:function(){this.el.removeEventListener("controllerconnected",this._handleControllerConnected)},tick:function(){if(!this.shapeAdded&&this.controller){this.shapeAdded=!0;var e=n.CONTROLLER_OFFSETS.hasOwnProperty(this.controller),t=e?n.CONTROLLER_OFFSETS[this.controller]:n.CONTROLLER_OFFSETS.default,i=new THREE.Vector3,a=new THREE.Quaternion,o=new THREE.Vector3;t.decompose(i,a,o),i.add(this.data.additionalOffset),a.conjugate();var r={shape:"sphere",radius:"0.02",orientation:a,offset:i};this.el.setAttribute("shape",r)}},_handleControllerConnected:function(e){this.controller=e.detail.name}})},function(e,t,i){"use strict";AFRAME.registerComponent("duck",{schema:{initialForce:{default:0},maxForce:{default:6.5},maxScale:{default:5}},init:function(){this.physicsSystem=this.el.sceneEl.systems.physics,this.hasBody=!1,this.position=new CANNON.Vec3,this.force=new CANNON.Vec3(0,this.data.initialForce,0),this.initialScale=this.el.object3D.scale.x,this.maxScale=this.data.maxScale*this.initialScale},play:function(){this.physicsSystem.addComponent(this)},pause:function(){this.physicsSystem.removeComponent(this)},beforeStep:function(){if(this.el.body&&NAF.utils.isMine(this.el)){var e=this.el.object3D.scale.x,t=Math.min(1,(e-this.initialScale)/(this.maxScale-this.initialScale)),i=t*this.data.maxForce;if(i>0){var n=Math.random()*Math.PI*2,a=Math.cos(n),o=Math.sin(n);this.force.set(a,i,o),this.position.set(.01*a,0,.01*o),this.el.body.applyForce(this.force,this.position)}}}})},function(e,t,i){"use strict";AFRAME.registerComponent("quack",{schema:{quackPercentage:{default:1},specialQuackPercentage:{default:.01}},init:function(){this._handleGrabStart=this._handleGrabStart.bind(this)},play:function(){this.el.addEventListener("grab-start",this._handleGrabStart)},pause:function(){this.el.removeEventListener("grab-start",this._handleGrabStart)},_handleGrabStart:function(){var e=Math.random();e<this.data.specialQuackPercentage?this.el.emit("specialquack"):e<this.data.quackPercentage&&this.el.emit("quack")}})},function(e,t,i){"use strict";var n,a,o,r,s=AFRAME.utils.extendDeep,l=i(136),c=i(17),d=s({},l,c);AFRAME.registerComponent("grabbable-toggle",s(d,{schema:{maxGrabbers:{type:"int",default:NaN},invert:{default:!1},suppressY:{default:!1},primaryReleaseEvents:{default:["primary_hand_release"]},secondaryReleaseEvents:{default:["secondary_hand_release"]}},init:function(){var e=this;this.GRABBED_STATE="grabbed",this.GRAB_EVENT="grab-start",this.UNGRAB_EVENT="grab-end",this.grabbed=!1,this.grabbers=[],this.constraints=new Map,this.deltaPositionIsValid=!1,this.grabDistance=void 0,this.grabDirection={x:0,y:0,z:-1},this.grabOffset={x:0,y:0,z:0},this.destPosition={x:0,y:0,z:0},this.deltaPosition=new THREE.Vector3,this.targetPosition=new THREE.Vector3,this.physicsInit(),this.el.addEventListener(this.GRAB_EVENT,function(t){return e.start(t)}),this.el.addEventListener(this.UNGRAB_EVENT,function(t){return e.end(t)}),this.el.addEventListener("mouseout",function(t){return e.lostGrabber(t)}),this.toggle=!1,this.lastGrabber=null},update:function(){this.physicsUpdate(),this.xFactor=this.data.invert?-1:1,this.zFactor=this.data.invert?-1:1,this.yFactor=(this.data.invert?-1:1)*!this.data.suppressY},tick:(o=new THREE.Quaternion,r=new THREE.Vector3,function(){var e=void 0;this.grabber&&(this.targetPosition.copy(this.grabDirection),this.targetPosition.applyQuaternion(this.grabber.object3D.getWorldQuaternion(o)).setLength(this.grabDistance).add(this.grabber.object3D.getWorldPosition(r)).add(this.grabOffset),this.deltaPositionIsValid?(this.deltaPosition.sub(this.targetPosition),e=this.el.getAttribute("position"),this.destPosition.x=e.x-this.deltaPosition.x*this.xFactor,this.destPosition.y=e.y-this.deltaPosition.y*this.yFactor,this.destPosition.z=e.z-this.deltaPosition.z*this.zFactor,this.el.setAttribute("position",this.destPosition)):this.deltaPositionIsValid=!0,this.deltaPosition.copy(this.targetPosition))}),remove:function(){this.el.removeEventListener(this.GRAB_EVENT,this.start),this.el.removeEventListener(this.UNGRAB_EVENT,this.end),this.physicsRemove()},start:function(e){if(!e.defaultPrevented&&this.startButtonOk(e)){var t=!Number.isFinite(this.data.maxGrabbers)||this.grabbers.length<this.data.maxGrabbers;if(Number.isFinite(this.data.maxGrabbers)&&!t&&this.grabbed&&(this.grabbers[0].components["super-hands"].onGrabEndButton(),t=!0),-1===this.grabbers.indexOf(e.detail.hand)&&t){if(!e.detail.hand.object3D)return void console.warn("grabbable entities must have an object3D");this.grabbers.push(e.detail.hand),this.physicsStart(e)||this.grabber||(this.grabber=e.detail.hand,this.resetGrabber()),e.preventDefault&&e.preventDefault(),this.grabbed=!0,this.el.addState(this.GRABBED_STATE)}}},end:function(e){var t=this.grabbers.indexOf(e.detail.hand);if(!e.defaultPrevented&&this.endButtonOk(e)){var i=e.detail&&e.detail.buttonEvent?e.detail.buttonEvent.type:null;if(this.toggle&&this.lastGrabber!==this.grabbers[0]&&(this.toggle=!1,this.lastGrabber=null),-1!==t&&(this.grabber=this.grabbers[0]),this.isPrimaryRelease(i)&&!this.toggle||this.isSecondaryRelease(i))return this.toggle=!0,void(this.lastGrabber=this.grabbers[0]);this.toggle&&this.isPrimaryRelease(i)&&(this.toggle=!1,this.lastGrabber=null),-1!==t&&(this.grabbers.splice(t,1),this.grabber=this.grabbers[0]),this.physicsEnd(e),this.resetGrabber()||(this.grabbed=!1,this.el.removeState(this.GRABBED_STATE)),e.preventDefault&&e.preventDefault()}},resetGrabber:(n=new THREE.Vector3,a=new THREE.Vector3,function(){if(!this.grabber)return!1;var e=this.grabber.getAttribute("raycaster");return this.deltaPositionIsValid=!1,this.grabDistance=this.el.object3D.getWorldPosition(n).distanceTo(this.grabber.object3D.getWorldPosition(a)),e&&(this.grabDirection=e.direction,this.grabOffset=e.origin),!0}),lostGrabber:function(e){var t=this.grabbers.indexOf(e.relatedTarget);-1===t||e.relatedTarget===this.grabber||this.physicsIsConstrained(e.relatedTarget)||this.grabbers.splice(t,1)},isPrimaryRelease:function(e){return-1!==this.data.primaryReleaseEvents.indexOf(e)},isSecondaryRelease:function(e){return-1!==this.data.secondaryReleaseEvents.indexOf(e)}}))},function(e,t,i){"use strict";e.exports=AFRAME.registerComponent("cardboard-controls",{init:function(){this.buttons={},this.gamepad=null,this.isMobile=AFRAME.utils.device.isMobile(),this.isVR=!1,this._handleEnterVR=this._handleEnterVR.bind(this),this._handleExitVR=this._handleExitVR.bind(this)},play:function(){window.addEventListener("enter-vr",this._handleEnterVR),window.addEventListener("exit-vr",this._handleExitVR)},pause:function(){window.removeEventListener("enter-vr",this._handleEnterVR),window.removeEventListener("exit-vr",this._handleExitVR)},tick:function(){if(this.inVR&&this.isMobile)if(this.gamepad=this.gamepad||this._getGamepad(),this.gamepad)for(var e=0;e<this.gamepad.buttons.length;e++)this.gamepad.buttons[e].pressed&&!this.buttons[e]?this.el.emit("cardboardbuttondown",{}):!this.gamepad.buttons[e].pressed&&this.buttons[e]&&this.el.emit("cardboardbuttonup",{}),this.buttons[e]=this.gamepad.buttons[e].pressed;else Object.keys(this.buttons).length&&(this.buttons={})},_getGamepad:function(){if(!navigator.getGamepads)return null;for(var e=navigator.getGamepads(),t=0;t<e.length;t++)if(e[t]&&"Cardboard Button"===e[t].id)return e[t];return null},_handleEnterVR:function(){this.inVR=!0},_handleExitVR:function(){this.inVR=!1}})},function(e,t,i){"use strict";var n,a;AFRAME.registerComponent("cursor-controller",{dependencies:["raycaster","line"],schema:{cursor:{type:"selector"},camera:{type:"selector"},maxDistance:{default:3},minDistance:{default:0},cursorColorHovered:{default:"#2F80ED"},cursorColorUnhovered:{default:"#FFFFFF"},rayObject:{type:"selector"},useMousePos:{default:!0},drawLine:{default:!1}},init:function(){this.enabled=!0,this.inVR=!1,this.isMobile=AFRAME.utils.device.isMobile(),this.currentTargetType=1,this.currentDistance=this.data.maxDistance,this.currentDistanceMod=0,this.mousePos=new THREE.Vector2,this.wasCursorHovered=!1,this.origin=new THREE.Vector3,this.direction=new THREE.Vector3,this.raycasterAttr=this.el.getAttribute("raycaster"),this.controllerQuaternion=new THREE.Quaternion,this.data.cursor.setAttribute("material",{color:this.data.cursorColorUnhovered}),this._handleCursorLoaded=this._handleCursorLoaded.bind(this),this.data.cursor.addEventListener("loaded",this._handleCursorLoaded)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1,this.setCursorVisibility(!1)},updateRay:function(){this.raycasterAttr.origin=this.origin,this.raycasterAttr.direction=this.direction,this.el.setAttribute("raycaster",this.raycasterAttr,!0)},tick:(n=new THREE.Quaternion,a=new THREE.Vector3,function(){if(this.enabled){if(this.data.useMousePos)this.setRaycasterWithMousePos();else if(null!=this.data.rayObject){var e=this.data.rayObject.object3D;n.setFromRotationMatrix(e.matrixWorld),this.direction.set(0,0,-1).applyQuaternion(n).normalize(),this.origin.setFromMatrixPosition(e.matrixWorld),this.updateRay()}var t=this.isInteracting();if(t){var i=Math.min(this.data.maxDistance,Math.max(this.data.minDistance,this.currentDistance-this.currentDistanceMod));this.direction.multiplyScalar(i),this.data.cursor.object3D.position.addVectors(this.origin,this.direction)}else{this.currentDistanceMod=0,this.updateDistanceAndTargetType();var o=this._isTargetOfType(6);o&&!this.wasCursorHovered?(this.wasCursorHovered=!0,this.data.cursor.setAttribute("material",{color:this.data.cursorColorHovered})):!o&&this.wasCursorHovered&&(this.wasCursorHovered=!1,this.data.cursor.setAttribute("material",{color:this.data.cursorColorUnhovered}))}this.data.drawLine&&this.el.setAttribute("line",{start:this.origin.clone(),end:this.data.cursor.object3D.position.clone()}),this.data.camera.object3D.getWorldPosition(a),a.y=this.data.cursor.object3D.position.y,this.data.cursor.object3D.lookAt(a)}}),setRaycasterWithMousePos:function(){var e=this.data.camera.components.camera.camera,t=this.el.components.raycaster.raycaster;t.setFromCamera(this.mousePos,e),this.origin.copy(t.ray.origin),this.direction.copy(t.ray.direction),this.updateRay()},updateDistanceAndTargetType:function(){var e=null,t=this.el.components.raycaster.intersections;t.length>0&&t[0].distance<=this.data.maxDistance?(e=t[0],this.data.cursor.object3D.position.copy(e.point),this.currentDistance=t[0].distance):(this.currentDistance=this.data.maxDistance,this.direction.multiplyScalar(this.currentDistance),this.data.cursor.object3D.position.addVectors(this.origin,this.direction)),e?e.object.el.matches(".interactable, .interactable *")?this.currentTargetType=2:e.object.el.matches(".ui, .ui *")&&(this.currentTargetType=4):this.currentTargetType=1},_isTargetOfType:function(e){return(this.currentTargetType&e)===this.currentTargetType},setCursorVisibility:function(e){this.data.cursor.setAttribute("visible",e),this.el.setAttribute("line",{visible:e&&this.data.drawLine})},forceCursorUpdate:function(){this.setRaycasterWithMousePos(),this.el.components.raycaster.checkIntersections(),this.updateDistanceAndTargetType(),this.data.cursor.components["static-body"].syncToPhysics()},isInteracting:function(){return this.data.cursor.components["super-hands"].state.has("grab-start")},startInteraction:function(){return!!this._isTargetOfType(6)&&(this.data.cursor.emit("cursor-grab",{}),!0)},moveCursor:function(e,t){this.mousePos.set(e,t)},endInteraction:function(){this.data.cursor.emit("cursor-release",{})},changeDistanceMod:function(e){var t=this.data,i=t.minDistance,n=t.maxDistance,a=this.currentDistanceMod+e,o=this.currentDistance-a;return!(o>n||o<i)&&(this.currentDistanceMod=a,!0)},_handleCursorLoaded:function(){this.data.cursor.object3DMap.mesh.renderOrder=window.APP.RENDER_ORDER.CURSOR,this.data.cursor.removeEventListener("loaded",this._handleCursorLoaded)},remove:function(){this.data.cursor.removeEventListener("loaded",this._handleCursorLoaded)}})},function(e,t,i){"use strict";AFRAME.registerComponent("nav-mesh-helper",{schema:{teleportControls:{type:"selectorAll",default:"[teleport-controls]"}},init:function(){var e=this.data.teleportControls;this.el.addEventListener("bundleloaded",function(){if(e)for(var t=0;t<e.length;t++)e[t].components["teleport-controls"].queryCollisionEntities()})}})},function(e,t,i){"use strict";i(415),i(416),i(417),i(418),i(419),i(420);var n,a=i(59),o=(n=a,n&&n.__esModule?n:{default:n});var r=(0,o.default)("disableTunnel");function s(e,t,i){return(1-i)*e+i*t}function l(e){var t=e-1;return 1+t*t*t*t*t}AFRAME.registerSystem("tunneleffect",{schema:{targetComponent:{type:"string",default:"character-controller"},radius:{type:"number",default:1,min:.25},minRadius:{type:"number",default:.25,min:.1},maxSpeed:{type:"number",default:.5,min:.1},softest:{type:"number",default:.1,min:0},opacity:{type:"number",default:1,min:0}},init:function(){this.scene=this.el,this.isMoving=!1,this.isVR=!1,this.dt=0,this.isPostProcessingReady=!1,this.characterEl=document.querySelector("a-entity["+this.data.targetComponent+"]"),this.characterEl?(this._initPostProcessing=this._initPostProcessing.bind(this),this.characterEl.addEventListener("componentinitialized",this._initPostProcessing)):console.warn("Could not find target component."),this._enterVR=this._enterVR.bind(this),this._exitVR=this._exitVR.bind(this),this.scene.addEventListener("enter-vr",this._enterVR),this.scene.addEventListener("exit-vr",this._exitVR)},pause:function(){this.characterEl&&(this.characterEl.removeEventListener("componentinitialized",this._initPostProcessing),this.scene.removeEventListener("enter-vr",this._enterVR),this.scene.removeEventListener("exit-vr",this._exitVR))},play:function(){this.scene.addEventListener("enter-vr",this._enterVR),this.scene.addEventListener("exit-vr",this._exitVR)},tick:function(e,t){if(this.dt=t,!r&&this.isPostProcessingReady&&this.isVR){var i=this.data,n=i.maxSpeed,a=i.minRadius,o=i.softest,c=this.characterComponent.velocity.length(),d=this.vignettePass.uniforms.radius.value||10;if(!this.enabled&&c>.01?(this.enabled=!0,this._bindRenderFunc()):this.enabled&&c<.01&&Math.abs(10-d)<.001&&(this.enabled=!1,this._exitTunnel()),this.enabled){var u=c>n?n:c,h=u/n;this.targetRadius=s(10,a,l(h)),this.targetSoftness=s(0,o,l(h)),this._updateVignettePass(this.targetRadius,this.targetSoftness,this.data.opacity)}}},_exitTunnel:function(){this.scene.renderer.render=this.originalRenderFunc,this.isMoving=!1},_initPostProcessing:function(e){e.detail.name===this.data.targetComponent&&(this.characterEl.removeEventListener("componentinitialized",this._initPostProcessing),this.characterComponent=this.characterEl.components[this.data.targetComponent],this._initComposer())},_enterVR:function(){this.isVR=!0},_exitVR:function(){this._exitTunnel(),this.isVR=!1},_initComposer:function(){this.renderer=this.scene.renderer,this.camera=this.scene.camera,this.originalRenderFunc=this.scene.renderer.render,this.isDigest=!1;var e=this.scene.renderer.render,t=this;this.postProcessingRenderFunc=function(){t.isDigest?e.apply(this,arguments):(t.isDigest=!0,t.composer.render(t.dt),t.isDigest=!1)},this.composer=new THREE.EffectComposer(this.renderer),this.composer.resize(),this.scenePass=new THREE.RenderPass(this.scene.object3D,this.camera),this.vignettePass=new THREE.ShaderPass(THREE.VignetteShader),this._updateVignettePass(this.data.radius,this.data.softness,this.data.opacity),this.composer.addPass(this.scenePass),this.composer.addPass(this.vignettePass),this.isPostProcessingReady=!0},_updateVignettePass:function(e,t,i){var n=this.renderer.getSize(),a=n.width,o=n.height,r=this.renderer.getPixelRatio();this.vignettePass.uniforms.radius.value=e,this.vignettePass.uniforms.softness.value=t,this.vignettePass.uniforms.opacity.value=i,this.vignettePass.resolution=new THREE.Uniform(new THREE.Vector2(a*r,o*r)),this.vignettePass.renderToScreen||(this.vignettePass.renderToScreen=!0)},_bindRenderFunc:function(){this.scene.renderer.render=this.postProcessingRenderFunc}})},function(e,t,i){"use strict";THREE.EffectComposer=function(e,t){if(this.renderer=e,this.delta=0,window.addEventListener("vrdisplaypresentchange",this.resize.bind(this)),void 0===t){var i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},n=e.getDrawingBufferSize();t=new THREE.WebGLRenderTarget(n.width,n.height,i),t.texture.name="EffectComposer.rt1"}this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],this.maskActive=!1,void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===THREE.ShaderPass&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},Object.assign(THREE.EffectComposer.prototype,{swapBuffers:function(e){if(e.needsSwap){if(this.maskActive){var t=this.renderer.context;t.stencilFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,this.delta),t.stencilFunc(t.EQUAL,1,4294967295)}var i=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=i}void 0!==THREE.MaskPass&&(e instanceof THREE.MaskPass?this.maskActive=!0:e instanceof THREE.ClearMaskPass&&(this.maskActive=!1))},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize();e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},render:function(e,t){var i=this.maskActive,n=void 0,a=void 0,o=this.passes.length,r=this,s=void 0;for(this.delta=e,a=t||0;a<o;a++)if(n=this.passes[a],!1!==n.enabled){if(this.renderer.vr.enabled&&n.scene)return s=n.scene.onAfterRender,n.scene.onAfterRender=function(){r.renderer.vr.enabled=!1,r.render(e,a+1,i),r.renderer.vr.enabled=!0},n.render(this.renderer,this.writeBuffer,this.readBuffer),n.scene.onAfterRender=s,void this.swapBuffers(n);n.render(this.renderer,this.writeBuffer,this.readBuffer),this.swapBuffers(n)}},reset:function(e){if(void 0===e){var t=this.renderer.getDrawingBufferSize();e=this.renderTarget1.clone(),e.setSize(t.width,t.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this.renderTarget1.setSize(e,t),this.renderTarget2.setSize(e,t);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(e,t)},resize:function(){var e=this.renderer.getDrawingBufferSize();this.setSize(e.width,e.height)}}),THREE.Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1},Object.assign(THREE.Pass.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}})},function(e,t,i){"use strict";THREE.RenderPass=function(e,t,i,n,a){THREE.Pass.call(this),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=n,this.clearAlpha=void 0!==a?a:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1},THREE.RenderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.RenderPass,render:function(e,t,i){var n=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial;var a=void 0,o=void 0;this.clearColor&&(a=e.getClearColor().getHex(),o=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.render(this.scene,this.camera,this.renderToScreen?null:i,this.clear),this.clearColor&&e.setClearColor(a,o),this.scene.overrideMaterial=null,e.autoClear=n}})},function(e,t,i){"use strict";THREE.ShaderPass=function(e,t){THREE.Pass.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof THREE.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)},THREE.ShaderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.ShaderPass,render:function(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}})},function(e,t,i){"use strict";THREE.MaskPass=function(e,t){THREE.Pass.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.MaskPass,render:function(e,t,i){var n=e.context,a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0);var o=void 0,r=void 0;this.inverse?(o=0,r=1):(o=1,r=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(n.REPLACE,n.REPLACE,n.REPLACE),a.buffers.stencil.setFunc(n.ALWAYS,o,4294967295),a.buffers.stencil.setClear(r),e.render(this.scene,this.camera,i,this.clear),e.render(this.scene,this.camera,t,this.clear),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setFunc(n.EQUAL,1,4294967295),a.buffers.stencil.setOp(n.KEEP,n.KEEP,n.KEEP)}}),THREE.ClearMaskPass=function(){THREE.Pass.call(this),this.needsSwap=!1},THREE.ClearMaskPass.prototype=Object.create(THREE.Pass.prototype),Object.assign(THREE.ClearMaskPass.prototype,{render:function(e){e.state.buffers.stencil.setTest(!1)}})},function(e,t,i){"use strict";THREE.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")}},function(e,t,i){"use strict";THREE.VignetteShader={uniforms:{tDiffuse:{value:null},radius:{value:.65},opacity:{value:.9},softness:{value:.2},resolution:new THREE.Uniform(new THREE.Vector2(1920,1080))},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float radius;","uniform float opacity;","uniform float softness;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv);","float ratio = resolution.x / resolution.y;","float centerXOffset = radius / ratio;","float leftX = (0.3 + centerXOffset >= 0.5) ? 0.5 - centerXOffset : 0.3;","float rightX = (0.7 - centerXOffset <= 0.5) ? 0.5 + centerXOffset : 0.7;","vec2 uvLeft = (vUv.xy) - vec2(leftX, 0.5);","vec2 uvRight = (vUv.xy) - vec2(rightX, 0.5);","uvLeft.x *= ratio;","uvRight.x *= ratio;","float lenLeft = length(uvLeft);","float lenRight = length(uvRight);","float vignetteLeft = smoothstep(radius, radius-softness, lenLeft);","float vignetteRight = smoothstep(radius, radius-softness, lenRight);","float vignette = vignetteLeft + vignetteRight;","vec3 final = mix (texel.rgb, texel.rgb * vignette, opacity);","gl_FragColor = vec4(final.rgb, 1.0);","}"].join("\n")}},function(e,t,i){"use strict";var n;AFRAME.registerComponent("pen",{schema:{drawFrequency:{default:5},minDistanceBetweenPoints:{default:.01},camera:{type:"selector"},drawingManager:{type:"string"},color:{type:"color",default:"#FF0033"},availableColors:{default:["#FF0033","#FFFF00","#0099FF","#00FF33","#9900FF","#FF6600","#8D5524","#C68642","#E0AC69","#F1C27D","#FFDBAC","#FFFFFF","#222222","#111111","#000000"]},radius:{default:.01},minRadius:{default:.005},maxRadius:{default:.2}},init:function(){this._stateAdded=this._stateAdded.bind(this),this._stateRemoved=this._stateRemoved.bind(this),this.timeSinceLastDraw=0,this.lastPosition=new THREE.Vector3,this.lastPosition.copy(this.el.object3D.position),this.direction=new THREE.Vector3(1,0,0),this.currentDrawing=null,this.normal=new THREE.Vector3,this.worldPosition=new THREE.Vector3,this.colorIndex=0,this.grabbed=!1},play:function(){this.drawingManager=document.querySelector(this.data.drawingManager).components["drawing-manager"],this.el.parentNode.addEventListener("stateadded",this._stateAdded),this.el.parentNode.addEventListener("stateremoved",this._stateRemoved)},pause:function(){this.el.parentNode.removeEventListener("stateadded",this._stateAdded),this.el.parentNode.removeEventListener("stateremoved",this._stateRemoved)},update:function(e){e.color!=this.data.color&&this.el.setAttribute("color",this.data.color),e.radius!=this.data.radius&&this.el.setAttribute("radius",this.data.radius)},tick:function(e,t){var i,n,a;if(this.el.object3D.getWorldPosition(this.worldPosition),i=.005,n=this.worldPosition,a=this.lastPosition,Math.abs(n.x-a.x)<i&&Math.abs(n.y-a.y)<i&&Math.abs(n.z-a.z)<i||(this.direction.subVectors(this.worldPosition,this.lastPosition).normalize(),this.lastPosition.copy(this.worldPosition)),this.currentDrawing){var o=this.timeSinceLastDraw+t;o>=this.data.drawFrequency&&this.currentDrawing.getLastPoint().distanceTo(this.worldPosition)>=this.data.minDistanceBetweenPoints&&(this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.draw(this.worldPosition,this.direction,this.normal,this.data.color,this.data.radius)),this.timeSinceLastDraw=o%this.data.drawFrequency}},_getNormal:(n=new THREE.Vector3,function(e,t,i){n.subVectors(t,this.data.camera.object3D.position).normalize(),e.crossVectors(i,n)}),_startDraw:function(){this.currentDrawing=this.drawingManager.getDrawing(this),this.currentDrawing&&(this.el.object3D.getWorldPosition(this.worldPosition),this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.startDraw(this.worldPosition,this.direction,this.normal,this.data.color,this.data.radius))},_endDraw:function(){this.currentDrawing&&(this.timeSinceLastDraw=0,this.el.object3D.getWorldPosition(this.worldPosition),this._getNormal(this.normal,this.worldPosition,this.direction),this.currentDrawing.endDraw(this.worldPosition,this.direction,this.normal),this.drawingManager.returnDrawing(this),this.currentDrawing=null)},_changeColor:function(e){this.colorIndex=(this.colorIndex+e+this.data.availableColors.length)%this.data.availableColors.length,this.data.color=this.data.availableColors[this.colorIndex],this.el.setAttribute("color",this.data.color)},_changeRadius:function(e){this.data.radius=Math.max(this.data.minRadius,Math.min(this.data.radius+e,this.data.maxRadius)),this.el.setAttribute("radius",this.data.radius)},_stateAdded:function(e){switch(e.detail){case"activated":this._startDraw();break;case"colorNext":this._changeColor(1);break;case"colorPrev":this._changeColor(-1);break;case"radiusUp":this._changeRadius(this.data.minRadius);break;case"radiusDown":this._changeRadius(-this.data.minRadius);break;case"grabbed":this.grabbed=!0}},_stateRemoved:function(e){switch(e.detail){case"activated":this._endDraw();break;case"grabbed":this.grabbed=!1,this._endDraw()}}})},function(e,t,i){"use strict";var n,a=i(423),o=(n=a,n&&n.__esModule?n:{default:n});var r,s,l,c,d,u,h,f,p,m;function v(e,t,i,n){for(var a=i-1,o=-1;a+1<=n;)t[++o]=e[++a]}AFRAME.registerComponent("networked-drawing",{schema:{segments:{default:8},defaultRadius:{default:.01},minDrawTimeout:{default:5e3},maxDrawTimeout:{default:6e5},maxLines:{default:50},maxPointsPerLine:{default:250}},init:function(){var e=this;this._receiveData=this._receiveData.bind(this),this.networkBuffer=[],this.sendNetworkBufferQueue=[],this.drawStarted=!1,this.lineStarted=!1,this.remoteLineStarted=!1,this.receivedBufferParts=0,this.bufferIndex=0,this.connectedToOwner=!1,this.networkBufferInitialized=!1;var t={vertexColors:THREE.VertexColors};this.color=new THREE.Color,this.radius=this.data.defaultRadius,this.segments=this.data.segments;var i=new THREE.MeshStandardMaterial(t);this.sharedBufferGeometryManager=new o.default,this.sharedBufferGeometryManager.addSharedBuffer(0,i,THREE.TriangleStripDrawMode),this.lastPoint=new THREE.Vector3,this.lastSegments=[],this.currentSegments=[];for(var n=0;n<this.segments;n++)this.lastSegments[n]={position:new THREE.Vector3,normal:new THREE.Vector3},this.currentSegments[n]={position:new THREE.Vector3,normal:new THREE.Vector3};this.sharedBuffer=this.sharedBufferGeometryManager.getSharedBuffer(0),this.drawing=this.sharedBuffer.drawing;var a=document.querySelector("a-scene");this.scene=a.object3D,this.scene.add(this.drawing),this.prevIdx=Object.assign({},this.sharedBuffer.idx),this.idx=Object.assign({},this.sharedBuffer.idx),this.vertexCount=0,this.networkBufferCount=0,this.currentPointCount=0,this.networkBufferHistory=[],NAF.connection.onConnect(function(){NAF.utils.getNetworkedEntity(e.el).then(function(t){e.networkedEl=t,e.networkId=NAF.utils.getNetworkId(e.networkedEl),e.drawingId="drawing-"+e.networkId,NAF.connection.subscribeToDataChannel(e.drawingId,e._receiveData)})})},remove:function(){NAF.connection.unsubscribeToDataChannel(this.drawingId,this._receiveData),this.scene.remove(this.drawing)},tick:function(){var e=NAF.connection.isConnected()&&this.networkedEl,t=e&&NAF.utils.isMine(this.networkedEl);if(!this.connectedToOwner&&e){var i=NAF.utils.getNetworkOwner(this.networkedEl);!t&&NAF.connection.hasActiveDataChannel(i)&&(NAF.connection.sendDataGuaranteed(i,this.drawingId,{type:0,clientId:NAF.clientId}),this.connectedToOwner=!0)}if(this.networkBuffer.length>0&&e&&(t?this.bufferIndex<this.networkBuffer.length&&this._broadcastDrawing():this._drawFromNetwork()),t&&this.sendNetworkBufferQueue.length>0){for(var n=[],a=0;a<this.sendNetworkBufferQueue.length;a++)NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[a])&&n.push(this.sendNetworkBufferQueue[a]);for(var o=0;o<n.length;o++){var r=this.sendNetworkBufferQueue.indexOf(n[o]);this._sendNetworkBuffer(n[o]),this.sendNetworkBufferQueue.splice(r,1)}}this._deleteLines()},_broadcastDrawing:(m=[],function(){m.length=0,v(this.networkBuffer,m,this.bufferIndex,this.networkBuffer.length-1),this.bufferIndex=this.networkBuffer.length,NAF.connection.broadcastDataGuaranteed(this.drawingId,{type:1,buffer:m})}),_drawFromNetwork:(h=new THREE.Vector3,f=new THREE.Vector3,p=new THREE.Vector3,function(){for(var e=this.networkBuffer[0],t=!1;null!=e&&this.networkBuffer.length>=10;)h.set(this.networkBuffer[0],this.networkBuffer[1],this.networkBuffer[2]),f.set(this.networkBuffer[3],this.networkBuffer[4],this.networkBuffer[5]),this.radius=Math.round(1e3*f.length())/1e3,f.normalize(),p.set(this.networkBuffer[6],this.networkBuffer[7],this.networkBuffer[8]),this.color.setHex(Math.round(p.length())-1),p.normalize(),this.networkBuffer.splice(0,9),this.remoteLineStarted||(this.startDraw(h,f,p),this.remoteLineStarted=!0),null===this.networkBuffer[0]?(this._endDraw(h,f,p),this.remoteLineStarted=!1,this.networkBuffer.shift()):(this._draw(h,f,p),t=!0);t&&this._updateBuffer()}),_deleteLines:function(){var e=this.networkBufferHistory.length;if(e>0){var t=Date.now(),i=this.networkBufferHistory[0].time;if(e>this.data.maxLines&&i+this.data.minDrawTimeout<=t||i+this.data.maxDrawTimeout<=t){var n=this.networkBufferHistory[0];e>1&&(n.idxLength+=2-this.segments%2,this.networkBufferHistory[1].idxLength-=2-this.segments%2),this.idx.position=n.idxLength,this.idx.uv=n.idxLength,this.idx.normal=n.idxLength,this.idx.color=n.idxLength,this.sharedBuffer.remove(this.prevIdx,this.idx),this.networkBufferHistory.shift(),this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(this.networkBuffer.splice(0,n.networkBufferCount),this.bufferIndex-=n.networkBufferCount)}}},_sendNetworkBuffer:function(){var e=[];return function(t){if(NAF.utils.isMine(this.networkedEl))if(this.networkBuffer.length<=3e3)NAF.connection.sendDataGuaranteed(t,this.drawingId,{type:2,parts:1,buffer:this.networkBuffer});else for(var i=0,n=0;n<this.networkBuffer.length;)n=Math.min(n+3e3,this.networkBuffer.length),e.length=0,v(this.networkBuffer,e,i,n-1),i=n,NAF.connection.sendDataGuaranteed(t,this.drawingId,{type:2,parts:Math.ceil(this.networkBuffer.length/3e3),buffer:e})}}(),_receiveData:function(e,t,i){switch(i.type){case 0:this.sendNetworkBufferQueue.push(i.clientId);break;case 1:this.networkBufferInitialized&&this.networkBuffer.push.apply(this.networkBuffer,i.buffer);break;case 2:this.networkBuffer.push.apply(this.networkBuffer,i.buffer),++this.receivedBufferParts>=i.parts&&(this.networkBufferInitialized=!0)}},getLastPoint:function(){return this.lastPoint},startDraw:function(e,t,i,n,a){NAF.connection.isConnected()&&(this.drawStarted=!0,n&&this.color.set(n),a&&(this.radius=a),this.lastPoint.copy(e),this._addToNetworkBuffer(e,t,i))},draw:function(e,t,i,n,a){NAF.connection.isConnected()&&this.drawStarted&&(n&&n!="#"+this.color.getHexString().toUpperCase()&&this.color.set(n),a&&(this.radius=a),this._addToNetworkBuffer(e,t,i),this._draw(e,t,i),this._updateBuffer())},_draw:(u=new THREE.Vector3,function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(this.lineStarted)this._generateSegments(this.currentSegments,e,t,i,this.radius*n),this._drawCylinder(),this.currentPointCount>this.data.maxPointsPerLine&&(this._drawEndCap(e,t),this._endLine());else{this._generateSegments(this.lastSegments,e,t,i,this.radius*n),0===this.networkBufferHistory.length?this._addDegenerateTriangle():(this._restartPrimitive(),this._addDegenerateTriangle(),this.segments%2==0&&this._addDegenerateTriangle()),u.copy(t).negate();for(var a=0;a<this.segments;a++)this.lastSegments[a].normal.add(u).multiplyScalar(.5);this._drawCap(this.lastPoint,this.lastSegments,u),this.segments%2!=0&&this._addDegenerateTriangle(),this.lineStarted=!0}this.lastPoint.copy(e)}),endDraw:function(e,t,i){this._endDraw(e,t,i),this._updateBuffer()},_endDraw:function(e,t,i){!this.lineStarted&&this.drawStarted?this._drawPoint(e):this.lineStarted&&this.drawStarted&&(this._addToNetworkBuffer(e,t,i),this._draw(e,t,i),this._drawEndCap(e,t)),this._endLine()},_drawEndCap:(c=new THREE.Vector3,d=new THREE.Vector3,function(e,t){this.lineStarted&&this.drawStarted&&(c.copy(t).multiplyScalar(this.radius),d.copy(e).add(c),this._addDegenerateTriangle(),this._drawCap(d,this.lastSegments,t))}),_endLine:function(){if(this.drawStarted){this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&this._pushToNetworkBuffer(null);var e={networkBufferCount:this.networkBufferCount,idxLength:this.vertexCount-1,time:Date.now()};this.networkBufferHistory.push(e),this.vertexCount=0,this.networkBufferCount=0,this.currentPointCount=0,this.lineStarted=!1,this.drawStarted=!1}},_addToNetworkBuffer:(s=new THREE.Vector3,l=new THREE.Vector3,function(e,t,i){this.networkedEl&&NAF.utils.isMine(this.networkedEl)&&(++this.currentPointCount,this._pushToNetworkBuffer(e.x),this._pushToNetworkBuffer(e.y),this._pushToNetworkBuffer(e.z),s.copy(t),s.setLength(this.radius),this._pushToNetworkBuffer(s.x),this._pushToNetworkBuffer(s.y),this._pushToNetworkBuffer(s.z),l.copy(i),l.setLength(this.color.getHex()+1),this._pushToNetworkBuffer(l.x),this._pushToNetworkBuffer(l.y),this._pushToNetworkBuffer(l.z))}),_pushToNetworkBuffer:function(e){++this.networkBufferCount,this.networkBuffer.push(e)},_drawCylinder:function(){for(var e=0;e<this.segments;e++)this.currentSegments[e].normal.add(this.lastSegments[e].normal).multiplyScalar(.5);for(var t=0;t!=this.segments+1;t++)this._addVertex(this.lastSegments[t%this.segments]),this._addVertex(this.currentSegments[t%this.segments]);for(var i=0;i<this.segments;i++)this.lastSegments[i].position.copy(this.currentSegments[i].position),this.lastSegments[i].normal.copy(this.currentSegments[i].normal)},_drawPoint:function(){var e=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,-1,0),i=new THREE.Vector3(1,0,0),n=new THREE.Vector3,a=new THREE.Vector3;return function(o){n.copy(e).multiplyScalar(.75*this.radius),a.copy(o).add(n),this.lastPoint.copy(a),n.copy(e).multiplyScalar(.5*this.radius),a.copy(o).add(n),this._draw(a,t,i,.75),this._draw(o,t,i),n.copy(t).multiplyScalar(.5*this.radius),a.copy(o).add(n),this._draw(a,t,i,.75),n.copy(t).multiplyScalar(.75*this.radius),a.copy(o).add(n),this._addDegenerateTriangle(),this._drawCap(a,this.lastSegments,t)}}(),_drawCap:function(e,t,i){for(var n=0,a=0;a<2*this.segments-this.segments%2;a++)(a-2)%4==0?this._addVertex({position:e,normal:i}):(this._addVertex(t[n%this.segments]),(a+1)%5!=0&&++n)},_restartPrimitive:function(){this.sharedBuffer.restartPrimitive(),++this.vertexCount},_updateBuffer:function(){this.sharedBuffer.update()},_addVertex:function(e){var t=e.position,i=e.normal;this.sharedBuffer.addVertex(t.x,t.y,t.z),this.sharedBuffer.addColor(this.color.r,this.color.g,this.color.b),i?this.sharedBuffer.addNormal(i.x,i.y,i.z):++this.sharedBuffer.idx.normal,++this.sharedBuffer.idx.uv,++this.vertexCount},_addDegenerateTriangle:function(){this._addVertex(this.lastSegments[0])},_generateSegments:function(e,t,i,n,a){for(var o=2*Math.PI/this.segments,r=0;r<this.segments;r++){var s=e[r].position;this._rotatePointAroundAxis(s,t,i,n,o*r,a),e[r].normal.subVectors(s,t).normalize()}},_rotatePointAroundAxis:(r=new THREE.Vector3,function(e,t,i,n,a,o){r.copy(n),r.applyAxisAngle(i,a),e.copy(t).add(r.normalize().multiplyScalar(o))})})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(424),r=(n=o,n&&n.__esModule?n:{default:n});var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sharedBuffers={}}return a(e,[{key:"addSharedBuffer",value:function(e,t,i){this.sharedBuffers[e]=new r.default(t,i)}},{key:"getSharedBuffer",value:function(e){return this.sharedBuffers[e]}}]),e}();t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.material=t,this.primitiveMode=i,this.maxBufferSize=1e6,this.geometries=[],this.current=null,this.drawing=new THREE.Object3D,this.addBuffer(!1)}return n(e,[{key:"restartPrimitive",value:function(){if(this.idx.position>=this.current.attributes.position.count)this.addBuffer(!1);else if(0!==this.idx.position){var e=3*(this.idx.position-1),t=this.current.attributes.position.array;this.addVertex(t[e++],t[e++],t[e++]),this.idx.color++,this.idx.normal++}}},{key:"remove",value:function(e,t){if(this.idx.position>t.position)for(var i in this.idx){for(var n=3*e[i],a=3*(t[i]+1),o=3*this.idx[i],r=a;r<o;r++)this.current.attributes[i].array[n++]=this.current.attributes[i].array[r];var s=t[i]-e[i]+1;this.idx[i]-=s}else for(var l in this.idx){var c=t[l]-e[l];this.idx[l]-=c}this.update()}},{key:"undo",value:function(e){this.idx=e,this.update()}},{key:"addBuffer",value:function(e){var t=new THREE.BufferGeometry,i=new Float32Array(3*this.maxBufferSize),n=new Float32Array(3*this.maxBufferSize),a=new Float32Array(3*this.maxBufferSize),o=new THREE.Mesh(t,this.material);o.drawMode=this.primitiveMode,o.frustumCulled=!1,o.vertices=i;var r=new THREE.Object3D;if(this.drawing.add(r),r.add(o),t.setDrawRange(0,0),t.addAttribute("position",new THREE.BufferAttribute(i,3).setDynamic(!0)),t.addAttribute("normal",new THREE.BufferAttribute(n,3).setDynamic(!0)),t.addAttribute("color",new THREE.BufferAttribute(a,3).setDynamic(!0)),this.previous=null,this.geometries.length>0&&(this.previous=this.current),this.idx={position:0,normal:0,color:0},this.geometries.push(t),this.current=t,this.previous&&e){var s=3*(this.maxBufferSize-2),l=3*(this.maxBufferSize-2),c=3*(this.maxBufferSize-2),d=this.previous.attributes.position.array;this.addVertex(d[s++],d[s++],d[s++]),this.addVertex(d[s++],d[s++],d[s++]);var u=this.previous.attributes.normal.array;this.addNormal(u[c++],u[c++],u[c++]),this.addNormal(u[c++],u[c++],u[c++]);var h=this.previous.attributes.color.array;this.addColor(h[l++],h[l++],h[l++]),this.addColor(h[l++],h[l++],h[l++])}}},{key:"addColor",value:function(e,t,i){this.current.attributes.color.setXYZ(this.idx.color++,e,t,i)}},{key:"addNormal",value:function(e,t,i){this.current.attributes.normal.setXYZ(this.idx.normal++,e,t,i)}},{key:"addVertex",value:function(e,t,i){var n=this.current.attributes.position;this.idx.position===n.count&&(this.addBuffer(!0),n=this.current.attributes.position),n.setXYZ(this.idx.position++,e,t,i)}},{key:"update",value:function(){this.current.setDrawRange(0,this.idx.position),this.current.attributes.color.needsUpdate=!0,this.current.attributes.normal.needsUpdate=!0,this.current.attributes.position.needsUpdate=!0}}]),e}();t.default=a},function(e,t,i){"use strict";AFRAME.registerComponent("drawing-manager",{init:function(){this._onComponentInitialized=this._onComponentInitialized.bind(this),this.drawingToPen=new Map,this.drawingEl=document.createElement("a-entity"),this.drawingEl.setAttribute("networked","template: #interactable-drawing"),this.el.sceneEl.appendChild(this.drawingEl),this.drawingEl.addEventListener("componentinitialized",this._onComponentInitialized)},remove:function(){this.drawingEl.removeEventListener("componentinitialized",this._onComponentInitialized)},_onComponentInitialized:function(e){"networked-drawing"==e.detail.name&&(this.drawing=this.drawingEl.components["networked-drawing"])},getDrawing:function(e){return!this.drawing||this.drawingToPen.has(this.drawing)&&this.drawingToPen.get(this.drawing)!==e?null:(this.drawingToPen.set(this.drawing,e),this.drawing)},returnDrawing:function(e){this.drawingToPen.has(this.drawing)&&this.drawingToPen.get(this.drawing)===e&&this.drawingToPen.delete(this.drawing)}})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=function(e){var t=null;return function(i){return null===t?(t=new THREE.Vector3(i.x,i.y,i.z),!0):!NAF.utils.almostEqualVec3(t,i,e)&&(t.copy(i),!0)}};NAF.schemas.add({template:"#remote-avatar-template",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"scale","player-info","networked-avatar",{selector:".camera",component:"position",requiresNetworkUpdate:e(.001)},{selector:".camera",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".left-controller",component:"position",requiresNetworkUpdate:e(.001)},{selector:".left-controller",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".left-controller",component:"visible"},{selector:".right-controller",component:"position",requiresNetworkUpdate:e(.001)},{selector:".right-controller",component:"rotation",requiresNetworkUpdate:e(.5)},{selector:".right-controller",component:"visible"}]}),NAF.schemas.add({template:"#video-template",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"visible"]}),NAF.schemas.add({template:"#interactable-media",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"scale","media-loader",{component:"media-video",property:"time"},{component:"media-video",property:"videoPaused"}]}),NAF.schemas.add({template:"#interactable-drawing",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"scale","networked-drawing"]}),NAF.schemas.add({template:"#pen-interactable",components:[{component:"position",requiresNetworkUpdate:e(.001)},{component:"rotation",requiresNetworkUpdate:e(.5)},"scale","media-loader",{selector:"#pen",component:"pen",property:"radius"},{selector:"#pen",component:"pen",property:"color"}]})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.inGameActions={default:{move:{label:"Move"},snap_rotate_left:{label:"Snap Rotate Left"},snap_rotate_right:{label:"Snap Rotate Right"},action_mute:{label:"Mute"},action_teleport_down:{label:"Teleport Aim"},action_teleport_up:{label:"Teleport"},action_share_screen:{label:"Share Screen"}},hud:{action_ui_select_down:{label:"Select UI item"},action_ui_select_up:{label:"Select UI item"}}},t.config={behaviours:{default:{"oculus-touch-controls":{joystick:"joystick_dpad4"},"vive-controls":{trackpad:"trackpad_dpad4",trackpad_scrolling:"trackpad_scrolling"},"windows-motion-controls":{joystick:"joystick_dpad4",axisMoveWithDeadzone:"msft_mr_axis_with_deadzone"},"daydream-controls":{trackpad:"trackpad_dpad4",axisMoveWithDeadzone:"msft_mr_axis_with_deadzone"},"gearvr-controls":{trackpad:"trackpad_dpad4",trackpad_scrolling:"trackpad_scrolling"},"oculus-go-controls":{trackpad:"trackpad_dpad4",trackpad_scrolling:"trackpad_scrolling"}}},mappings:{default:{"vive-controls":{"trackpad.pressedmove":{left:"move"},trackpad_dpad4_pressed_west_down:{right:"snap_rotate_left"},trackpad_dpad4_pressed_east_down:{right:"snap_rotate_right"},trackpad_dpad4_pressed_center_down:{right:"action_primary_down"},trackpad_dpad4_pressed_north_down:{right:"action_primary_down"},trackpad_dpad4_pressed_south_down:{right:"action_primary_down"},trackpadup:{left:"action_primary_up",right:"action_primary_up"},menudown:"thumb_down",menuup:"thumb_up",gripdown:["primary_action_grab","middle_ring_pinky_down"],gripup:["primary_action_release","middle_ring_pinky_up"],trackpadtouchstart:"thumb_down",trackpadtouchend:"thumb_up",triggerdown:["secondary_action_grab","index_down"],triggerup:["secondary_action_release","index_up"],scroll:{left:"scroll_move",right:"scroll_move"}},"oculus-touch-controls":{joystick_dpad4_west:{right:"snap_rotate_left"},joystick_dpad4_east:{right:"snap_rotate_right"},gripdown:["primary_action_grab","middle_ring_pinky_down"],gripup:["primary_action_release","middle_ring_pinky_up"],abuttontouchstart:["thumb_down","increase_radius"],abuttontouchend:"thumb_up",bbuttontouchstart:["thumb_down","decrease_radius"],bbuttontouchend:"thumb_up",xbuttontouchstart:["thumb_down","increase_radius"],xbuttontouchend:"thumb_up",ybuttontouchstart:["thumb_down","decrease_radius"],ybuttontouchend:"thumb_up",surfacetouchstart:["thumb_down","next_color"],surfacetouchend:"thumb_up",thumbsticktouchstart:"thumb_down",thumbsticktouchend:"thumb_up",triggerdown:["secondary_action_grab","index_down"],triggerup:["secondary_action_release","index_up"],"axismove.reverseY":{left:"move",right:"scroll_move"},abuttondown:"action_primary_down",abuttonup:"action_primary_up"},"windows-motion-controls":{joystick_dpad4_west:{right:"snap_rotate_left"},joystick_dpad4_east:{right:"snap_rotate_right"},"trackpad.pressedmove":{left:"move"},joystick_dpad4_pressed_west_down:{right:"snap_rotate_left"},joystick_dpad4_pressed_east_down:{right:"snap_rotate_right"},trackpaddown:{right:"action_primary_down"},trackpadup:{left:"action_primary_up",right:"action_primary_up"},menudown:"thumb_down",menuup:"thumb_up",gripdown:["primary_action_grab","middle_ring_pinky_down"],gripup:["primary_action_release","middle_ring_pinky_up"],trackpadtouchstart:"thumb_down",trackpadtouchend:"thumb_up",triggerdown:["secondary_action_grab","index_down"],triggerup:["secondary_action_release","index_up"],axisMoveWithDeadzone:{left:"move",right:"scroll_move"}},"daydream-controls":{trackpad_dpad4_pressed_west_down:"snap_rotate_left",trackpad_dpad4_pressed_east_down:"snap_rotate_right",trackpad_dpad4_pressed_center_down:["action_primary_down"],trackpad_dpad4_pressed_north_down:["action_primary_down"],trackpad_dpad4_pressed_south_down:["action_primary_down"],trackpadup:["action_primary_up"],axisMoveWithDeadzone:"scroll_move"},"gearvr-controls":{trackpad_dpad4_pressed_west_down:"snap_rotate_left",trackpad_dpad4_pressed_east_down:"snap_rotate_right",trackpad_dpad4_pressed_center_down:["action_primary_down"],trackpad_dpad4_pressed_north_down:["action_primary_down"],trackpad_dpad4_pressed_south_down:["action_primary_down"],trackpadup:["action_primary_up"],triggerdown:["action_secondary_down"],triggerup:["action_secondary_up"],scroll:"scroll_move"},"oculus-go-controls":{trackpad_dpad4_pressed_west_down:"snap_rotate_left",trackpad_dpad4_pressed_east_down:"snap_rotate_right",trackpad_dpad4_pressed_center_down:["action_primary_down"],trackpad_dpad4_pressed_north_down:["action_primary_down"],trackpad_dpad4_pressed_south_down:["action_primary_down"],trackpadup:["action_primary_up"],triggerdown:["action_secondary_down"],triggerup:["action_secondary_up"],scroll:"scroll_move"},keyboard:{m_press:"action_mute",q_press:"snap_rotate_left",e_press:"snap_rotate_right",b_press:"action_share_screen",w_down:"w_down",w_up:"w_up",a_down:"a_down",a_up:"a_up",s_down:"s_down",s_up:"s_up",d_down:"d_down",d_up:"d_up",arrowup_down:"w_down",arrowup_up:"w_up",arrowleft_down:"a_down",arrowleft_up:"a_up",arrowdown_down:"s_down",arrowdown_up:"s_up",arrowright_down:"d_down",arrowright_up:"d_up"}}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(43);var a="___concurrent_load_detector",o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.start=function(){i.startedAt=new Date,localStorage.setItem(i.localStorageKey(),JSON.stringify({started_at:i.startedAt})),i.interval=setInterval(i._step,1e3)},i.stop=function(){i.interval&&clearInterval(i.interval)},i.localStorageKey=function(){return a+"_"+i.instanceKey},i._step=function(){var e=JSON.parse(localStorage.getItem(i.localStorageKey())),t=new Date(e.started_at);t.getTime()!==i.startedAt.getTime()&&(i.dispatchEvent(new CustomEvent("concurrentload")),i.stop())},i.interval=null,i.startedAt=null,i.instanceKey=e||"global",i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(n.EventTarget);t.default=o},,,,,,,,,,,function(e,t){e.exports={domain:"link-dialog__domain__1WbPJ",code:"link-dialog__code__259RI","keep-open":"link-dialog__keep-open__DYcUI",keepOpen:"link-dialog__keep-open__DYcUI",digit:"link-dialog__digit___zoC4","code-loading-panel":"link-dialog__code-loading-panel__WKkNk",codeLoadingPanel:"link-dialog__code-loading-panel__WKkNk"}},,function(e,t){e.exports={"action-button":"create-object-dialog__action-button__3OIJQ",actionButton:"create-object-dialog__action-button__3OIJQ","input-border":"create-object-dialog__input-border__1N9AV",inputBorder:"create-object-dialog__input-border__1N9AV","add-media-form":"create-object-dialog__add-media-form__10Wh-",addMediaForm:"create-object-dialog__add-media-form__10Wh-",buttons:"create-object-dialog__buttons__1zA-b","small-button":"create-object-dialog__small-button__7UxXQ",smallButton:"create-object-dialog__small-button__7UxXQ","cancel-icon":"create-object-dialog__cancel-icon__yD-8A",cancelIcon:"create-object-dialog__cancel-icon__yD-8A","upload-icon":"create-object-dialog__upload-icon__19g9k",uploadIcon:"create-object-dialog__upload-icon__19g9k","left-side-of-input":"create-object-dialog__left-side-of-input__zyV06",leftSideOfInput:"create-object-dialog__left-side-of-input__zyV06","hide-file-input":"create-object-dialog__hide-file-input__2myDe",hideFileInput:"create-object-dialog__hide-file-input__2myDe"}},,,,function(e,t){e.exports={"nag-button":"hub__nag-button__3iQyC",nagButton:"hub__nag-button__3iQyC","entry-panel":"hub__entry-panel__cCmIv",entryPanel:"hub__entry-panel__cCmIv","button-container":"hub__button-container__38FOc",buttonContainer:"hub__button-container__38FOc","invite-button":"hub__invite-button__2DMgC",inviteButton:"hub__invite-button__2DMgC","entry-button":"hub__entry-button__1e9jM",entryButton:"hub__entry-button__1e9jM",label:"hub__label__1kjp1",icon:"hub__icon__1pzf7","screen-sharing":"hub__screen-sharing__2VF91",screenSharing:"hub__screen-sharing__2VF91",checkbox:"hub__checkbox__32dyv","presence-info":"hub__presence-info__dqWyo",presenceInfo:"hub__presence-info__dqWyo","occupant-count":"hub__occupant-count__3eAEj",occupantCount:"hub__occupant-count__3eAEj","entry-dialog":"hub__entry-dialog__2Ljux",entryDialog:"hub__entry-dialog__2Ljux",bolded:"hub__bolded__2MYLZ",subtitle:"hub__subtitle__3kYcd",people:"hub__people__1veY3","webvr-link-container":"hub__webvr-link-container__1Vq5m",webvrLinkContainer:"hub__webvr-link-container__1Vq5m","webvr-link":"hub__webvr-link__xW04U",webvrLink:"hub__webvr-link__xW04U",secondary:"hub__secondary__22yt_"}},,function(e,t){e.exports={touchZone:"virtual-gamepad-controls__touchZone__1KF_C",left:"virtual-gamepad-controls__left__1-URB",right:"virtual-gamepad-controls__right__1cgnU",mockJoystickContainer:"virtual-gamepad-controls__mockJoystickContainer__1aH3e",mockJoystick:"virtual-gamepad-controls__mockJoystick__2CuCG",inner:"virtual-gamepad-controls__inner__1Bn3C"}},,function(e,t){e.exports={video:"networked-video-player__video__2PrBt",container:"networked-video-player__container__2SqNi"}},,function(e,t){},,function(e,t){e.exports={"nag-button":"ui-root__nag-button__2t6K2",nagButton:"ui-root__nag-button__2t6K2","presence-info":"ui-root__presence-info__3cieq",presenceInfo:"ui-root__presence-info__3cieq","occupant-count":"ui-root__occupant-count__34rGX",occupantCount:"ui-root__occupant-count__34rGX"}},,function(e,t){e.exports={"entry-panel":"entry__entry-panel__34CD9",entryPanel:"entry__entry-panel__34CD9","button-container":"entry__button-container__3Blog",buttonContainer:"entry__button-container__3Blog","invite-button":"entry__invite-button__3J4Qk",inviteButton:"entry__invite-button__3J4Qk","entry-button":"entry__entry-button__G7PQF",entryButton:"entry__entry-button__G7PQF",label:"entry__label__fUhpb",icon:"entry__icon__3JiUl","screen-sharing":"entry__screen-sharing__NBXQu",screenSharing:"entry__screen-sharing__NBXQu",checkbox:"entry__checkbox__3SoPk","entry-dialog":"entry__entry-dialog__30kMs",entryDialog:"entry__entry-dialog__30kMs",bolded:"entry__bolded__13B4f",subtitle:"entry__subtitle__1BC2y","presence-info":"entry__presence-info__zbA7o",presenceInfo:"entry__presence-info__zbA7o",people:"entry__people__1tY6W","webvr-link-container":"entry__webvr-link-container__3scWP",webvrLinkContainer:"entry__webvr-link-container__3scWP","webvr-link":"entry__webvr-link__3eWuZ",webvrLink:"entry__webvr-link__3eWuZ",secondary:"entry__secondary__3uhYE"}},,function(e,t){e.exports={unselectable:"_2d-hud__unselectable__2QGn5",container:"_2d-hud__container__66GRt",top:"_2d-hud__top__3PiNe",column:"_2d-hud__column__1y7XY",bottom:"_2d-hud__bottom__2jUcT",hide:"_2d-hud__hide__3HJO8",panel:"_2d-hud__panel__2oM_T",left:"_2d-hud__left__20b8y",right:"_2d-hud__right__1vrba",up:"_2d-hud__up__1lyhr",iconButton:"_2d-hud__iconButton__3faJz",small:"_2d-hud__small__2rqgF",large:"_2d-hud__large__2bHqH",mute:"_2d-hud__mute__25kHI",active:"_2d-hud__active__1TMB8",bubble:"_2d-hud__bubble__2oTt2",spawn_pen:"_2d-hud__spawn_pen__1F_c6",spawnPen:"_2d-hud__spawn_pen__1F_c6",freeze:"_2d-hud__freeze__26rlJ","create-object":"_2d-hud__create-object__27TcL",createObject:"_2d-hud__create-object__27TcL","mobile-media-picker":"_2d-hud__mobile-media-picker__3ZXHc",mobileMediaPicker:"_2d-hud__mobile-media-picker__3ZXHc"}}]);
//# sourceMappingURL=hub-20436bc60ebd94527897.js.map