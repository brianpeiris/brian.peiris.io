{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/telemetry.js","webpack:///./src/utils/i18n.js","webpack:///./src/storage/store.js","webpack:///./src/assets/avatars/avatars.js","webpack:///./src/utils/identity.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/avatar-selector.js","webpack:///./src/react-components/avatar-selector.js","webpack:///./src/utils/webgl.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/loop-animation.js","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/components/gamma-factor.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/App.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","5","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Raven","config","install","_ravenJs","_translationsData","navigatorLang","navigator","languages","language","userLanguage","toLowerCase","split","lang","localeData","messages","en","_jsonschema","_deepmerge","_eventTargetShim","_identity","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","validator","Validator","SCHEMA","id","definitions","profile","type","additionalProperties","properties","displayName","pattern","avatarId","activity","hasFoundFreeze","hasChangedName","lastEnteredAt","settings","lastUsedMicDeviceId","$ref","Store","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","getPrototypeOf","init","update","generateDefaultProfile","state","generateRandomName","localStorage","getItem","setItem","JSON","stringify","newState","finalState","_deepmerge2","default","isValid","validate","valid","Error","dispatchEvent","CustomEvent","parse","EventTarget","avatars","model","selectRandom","names","Math","floor","random","avatarIds","_avatars","arr","map","av","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","texture","THREE","CubeTextureLoader","load","format","RGBFormat","src","contentType","preferredTechnique","onProgress","gltfUrl","fileMap","includes","Promise","resolve","reject","worker","SketchfabZipWorker","onmessage","e","_e$data","_slicedToArray","success","fileMapOrError","postMessage","getFilesFromSketchfabZip","gltfLoader","GLTFLoader","setLazy","_ref4","parser","materials","json","material","extensions","MOZ_alt_materials","undefined","altMaterialIndex","CachedEnvMapTexture","loadEnvMap","gltf","scene","scenes","cameras","animations","envMap","traverse","needsUpdate","keys","forEach","URL","revokeObjectURL","_sketchfabZipWorker","_posx","_negx","_posy","_negy","_posz","_negz","GLTFCache","inflateComponent","el","componentName","componentData","AFRAME","components","multiple","Array","isArray","setAttribute","GLTFModelPlus","registerComponent","componentKey","inflator","attachTemplate","root","templateRoot","targetEls","querySelectorAll","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","iterator","next","done","cloneNode","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","attributes","_ref","err","return","children","appendChild","schema","inflate","APP","quality","loadTemplates","applySrc","templates","templateEl","document","importNode","firstElementChild","content","getAttribute","_ref5","_asyncToGenerator","charAt","assetEl","getElementById","substring","lastSrc","inflatedEl","console","warn","removeInflatedEl","loadGLTF","skinnedMeshes","node","uuid","isSkinnedMesh","clone","cloneBones","cloneSkinnedMeshes","isBone","skinnedMesh","skeleton","cloneSkinnedMesh","orderedCloneBones","bones","cloneBone","Skeleton","boneInverses","matrixWorld","cloneGltf","object3DToSet","inflateEntities","isRoot","childEntities","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","child","nodeHasBehavior","userData","createElement","append","className","replace","classList","add","rotation","order","setFromQuaternion","quaternion","x","position","y","z","RAD2DEG","scale","matrixAutoUpdate","matrix","identity","setObject3D","object3D","parent","entityComponents","prop","_AFRAME$GLTFModelPlus","setTimeout","emit","error","_x5","_x6","arguments","parentNode","removeChild","_reactDom","_react","_reactIntl","_en","_i18n","_webgl","_telemetry","_App","_avatarSelector","getHashArg","arg","URLSearchParams","location","hash","postAvatarIdToParent","newAvatarId","origin","mountUI","ReactDOM","render","_react2","IntlProvider","locale","_avatarSelector2","onChange","patchWebGLRenderingContext","addLocaleData","concat","_toConsumableArray","_telemetry2","App","utils","device","isMobile","addEventListener","_propTypes","_reactFontawesome","_faAngleLeft","_faAngleRight","AvatarSelector","props","_initialiseProps","initialAvatarIndex","getAvatarIndex","avatarIndices","nextAvatarIndex","previousAvatarIndex","nextProps","_this2","setState","numAvatars","lastIndex","currAvatarIndex","from","increasing","direction","indexOf","addIndex","unshift","prevProps","currRot","animation","currY","toRot","toY","step","brokenlyBigRotation","abs","fromY","stop","handleMixinUpdate","start","_this3","gammaOutput","sortObjects","physicallyCorrectLights","_this4","avatarAssets","avatar","response-type","avatarData","avatarEntities","_ref2","gltf-model-plus","data-selector","animation-mixer","attribute","dur","to","repeat","rotationFromIndex","index","initialRotation","toRotation","vr-mode-ui","ref","sce","anm","easing","camera","hide-when-quality","light","onClick","emitChangeToPrevious","FontAwesomeIcon","icon","faAngleLeft","emitChangeToNext","faAngleRight","Component","propTypes","PropTypes","array","string","func","offset","findIndex","_this5","nextAvatarId","previousAvatarId","injectIntl","test","userAgent","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","renderer","WebGLRenderer","Scene","Float32Array","size","dataTexture","DataTexture","RGBAFormat","FloatType","box","Mesh","PlaneBufferGeometry","MeshBasicMaterial","Camera","context","getError","dispose","checkFloatTextureSupport","volume","prevVolume","smoothing","threshold","event","ctx","AudioContext","getContext","analyser","createAnalyser","fftSize","levels","Uint8Array","frequencyBinCount","detail","soundSource","connect","tick","getByteTimeDomainData","sum","amplitude","currVolume","sqrt","minScale","maxScale","visible","_data","audioAnalyser","min","setScalar","mixer","object3DMap","rootObject3D","mesh","setAnimationMixer","onModelLoaded","sceneObject3D","removeEventListener","AnimationMixer","dt","destroy","dependencies","clip","required","animationMixerComponent","updateClipState","oldData","play","clipName","action","clipAction","enabled","setLoop","LoopRepeat","Infinity","gammaFactor","isScene","prevData","sceneEl","needsShaderUpdate","time","isMesh","euler","orientation","Euler","Quaternion","set","setFromEuler","shape","halfExtents","_componentName","nav","systems","zone","found","loadMesh","_store","store"],"mappings":"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","file":"assets/js/avatar-selector-a698ce53d13141e66b3e.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t5: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([432,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import Raven from \"raven-js\";\n\nexport default function registerTelemetry() {\n  if (process.env.NODE_ENV === \"production\") {\n    Raven.config(\"https://013d6a364fed43cdb0539a61d520597a@sentry.prod.mozaws.net/370\").install();\n  }\n}\n","import localeData from \"../assets/translations.data.json\";\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\nexport const messages = localeData[lang] || localeData.en;\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { generateDefaultProfile, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9-]{3,32}$\" },\n        avatarId: { type: \"string\" }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n  }\n\n  // Initializes store with any default bits\n  init = () => {\n    this.update({\n      activity: {},\n      settings: {},\n      profile: { ...generateDefaultProfile(), ...(this.state.profile || {}) }\n    });\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  update(newState) {\n    const finalState = merge(this.state, newState);\n    const isValid = validator.validate(finalState, SCHEMA).valid;\n\n    if (!isValid) {\n      throw new Error(`Write of ${JSON.stringify(finalState)} to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","export const avatars = [\n  {\n    id: \"botdefault\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf\"\n  },\n  {\n    id: \"botbobo\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf\"\n  },\n  {\n    id: \"botdom\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf\"\n  },\n  {\n    id: \"botgreg\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf\"\n  },\n  {\n    id: \"botguest\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf\"\n  },\n  {\n    id: \"botjim\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf\"\n  },\n  {\n    id: \"botkev\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf\"\n  },\n  {\n    id: \"botpinky\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf\"\n  },\n  {\n    id: \"botrobert\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf\"\n  },\n  {\n    id: \"botwoody\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf\"\n  }\n];\n","import { avatars } from \"../assets/avatars/avatars.js\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction selectRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${selectRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport const avatarIds = avatars.map(av => av.id);\n\nexport function generateDefaultProfile() {\n  return {\n    avatarId: selectRandom(avatarIds)\n  };\n}\n","import SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nconst GLTFCache = {};\nlet CachedEnvMapTexture = null;\n\nfunction inflateComponent(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || inflateComponent;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\n// From https://gist.github.com/cdata/f2d7a6ccdec071839bc1954c32595e87\n// Tracking glTF cloning here: https://github.com/mrdoob/three.js/issues/11573\nfunction cloneGltf(gltf) {\n  const skinnedMeshes = {};\n  gltf.scene.traverse(node => {\n    if (!node.name) {\n      node.name = node.uuid;\n    }\n    if (node.isSkinnedMesh) {\n      skinnedMeshes[node.name] = node;\n    }\n  });\n\n  const clone = {\n    animations: gltf.animations,\n    scene: gltf.scene.clone(true)\n  };\n\n  const cloneBones = {};\n  const cloneSkinnedMeshes = {};\n\n  clone.scene.traverse(node => {\n    if (node.isBone) {\n      cloneBones[node.name] = node;\n    }\n\n    if (node.isSkinnedMesh) {\n      cloneSkinnedMeshes[node.name] = node;\n    }\n  });\n\n  for (const name in skinnedMeshes) {\n    const skinnedMesh = skinnedMeshes[name];\n    const skeleton = skinnedMesh.skeleton;\n    const cloneSkinnedMesh = cloneSkinnedMeshes[name];\n\n    const orderedCloneBones = [];\n\n    for (let i = 0; i < skeleton.bones.length; ++i) {\n      const cloneBone = cloneBones[skeleton.bones[i].name];\n      orderedCloneBones.push(cloneBone);\n    }\n\n    cloneSkinnedMesh.bind(new THREE.Skeleton(orderedCloneBones, skeleton.boneInverses), cloneSkinnedMesh.matrixWorld);\n\n    cloneSkinnedMesh.material = skinnedMesh.material.clone();\n  }\n\n  return clone;\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(node, templates, isRoot) {\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const nodeHasBehavior = node.userData.components || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.setAttribute(\"position\", {\n    x: node.position.x,\n    y: node.position.y,\n    z: node.position.z\n  });\n  el.setAttribute(\"rotation\", {\n    x: node.rotation.x * THREE.Math.RAD2DEG,\n    y: node.rotation.y * THREE.Math.RAD2DEG,\n    z: node.rotation.z * THREE.Math.RAD2DEG\n  });\n  el.setAttribute(\"scale\", {\n    x: node.scale.x,\n    y: node.scale.y,\n    z: node.scale.z\n  });\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (node.userData.components && \"nav-mesh\" in node.userData.components) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.name = node.name;\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  const entityComponents = node.userData.components;\n  if (entityComponents) {\n    for (const prop in entityComponents) {\n      if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n        const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n        inflator(el, componentName, entityComponents[prop]);\n      }\n    }\n  }\n\n  return el;\n};\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nfunction nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n\nfunction getFilesFromSketchfabZip(src) {\n  return new Promise((resolve, reject) => {\n    const worker = new SketchfabZipWorker();\n    worker.onmessage = e => {\n      const [success, fileMapOrError] = e.data;\n      (success ? resolve : reject)(fileMapOrError);\n    };\n    worker.postMessage(src);\n  });\n}\n\nasync function loadEnvMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new THREE.CubeTextureLoader().load(urls);\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n\nasync function loadGLTF(src, contentType, preferredTechnique, onProgress) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\")) {\n    fileMap = await getFilesFromSketchfabZip(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const gltfLoader = new THREE.GLTFLoader();\n  gltfLoader.setLazy(true);\n\n  const { parser } = await new Promise((resolve, reject) => gltfLoader.load(gltfUrl, resolve, onProgress, reject));\n\n  const materials = parser.json.materials;\n  if (materials) {\n    for (let i = 0; i < materials.length; i++) {\n      const material = materials[i];\n\n      if (\n        material.extensions &&\n        material.extensions.MOZ_alt_materials &&\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\n      ) {\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\n        materials[i] = materials[altMaterialIndex];\n      }\n    }\n  }\n\n  if (!CachedEnvMapTexture) {\n    CachedEnvMapTexture = loadEnvMap();\n  }\n\n  const gltf = await new Promise((resolve, reject) =>\n    parser.parse(\n      (scene, scenes, cameras, animations, json) => {\n        resolve({ scene, scenes, cameras, animations, json });\n      },\n      e => {\n        reject(e);\n      }\n    )\n  );\n\n  const envMap = await CachedEnvMapTexture;\n\n  gltf.scene.traverse(object => {\n    if (object.material && object.material.type === \"MeshStandardMaterial\") {\n      object.material.envMap = envMap;\n      object.material.needsUpdate = true;\n    }\n  });\n\n  if (fileMap) {\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\n  }\n\n  return gltf;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * whitelisted components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    inflate: { default: false }\n  },\n\n  init() {\n    this.preferredTechnique =\n      window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\n    this.loadTemplates();\n  },\n\n  update() {\n    this.applySrc(this.data.src, this.data.contentType);\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      // If the src attribute is a selector, get the url from the asset item.\n      if (src && src.charAt(0) === \"#\") {\n        const assetEl = document.getElementById(src.substring(1));\n        src = assetEl.getAttribute(\"src\");\n      }\n\n      if (src === this.lastSrc) return;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.removeInflatedEl();\n        }\n        return;\n      }\n\n      if (!GLTFCache[src]) {\n        GLTFCache[src] = loadGLTF(src, contentType, this.preferredTechnique);\n      }\n\n      const model = cloneGltf(await GLTFCache[src]);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.removeInflatedEl();\n\n      this.model = model.scene || model.scenes[0];\n      this.model.animations = model.animations;\n\n      let object3DToSet = this.model;\n      if (this.data.inflate && (this.inflatedEl = inflateEntities(this.model, this.templates, true))) {\n        this.el.appendChild(this.inflatedEl);\n        object3DToSet = this.inflatedEl.object3D;\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n      this.el.setObject3D(\"mesh\", object3DToSet);\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\n    } catch (e) {\n      delete GLTFCache[src];\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  removeInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n      delete this.inflatedEl;\n    }\n  }\n});\n","import \"aframe\";\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport { IntlProvider, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\n\nimport { lang, messages } from \"./utils/i18n\";\n\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"./assets/stylesheets/avatar-selector.scss\";\nimport \"three/examples/js/loaders/GLTFLoader\";\n\nimport \"./components/animation-mixer\";\nimport \"./components/audio-feedback\";\nimport \"./components/loop-animation\";\nimport \"./components/gamma-factor\";\nimport \"./gltf-component-mappings\";\nimport { avatars } from \"./assets/avatars/avatars\";\n\nimport registerTelemetry from \"./telemetry\";\nimport { App } from \"./App\";\nimport AvatarSelector from \"./react-components/avatar-selector\";\n\naddLocaleData([...en]);\n\nregisterTelemetry();\n\nfunction getHashArg(arg) {\n  return new URLSearchParams(location.hash.replace(/^#/, \"?\")).get(arg);\n}\n\nwindow.APP = new App();\nwindow.APP.quality = getHashArg(\"quality\") || AFRAME.utils.device.isMobile() ? \"low\" : \"high\";\n\nfunction postAvatarIdToParent(newAvatarId) {\n  window.parent.postMessage({ avatarId: newAvatarId }, location.origin);\n}\n\nfunction mountUI() {\n  const avatarId = getHashArg(\"avatar_id\");\n  ReactDOM.render(\n    <IntlProvider locale={lang} messages={messages}>\n      <AvatarSelector {...{ avatars, avatarId, onChange: postAvatarIdToParent }} />\n    </IntlProvider>,\n    document.getElementById(\"selector-root\")\n  );\n}\n\nwindow.addEventListener(\"hashchange\", mountUI);\ndocument.addEventListener(\"DOMContentLoaded\", mountUI);\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl } from \"react-intl\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faAngleLeft } from \"@fortawesome/free-solid-svg-icons/faAngleLeft\";\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\n\n// TODO: we should make a bundle for avatar picker with it's own geometry, for now just use the indoor part of the meting room\nconst meetingSpace = \"https://asset-bundles-prod.reticulum.io/rooms/meetingroom/MeetingSpace1_mesh-d48250ebc6.gltf\";\n\nclass AvatarSelector extends Component {\n  static propTypes = {\n    avatars: PropTypes.array,\n    avatarId: PropTypes.string,\n    onChange: PropTypes.func\n  };\n\n  static getAvatarIndex = (props, offset = 0) => {\n    const currAvatarIndex = props.avatars.findIndex(avatar => avatar.id === props.avatarId);\n    const numAvatars = props.avatars.length;\n    return (((currAvatarIndex + offset) % numAvatars) + numAvatars) % numAvatars;\n  };\n  static nextAvatarIndex = props => AvatarSelector.getAvatarIndex(props, -1);\n  static previousAvatarIndex = props => AvatarSelector.getAvatarIndex(props, 1);\n\n  state = {\n    initialAvatarIndex: 0,\n    avatarIndices: []\n  };\n\n  getAvatarIndex = (offset = 0) => AvatarSelector.getAvatarIndex(this.props, offset);\n  nextAvatarIndex = () => this.getAvatarIndex(-1);\n  previousAvatarIndex = () => this.getAvatarIndex(1);\n\n  emitChangeToNext = () => {\n    const nextAvatarId = this.props.avatars[this.nextAvatarIndex()].id;\n    this.props.onChange(nextAvatarId);\n  };\n\n  emitChangeToPrevious = () => {\n    const previousAvatarId = this.props.avatars[this.previousAvatarIndex()].id;\n    this.props.onChange(previousAvatarId);\n  };\n\n  constructor(props) {\n    super(props);\n    this.state.initialAvatarIndex = AvatarSelector.getAvatarIndex(props);\n    this.state.avatarIndices = [\n      AvatarSelector.nextAvatarIndex(props),\n      this.state.initialAvatarIndex,\n      AvatarSelector.previousAvatarIndex(props)\n    ];\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    // Push new avatar indices onto the array if necessary.\n    this.setState(state => {\n      const numAvatars = nextProps.avatars.length;\n      if (state.avatarIndices.length === numAvatars) return;\n\n      const lastIndex = numAvatars - 1;\n      const currAvatarIndex = this.getAvatarIndex();\n      const nextAvatarIndex = AvatarSelector.getAvatarIndex(nextProps);\n      const avatarIndices = Array.from(state.avatarIndices);\n      const increasing = currAvatarIndex - nextAvatarIndex < 0;\n\n      let direction = -1;\n      let push = false;\n\n      if (nextAvatarIndex === 0) {\n        if (currAvatarIndex === lastIndex) {\n          direction = 1;\n          push = avatarIndices.indexOf(lastIndex) !== 0;\n        } else {\n          direction = -1;\n          push = avatarIndices.indexOf(1) !== 0;\n        }\n      } else if (nextAvatarIndex === lastIndex) {\n        if (currAvatarIndex === 0) {\n          direction = -1;\n          push = avatarIndices.indexOf(0) === 0;\n        } else {\n          direction = 1;\n          push = avatarIndices.indexOf(lastIndex - 1) !== 0;\n        }\n      } else {\n        direction = increasing ? 1 : -1;\n        push = increasing;\n      }\n\n      const addIndex = AvatarSelector.getAvatarIndex(nextProps, direction);\n      if (avatarIndices.includes(addIndex)) return;\n\n      if (push) {\n        avatarIndices.push(addIndex);\n      } else {\n        avatarIndices.unshift(addIndex);\n      }\n      return { avatarIndices };\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.avatarId !== prevProps.avatarId) {\n      // HACK - a-animation ought to restart the animation when the `to` attribute changes, but it doesn't\n      // so we need to force it here.\n      const currRot = this.animation.parentNode.getAttribute(\"rotation\");\n      const currY = currRot.y;\n      const toRot = this.animation.getAttribute(\"to\").split(\" \");\n      const toY = toRot[1];\n      const step = 360.0 / this.props.avatars.length;\n      const brokenlyBigRotation = Math.abs(toY - currY) > 3 * step;\n      let fromY = currY;\n      if (brokenlyBigRotation) {\n        // Rotation in Y wrapped around 360. Adjust the \"from\" to prevent a dramatic rotation\n        fromY = currY < toY ? currY + 360 : currY - 360;\n      }\n      this.animation.setAttribute(\"from\", `${currRot.x} ${fromY} ${currRot.z}`);\n      this.animation.stop();\n      this.animation.handleMixinUpdate();\n      this.animation.start();\n    }\n  }\n\n  componentDidMount() {\n    // <a-scene> component not initialized until scene element mounted and loaded.\n    this.scene.addEventListener(\"loaded\", () => {\n      this.scene.setAttribute(\"renderer\", { gammaOutput: true, sortObjects: true, physicallyCorrectLights: true });\n      this.scene.setAttribute(\"gamma-factor\", \"\");\n    });\n  }\n\n  render() {\n    const avatarAssets = this.props.avatars.map(avatar => (\n      <a-asset-item id={avatar.id} key={avatar.id} response-type=\"arraybuffer\" src={`${avatar.model}`} />\n    ));\n    const avatarData = this.state.avatarIndices.map(i => [this.props.avatars[i], i]);\n    const avatarEntities = avatarData.map(([avatar, i]) => (\n      <a-entity key={avatar.id} rotation={`0 ${(360 * -i) / this.props.avatars.length} 0`}>\n        <a-entity position=\"0 0 5\" gltf-model-plus={`src: #${avatar.id}`} inflate=\"true\">\n          <template data-selector=\".RootScene\">\n            <a-entity animation-mixer=\"\" />\n          </template>\n\n          <a-animation\n            attribute=\"rotation\"\n            dur=\"12000\"\n            to={`0 ${this.getAvatarIndex() === i ? 360 : 0} 0`}\n            repeat=\"indefinite\"\n          />\n        </a-entity>\n      </a-entity>\n    ));\n\n    const rotationFromIndex = index => ((360 * index) / this.props.avatars.length + 180) % 360;\n    const initialRotation = rotationFromIndex(this.state.initialAvatarIndex);\n    const toRotation = rotationFromIndex(this.getAvatarIndex());\n\n    return (\n      <div className=\"avatar-selector\">\n        <a-scene vr-mode-ui=\"enabled: false\" ref={sce => (this.scene = sce)}>\n          <a-assets>\n            {avatarAssets}\n            <a-asset-item id=\"meeting-space1-mesh\" response-type=\"arraybuffer\" src={meetingSpace} />\n          </a-assets>\n\n          <a-entity rotation={`0 ${initialRotation} 0`}>\n            <a-animation\n              ref={anm => (this.animation = anm)}\n              attribute=\"rotation\"\n              dur=\"2000\"\n              easing=\"ease-out\"\n              to={`0 ${toRotation} 0`}\n            />\n            {avatarEntities}\n          </a-entity>\n\n          <a-entity position=\"0 1.5 -5.6\" rotation=\"-10 180 0\">\n            <a-entity camera=\"\" />\n          </a-entity>\n\n          <a-entity\n            hide-when-quality=\"low\"\n            light=\"type: directional; color: #F9FFCE; intensity: 0.6\"\n            position=\"0 5 -15\"\n          />\n          <a-entity hide-when-quality=\"low\" light=\"type: ambient; color: #FFF\" />\n          <a-entity id=\"meeting-space\" gltf-model-plus=\"src: #meeting-space1-mesh\" position=\"0 0 0\" />\n        </a-scene>\n        <button className=\"avatar-selector__previous-button\" onClick={this.emitChangeToPrevious}>\n          <FontAwesomeIcon icon={faAngleLeft} />\n        </button>\n        <button className=\"avatar-selector__next-button\" onClick={this.emitChangeToNext}>\n          <FontAwesomeIcon icon={faAngleRight} />\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarSelector);\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer();\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.context.getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n","/**\n * Emits audioFrequencyChange events based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this.smoothing = 0.3;\n    this.threshold = 0.01;\n    this.el.addEventListener(\"sound-source-set\", event => {\n      const ctx = THREE.AudioContext.getContext();\n      this.analyser = ctx.createAnalyser();\n      this.analyser.fftSize = 32;\n      this.levels = new Uint8Array(this.analyser.frequencyBinCount);\n      event.detail.soundSource.connect(this.analyser);\n    });\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n\n    // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n    this.analyser.getByteTimeDomainData(this.levels);\n\n    let sum = 0;\n    for (let i = 0; i < this.levels.length; i++) {\n      const amplitude = (this.levels[i] - 128) / 128;\n      sum += amplitude * amplitude;\n    }\n    let currVolume = Math.sqrt(sum / this.levels.length);\n    if (currVolume < this.threshold) {\n      currVolume = 0;\n    }\n    this.volume = this.smoothing * currVolume + (1 - this.smoothing) * this.prevVolume;\n    this.prevVolume = this.volume;\n  }\n});\n\n/**\n * Sets an entity's scale base on audioFrequencyChange events.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 2 }\n  },\n\n  tick() {\n    // TODO: come up with a cleaner way to handle this.\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\n    if (!this.el.object3D.visible) return;\n\n    const { minScale, maxScale } = this.data;\n\n    const audioAnalyser = this.el.components[\"networked-audio-analyser\"];\n\n    if (!audioAnalyser) return;\n\n    const scale = Math.min(maxScale, minScale + (maxScale - minScale) * audioAnalyser.volume * 8);\n    this.el.object3D.scale.setScalar(scale);\n  }\n});\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\nAFRAME.registerComponent(\"animation-mixer\", {\n  init() {\n    this.mixer = null;\n\n    const object3DMap = this.el.object3DMap;\n    const rootObject3D = object3DMap.mesh || object3DMap.scene;\n\n    if (rootObject3D) {\n      this.setAnimationMixer(rootObject3D);\n    } else {\n      this.onModelLoaded = this.onModelLoaded.bind(this);\n      this.el.addEventListener(\"model-loaded\", this.onModelLoaded);\n    }\n  },\n\n  onModelLoaded(event) {\n    const sceneObject3D = event.detail.model;\n    this.setAnimationMixer(sceneObject3D);\n\n    this.el.removeEventListener(this.onModelLoaded);\n  },\n\n  setAnimationMixer(rootObject3D) {\n    this.mixer = new THREE.AnimationMixer(rootObject3D);\n  },\n\n  tick: function(t, dt) {\n    if (this.mixer) {\n      this.mixer.update(dt / 1000);\n    }\n  },\n\n  destroy() {\n    this.el.removeEventListener(this.onModelLoaded);\n  }\n});\n","/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  dependencies: [\"animation-mixer\"],\n  schema: {\n    clip: { type: \"string\", required: true }\n  },\n  init() {\n    const object3DMap = this.el.object3DMap;\n    this.model = object3DMap.mesh || object3DMap.scene;\n\n    if (this.model) {\n      this.mixer = this.el.components[\"animation-mixer\"].mixer;\n    } else {\n      this.onModelLoaded = this.onModelLoaded.bind(this);\n      this.el.addEventListener(\"model-loaded\", this.onModelLoaded);\n    }\n  },\n\n  onModelLoaded(event) {\n    const animationMixerComponent = this.el.components[\"animation-mixer\"];\n    this.model = event.detail.model;\n    this.mixer = animationMixerComponent.mixer;\n\n    this.updateClipState(true);\n\n    this.el.removeEventListener(this.onModelLoaded);\n  },\n\n  update(oldData) {\n    if (oldData.clip !== this.data.clip && this.model) {\n      this.updateClipState(true);\n    }\n  },\n\n  updateClipState(play) {\n    const model = this.model;\n    const clipName = this.data.clip;\n\n    for (const clip of this.model.animations) {\n      if (clip.name === clipName) {\n        const action = this.mixer.clipAction(clip, model.parent);\n\n        if (play) {\n          action.enabled = true;\n          action.setLoop(THREE.LoopRepeat, Infinity).play();\n        } else {\n          action.stop();\n        }\n\n        break;\n      }\n    }\n  },\n\n  destroy() {\n    this.updateClipState(false);\n    this.el.removeEventListener(this.onModelLoaded);\n  }\n});\n","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","AFRAME.registerComponent(\"gamma-factor\", {\n  schema: {\n    gammaFactor: { type: \"number\", default: 2.2 }\n  },\n\n  init() {\n    const el = this.el;\n\n    if (!el.isScene) {\n      console.warn(\"gamma-factor component can only be applied to <a-scene>\");\n    }\n  },\n\n  update(prevData) {\n    const data = this.data;\n    const sceneEl = this.el;\n    const renderer = sceneEl.renderer;\n    let needsShaderUpdate = false;\n\n    if (data.gammaFactor !== prevData.gammaFactor) {\n      renderer.gammaFactor = data.gammaFactor;\n      needsShaderUpdate = true;\n    }\n\n    if (!needsShaderUpdate || sceneEl.time === 0) {\n      return;\n    }\n\n    sceneEl.object3D.traverse(function(node) {\n      if (!node.isMesh) {\n        return;\n      }\n\n      if (Array.isArray(node.material)) {\n        node.material.forEach(function(material) {\n          material.needsUpdate = true;\n        });\n      } else {\n        node.material.needsUpdate = true;\n      }\n    });\n  }\n});\n","import \"./components/gltf-model-plus\";\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"collision-filter\", \"collision-filter\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"scene-shadow\", \"scene-shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\");\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"body\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\");\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\"shape\", \"shape\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"shape\",\n  (() => {\n    const euler = new THREE.Euler();\n    const orientation = new THREE.Quaternion();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      orientation.setFromEuler(euler);\n      el.setAttribute(componentName, {\n        shape: \"box\",\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\");\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\");\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"hoverable\");\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\n  const nav = AFRAME.scenes[0].systems.nav;\n  const zone = componentData.zone || \"character\";\n  let found = false;\n  el.object3D.traverse(node => {\n    if (node.isMesh && !found) {\n      found = true;\n      nav.loadMesh(node, zone);\n    }\n  });\n});\n","import Store from \"./storage/store\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.quality = \"low\";\n    this.store = new Store();\n  }\n\n  setQuality(quality) {\n    if (this.quality === quality) {\n      return false;\n    }\n\n    this.quality = quality;\n\n    if (this.scene) {\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\n    }\n\n    return true;\n  }\n}\n"],"sourceRoot":""}